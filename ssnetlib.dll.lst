.text:42CF1000 ;
.text:42CF1000 ; +-------------------------------------------------------------------------+
.text:42CF1000 ; |      This file was generated by The Interactive Disassembler (IDA)      |
.text:42CF1000 ; |           Copyright (c) 2019 Hex-Rays, <support@hex-rays.com>           |
.text:42CF1000 ; |                      License info: 48-BABB-7E64-E2                      |
.text:42CF1000 ; |                     Georgia Institute of Technology                     |
.text:42CF1000 ; +-------------------------------------------------------------------------+
.text:42CF1000 ;
.text:42CF1000 ; Input SHA256 : 106D6842809B7C19C6C6B1EDC383D314384F2779BFB2C8FDED57667899DC7115
.text:42CF1000 ; Input MD5    : CDB90206E04F093949FEE2F0FB43E306
.text:42CF1000 ; Input CRC32  : 3A143BDC
.text:42CF1000
.text:42CF1000 ; File Name   : /nethome/pthirumal3/ECE4117/lab4/ssnetlib.dll
.text:42CF1000 ; Format      : Portable executable for 80386 (PE)
.text:42CF1000 ; Imagebase   : 42CF0000
.text:42CF1000 ; Timestamp   : 398D26D8 (Sun Aug 06 08:50:32 2000)
.text:42CF1000 ; Section 1. (virtual address 00001000)
.text:42CF1000 ; Virtual size                  : 0000C790 (  51088.)
.text:42CF1000 ; Section size in file          : 0000D000 (  53248.)
.text:42CF1000 ; Offset to raw data for section: 00001000
.text:42CF1000 ; Flags 60000020: Text Executable Readable
.text:42CF1000 ; Alignment     : default
.text:42CF1000 ; PDB File Name : dll\SSnetlib.pdb
.text:42CF1000
.text:42CF1000                 include uni.inc ; see unicode subdir of ida for info on unicode
.text:42CF1000
.text:42CF1000                 .686p
.text:42CF1000                 .mmx
.text:42CF1000                 .model flat
.text:42CF1000
.text:42CF1000 ; ===========================================================================
.text:42CF1000
.text:42CF1000 ; Segment type: Pure code
.text:42CF1000 ; Segment permissions: Read/Execute
.text:42CF1000 _text           segment para public 'CODE' use32
.text:42CF1000                 assume cs:_text
.text:42CF1000                 ;org 42CF1000h
.text:42CF1000                 assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
.text:42CF1000
.text:42CF1000 ; =============== S U B R O U T I N E =======================================
.text:42CF1000
.text:42CF1000 ; Attributes: bp-based frame
.text:42CF1000
.text:42CF1000 ; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
.text:42CF1000                 public DllEntryPoint
.text:42CF1000 DllEntryPoint   proc near
.text:42CF1000
.text:42CF1000 var_1A4         = dword ptr -1A4h
.text:42CF1000 NumberOfConcurrentThreads= dword ptr -1A0h
.text:42CF1000 Buffer          = byte ptr -19Ch
.text:42CF1000 WSAData         = WSAData ptr -190h
.text:42CF1000 hinstDLL        = dword ptr  8
.text:42CF1000 fdwReason       = dword ptr  0Ch
.text:42CF1000 lpReserved      = dword ptr  10h
.text:42CF1000
.text:42CF1000                 push    ebp
.text:42CF1001                 mov     ebp, esp
.text:42CF1003                 sub     esp, 1A4h
.text:42CF1009                 mov     eax, [ebp+fdwReason]
.text:42CF100C                 mov     [ebp+var_1A4], eax
.text:42CF1012                 cmp     [ebp+var_1A4], 0
.text:42CF1019                 jz      loc_42CF10E1
.text:42CF101F                 cmp     [ebp+var_1A4], 1
.text:42CF1026                 jz      short loc_42CF102D
.text:42CF1028                 jmp     loc_42CF1182
.text:42CF102D ; ---------------------------------------------------------------------------
.text:42CF102D
.text:42CF102D loc_42CF102D:                           ; CODE XREF: DllEntryPoint+26\u2191j
.text:42CF102D                 lea     ecx, [ebp+WSAData]
.text:42CF1033                 push    ecx             ; lpWSAData
.text:42CF1034                 push    202h            ; wVersionRequested
.text:42CF1039                 call    ds:WSAStartup
.text:42CF103F                 test    eax, eax
.text:42CF1041                 jz      short loc_42CF104A
.text:42CF1043                 xor     eax, eax
.text:42CF1045                 jmp     loc_42CF1187
.text:42CF104A ; ---------------------------------------------------------------------------
.text:42CF104A
.text:42CF104A loc_42CF104A:                           ; CODE XREF: DllEntryPoint+41\u2191j
.text:42CF104A                 mov     dword_42D01A1C, 0
.text:42CF1054                 mov     VersionInformation.dwOSVersionInfoSize, 94h ; '”'
.text:42CF105E                 push    offset VersionInformation ; lpVersionInformation
.text:42CF1063                 call    ds:GetVersionExA
.text:42CF1069                 cmp     eax, 1
.text:42CF106C                 jnz     short loc_42CF1081
.text:42CF106E                 cmp     VersionInformation.dwPlatformId, 2
.text:42CF1075                 jnz     short loc_42CF1081
.text:42CF1077                 mov     dword_42D01A1C, 1
.text:42CF1081
.text:42CF1081 loc_42CF1081:                           ; CODE XREF: DllEntryPoint+6C\u2191j
.text:42CF1081                                         ; DllEntryPoint+75\u2191j
.text:42CF1081                 cmp     dword_42D01A1C, 0
.text:42CF1088                 jz      short loc_42CF10DC
.text:42CF108A                 push    0Ch             ; nSize
.text:42CF108C                 lea     edx, [ebp+Buffer]
.text:42CF1092                 push    edx             ; lpBuffer
.text:42CF1093                 push    offset Name     ; "CONCURRENT"
.text:42CF1098                 call    ds:GetEnvironmentVariableA
.text:42CF109E                 test    eax, eax
.text:42CF10A0                 jz      short loc_42CF10BA
.text:42CF10A2                 lea     eax, [ebp+Buffer]
.text:42CF10A8                 push    eax             ; String
.text:42CF10A9                 call    ds:atoi
.text:42CF10AF                 add     esp, 4
.text:42CF10B2                 mov     [ebp+NumberOfConcurrentThreads], eax
.text:42CF10B8                 jmp     short loc_42CF10C4
.text:42CF10BA ; ---------------------------------------------------------------------------
.text:42CF10BA
.text:42CF10BA loc_42CF10BA:                           ; CODE XREF: DllEntryPoint+A0\u2191j
.text:42CF10BA                 mov     [ebp+NumberOfConcurrentThreads], 1
.text:42CF10C4
.text:42CF10C4 loc_42CF10C4:                           ; CODE XREF: DllEntryPoint+B8\u2191j
.text:42CF10C4                 mov     ecx, [ebp+NumberOfConcurrentThreads]
.text:42CF10CA                 push    ecx             ; NumberOfConcurrentThreads
.text:42CF10CB                 push    0               ; CompletionKey
.text:42CF10CD                 push    0               ; ExistingCompletionPort
.text:42CF10CF                 push    0FFFFFFFFh      ; FileHandle
.text:42CF10D1                 call    ds:CreateIoCompletionPort
.text:42CF10D7                 mov     CompletionPort, eax
.text:42CF10DC
.text:42CF10DC loc_42CF10DC:                           ; CODE XREF: DllEntryPoint+88\u2191j
.text:42CF10DC                 jmp     loc_42CF1182
.text:42CF10E1 ; ---------------------------------------------------------------------------
.text:42CF10E1
.text:42CF10E1 loc_42CF10E1:                           ; CODE XREF: DllEntryPoint+19\u2191j
.text:42CF10E1                 cmp     CompletionPort, 0
.text:42CF10E8                 jz      short loc_42CF10F7
.text:42CF10EA                 mov     edx, CompletionPort
.text:42CF10F0                 push    edx             ; hObject
.text:42CF10F1                 call    ds:CloseHandle
.text:42CF10F7
.text:42CF10F7 loc_42CF10F7:                           ; CODE XREF: DllEntryPoint+E8\u2191j
.text:42CF10F7                 mov     CompletionPort, 0
.text:42CF1101                 cmp     hLibModule, 0
.text:42CF1108                 jz      short loc_42CF1116
.text:42CF110A                 mov     eax, hLibModule
.text:42CF110F                 push    eax             ; hLibModule
.text:42CF1110                 call    ds:FreeLibrary
.text:42CF1116
.text:42CF1116 loc_42CF1116:                           ; CODE XREF: DllEntryPoint+108\u2191j
.text:42CF1116                 cmp     dword_42D01F44, 0
.text:42CF111D                 jz      short loc_42CF112C
.text:42CF111F                 mov     ecx, dword_42D01F44
.text:42CF1125                 push    ecx             ; hLibModule
.text:42CF1126                 call    ds:FreeLibrary
.text:42CF112C
.text:42CF112C loc_42CF112C:                           ; CODE XREF: DllEntryPoint+11D\u2191j
.text:42CF112C                 cmp     dword_42D01C64, 0
.text:42CF1133                 jz      short loc_42CF1142
.text:42CF1135                 mov     edx, dword_42D01C64
.text:42CF113B                 push    edx             ; hLibModule
.text:42CF113C                 call    ds:FreeLibrary
.text:42CF1142
.text:42CF1142 loc_42CF1142:                           ; CODE XREF: DllEntryPoint+133\u2191j
.text:42CF1142                 cmp     dword_42D01C04, 0
.text:42CF1149                 jz      short loc_42CF1157
.text:42CF114B                 mov     eax, dword_42D01C04
.text:42CF1150                 push    eax             ; hLibModule
.text:42CF1151                 call    ds:FreeLibrary
.text:42CF1157
.text:42CF1157 loc_42CF1157:                           ; CODE XREF: DllEntryPoint+149\u2191j
.text:42CF1157                 cmp     dword_42D020C4, 0
.text:42CF115E                 jz      short loc_42CF116D
.text:42CF1160                 mov     ecx, dword_42D020C4
.text:42CF1166                 push    ecx             ; hLibModule
.text:42CF1167                 call    ds:FreeLibrary
.text:42CF116D
.text:42CF116D loc_42CF116D:                           ; CODE XREF: DllEntryPoint+15E\u2191j
.text:42CF116D                 call    ds:WSACleanup
.text:42CF1173                 test    eax, eax
.text:42CF1175                 jnz     short loc_42CF117E
.text:42CF1177                 mov     eax, 1
.text:42CF117C                 jmp     short loc_42CF1187
.text:42CF117E ; ---------------------------------------------------------------------------
.text:42CF117E
.text:42CF117E loc_42CF117E:                           ; CODE XREF: DllEntryPoint+175\u2191j
.text:42CF117E                 xor     eax, eax
.text:42CF1180                 jmp     short loc_42CF1187
.text:42CF1182 ; ---------------------------------------------------------------------------
.text:42CF1182
.text:42CF1182 loc_42CF1182:                           ; CODE XREF: DllEntryPoint+28\u2191j
.text:42CF1182                                         ; DllEntryPoint:loc_42CF10DC\u2191j
.text:42CF1182                 mov     eax, 1
.text:42CF1187
.text:42CF1187 loc_42CF1187:                           ; CODE XREF: DllEntryPoint+45\u2191j
.text:42CF1187                                         ; DllEntryPoint+17C\u2191j ...
.text:42CF1187                 mov     esp, ebp
.text:42CF1189                 pop     ebp
.text:42CF118A                 retn    0Ch
.text:42CF118A DllEntryPoint   endp
.text:42CF118A
.text:42CF118D ; Exported entry   9. ConnectionVer
.text:42CF118D
.text:42CF118D ; =============== S U B R O U T I N E =======================================
.text:42CF118D
.text:42CF118D ; Attributes: bp-based frame
.text:42CF118D
.text:42CF118D ; ULONG ConnectionVer(void)
.text:42CF118D                 public ConnectionVer
.text:42CF118D ConnectionVer   proc near               ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF118D                 push    ebp
.text:42CF118E                 mov     ebp, esp
.text:42CF1190                 mov     eax, 80000C2h
.text:42CF1195                 pop     ebp
.text:42CF1196                 retn
.text:42CF1196 ConnectionVer   endp
.text:42CF1196
.text:42CF1197
.text:42CF1197 ; =============== S U B R O U T I N E =======================================
.text:42CF1197
.text:42CF1197 ; Attributes: bp-based frame
.text:42CF1197
.text:42CF1197 sub_42CF1197    proc near               ; CODE XREF: ConnectionListen+253\u2193p
.text:42CF1197                                         ; ConnectionListen+278\u2193p ...
.text:42CF1197
.text:42CF1197 var_C           = dword ptr -0Ch
.text:42CF1197 Strings         = dword ptr -8
.text:42CF1197 var_4           = dword ptr -4
.text:42CF1197 arg_0           = dword ptr  8
.text:42CF1197 arg_4           = dword ptr  0Ch
.text:42CF1197
.text:42CF1197                 push    ebp
.text:42CF1198                 mov     ebp, esp
.text:42CF119A                 sub     esp, 0Ch
.text:42CF119D                 cmp     hEventLog, 0
.text:42CF11A4                 jz      short loc_42CF11D6
.text:42CF11A6                 mov     eax, [ebp+arg_0]
.text:42CF11A9                 mov     [ebp+Strings], eax
.text:42CF11AC                 mov     ecx, [ebp+arg_4]
.text:42CF11AF                 mov     [ebp+var_4], ecx
.text:42CF11B2                 push    0               ; lpRawData
.text:42CF11B4                 lea     edx, [ebp+Strings]
.text:42CF11B7                 push    edx             ; lpStrings
.text:42CF11B8                 push    0               ; dwDataSize
.text:42CF11BA                 push    2               ; wNumStrings
.text:42CF11BC                 push    0               ; lpUserSid
.text:42CF11BE                 push    0C0004A46h      ; dwEventID
.text:42CF11C3                 push    8               ; wCategory
.text:42CF11C5                 push    1               ; wType
.text:42CF11C7                 mov     eax, hEventLog
.text:42CF11CC                 push    eax             ; hEventLog
.text:42CF11CD                 call    ds:ReportEventA
.text:42CF11D3                 mov     [ebp+var_C], eax
.text:42CF11D6
.text:42CF11D6 loc_42CF11D6:                           ; CODE XREF: sub_42CF1197+D\u2191j
.text:42CF11D6                 mov     ecx, [ebp+arg_4]
.text:42CF11D9                 push    ecx
.text:42CF11DA                 mov     edx, [ebp+arg_0]
.text:42CF11DD                 push    edx
.text:42CF11DE                 push    0C0004A46h
.text:42CF11E3                 call    dword_42D01A18
.text:42CF11E9                 add     esp, 0Ch
.text:42CF11EC                 mov     esp, ebp
.text:42CF11EE                 pop     ebp
.text:42CF11EF                 retn
.text:42CF11EF sub_42CF1197    endp
.text:42CF11EF
.text:42CF11F0 ; Exported entry   4. ConnectionListen
.text:42CF11F0
.text:42CF11F0 ; =============== S U B R O U T I N E =======================================
.text:42CF11F0
.text:42CF11F0 ; Attributes: bp-based frame
.text:42CF11F0
.text:42CF11F0 ; int __cdecl ConnectionListen(char *Str1, int, int)
.text:42CF11F0                 public ConnectionListen
.text:42CF11F0 ConnectionListen proc near              ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF11F0
.text:42CF11F0 var_3820        = dword ptr -3820h
.text:42CF11F0 namelen         = dword ptr -381Ch
.text:42CF11F0 var_3818        = sockaddr ptr -3818h
.text:42CF11F0 Buffer          = word ptr -3808h
.text:42CF11F0 var_37C8        = dword ptr -37C8h
.text:42CF11F0 var_37C4        = dword ptr -37C4h
.text:42CF11F0 Destination     = byte ptr -37C0h
.text:42CF11F0 var_37BC        = word ptr -37BCh
.text:42CF11F0 var_37BA        = byte ptr -37BAh
.text:42CF11F0 var_37B9        = byte ptr -37B9h
.text:42CF11F0 s               = dword ptr -35C0h
.text:42CF11F0 var_35BC        = dword ptr -35BCh
.text:42CF11F0 var_35B8        = dword ptr -35B8h
.text:42CF11F0 var_35B4        = dword ptr -35B4h
.text:42CF11F0 var_35B0        = dword ptr -35B0h
.text:42CF11F0 var_35AC        = dword ptr -35ACh
.text:42CF11F0 optval          = byte ptr -35A8h
.text:42CF11F0 var_35A4        = dword ptr -35A4h
.text:42CF11F0 var_35A0        = dword ptr -35A0h
.text:42CF11F0 var_359C        = dword ptr -359Ch
.text:42CF11F0 var_3598        = dword ptr -3598h
.text:42CF11F0 Value           = dword ptr -3594h
.text:42CF11F0 var_3494        = dword ptr -3494h
.text:42CF11F0 var_348C        = dword ptr -348Ch
.text:42CF11F0 var_338C        = dword ptr -338Ch
.text:42CF11F0 var_3284        = dword ptr -3284h
.text:42CF11F0 var_3280        = dword ptr -3280h
.text:42CF11F0 var_3278        = dword ptr -3278h
.text:42CF11F0 Source          = byte ptr -3274h
.text:42CF11F0 var_3074        = dword ptr -3074h
.text:42CF11F0 var_206C        = dword ptr -206Ch
.text:42CF11F0 var_106C        = dword ptr -106Ch
.text:42CF11F0 var_1068        = byte ptr -1068h
.text:42CF11F0 backlog         = dword ptr -0E68h
.text:42CF11F0 var_E64         = dword ptr -0E64h
.text:42CF11F0 var_E60         = dword ptr -0E60h
.text:42CF11F0 var_E5C         = dword ptr -0E5Ch
.text:42CF11F0 var_E58         = dword ptr -0E58h
.text:42CF11F0 var_E50         = dword ptr -0E50h
.text:42CF11F0 var_E4C         = dword ptr -0E4Ch
.text:42CF11F0 var_E48         = dword ptr -0E48h
.text:42CF11F0 String1         = byte ptr -0E40h
.text:42CF11F0 var_E3F         = byte ptr -0E3Fh
.text:42CF11F0 MultiByteStr    = byte ptr -0E3Eh
.text:42CF11F0 var_A40         = dword ptr -0A40h
.text:42CF11F0 var_A3C         = dword ptr -0A3Ch
.text:42CF11F0 var_A38         = dword ptr -0A38h
.text:42CF11F0 var_A34         = dword ptr -0A34h
.text:42CF11F0 var_A30         = dword ptr -0A30h
.text:42CF11F0 var_A2C         = dword ptr -0A2Ch
.text:42CF11F0 WideCharStr     = word ptr -0A28h
.text:42CF11F0 name            = dword ptr -228h
.text:42CF11F0 var_224         = dword ptr -224h
.text:42CF11F0 var_220         = dword ptr -220h
.text:42CF11F0 dwBufferLength  = dword ptr -21Ch
.text:42CF11F0 var_218         = dword ptr -218h
.text:42CF11F0 var_214         = word ptr -214h
.text:42CF11F0 var_212         = byte ptr -212h
.text:42CF11F0 var_210         = byte ptr -210h
.text:42CF11F0 var_14          = dword ptr -14h
.text:42CF11F0 Block           = dword ptr -10h
.text:42CF11F0 var_C           = dword ptr -0Ch
.text:42CF11F0 lpProtocolBuffer= dword ptr -8
.text:42CF11F0 var_4           = dword ptr -4
.text:42CF11F0 Str1            = dword ptr  8
.text:42CF11F0 arg_4           = dword ptr  0Ch
.text:42CF11F0 arg_8           = dword ptr  10h
.text:42CF11F0
.text:42CF11F0                 push    ebp
.text:42CF11F1                 mov     ebp, esp
.text:42CF11F3                 mov     eax, 3820h
.text:42CF11F8                 call    __alloca_probe
.text:42CF11FD                 push    edi
.text:42CF11FE                 mov     [ebp+var_35AC], 0
.text:42CF1208                 mov     [ebp+var_359C], 0
.text:42CF1212                 mov     [ebp+var_A34], 0
.text:42CF121C                 mov     dword ptr [ebp+optval], 1
.text:42CF1226                 mov     [ebp+Block], 0
.text:42CF122D                 mov     [ebp+var_A2C], 0
.text:42CF1237                 mov     ax, word_42D010EC
.text:42CF123D                 mov     [ebp+var_214], ax
.text:42CF1244                 mov     ecx, 7Fh
.text:42CF1249                 xor     eax, eax
.text:42CF124B                 lea     edi, [ebp+var_212]
.text:42CF1251                 rep stosd
.text:42CF1253                 stosw
.text:42CF1255                 mov     [ebp+var_35A4], 0
.text:42CF125F                 mov     [ebp+var_14], 1
.text:42CF1266                 mov     cl, byte_42D010F0
.text:42CF126C                 mov     [ebp+String1], cl
.text:42CF1272                 mov     ecx, 0FFh
.text:42CF1277                 xor     eax, eax
.text:42CF1279                 lea     edi, [ebp+var_E3F]
.text:42CF127F                 rep stosd
.text:42CF1281                 stosw
.text:42CF1283                 stosb
.text:42CF1284                 push    offset nSize    ; nSize
.text:42CF1289                 push    offset name     ; lpBuffer
.text:42CF128E                 call    ds:GetComputerNameA
.text:42CF1294                 test    eax, eax
.text:42CF1296                 jnz     short loc_42CF12A6
.text:42CF1298                 mov     edx, [ebp+arg_4]
.text:42CF129B                 mov     dword ptr [edx], 0Bh
.text:42CF12A1                 jmp     loc_42CF23CF
.text:42CF12A6 ; ---------------------------------------------------------------------------
.text:42CF12A6
.text:42CF12A6 loc_42CF12A6:                           ; CODE XREF: ConnectionListen+A6\u2191j
.text:42CF12A6                 cmp     [ebp+Str1], 0
.text:42CF12AA                 jz      short loc_42CF12D7
.text:42CF12AC                 push    offset Str2     ; Str2
.text:42CF12B1                 mov     eax, [ebp+Str1]
.text:42CF12B4                 push    eax             ; Str1
.text:42CF12B5                 call    strcmp
.text:42CF12BA                 add     esp, 8
.text:42CF12BD                 test    eax, eax
.text:42CF12BF                 jz      short loc_42CF12D7
.text:42CF12C1                 push    offset String2  ; "MSSQLServer"
.text:42CF12C6                 mov     ecx, [ebp+Str1]
.text:42CF12C9                 push    ecx             ; String1
.text:42CF12CA                 call    ds:_stricmp
.text:42CF12D0                 add     esp, 8
.text:42CF12D3                 test    eax, eax
.text:42CF12D5                 jnz     short loc_42CF12EB
.text:42CF12D7
.text:42CF12D7 loc_42CF12D7:                           ; CODE XREF: ConnectionListen+BA\u2191j
.text:42CF12D7                                         ; ConnectionListen+CF\u2191j
.text:42CF12D7                 push    offset Source   ; "MSSQLServer"
.text:42CF12DC                 push    offset MultiByteStr ; Destination
.text:42CF12E1                 call    strcpy
.text:42CF12E6                 add     esp, 8
.text:42CF12E9                 jmp     short loc_42CF12FC
.text:42CF12EB ; ---------------------------------------------------------------------------
.text:42CF12EB
.text:42CF12EB loc_42CF12EB:                           ; CODE XREF: ConnectionListen+E5\u2191j
.text:42CF12EB                 mov     edx, [ebp+Str1]
.text:42CF12EE                 push    edx             ; Source
.text:42CF12EF                 push    offset MultiByteStr ; Destination
.text:42CF12F4                 call    strcpy
.text:42CF12F9                 add     esp, 8
.text:42CF12FC
.text:42CF12FC loc_42CF12FC:                           ; CODE XREF: ConnectionListen+F9\u2191j
.text:42CF12FC                 lea     eax, [ebp+var_3598]
.text:42CF1302                 push    eax             ; PHKEY
.text:42CF1303                 push    offset MultiByteStr ; String1
.text:42CF1308                 call    sub_42CF8300
.text:42CF130D                 add     esp, 8
.text:42CF1310                 cmp     [ebp+var_E64], 0
.text:42CF1317                 jz      short loc_42CF132C
.text:42CF1319                 cmp     [ebp+var_3284], 0
.text:42CF1320                 jz      short loc_42CF132C
.text:42CF1322                 mov     dword_42D010DC, 1
.text:42CF132C
.text:42CF132C loc_42CF132C:                           ; CODE XREF: ConnectionListen+127\u2191j
.text:42CF132C                                         ; ConnectionListen+130\u2191j
.text:42CF132C                 cmp     [ebp+var_E48], 1
.text:42CF1333                 jnz     short loc_42CF1359
.text:42CF1335                 push    offset MultiByteStr ; lpMultiByteStr
.text:42CF133A                 push    offset name     ; LPSTR
.text:42CF133F                 call    sub_42CFCFEA
.text:42CF1344                 add     esp, 8
.text:42CF1347                 test    eax, eax
.text:42CF1349                 jnz     short loc_42CF1359
.text:42CF134B                 mov     ecx, [ebp+arg_4]
.text:42CF134E                 mov     dword ptr [ecx], 0Bh
.text:42CF1354                 jmp     loc_42CF23CF
.text:42CF1359 ; ---------------------------------------------------------------------------
.text:42CF1359
.text:42CF1359 loc_42CF1359:                           ; CODE XREF: ConnectionListen+143\u2191j
.text:42CF1359                                         ; ConnectionListen+159\u2191j
.text:42CF1359                 push    0A8h ; '¨'      ; Size
.text:42CF135E                 call    ds:malloc
.text:42CF1364                 add     esp, 4
.text:42CF1367                 mov     [ebp+Block], eax
.text:42CF136A                 cmp     [ebp+Block], 0
.text:42CF136E                 jnz     short loc_42CF137E
.text:42CF1370                 mov     edx, [ebp+arg_4]
.text:42CF1373                 mov     dword ptr [edx], 1
.text:42CF1379                 jmp     loc_42CF23CF
.text:42CF137E ; ---------------------------------------------------------------------------
.text:42CF137E
.text:42CF137E loc_42CF137E:                           ; CODE XREF: ConnectionListen+17E\u2191j
.text:42CF137E                 push    0A8h ; '¨'      ; Size
.text:42CF1383                 push    0               ; Val
.text:42CF1385                 mov     eax, [ebp+Block]
.text:42CF1388                 push    eax             ; void *
.text:42CF1389                 call    memset
.text:42CF138E                 add     esp, 0Ch
.text:42CF1391                 push    offset aMssqlserver_1 ; "MSSQLServer"
.text:42CF1396                 push    offset MultiByteStr ; String1
.text:42CF139B                 call    ds:_stricmp
.text:42CF13A1                 add     esp, 8
.text:42CF13A4                 test    eax, eax
.text:42CF13A6                 jnz     short loc_42CF13BC
.text:42CF13A8                 push    offset MultiByteStr ; lpSourceName
.text:42CF13AD                 push    0               ; lpUNCServerName
.text:42CF13AF                 call    ds:RegisterEventSourceA
.text:42CF13B5                 mov     hEventLog, eax
.text:42CF13BA                 jmp     short loc_42CF1419
.text:42CF13BC ; ---------------------------------------------------------------------------
.text:42CF13BC
.text:42CF13BC loc_42CF13BC:                           ; CODE XREF: ConnectionListen+1B6\u2191j
.text:42CF13BC                 mov     ecx, dword_42CFF058
.text:42CF13C2                 mov     dword ptr [ebp+Destination], ecx
.text:42CF13C8                 mov     dx, word_42CFF05C
.text:42CF13CF                 mov     [ebp+var_37BC], dx
.text:42CF13D6                 mov     al, byte_42CFF05E
.text:42CF13DB                 mov     [ebp+var_37BA], al
.text:42CF13E1                 mov     ecx, 7Eh ; '~'
.text:42CF13E6                 xor     eax, eax
.text:42CF13E8                 lea     edi, [ebp+var_37B9]
.text:42CF13EE                 rep stosd
.text:42CF13F0                 stosb
.text:42CF13F1                 push    offset MultiByteStr ; Source
.text:42CF13F6                 lea     ecx, [ebp+Destination]
.text:42CF13FC                 push    ecx             ; Destination
.text:42CF13FD                 call    strcat
.text:42CF1402                 add     esp, 8
.text:42CF1405                 lea     edx, [ebp+Destination]
.text:42CF140B                 push    edx             ; lpSourceName
.text:42CF140C                 push    0               ; lpUNCServerName
.text:42CF140E                 call    ds:RegisterEventSourceA
.text:42CF1414                 mov     hEventLog, eax
.text:42CF1419
.text:42CF1419 loc_42CF1419:                           ; CODE XREF: ConnectionListen+1CA\u2191j
.text:42CF1419                 cmp     [ebp+var_E48], 1
.text:42CF1420                 jnz     loc_42CF14DF
.text:42CF1426                 cmp     [ebp+var_E60], 1
.text:42CF142D                 jnz     short loc_42CF144B
.text:42CF142F                 mov     [ebp+var_E60], 0
.text:42CF1439                 push    offset unk_42CFF060
.text:42CF143E                 push    offset aClustered ; "Clustered"
.text:42CF1443                 call    sub_42CF1197
.text:42CF1448                 add     esp, 8
.text:42CF144B
.text:42CF144B loc_42CF144B:                           ; CODE XREF: ConnectionListen+23D\u2191j
.text:42CF144B                 cmp     [ebp+var_E5C], 1
.text:42CF1452                 jnz     short loc_42CF1470
.text:42CF1454                 mov     [ebp+var_E5C], 0
.text:42CF145E                 push    offset aAdsp    ; "Adsp"
.text:42CF1463                 push    offset aClustered_0 ; "Clustered"
.text:42CF1468                 call    sub_42CF1197
.text:42CF146D                 add     esp, 8
.text:42CF1470
.text:42CF1470 loc_42CF1470:                           ; CODE XREF: ConnectionListen+262\u2191j
.text:42CF1470                 cmp     [ebp+var_E58], 1
.text:42CF1477                 jnz     short loc_42CF1495
.text:42CF1479                 mov     [ebp+var_E58], 0
.text:42CF1483                 push    offset aWsproxy ; "WsProxy"
.text:42CF1488                 push    offset aClustered_1 ; "Clustered"
.text:42CF148D                 call    sub_42CF1197
.text:42CF1492                 add     esp, 8
.text:42CF1495
.text:42CF1495 loc_42CF1495:                           ; CODE XREF: ConnectionListen+287\u2191j
.text:42CF1495                 cmp     [ebp+var_E50], 1
.text:42CF149C                 jnz     short loc_42CF14BA
.text:42CF149E                 mov     [ebp+var_E50], 0
.text:42CF14A8                 push    offset aRpc     ; "Rpc"
.text:42CF14AD                 push    offset aClustered_2 ; "Clustered"
.text:42CF14B2                 call    sub_42CF1197
.text:42CF14B7                 add     esp, 8
.text:42CF14BA
.text:42CF14BA loc_42CF14BA:                           ; CODE XREF: ConnectionListen+2AC\u2191j
.text:42CF14BA                 cmp     [ebp+var_E4C], 1
.text:42CF14C1                 jnz     short loc_42CF14DF
.text:42CF14C3                 mov     [ebp+var_E4C], 0
.text:42CF14CD                 push    offset aBanyanVines ; "Banyan Vines"
.text:42CF14D2                 push    offset aClustered_3 ; "Clustered"
.text:42CF14D7                 call    sub_42CF1197
.text:42CF14DC                 add     esp, 8
.text:42CF14DF
.text:42CF14DF loc_42CF14DF:                           ; CODE XREF: ConnectionListen+230\u2191j
.text:42CF14DF                                         ; ConnectionListen+2D1\u2191j
.text:42CF14DF                 push    offset aMssqlserver_2 ; "MSSQLServer"
.text:42CF14E4                 push    offset MultiByteStr ; String1
.text:42CF14E9                 call    ds:_stricmp
.text:42CF14EF                 add     esp, 8
.text:42CF14F2                 test    eax, eax
.text:42CF14F4                 jz      loc_42CF158E
.text:42CF14FA                 cmp     [ebp+var_E5C], 1
.text:42CF1501                 jnz     short loc_42CF151F
.text:42CF1503                 mov     [ebp+var_E5C], 0
.text:42CF150D                 push    offset aAdsp_0  ; "Adsp"
.text:42CF1512                 push    offset aNonDefaultInst ; "Non-Default Instance"
.text:42CF1517                 call    sub_42CF1197
.text:42CF151C                 add     esp, 8
.text:42CF151F
.text:42CF151F loc_42CF151F:                           ; CODE XREF: ConnectionListen+311\u2191j
.text:42CF151F                 cmp     [ebp+var_E58], 1
.text:42CF1526                 jnz     short loc_42CF1544
.text:42CF1528                 mov     [ebp+var_E58], 0
.text:42CF1532                 push    offset aWsproxy_0 ; "WsProxy"
.text:42CF1537                 push    offset aNonDefault ; "Non-Default"
.text:42CF153C                 call    sub_42CF1197
.text:42CF1541                 add     esp, 8
.text:42CF1544
.text:42CF1544 loc_42CF1544:                           ; CODE XREF: ConnectionListen+336\u2191j
.text:42CF1544                 cmp     [ebp+var_E50], 1
.text:42CF154B                 jnz     short loc_42CF1569
.text:42CF154D                 mov     [ebp+var_E50], 0
.text:42CF1557                 push    offset aRpc_0   ; "Rpc"
.text:42CF155C                 push    offset aNonDefault_0 ; "Non-Default"
.text:42CF1561                 call    sub_42CF1197
.text:42CF1566                 add     esp, 8
.text:42CF1569
.text:42CF1569 loc_42CF1569:                           ; CODE XREF: ConnectionListen+35B\u2191j
.text:42CF1569                 cmp     [ebp+var_E4C], 1
.text:42CF1570                 jnz     short loc_42CF158E
.text:42CF1572                 mov     [ebp+var_E4C], 0
.text:42CF157C                 push    offset aBanyanVines_0 ; "Banyan Vines"
.text:42CF1581                 push    offset aNonDefault_1 ; "Non-Default"
.text:42CF1586                 call    sub_42CF1197
.text:42CF158B                 add     esp, 8
.text:42CF158E
.text:42CF158E loc_42CF158E:                           ; CODE XREF: ConnectionListen+304\u2191j
.text:42CF158E                                         ; ConnectionListen+380\u2191j
.text:42CF158E                 mov     eax, [ebp+Block]
.text:42CF1591                 mov     dword ptr [eax+8], 1
.text:42CF1598                 mov     ecx, [ebp+arg_4]
.text:42CF159B                 mov     dword ptr [ecx], 0
.text:42CF15A1                 mov     edx, [ebp+Block]
.text:42CF15A4                 mov     eax, dword_42D01B40
.text:42CF15A9                 mov     [edx+64h], eax
.text:42CF15AC                 call    sub_42CF7930
.text:42CF15B1                 test    eax, eax
.text:42CF15B3                 jz      short loc_42CF15F0
.text:42CF15B5                 cmp     [ebp+var_E48], 1
.text:42CF15BC                 jnz     short loc_42CF15CC
.text:42CF15BE                 lea     ecx, [ebp+var_1068]
.text:42CF15C4                 mov     [ebp+var_3820], ecx
.text:42CF15CA                 jmp     short loc_42CF15D6
.text:42CF15CC ; ---------------------------------------------------------------------------
.text:42CF15CC
.text:42CF15CC loc_42CF15CC:                           ; CODE XREF: ConnectionListen+3CC\u2191j
.text:42CF15CC                 mov     [ebp+var_3820], offset name
.text:42CF15D6
.text:42CF15D6 loc_42CF15D6:                           ; CODE XREF: ConnectionListen+3DA\u2191j
.text:42CF15D6                 push    1
.text:42CF15D8                 push    offset unk_42D01DC8
.text:42CF15DD                 mov     edx, [ebp+var_3820]
.text:42CF15E3                 push    edx
.text:42CF15E4                 call    sub_42CF7A27
.text:42CF15E9                 add     esp, 0Ch
.text:42CF15EC                 test    eax, eax
.text:42CF15EE                 jz      short loc_42CF1650
.text:42CF15F0
.text:42CF15F0 loc_42CF15F0:                           ; CODE XREF: ConnectionListen+3C3\u2191j
.text:42CF15F0                 mov     eax, [ebp+Block]
.text:42CF15F3                 cmp     dword ptr [eax+64h], 1
.text:42CF15F7                 jnz     short loc_42CF1644
.text:42CF15F9                 cmp     hEventLog, 0
.text:42CF1600                 jz      short loc_42CF1628
.text:42CF1602                 push    0               ; lpRawData
.text:42CF1604                 push    0               ; lpStrings
.text:42CF1606                 push    0               ; dwDataSize
.text:42CF1608                 push    0               ; wNumStrings
.text:42CF160A                 push    0               ; lpUserSid
.text:42CF160C                 push    0C0004A47h      ; dwEventID
.text:42CF1611                 push    8               ; wCategory
.text:42CF1613                 push    1               ; wType
.text:42CF1615                 mov     ecx, hEventLog
.text:42CF161B                 push    ecx             ; hEventLog
.text:42CF161C                 call    ds:ReportEventA
.text:42CF1622                 mov     [ebp+var_37C4], eax
.text:42CF1628
.text:42CF1628 loc_42CF1628:                           ; CODE XREF: ConnectionListen+410\u2191j
.text:42CF1628                 push    0C0004A47h
.text:42CF162D                 call    dword_42D01A18
.text:42CF1633                 add     esp, 4
.text:42CF1636                 mov     edx, [ebp+arg_4]
.text:42CF1639                 mov     dword ptr [edx], 14h
.text:42CF163F                 jmp     loc_42CF23CF
.text:42CF1644 ; ---------------------------------------------------------------------------
.text:42CF1644
.text:42CF1644 loc_42CF1644:                           ; CODE XREF: ConnectionListen+407\u2191j
.text:42CF1644                 mov     dword_42D01DFC, 0
.text:42CF164E                 jmp     short loc_42CF165A
.text:42CF1650 ; ---------------------------------------------------------------------------
.text:42CF1650
.text:42CF1650 loc_42CF1650:                           ; CODE XREF: ConnectionListen+3FE\u2191j
.text:42CF1650                 mov     dword_42D01DFC, 1
.text:42CF165A
.text:42CF165A loc_42CF165A:                           ; CODE XREF: ConnectionListen+45E\u2191j
.text:42CF165A                 mov     eax, [ebp+arg_8]
.text:42CF165D                 mov     ecx, [ebp+Block]
.text:42CF1660                 mov     edx, [ecx+64h]
.text:42CF1663                 mov     [eax], edx
.text:42CF1665                 push    0               ; lpName
.text:42CF1667                 push    1               ; lMaximumCount
.text:42CF1669                 push    1               ; lInitialCount
.text:42CF166B                 push    0               ; lpSemaphoreAttributes
.text:42CF166D                 call    ds:CreateSemaphoreA
.text:42CF1673                 mov     hSemaphore, eax
.text:42CF1678                 cmp     hSemaphore, 0
.text:42CF167F                 jnz     short loc_42CF168F
.text:42CF1681                 mov     eax, [ebp+arg_4]
.text:42CF1684                 mov     dword ptr [eax], 0Bh
.text:42CF168A                 jmp     loc_42CF23CF
.text:42CF168F ; ---------------------------------------------------------------------------
.text:42CF168F
.text:42CF168F loc_42CF168F:                           ; CODE XREF: ConnectionListen+48F\u2191j
.text:42CF168F                 push    0               ; lpName
.text:42CF1691                 push    0               ; bInitialState
.text:42CF1693                 push    0               ; bManualReset
.text:42CF1695                 push    0               ; lpEventAttributes
.text:42CF1697                 call    ds:CreateEventA
.text:42CF169D                 mov     hHandle, eax
.text:42CF16A2                 cmp     hHandle, 0
.text:42CF16A9                 jnz     short loc_42CF16B9
.text:42CF16AB                 mov     ecx, [ebp+arg_4]
.text:42CF16AE                 mov     dword ptr [ecx], 0Bh
.text:42CF16B4                 jmp     loc_42CF23CF
.text:42CF16B9 ; ---------------------------------------------------------------------------
.text:42CF16B9
.text:42CF16B9 loc_42CF16B9:                           ; CODE XREF: ConnectionListen+4B9\u2191j
.text:42CF16B9                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF16BB                 mov     edx, hSemaphore
.text:42CF16C1                 push    edx             ; hHandle
.text:42CF16C2                 call    ds:WaitForSingleObject
.text:42CF16C8                 mov     [ebp+var_A3C], 0
.text:42CF16D2                 jmp     short loc_42CF16E3
.text:42CF16D4 ; ---------------------------------------------------------------------------
.text:42CF16D4
.text:42CF16D4 loc_42CF16D4:                           ; CODE XREF: ConnectionListen+51E\u2193j
.text:42CF16D4                 mov     eax, [ebp+var_A3C]
.text:42CF16DA                 add     eax, 1
.text:42CF16DD                 mov     [ebp+var_A3C], eax
.text:42CF16E3
.text:42CF16E3 loc_42CF16E3:                           ; CODE XREF: ConnectionListen+4E2\u2191j
.text:42CF16E3                 cmp     [ebp+var_A3C], 40h ; '@'
.text:42CF16EA                 jge     short loc_42CF1710
.text:42CF16EC                 mov     ecx, [ebp+var_A3C]
.text:42CF16F2                 mov     hEventObject[ecx*4], 0
.text:42CF16FD                 mov     edx, [ebp+var_A3C]
.text:42CF1703                 mov     s[edx*4], 0
.text:42CF170E                 jmp     short loc_42CF16D4
.text:42CF1710 ; ---------------------------------------------------------------------------
.text:42CF1710
.text:42CF1710 loc_42CF1710:                           ; CODE XREF: ConnectionListen+4FA\u2191j
.text:42CF1710                 mov     [ebp+dwBufferLength], 0
.text:42CF171A                 lea     eax, [ebp+dwBufferLength]
.text:42CF1720                 push    eax             ; lpdwBufferLength
.text:42CF1721                 push    0               ; lpProtocolBuffer
.text:42CF1723                 push    0               ; lpiProtocols
.text:42CF1725                 call    ds:WSAEnumProtocolsA
.text:42CF172B                 mov     [ebp+var_A30], eax
.text:42CF1731                 cmp     [ebp+var_A30], 0FFFFFFFFh
.text:42CF1738                 jnz     short loc_42CF1762
.text:42CF173A                 call    ds:WSAGetLastError
.text:42CF1740                 mov     [ebp+var_A30], eax
.text:42CF1746                 cmp     [ebp+var_A30], 2747h
.text:42CF1750                 jz      short loc_42CF1762
.text:42CF1752                 mov     ecx, [ebp+arg_4]
.text:42CF1755                 mov     edx, [ebp+var_A30]
.text:42CF175B                 mov     [ecx], edx
.text:42CF175D                 jmp     loc_42CF23CF
.text:42CF1762 ; ---------------------------------------------------------------------------
.text:42CF1762
.text:42CF1762 loc_42CF1762:                           ; CODE XREF: ConnectionListen+548\u2191j
.text:42CF1762                                         ; ConnectionListen+560\u2191j
.text:42CF1762                 mov     eax, [ebp+dwBufferLength]
.text:42CF1768                 push    eax             ; Size
.text:42CF1769                 call    ds:malloc
.text:42CF176F                 add     esp, 4
.text:42CF1772                 mov     [ebp+lpProtocolBuffer], eax
.text:42CF1775                 cmp     [ebp+lpProtocolBuffer], 0
.text:42CF1779                 jnz     short loc_42CF1789
.text:42CF177B                 mov     ecx, [ebp+arg_4]
.text:42CF177E                 mov     dword ptr [ecx], 1
.text:42CF1784                 jmp     loc_42CF23CF
.text:42CF1789 ; ---------------------------------------------------------------------------
.text:42CF1789
.text:42CF1789 loc_42CF1789:                           ; CODE XREF: ConnectionListen+589\u2191j
.text:42CF1789                 lea     edx, [ebp+dwBufferLength]
.text:42CF178F                 push    edx             ; lpdwBufferLength
.text:42CF1790                 mov     eax, [ebp+lpProtocolBuffer]
.text:42CF1793                 push    eax             ; lpProtocolBuffer
.text:42CF1794                 push    0               ; lpiProtocols
.text:42CF1796                 call    ds:WSAEnumProtocolsA
.text:42CF179C                 mov     [ebp+var_4], eax
.text:42CF179F                 cmp     [ebp+var_4], 0FFFFFFFFh
.text:42CF17A3                 jnz     short loc_42CF17C2
.text:42CF17A5                 mov     ecx, [ebp+lpProtocolBuffer]
.text:42CF17A8                 push    ecx             ; Block
.text:42CF17A9                 call    ds:free
.text:42CF17AF                 add     esp, 4
.text:42CF17B2                 call    ds:WSAGetLastError
.text:42CF17B8                 mov     edx, [ebp+arg_4]
.text:42CF17BB                 mov     [edx], eax
.text:42CF17BD                 jmp     loc_42CF23CF
.text:42CF17C2 ; ---------------------------------------------------------------------------
.text:42CF17C2
.text:42CF17C2 loc_42CF17C2:                           ; CODE XREF: ConnectionListen+5B3\u2191j
.text:42CF17C2                 mov     eax, [ebp+lpProtocolBuffer]
.text:42CF17C5                 mov     [ebp+var_A40], eax
.text:42CF17CB                 mov     [ebp+var_359C], 0
.text:42CF17D5                 jmp     short loc_42CF17F8
.text:42CF17D7 ; ---------------------------------------------------------------------------
.text:42CF17D7
.text:42CF17D7 loc_42CF17D7:                           ; CODE XREF: ConnectionListen:loc_42CF1873\u2193j
.text:42CF17D7                                         ; ConnectionListen+85B\u2193j ...
.text:42CF17D7                 mov     ecx, [ebp+var_359C]
.text:42CF17DD                 add     ecx, 1
.text:42CF17E0                 mov     [ebp+var_359C], ecx
.text:42CF17E6                 mov     edx, [ebp+var_A40]
.text:42CF17EC                 add     edx, 174h
.text:42CF17F2                 mov     [ebp+var_A40], edx
.text:42CF17F8
.text:42CF17F8 loc_42CF17F8:                           ; CODE XREF: ConnectionListen+5E5\u2191j
.text:42CF17F8                 mov     eax, [ebp+var_359C]
.text:42CF17FE                 cmp     eax, [ebp+var_4]
.text:42CF1801                 jge     loc_42CF2252
.text:42CF1807                 mov     ecx, [ebp+var_A40]
.text:42CF180D                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF1811                 jnz     short loc_42CF1878
.text:42CF1813                 mov     edx, [ebp+var_A40]
.text:42CF1819                 add     edx, 14h
.text:42CF181C                 sub     esp, 10h
.text:42CF181F                 mov     eax, esp
.text:42CF1821                 mov     ecx, [edx]
.text:42CF1823                 mov     [eax], ecx
.text:42CF1825                 mov     ecx, [edx+4]
.text:42CF1828                 mov     [eax+4], ecx
.text:42CF182B                 mov     ecx, [edx+8]
.text:42CF182E                 mov     [eax+8], ecx
.text:42CF1831                 mov     edx, [edx+0Ch]
.text:42CF1834                 mov     [eax+0Ch], edx
.text:42CF1837                 call    sub_42CF78D0
.text:42CF183C                 add     esp, 10h
.text:42CF183F                 test    eax, eax
.text:42CF1841                 jnz     short loc_42CF1873
.text:42CF1843                 mov     eax, [ebp+var_A40]
.text:42CF1849                 add     eax, 14h
.text:42CF184C                 sub     esp, 10h
.text:42CF184F                 mov     ecx, esp
.text:42CF1851                 mov     edx, [eax]
.text:42CF1853                 mov     [ecx], edx
.text:42CF1855                 mov     edx, [eax+4]
.text:42CF1858                 mov     [ecx+4], edx
.text:42CF185B                 mov     edx, [eax+8]
.text:42CF185E                 mov     [ecx+8], edx
.text:42CF1861                 mov     eax, [eax+0Ch]
.text:42CF1864                 mov     [ecx+0Ch], eax
.text:42CF1867                 call    sub_42CF7900
.text:42CF186C                 add     esp, 10h
.text:42CF186F                 test    eax, eax
.text:42CF1871                 jz      short loc_42CF1878
.text:42CF1873
.text:42CF1873 loc_42CF1873:                           ; CODE XREF: ConnectionListen+651\u2191j
.text:42CF1873                 jmp     loc_42CF17D7
.text:42CF1878 ; ---------------------------------------------------------------------------
.text:42CF1878
.text:42CF1878 loc_42CF1878:                           ; CODE XREF: ConnectionListen+621\u2191j
.text:42CF1878                                         ; ConnectionListen+681\u2191j
.text:42CF1878                 mov     [ebp+var_35A4], 0
.text:42CF1882                 mov     ecx, [ebp+var_A40]
.text:42CF1888                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF188C                 jnz     loc_42CF193A
.text:42CF1892                 cmp     [ebp+var_E58], 0
.text:42CF1899                 jz      loc_42CF193A
.text:42CF189F                 mov     [ebp+var_37C8], 1
.text:42CF18A9
.text:42CF18A9 loc_42CF18A9:                           ; CODE XREF: ConnectionListen+733\u2193j
.text:42CF18A9                 mov     edx, [ebp+var_37C8]
.text:42CF18AF                 push    edx
.text:42CF18B0                 lea     eax, [ebp+var_3598]
.text:42CF18B6                 push    eax
.text:42CF18B7                 mov     ecx, [ebp+arg_4]
.text:42CF18BA                 push    ecx
.text:42CF18BB                 mov     edx, [ebp+var_35AC]
.text:42CF18C1                 push    edx
.text:42CF18C2                 mov     eax, [ebp+var_A40]
.text:42CF18C8                 push    eax
.text:42CF18C9                 call    sub_42CF67F5
.text:42CF18CE                 add     esp, 14h
.text:42CF18D1                 mov     ecx, dword_42D010E4
.text:42CF18D7                 or      ecx, eax
.text:42CF18D9                 mov     dword_42D010E4, ecx
.text:42CF18DF                 cmp     dword_42D010E4, 0
.text:42CF18E6                 jnz     short loc_42CF1908
.text:42CF18E8                 push    1               ; wType
.text:42CF18EA                 mov     edx, [ebp+arg_4]
.text:42CF18ED                 mov     eax, [edx]
.text:42CF18EF                 push    eax             ; int
.text:42CF18F0                 mov     ecx, [ebp+var_35AC]
.text:42CF18F6                 push    ecx             ; int
.text:42CF18F7                 push    offset aWsproxy_1 ; "WSProxy"
.text:42CF18FC                 mov     edx, [ebp+Block]
.text:42CF18FF                 push    edx             ; int
.text:42CF1900                 call    sub_42CF56FE
.text:42CF1905                 add     esp, 14h
.text:42CF1908
.text:42CF1908 loc_42CF1908:                           ; CODE XREF: ConnectionListen+6F6\u2191j
.text:42CF1908                 mov     eax, [ebp+arg_4]
.text:42CF190B                 cmp     dword ptr [eax], 271Dh
.text:42CF1911                 jnz     short loc_42CF1925
.text:42CF1913                 cmp     [ebp+var_14], 1
.text:42CF1917                 jnz     short loc_42CF1925
.text:42CF1919                 mov     [ebp+var_37C8], 0
.text:42CF1923                 jmp     short loc_42CF18A9
.text:42CF1925 ; ---------------------------------------------------------------------------
.text:42CF1925
.text:42CF1925 loc_42CF1925:                           ; CODE XREF: ConnectionListen+721\u2191j
.text:42CF1925                                         ; ConnectionListen+727\u2191j
.text:42CF1925                 push    offset aWinsockProxy ; ", Winsock Proxy"
.text:42CF192A                 lea     ecx, [ebp+var_214]
.text:42CF1930                 push    ecx             ; Destination
.text:42CF1931                 call    ds:wcscat
.text:42CF1937                 add     esp, 8
.text:42CF193A
.text:42CF193A loc_42CF193A:                           ; CODE XREF: ConnectionListen+69C\u2191j
.text:42CF193A                                         ; ConnectionListen+6A9\u2191j
.text:42CF193A                 mov     edx, [ebp+var_A40]
.text:42CF1940                 cmp     dword ptr [edx+5Ch], 6
.text:42CF1944                 jnz     short loc_42CF194F
.text:42CF1946                 cmp     [ebp+var_E64], 0
.text:42CF194D                 jnz     short loc_42CF196F
.text:42CF194F
.text:42CF194F loc_42CF194F:                           ; CODE XREF: ConnectionListen+754\u2191j
.text:42CF194F                 mov     eax, [ebp+var_A40]
.text:42CF1955                 cmp     dword ptr [eax+5Ch], 4E8h
.text:42CF195C                 jnz     loc_42CF224D
.text:42CF1962                 cmp     [ebp+var_E60], 0
.text:42CF1969                 jz      loc_42CF224D
.text:42CF196F
.text:42CF196F loc_42CF196F:                           ; CODE XREF: ConnectionListen+75D\u2191j
.text:42CF196F                 mov     ecx, [ebp+var_A40]
.text:42CF1975                 cmp     dword ptr [ecx+58h], 1
.text:42CF1979                 jnz     loc_42CF224D
.text:42CF197F                 mov     edx, [ebp+var_A40]
.text:42CF1985                 mov     eax, [edx+50h]
.text:42CF1988                 push    eax             ; Size
.text:42CF1989                 call    ds:malloc
.text:42CF198F                 add     esp, 4
.text:42CF1992                 mov     [ebp+name], eax
.text:42CF1998                 cmp     [ebp+name], 0
.text:42CF199F                 jnz     short loc_42CF19AF
.text:42CF19A1                 mov     ecx, [ebp+arg_4]
.text:42CF19A4                 mov     dword ptr [ecx], 1
.text:42CF19AA                 jmp     loc_42CF23CF
.text:42CF19AF ; ---------------------------------------------------------------------------
.text:42CF19AF
.text:42CF19AF loc_42CF19AF:                           ; CODE XREF: ConnectionListen+7AF\u2191j
.text:42CF19AF                 mov     edx, [ebp+var_A40]
.text:42CF19B5                 cmp     dword ptr [edx+5Ch], 6
.text:42CF19B9                 jnz     short loc_42CF19C9
.text:42CF19BB                 mov     eax, [ebp+var_3494]
.text:42CF19C1                 mov     [ebp+var_224], eax
.text:42CF19C7                 jmp     short loc_42CF19E2
.text:42CF19C9 ; ---------------------------------------------------------------------------
.text:42CF19C9
.text:42CF19C9 loc_42CF19C9:                           ; CODE XREF: ConnectionListen+7C9\u2191j
.text:42CF19C9                 mov     ecx, [ebp+var_A40]
.text:42CF19CF                 cmp     dword ptr [ecx+5Ch], 4E8h
.text:42CF19D6                 jnz     short loc_42CF19E2
.text:42CF19D8                 mov     [ebp+var_224], 1
.text:42CF19E2
.text:42CF19E2 loc_42CF19E2:                           ; CODE XREF: ConnectionListen+7D7\u2191j
.text:42CF19E2                                         ; ConnectionListen+7E6\u2191j
.text:42CF19E2                 mov     edx, [ebp+var_A40]
.text:42CF19E8                 cmp     dword ptr [edx+5Ch], 6
.text:42CF19EC                 jnz     short loc_42CF1A59
.text:42CF19EE                 cmp     [ebp+var_E48], 0
.text:42CF19F5                 jnz     short loc_42CF1A59
.text:42CF19F7                 push    offset name     ; name
.text:42CF19FC                 call    ds:__imp_gethostbyname
.text:42CF1A02                 mov     [ebp+var_A2C], eax
.text:42CF1A08                 cmp     [ebp+var_A2C], 0
.text:42CF1A0F                 jnz     short loc_42CF1A50
.text:42CF1A11                 mov     [ebp+var_35AC], offset aGethostbyname ; "gethostbyname"
.text:42CF1A1B                 call    ds:WSAGetLastError
.text:42CF1A21                 mov     ecx, [ebp+arg_4]
.text:42CF1A24                 mov     [ecx], eax
.text:42CF1A26                 push    1               ; wType
.text:42CF1A28                 mov     edx, [ebp+arg_4]
.text:42CF1A2B                 mov     eax, [edx]
.text:42CF1A2D                 push    eax             ; int
.text:42CF1A2E                 mov     ecx, [ebp+var_35AC]
.text:42CF1A34                 push    ecx             ; int
.text:42CF1A35                 mov     edx, [ebp+var_A40]
.text:42CF1A3B                 add     edx, 74h ; 't'
.text:42CF1A3E                 push    edx             ; int
.text:42CF1A3F                 mov     eax, [ebp+Block]
.text:42CF1A42                 push    eax             ; int
.text:42CF1A43                 call    sub_42CF56FE
.text:42CF1A48                 add     esp, 14h
.text:42CF1A4B                 jmp     loc_42CF17D7
.text:42CF1A50 ; ---------------------------------------------------------------------------
.text:42CF1A50
.text:42CF1A50 loc_42CF1A50:                           ; CODE XREF: ConnectionListen+81F\u2191j
.text:42CF1A50                 mov     [ebp+var_C], 400h
.text:42CF1A57                 jmp     short loc_42CF1A80
.text:42CF1A59 ; ---------------------------------------------------------------------------
.text:42CF1A59
.text:42CF1A59 loc_42CF1A59:                           ; CODE XREF: ConnectionListen+7FC\u2191j
.text:42CF1A59                                         ; ConnectionListen+805\u2191j
.text:42CF1A59                 mov     ecx, [ebp+var_A40]
.text:42CF1A5F                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF1A63                 jnz     short loc_42CF1A79
.text:42CF1A65                 cmp     [ebp+var_E48], 1
.text:42CF1A6C                 jnz     short loc_42CF1A79
.text:42CF1A6E                 mov     edx, [ebp+var_106C]
.text:42CF1A74                 mov     [ebp+var_C], edx
.text:42CF1A77                 jmp     short loc_42CF1A80
.text:42CF1A79 ; ---------------------------------------------------------------------------
.text:42CF1A79
.text:42CF1A79 loc_42CF1A79:                           ; CODE XREF: ConnectionListen+873\u2191j
.text:42CF1A79                                         ; ConnectionListen+87C\u2191j
.text:42CF1A79                 mov     [ebp+var_C], 1
.text:42CF1A80
.text:42CF1A80 loc_42CF1A80:                           ; CODE XREF: ConnectionListen+867\u2191j
.text:42CF1A80                                         ; ConnectionListen+887\u2191j
.text:42CF1A80                 mov     [ebp+var_A38], 0
.text:42CF1A8A                 mov     [ebp+var_220], 0
.text:42CF1A94                 jmp     short loc_42CF1AA5
.text:42CF1A96 ; ---------------------------------------------------------------------------
.text:42CF1A96
.text:42CF1A96 loc_42CF1A96:                           ; CODE XREF: ConnectionListen:loc_42CF2106\u2193j
.text:42CF1A96                 mov     eax, [ebp+var_220]
.text:42CF1A9C                 add     eax, 1
.text:42CF1A9F                 mov     [ebp+var_220], eax
.text:42CF1AA5
.text:42CF1AA5 loc_42CF1AA5:                           ; CODE XREF: ConnectionListen+8A4\u2191j
.text:42CF1AA5                 mov     ecx, [ebp+var_220]
.text:42CF1AAB                 cmp     ecx, [ebp+var_C]
.text:42CF1AAE                 jge     loc_42CF210B
.text:42CF1AB4                 mov     edx, [ebp+var_A40]
.text:42CF1ABA                 cmp     dword ptr [edx+5Ch], 6
.text:42CF1ABE                 jnz     loc_42CF1B6E
.text:42CF1AC4                 cmp     [ebp+var_E48], 0
.text:42CF1ACB                 jnz     loc_42CF1B5B
.text:42CF1AD1                 mov     eax, [ebp+var_A2C]
.text:42CF1AD7                 mov     ecx, [eax+0Ch]
.text:42CF1ADA                 mov     edx, [ebp+var_220]
.text:42CF1AE0                 cmp     dword ptr [ecx+edx*4], 0
.text:42CF1AE4                 jnz     short loc_42CF1B22
.text:42CF1AE6                 cmp     [ebp+var_A38], 0
.text:42CF1AED                 jnz     short loc_42CF1B1B
.text:42CF1AEF                 push    offset cp       ; "127.0.0.1"
.text:42CF1AF4                 call    ds:__imp_inet_addr
.text:42CF1AFA                 mov     [ebp+var_35B8], eax
.text:42CF1B00                 mov     [ebp+var_A38], 1
.text:42CF1B0A                 mov     eax, [ebp+var_220]
.text:42CF1B10                 sub     eax, 1
.text:42CF1B13                 mov     [ebp+var_220], eax
.text:42CF1B19                 jmp     short loc_42CF1B20
.text:42CF1B1B ; ---------------------------------------------------------------------------
.text:42CF1B1B
.text:42CF1B1B loc_42CF1B1B:                           ; CODE XREF: ConnectionListen+8FD\u2191j
.text:42CF1B1B                 jmp     loc_42CF210B
.text:42CF1B20 ; ---------------------------------------------------------------------------
.text:42CF1B20
.text:42CF1B20 loc_42CF1B20:                           ; CODE XREF: ConnectionListen+929\u2191j
.text:42CF1B20                 jmp     short loc_42CF1B59
.text:42CF1B22 ; ---------------------------------------------------------------------------
.text:42CF1B22
.text:42CF1B22 loc_42CF1B22:                           ; CODE XREF: ConnectionListen+8F4\u2191j
.text:42CF1B22                 mov     ecx, [ebp+var_A2C]
.text:42CF1B28                 mov     edx, [ecx+0Ch]
.text:42CF1B2B                 mov     eax, [ebp+var_220]
.text:42CF1B31                 mov     ecx, [edx+eax*4]
.text:42CF1B34                 mov     edx, [ecx]
.text:42CF1B36                 mov     [ebp+var_35B8], edx
.text:42CF1B3C                 push    offset a127001_0 ; "127.0.0.1"
.text:42CF1B41                 call    ds:__imp_inet_addr
.text:42CF1B47                 cmp     [ebp+var_35B8], eax
.text:42CF1B4D                 jnz     short loc_42CF1B59
.text:42CF1B4F                 mov     [ebp+var_A38], 1
.text:42CF1B59
.text:42CF1B59 loc_42CF1B59:                           ; CODE XREF: ConnectionListen:loc_42CF1B20\u2191j
.text:42CF1B59                                         ; ConnectionListen+95D\u2191j
.text:42CF1B59                 jmp     short loc_42CF1B6E
.text:42CF1B5B ; ---------------------------------------------------------------------------
.text:42CF1B5B
.text:42CF1B5B loc_42CF1B5B:                           ; CODE XREF: ConnectionListen+8DB\u2191j
.text:42CF1B5B                 mov     eax, [ebp+var_220]
.text:42CF1B61                 mov     ecx, [ebp+eax*4+var_206C]
.text:42CF1B68                 mov     [ebp+var_35B8], ecx
.text:42CF1B6E
.text:42CF1B6E loc_42CF1B6E:                           ; CODE XREF: ConnectionListen+8CE\u2191j
.text:42CF1B6E                                         ; ConnectionListen:loc_42CF1B59\u2191j
.text:42CF1B6E                 mov     [ebp+var_218], 0
.text:42CF1B78                 jmp     short loc_42CF1B89
.text:42CF1B7A ; ---------------------------------------------------------------------------
.text:42CF1B7A
.text:42CF1B7A loc_42CF1B7A:                           ; CODE XREF: ConnectionListen+9E9\u2193j
.text:42CF1B7A                                         ; ConnectionListen+A58\u2193j ...
.text:42CF1B7A                 mov     edx, [ebp+var_218]
.text:42CF1B80                 add     edx, 1
.text:42CF1B83                 mov     [ebp+var_218], edx
.text:42CF1B89
.text:42CF1B89 loc_42CF1B89:                           ; CODE XREF: ConnectionListen+988\u2191j
.text:42CF1B89                 mov     eax, [ebp+var_218]
.text:42CF1B8F                 cmp     eax, [ebp+var_224]
.text:42CF1B95                 jnb     loc_42CF2106
.text:42CF1B9B                 mov     ecx, [ebp+var_A40]
.text:42CF1BA1                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF1BA5                 jnz     short loc_42CF1BDB
.text:42CF1BA7                 mov     edx, [ebp+var_218]
.text:42CF1BAD                 mov     ax, word ptr [ebp+edx*4+Value]
.text:42CF1BB5                 mov     word ptr [ebp+var_35BC+2], ax
.text:42CF1BBC                 cmp     dword_42D010E4, 0
.text:42CF1BC3                 jz      short loc_42CF1BDB
.text:42CF1BC5                 mov     ecx, [ebp+var_35BC+2]
.text:42CF1BCB                 and     ecx, 0FFFFh
.text:42CF1BD1                 cmp     ecx, [ebp+var_3074]
.text:42CF1BD7                 jnz     short loc_42CF1BDB
.text:42CF1BD9                 jmp     short loc_42CF1B7A
.text:42CF1BDB ; ---------------------------------------------------------------------------
.text:42CF1BDB
.text:42CF1BDB loc_42CF1BDB:                           ; CODE XREF: ConnectionListen+9B5\u2191j
.text:42CF1BDB                                         ; ConnectionListen+9D3\u2191j ...
.text:42CF1BDB                 mov     edx, [ebp+var_A40]
.text:42CF1BE1                 mov     eax, [edx+5Ch]
.text:42CF1BE4                 push    eax             ; protocol
.text:42CF1BE5                 mov     ecx, [ebp+var_A40]
.text:42CF1BEB                 mov     edx, [ecx+58h]
.text:42CF1BEE                 push    edx             ; type
.text:42CF1BEF                 mov     eax, [ebp+var_A40]
.text:42CF1BF5                 mov     ecx, [eax+4Ch]
.text:42CF1BF8                 push    ecx             ; af
.text:42CF1BF9                 call    ds:socket
.text:42CF1BFF                 mov     [ebp+s], eax
.text:42CF1C05                 cmp     [ebp+s], 0FFFFFFFFh
.text:42CF1C0C                 jnz     short loc_42CF1C4D
.text:42CF1C0E                 mov     [ebp+var_35AC], offset aSocket ; "Socket"
.text:42CF1C18                 call    ds:WSAGetLastError
.text:42CF1C1E                 mov     edx, [ebp+arg_4]
.text:42CF1C21                 mov     [edx], eax
.text:42CF1C23                 push    1               ; wType
.text:42CF1C25                 mov     eax, [ebp+arg_4]
.text:42CF1C28                 mov     ecx, [eax]
.text:42CF1C2A                 push    ecx             ; int
.text:42CF1C2B                 mov     edx, [ebp+var_35AC]
.text:42CF1C31                 push    edx             ; int
.text:42CF1C32                 mov     eax, [ebp+var_A40]
.text:42CF1C38                 add     eax, 74h ; 't'
.text:42CF1C3B                 push    eax             ; int
.text:42CF1C3C                 mov     ecx, [ebp+Block]
.text:42CF1C3F                 push    ecx             ; int
.text:42CF1C40                 call    sub_42CF56FE
.text:42CF1C45                 add     esp, 14h
.text:42CF1C48                 jmp     loc_42CF1B7A
.text:42CF1C4D ; ---------------------------------------------------------------------------
.text:42CF1C4D
.text:42CF1C4D loc_42CF1C4D:                           ; CODE XREF: ConnectionListen+A1C\u2191j
.text:42CF1C4D                 lea     edx, [ebp+var_3598]
.text:42CF1C53                 push    edx
.text:42CF1C54                 mov     eax, [ebp+var_A40]
.text:42CF1C5A                 xor     ecx, ecx
.text:42CF1C5C                 cmp     dword ptr [eax+5Ch], 6
.text:42CF1C60                 setnz   cl
.text:42CF1C63                 dec     ecx
.text:42CF1C64                 lea     edx, [ebp+var_35BC]
.text:42CF1C6A                 and     ecx, edx
.text:42CF1C6C                 push    ecx
.text:42CF1C6D                 mov     eax, [ebp+var_A40]
.text:42CF1C73                 push    eax
.text:42CF1C74                 mov     ecx, [ebp+name]
.text:42CF1C7A                 push    ecx             ; int
.text:42CF1C7B                 call    sub_42CF4FA0
.text:42CF1C80                 add     esp, 10h
.text:42CF1C83                 test    eax, eax
.text:42CF1C85                 jnz     short loc_42CF1CD3
.text:42CF1C87                 mov     [ebp+var_35AC], offset aFilladdress ; "FillAddress"
.text:42CF1C91                 call    ds:WSAGetLastError
.text:42CF1C97                 mov     edx, [ebp+arg_4]
.text:42CF1C9A                 mov     [edx], eax
.text:42CF1C9C                 mov     eax, [ebp+s]
.text:42CF1CA2                 push    eax             ; s
.text:42CF1CA3                 call    ds:closesocket
.text:42CF1CA9                 push    1               ; wType
.text:42CF1CAB                 mov     ecx, [ebp+arg_4]
.text:42CF1CAE                 mov     edx, [ecx]
.text:42CF1CB0                 push    edx             ; int
.text:42CF1CB1                 mov     eax, [ebp+var_35AC]
.text:42CF1CB7                 push    eax             ; int
.text:42CF1CB8                 mov     ecx, [ebp+var_A40]
.text:42CF1CBE                 add     ecx, 74h ; 't'
.text:42CF1CC1                 push    ecx             ; int
.text:42CF1CC2                 mov     edx, [ebp+Block]
.text:42CF1CC5                 push    edx             ; int
.text:42CF1CC6                 call    sub_42CF56FE
.text:42CF1CCB                 add     esp, 14h
.text:42CF1CCE                 jmp     loc_42CF1B7A
.text:42CF1CD3 ; ---------------------------------------------------------------------------
.text:42CF1CD3
.text:42CF1CD3 loc_42CF1CD3:                           ; CODE XREF: ConnectionListen+A95\u2191j
.text:42CF1CD3                 cmp     dword_42D01A1C, 0
.text:42CF1CDA                 jz      short loc_42CF1D50
.text:42CF1CDC                 cmp     [ebp+var_14], 0
.text:42CF1CE0                 jz      short loc_42CF1D50
.text:42CF1CE2                 push    4               ; optlen
.text:42CF1CE4                 lea     eax, [ebp+optval]
.text:42CF1CEA                 push    eax             ; optval
.text:42CF1CEB                 push    0FFFFFFFBh      ; optname
.text:42CF1CED                 push    0FFFFh          ; level
.text:42CF1CF2                 mov     ecx, [ebp+s]
.text:42CF1CF8                 push    ecx             ; s
.text:42CF1CF9                 call    ds:setsockopt
.text:42CF1CFF                 cmp     eax, 0FFFFFFFFh
.text:42CF1D02                 jnz     short loc_42CF1D50
.text:42CF1D04                 mov     [ebp+var_35AC], offset aSoExclusiveadd ; "SO_EXCLUSIVEADDRUSE"
.text:42CF1D0E                 call    ds:WSAGetLastError
.text:42CF1D14                 mov     edx, [ebp+arg_4]
.text:42CF1D17                 mov     [edx], eax
.text:42CF1D19                 mov     eax, [ebp+s]
.text:42CF1D1F                 push    eax             ; s
.text:42CF1D20                 call    ds:closesocket
.text:42CF1D26                 push    1               ; wType
.text:42CF1D28                 mov     ecx, [ebp+arg_4]
.text:42CF1D2B                 mov     edx, [ecx]
.text:42CF1D2D                 push    edx             ; int
.text:42CF1D2E                 mov     eax, [ebp+var_35AC]
.text:42CF1D34                 push    eax             ; int
.text:42CF1D35                 mov     ecx, [ebp+var_A40]
.text:42CF1D3B                 add     ecx, 74h ; 't'
.text:42CF1D3E                 push    ecx             ; int
.text:42CF1D3F                 mov     edx, [ebp+Block]
.text:42CF1D42                 push    edx             ; int
.text:42CF1D43                 call    sub_42CF56FE
.text:42CF1D48                 add     esp, 14h
.text:42CF1D4B                 jmp     loc_42CF1B7A
.text:42CF1D50 ; ---------------------------------------------------------------------------
.text:42CF1D50
.text:42CF1D50 loc_42CF1D50:                           ; CODE XREF: ConnectionListen+AEA\u2191j
.text:42CF1D50                                         ; ConnectionListen+AF0\u2191j ...
.text:42CF1D50                 mov     eax, [ebp+var_A40]
.text:42CF1D56                 mov     ecx, [eax+50h]
.text:42CF1D59                 push    ecx             ; namelen
.text:42CF1D5A                 mov     edx, [ebp+name]
.text:42CF1D60                 push    edx             ; name
.text:42CF1D61                 mov     eax, [ebp+s]
.text:42CF1D67                 push    eax             ; s
.text:42CF1D68                 call    ds:bind
.text:42CF1D6E                 mov     [ebp+var_A30], eax
.text:42CF1D74                 cmp     [ebp+var_A30], 0FFFFFFFFh
.text:42CF1D7B                 jnz     loc_42CF1F2D
.text:42CF1D81                 mov     [ebp+var_35AC], offset aBind ; "Bind"
.text:42CF1D8B                 call    ds:WSAGetLastError
.text:42CF1D91                 mov     ecx, [ebp+arg_4]
.text:42CF1D94                 mov     [ecx], eax
.text:42CF1D96                 mov     edx, [ebp+arg_4]
.text:42CF1D99                 cmp     dword ptr [edx], 271Dh
.text:42CF1D9F                 jnz     short loc_42CF1DEF
.text:42CF1DA1                 cmp     [ebp+var_14], 1
.text:42CF1DA5                 jnz     short loc_42CF1DEF
.text:42CF1DA7                 mov     [ebp+var_35AC], offset aFailedToGetExc ; "Failed to get Exclusive port use"
.text:42CF1DB1                 push    1               ; wType
.text:42CF1DB3                 mov     eax, [ebp+arg_4]
.text:42CF1DB6                 mov     ecx, [eax]
.text:42CF1DB8                 push    ecx             ; int
.text:42CF1DB9                 mov     edx, [ebp+var_35AC]
.text:42CF1DBF                 push    edx             ; int
.text:42CF1DC0                 mov     eax, [ebp+var_A40]
.text:42CF1DC6                 add     eax, 74h ; 't'
.text:42CF1DC9                 push    eax             ; int
.text:42CF1DCA                 mov     ecx, [ebp+Block]
.text:42CF1DCD                 push    ecx             ; int
.text:42CF1DCE                 call    sub_42CF56FE
.text:42CF1DD3                 add     esp, 14h
.text:42CF1DD6                 mov     edx, [ebp+s]
.text:42CF1DDC                 push    edx             ; s
.text:42CF1DDD                 call    ds:closesocket
.text:42CF1DE3                 mov     [ebp+var_14], 0
.text:42CF1DEA                 jmp     loc_42CF1BDB
.text:42CF1DEF ; ---------------------------------------------------------------------------
.text:42CF1DEF
.text:42CF1DEF loc_42CF1DEF:                           ; CODE XREF: ConnectionListen+BAF\u2191j
.text:42CF1DEF                                         ; ConnectionListen+BB5\u2191j
.text:42CF1DEF                 mov     eax, [ebp+s]
.text:42CF1DF5                 push    eax             ; s
.text:42CF1DF6                 call    ds:closesocket
.text:42CF1DFC                 mov     ecx, [ebp+arg_4]
.text:42CF1DFF                 cmp     dword ptr [ecx], 2740h
.text:42CF1E05                 jnz     loc_42CF1EBD
.text:42CF1E0B                 mov     edx, [ebp+var_A40]
.text:42CF1E11                 cmp     dword ptr [edx+5Ch], 4E8h
.text:42CF1E18                 jnz     short loc_42CF1E4E
.text:42CF1E1A                 mov     eax, [ebp+var_3280]
.text:42CF1E20                 add     eax, 1
.text:42CF1E23                 mov     [ebp+var_3280], eax
.text:42CF1E29                 push    4               ; wType
.text:42CF1E2B                 mov     ecx, [ebp+arg_4]
.text:42CF1E2E                 mov     edx, [ecx]
.text:42CF1E30                 push    edx             ; int
.text:42CF1E31                 mov     eax, [ebp+var_35AC]
.text:42CF1E37                 push    eax             ; int
.text:42CF1E38                 mov     ecx, [ebp+var_A40]
.text:42CF1E3E                 add     ecx, 74h ; 't'
.text:42CF1E41                 push    ecx             ; int
.text:42CF1E42                 mov     edx, [ebp+Block]
.text:42CF1E45                 push    edx             ; int
.text:42CF1E46                 call    sub_42CF56FE
.text:42CF1E4B                 add     esp, 14h
.text:42CF1E4E
.text:42CF1E4E loc_42CF1E4E:                           ; CODE XREF: ConnectionListen+C28\u2191j
.text:42CF1E4E                 lea     eax, [ebp+var_3598]
.text:42CF1E54                 push    eax
.text:42CF1E55                 mov     ecx, [ebp+var_218]
.text:42CF1E5B                 mov     edx, [ebp+ecx*4+Value]
.text:42CF1E62                 push    edx
.text:42CF1E63                 call    sub_42CF7820
.text:42CF1E68                 add     esp, 8
.text:42CF1E6B                 test    eax, eax
.text:42CF1E6D                 jz      short loc_42CF1EB3
.text:42CF1E6F                 mov     eax, [ebp+var_218]
.text:42CF1E75                 mov     [ebp+eax*4+Value], 0
.text:42CF1E80                 mov     word ptr [ebp+var_35BC+2], 0
.text:42CF1E89                 push    4               ; wType
.text:42CF1E8B                 mov     ecx, [ebp+arg_4]
.text:42CF1E8E                 mov     edx, [ecx]
.text:42CF1E90                 push    edx             ; int
.text:42CF1E91                 mov     eax, [ebp+var_35AC]
.text:42CF1E97                 push    eax             ; int
.text:42CF1E98                 mov     ecx, [ebp+var_A40]
.text:42CF1E9E                 add     ecx, 74h ; 't'
.text:42CF1EA1                 push    ecx             ; int
.text:42CF1EA2                 mov     edx, [ebp+Block]
.text:42CF1EA5                 push    edx             ; int
.text:42CF1EA6                 call    sub_42CF56FE
.text:42CF1EAB                 add     esp, 14h
.text:42CF1EAE                 jmp     loc_42CF1BDB
.text:42CF1EB3 ; ---------------------------------------------------------------------------
.text:42CF1EB3
.text:42CF1EB3 loc_42CF1EB3:                           ; CODE XREF: ConnectionListen+C7D\u2191j
.text:42CF1EB3                 mov     [ebp+var_35AC], offset aBindPortInUse ; "Bind - Port in use"
.text:42CF1EBD
.text:42CF1EBD loc_42CF1EBD:                           ; CODE XREF: ConnectionListen+C15\u2191j
.text:42CF1EBD                 mov     eax, [ebp+var_A40]
.text:42CF1EC3                 cmp     dword ptr [eax+5Ch], 4E8h
.text:42CF1ECA                 jnz     short loc_42CF1EF3
.text:42CF1ECC                 push    1               ; wType
.text:42CF1ECE                 mov     ecx, [ebp+arg_4]
.text:42CF1ED1                 mov     edx, [ecx]
.text:42CF1ED3                 push    edx             ; int
.text:42CF1ED4                 mov     eax, [ebp+var_35AC]
.text:42CF1EDA                 push    eax             ; int
.text:42CF1EDB                 mov     ecx, [ebp+var_A40]
.text:42CF1EE1                 add     ecx, 74h ; 't'
.text:42CF1EE4                 push    ecx             ; int
.text:42CF1EE5                 mov     edx, [ebp+Block]
.text:42CF1EE8                 push    edx             ; int
.text:42CF1EE9                 call    sub_42CF56FE
.text:42CF1EEE                 add     esp, 14h
.text:42CF1EF1                 jmp     short loc_42CF1F28
.text:42CF1EF3 ; ---------------------------------------------------------------------------
.text:42CF1EF3
.text:42CF1EF3 loc_42CF1EF3:                           ; CODE XREF: ConnectionListen+CDA\u2191j
.text:42CF1EF3                 push    0Ah             ; Radix
.text:42CF1EF5                 lea     eax, [ebp+Buffer]
.text:42CF1EFB                 push    eax             ; Buffer
.text:42CF1EFC                 mov     ecx, [ebp+var_218]
.text:42CF1F02                 mov     edx, [ebp+ecx*4+Value]
.text:42CF1F09                 push    edx             ; Value
.text:42CF1F0A                 call    ds:_itow
.text:42CF1F10                 add     esp, 0Ch
.text:42CF1F13                 lea     eax, [ebp+Buffer]
.text:42CF1F19                 push    eax
.text:42CF1F1A                 push    0C0004A44h
.text:42CF1F1F                 call    dword_42D01A18
.text:42CF1F25                 add     esp, 8
.text:42CF1F28
.text:42CF1F28 loc_42CF1F28:                           ; CODE XREF: ConnectionListen+D01\u2191j
.text:42CF1F28                 jmp     loc_42CF1B7A
.text:42CF1F2D ; ---------------------------------------------------------------------------
.text:42CF1F2D
.text:42CF1F2D loc_42CF1F2D:                           ; CODE XREF: ConnectionListen+B8B\u2191j
.text:42CF1F2D                 mov     ecx, [ebp+var_A40]
.text:42CF1F33                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF1F37                 jnz     loc_42CF1FF8
.text:42CF1F3D                 mov     edx, [ebp+var_35BC+2]
.text:42CF1F43                 and     edx, 0FFFFh
.text:42CF1F49                 test    edx, edx
.text:42CF1F4B                 jnz     loc_42CF1FF8
.text:42CF1F51                 mov     [ebp+namelen], 10h
.text:42CF1F5B                 lea     eax, [ebp+namelen]
.text:42CF1F61                 push    eax             ; namelen
.text:42CF1F62                 lea     ecx, [ebp+var_3818]
.text:42CF1F68                 push    ecx             ; name
.text:42CF1F69                 mov     edx, [ebp+s]
.text:42CF1F6F                 push    edx             ; in
.text:42CF1F70                 call    ds:getsockname
.text:42CF1F76                 lea     eax, [ebp+var_3598]
.text:42CF1F7C                 push    eax
.text:42CF1F7D                 mov     cx, word ptr [ebp+var_3818.sa_data]
.text:42CF1F84                 push    ecx             ; netshort
.text:42CF1F85                 call    ds:ntohs
.text:42CF1F8B                 and     eax, 0FFFFh
.text:42CF1F90                 push    eax
.text:42CF1F91                 call    sub_42CF99D7
.text:42CF1F96                 add     esp, 8
.text:42CF1F99                 test    eax, eax
.text:42CF1F9B                 jz      short loc_42CF1FAF
.text:42CF1F9D                 mov     edx, [ebp+s]
.text:42CF1FA3                 push    edx             ; s
.text:42CF1FA4                 call    ds:closesocket
.text:42CF1FAA                 jmp     loc_42CF1BDB
.text:42CF1FAF ; ---------------------------------------------------------------------------
.text:42CF1FAF
.text:42CF1FAF loc_42CF1FAF:                           ; CODE XREF: ConnectionListen+DAB\u2191j
.text:42CF1FAF                 mov     ax, word ptr [ebp+var_3818.sa_data]
.text:42CF1FB6                 push    eax             ; netshort
.text:42CF1FB7                 call    ds:ntohs
.text:42CF1FBD                 and     eax, 0FFFFh
.text:42CF1FC2                 mov     ecx, [ebp+var_218]
.text:42CF1FC8                 mov     [ebp+ecx*4+Value], eax
.text:42CF1FCF                 mov     edx, [ebp+var_338C]
.text:42CF1FD5                 mov     eax, [ebp+var_218]
.text:42CF1FDB                 mov     ecx, [ebp+eax*4+Value]
.text:42CF1FE2                 mov     [ebp+edx*4+var_348C], ecx
.text:42CF1FE9                 mov     edx, [ebp+var_338C]
.text:42CF1FEF                 add     edx, 1
.text:42CF1FF2                 mov     [ebp+var_338C], edx
.text:42CF1FF8
.text:42CF1FF8 loc_42CF1FF8:                           ; CODE XREF: ConnectionListen+D47\u2191j
.text:42CF1FF8                                         ; ConnectionListen+D5B\u2191j
.text:42CF1FF8                 mov     eax, [ebp+backlog]
.text:42CF1FFE                 push    eax             ; backlog
.text:42CF1FFF                 mov     ecx, [ebp+s]
.text:42CF2005                 push    ecx             ; s
.text:42CF2006                 call    ds:listen
.text:42CF200C                 mov     [ebp+var_A30], eax
.text:42CF2012                 cmp     [ebp+var_A30], 0FFFFFFFFh
.text:42CF2019                 jnz     short loc_42CF2084
.text:42CF201B                 mov     edx, [ebp+var_A40]
.text:42CF2021                 cmp     dword ptr [edx+5Ch], 6
.text:42CF2025                 jnz     short loc_42CF2038
.text:42CF2027                 mov     eax, [ebp+var_218]
.text:42CF202D                 mov     [ebp+eax*4+Value], 0
.text:42CF2038
.text:42CF2038 loc_42CF2038:                           ; CODE XREF: ConnectionListen+E35\u2191j
.text:42CF2038                 mov     [ebp+var_35AC], offset aListen ; "Listen"
.text:42CF2042                 call    ds:WSAGetLastError
.text:42CF2048                 mov     ecx, [ebp+arg_4]
.text:42CF204B                 mov     [ecx], eax
.text:42CF204D                 mov     edx, [ebp+s]
.text:42CF2053                 push    edx             ; s
.text:42CF2054                 call    ds:closesocket
.text:42CF205A                 push    1               ; wType
.text:42CF205C                 mov     eax, [ebp+arg_4]
.text:42CF205F                 mov     ecx, [eax]
.text:42CF2061                 push    ecx             ; int
.text:42CF2062                 mov     edx, [ebp+var_35AC]
.text:42CF2068                 push    edx             ; int
.text:42CF2069                 mov     eax, [ebp+var_A40]
.text:42CF206F                 add     eax, 74h ; 't'
.text:42CF2072                 push    eax             ; int
.text:42CF2073                 mov     ecx, [ebp+Block]
.text:42CF2076                 push    ecx             ; int
.text:42CF2077                 call    sub_42CF56FE
.text:42CF207C                 add     esp, 14h
.text:42CF207F                 jmp     loc_42CF1B7A
.text:42CF2084 ; ---------------------------------------------------------------------------
.text:42CF2084
.text:42CF2084 loc_42CF2084:                           ; CODE XREF: ConnectionListen+E29\u2191j
.text:42CF2084                 mov     edx, cEvents
.text:42CF208A                 mov     eax, [ebp+s]
.text:42CF2090                 mov     s[edx*4], eax
.text:42CF2097                 mov     ecx, [ebp+var_A40]
.text:42CF209D                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF20A1                 jnz     short loc_42CF20AD
.text:42CF20A3                 mov     [ebp+var_35A4], 1
.text:42CF20AD
.text:42CF20AD loc_42CF20AD:                           ; CODE XREF: ConnectionListen+EB1\u2191j
.text:42CF20AD                 mov     edx, cEvents
.text:42CF20B3                 add     edx, 1
.text:42CF20B6                 mov     cEvents, edx
.text:42CF20BC                 sub     esp, 10h
.text:42CF20BF                 mov     eax, esp
.text:42CF20C1                 mov     ecx, [ebp+var_35BC]
.text:42CF20C7                 mov     [eax], ecx
.text:42CF20C9                 mov     edx, [ebp+var_35B8]
.text:42CF20CF                 mov     [eax+4], edx
.text:42CF20D2                 mov     ecx, [ebp+var_35B4]
.text:42CF20D8                 mov     [eax+8], ecx
.text:42CF20DB                 mov     edx, [ebp+var_35B0]
.text:42CF20E1                 mov     [eax+0Ch], edx
.text:42CF20E4                 mov     eax, [ebp+var_218]
.text:42CF20EA                 mov     ecx, [ebp+eax*4+Value]
.text:42CF20F1                 push    ecx             ; int
.text:42CF20F2                 lea     edx, [ebp+String1]
.text:42CF20F8                 push    edx             ; Destination
.text:42CF20F9                 call    sub_42CF7880
.text:42CF20FE                 add     esp, 18h
.text:42CF2101                 jmp     loc_42CF1B7A
.text:42CF2106 ; ---------------------------------------------------------------------------
.text:42CF2106
.text:42CF2106 loc_42CF2106:                           ; CODE XREF: ConnectionListen+9A5\u2191j
.text:42CF2106                 jmp     loc_42CF1A96
.text:42CF210B ; ---------------------------------------------------------------------------
.text:42CF210B
.text:42CF210B loc_42CF210B:                           ; CODE XREF: ConnectionListen+8BE\u2191j
.text:42CF210B                                         ; ConnectionListen:loc_42CF1B1B\u2191j
.text:42CF210B                 cmp     [ebp+var_35A4], 0
.text:42CF2112                 jz      short loc_42CF2129
.text:42CF2114                 push    offset aTcp     ; ", TCP"
.text:42CF2119                 lea     eax, [ebp+var_214]
.text:42CF211F                 push    eax             ; Destination
.text:42CF2120                 call    ds:wcscat
.text:42CF2126                 add     esp, 8
.text:42CF2129
.text:42CF2129 loc_42CF2129:                           ; CODE XREF: ConnectionListen+F22\u2191j
.text:42CF2129                 mov     ecx, [ebp+var_A40]
.text:42CF212F                 cmp     dword ptr [ecx+5Ch], 6
.text:42CF2133                 jnz     short loc_42CF217C
.text:42CF2135                 lea     edx, [ebp+var_3598]
.text:42CF213B                 push    edx
.text:42CF213C                 call    sub_42CF9A35
.text:42CF2141                 add     esp, 4
.text:42CF2144                 test    eax, eax
.text:42CF2146                 jnz     short loc_42CF217C
.text:42CF2148                 mov     [ebp+var_35AC], offset aUpdatetcpport ; "UpdateTcpPort"
.text:42CF2152                 push    4               ; wType
.text:42CF2154                 mov     eax, [ebp+arg_4]
.text:42CF2157                 mov     ecx, [eax]
.text:42CF2159                 push    ecx             ; int
.text:42CF215A                 mov     edx, [ebp+var_35AC]
.text:42CF2160                 push    edx             ; int
.text:42CF2161                 mov     eax, [ebp+var_A40]
.text:42CF2167                 add     eax, 74h ; 't'
.text:42CF216A                 push    eax             ; int
.text:42CF216B                 mov     ecx, [ebp+Block]
.text:42CF216E                 push    ecx             ; int
.text:42CF216F                 call    sub_42CF56FE
.text:42CF2174                 add     esp, 14h
.text:42CF2177                 jmp     loc_42CF17D7
.text:42CF217C ; ---------------------------------------------------------------------------
.text:42CF217C
.text:42CF217C loc_42CF217C:                           ; CODE XREF: ConnectionListen+F43\u2191j
.text:42CF217C                                         ; ConnectionListen+F56\u2191j
.text:42CF217C                 mov     edx, [ebp+var_A40]
.text:42CF2182                 cmp     dword ptr [edx+5Ch], 4E8h
.text:42CF2189                 jnz     loc_42CF223D
.text:42CF218F                 lea     eax, [ebp+Source]
.text:42CF2195                 push    eax             ; Source
.text:42CF2196                 mov     ecx, [ebp+var_3278]
.text:42CF219C                 push    ecx             ; int
.text:42CF219D                 mov     edx, [ebp+s]
.text:42CF21A3                 push    edx             ; int
.text:42CF21A4                 call    sub_42CFC5E0
.text:42CF21A9                 add     esp, 0Ch
.text:42CF21AC                 test    eax, eax
.text:42CF21AE                 jnz     short loc_42CF220F
.text:42CF21B0                 mov     [ebp+var_35AC], offset aAdvertisespx ; "AdvertiseSPX"
.text:42CF21BA                 mov     eax, [ebp+s]
.text:42CF21C0                 push    eax             ; s
.text:42CF21C1                 call    ds:closesocket
.text:42CF21C7                 push    4               ; wType
.text:42CF21C9                 mov     ecx, [ebp+arg_4]
.text:42CF21CC                 mov     edx, [ecx]
.text:42CF21CE                 push    edx             ; int
.text:42CF21CF                 mov     eax, [ebp+var_35AC]
.text:42CF21D5                 push    eax             ; int
.text:42CF21D6                 mov     ecx, [ebp+var_A40]
.text:42CF21DC                 add     ecx, 74h ; 't'
.text:42CF21DF                 push    ecx             ; int
.text:42CF21E0                 mov     edx, [ebp+Block]
.text:42CF21E3                 push    edx             ; int
.text:42CF21E4                 call    sub_42CF56FE
.text:42CF21E9                 add     esp, 14h
.text:42CF21EC                 mov     eax, cEvents
.text:42CF21F1                 sub     eax, 1
.text:42CF21F4                 mov     cEvents, eax
.text:42CF21F9                 mov     ecx, cEvents
.text:42CF21FF                 mov     s[ecx*4], 0
.text:42CF220A                 jmp     loc_42CF17D7
.text:42CF220F ; ---------------------------------------------------------------------------
.text:42CF220F
.text:42CF220F loc_42CF220F:                           ; CODE XREF: ConnectionListen+FBE\u2191j
.text:42CF220F                 mov     dword_42D01C40, 1
.text:42CF2219                 mov     edx, cEvents
.text:42CF221F                 sub     edx, 1
.text:42CF2222                 mov     dword_42D010D0, edx
.text:42CF2228                 push    offset aSpx     ; ", Spx"
.text:42CF222D                 lea     eax, [ebp+var_214]
.text:42CF2233                 push    eax             ; Destination
.text:42CF2234                 call    ds:wcscat
.text:42CF223A                 add     esp, 8
.text:42CF223D
.text:42CF223D loc_42CF223D:                           ; CODE XREF: ConnectionListen+F99\u2191j
.text:42CF223D                 mov     ecx, [ebp+name]
.text:42CF2243                 push    ecx             ; Block
.text:42CF2244                 call    ds:free
.text:42CF224A                 add     esp, 4
.text:42CF224D
.text:42CF224D loc_42CF224D:                           ; CODE XREF: ConnectionListen+76C\u2191j
.text:42CF224D                                         ; ConnectionListen+779\u2191j ...
.text:42CF224D                 jmp     loc_42CF17D7
.text:42CF2252 ; ---------------------------------------------------------------------------
.text:42CF2252
.text:42CF2252 loc_42CF2252:                           ; CODE XREF: ConnectionListen+611\u2191j
.text:42CF2252                 mov     edx, [ebp+lpProtocolBuffer]
.text:42CF2255                 push    edx             ; Block
.text:42CF2256                 call    ds:free
.text:42CF225C                 add     esp, 4
.text:42CF225F                 mov     eax, [ebp+var_35AC]
.text:42CF2265                 push    eax
.text:42CF2266                 mov     ecx, [ebp+arg_4]
.text:42CF2269                 push    ecx
.text:42CF226A                 mov     edx, [ebp+Block]
.text:42CF226D                 push    edx
.text:42CF226E                 call    sub_42CF508D
.text:42CF2273                 add     esp, 0Ch
.text:42CF2276                 test    eax, eax
.text:42CF2278                 jnz     short loc_42CF229A
.text:42CF227A                 push    1               ; wType
.text:42CF227C                 mov     eax, [ebp+arg_4]
.text:42CF227F                 mov     ecx, [eax]
.text:42CF2281                 push    ecx             ; int
.text:42CF2282                 mov     edx, [ebp+var_35AC]
.text:42CF2288                 push    edx             ; int
.text:42CF2289                 push    offset aStartssrp ; "StartSsrp"
.text:42CF228E                 mov     eax, [ebp+Block]
.text:42CF2291                 push    eax             ; int
.text:42CF2292                 call    sub_42CF56FE
.text:42CF2297                 add     esp, 14h
.text:42CF229A
.text:42CF229A loc_42CF229A:                           ; CODE XREF: ConnectionListen+1088\u2191j
.text:42CF229A                 mov     ecx, [ebp+Block]
.text:42CF229D                 mov     dword_42D010D8, ecx
.text:42CF22A3                 lea     edx, [ebp+var_3598]
.text:42CF22A9                 push    edx
.text:42CF22AA                 call    sub_42CF5128
.text:42CF22AF                 add     esp, 4
.text:42CF22B2                 lea     eax, [ebp+var_214]
.text:42CF22B8                 push    eax             ; Destination
.text:42CF22B9                 lea     ecx, [ebp+var_3598]
.text:42CF22BF                 push    ecx             ; int
.text:42CF22C0                 mov     edx, [ebp+arg_4]
.text:42CF22C3                 push    edx             ; int
.text:42CF22C4                 mov     eax, [ebp+Block]
.text:42CF22C7                 push    eax             ; int
.text:42CF22C8                 call    sub_42CF5769
.text:42CF22CD                 add     esp, 10h
.text:42CF22D0                 mov     [ebp+var_35A0], eax
.text:42CF22D6                 cmp     dword_42D01A1C, 0
.text:42CF22DD                 jz      short loc_42CF2330
.text:42CF22DF                 cmp     VersionInformation.dwMajorVersion, 5
.text:42CF22E6                 jb      short loc_42CF2330
.text:42CF22E8                 push    1
.text:42CF22EA                 mov     ecx, [ebp+Value]
.text:42CF22F0                 push    ecx
.text:42CF22F1                 call    sub_42CFCA5A
.text:42CF22F6                 add     esp, 8
.text:42CF22F9                 mov     edx, [ebp+arg_4]
.text:42CF22FC                 mov     [edx], eax
.text:42CF22FE                 mov     eax, [ebp+arg_4]
.text:42CF2301                 cmp     dword ptr [eax], 0
.text:42CF2304                 jnz     short loc_42CF2312
.text:42CF2306                 mov     dword_42D010E0, 1
.text:42CF2310                 jmp     short loc_42CF2330
.text:42CF2312 ; ---------------------------------------------------------------------------
.text:42CF2312
.text:42CF2312 loc_42CF2312:                           ; CODE XREF: ConnectionListen+1114\u2191j
.text:42CF2312                 push    2               ; wType
.text:42CF2314                 mov     ecx, [ebp+arg_4]
.text:42CF2317                 mov     edx, [ecx]
.text:42CF2319                 push    edx             ; int
.text:42CF231A                 push    offset unk_42D010F8 ; int
.text:42CF231F                 push    offset aSpnregister ; "SpnRegister"
.text:42CF2324                 mov     eax, [ebp+Block]
.text:42CF2327                 push    eax             ; int
.text:42CF2328                 call    sub_42CF56FE
.text:42CF232D                 add     esp, 14h
.text:42CF2330
.text:42CF2330 loc_42CF2330:                           ; CODE XREF: ConnectionListen+10ED\u2191j
.text:42CF2330                                         ; ConnectionListen+10F6\u2191j ...
.text:42CF2330                 mov     ecx, [ebp+arg_4]
.text:42CF2333                 push    ecx             ; int
.text:42CF2334                 mov     edx, [ebp+Block]
.text:42CF2337                 push    edx             ; lpParameter
.text:42CF2338                 call    sub_42CF69B4
.text:42CF233D                 add     esp, 8
.text:42CF2340                 test    eax, eax
.text:42CF2342                 jnz     short loc_42CF2349
.text:42CF2344                 jmp     loc_42CF23CF
.text:42CF2349 ; ---------------------------------------------------------------------------
.text:42CF2349
.text:42CF2349 loc_42CF2349:                           ; CODE XREF: ConnectionListen+1152\u2191j
.text:42CF2349                 lea     eax, [ebp+var_210]
.text:42CF234F                 push    eax
.text:42CF2350                 push    40004A45h
.text:42CF2355                 call    dword_42D01A18
.text:42CF235B                 add     esp, 8
.text:42CF235E                 push    offset byte_42D010FC ; String2
.text:42CF2363                 lea     ecx, [ebp+String1]
.text:42CF2369                 push    ecx             ; String1
.text:42CF236A                 call    ds:_stricmp
.text:42CF2370                 add     esp, 8
.text:42CF2373                 test    eax, eax
.text:42CF2375                 jz      short loc_42CF23AF
.text:42CF2377                 push    800h            ; cchWideChar
.text:42CF237C                 lea     edx, [ebp+WideCharStr]
.text:42CF2382                 push    edx             ; lpWideCharStr
.text:42CF2383                 push    0FFFFFFFFh      ; cbMultiByte
.text:42CF2385                 lea     eax, [ebp+MultiByteStr]
.text:42CF238B                 push    eax             ; lpMultiByteStr
.text:42CF238C                 push    0               ; dwFlags
.text:42CF238E                 push    0               ; CodePage
.text:42CF2390                 call    ds:MultiByteToWideChar
.text:42CF2396                 test    eax, eax
.text:42CF2398                 jz      short loc_42CF23AF
.text:42CF239A                 lea     ecx, [ebp+WideCharStr]
.text:42CF23A0                 push    ecx
.text:42CF23A1                 push    40004A45h
.text:42CF23A6                 call    dword_42D01A18
.text:42CF23AC                 add     esp, 8
.text:42CF23AF
.text:42CF23AF loc_42CF23AF:                           ; CODE XREF: ConnectionListen+1185\u2191j
.text:42CF23AF                                         ; ConnectionListen+11A8\u2191j
.text:42CF23AF                 cmp     cEvents, 0
.text:42CF23B6                 jg      short loc_42CF23CA
.text:42CF23B8                 cmp     dword_42D010D4, 0
.text:42CF23BF                 jnz     short loc_42CF23CA
.text:42CF23C1                 cmp     [ebp+var_35A0], 1
.text:42CF23C8                 jnz     short loc_42CF23CF
.text:42CF23CA
.text:42CF23CA loc_42CF23CA:                           ; CODE XREF: ConnectionListen+11C6\u2191j
.text:42CF23CA                                         ; ConnectionListen+11CF\u2191j
.text:42CF23CA                 mov     eax, [ebp+Block]
.text:42CF23CD                 jmp     short loc_42CF23E4
.text:42CF23CF ; ---------------------------------------------------------------------------
.text:42CF23CF
.text:42CF23CF loc_42CF23CF:                           ; CODE XREF: ConnectionListen+B1\u2191j
.text:42CF23CF                                         ; ConnectionListen+164\u2191j ...
.text:42CF23CF                 cmp     [ebp+Block], 0
.text:42CF23D3                 jz      short loc_42CF23E2
.text:42CF23D5                 mov     edx, [ebp+Block]
.text:42CF23D8                 push    edx             ; Block
.text:42CF23D9                 call    ds:free
.text:42CF23DF                 add     esp, 4
.text:42CF23E2
.text:42CF23E2 loc_42CF23E2:                           ; CODE XREF: ConnectionListen+11E3\u2191j
.text:42CF23E2                 xor     eax, eax
.text:42CF23E4
.text:42CF23E4 loc_42CF23E4:                           ; CODE XREF: ConnectionListen+11DD\u2191j
.text:42CF23E4                 pop     edi
.text:42CF23E5                 mov     esp, ebp
.text:42CF23E7                 pop     ebp
.text:42CF23E8                 retn
.text:42CF23E8 ConnectionListen endp
.text:42CF23E8
.text:42CF23E9
.text:42CF23E9 ; =============== S U B R O U T I N E =======================================
.text:42CF23E9
.text:42CF23E9 ; Attributes: noreturn bp-based frame
.text:42CF23E9
.text:42CF23E9 sub_42CF23E9    proc near               ; CODE XREF: sub_42CF2424+64\u2193p
.text:42CF23E9                                         ; sub_42CF2424+9A\u2193p ...
.text:42CF23E9
.text:42CF23E9 arg_0           = dword ptr  8
.text:42CF23E9
.text:42CF23E9                 push    ebp
.text:42CF23EA                 mov     ebp, esp
.text:42CF23EC                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF23EE                 mov     eax, hSemaphore
.text:42CF23F3                 push    eax             ; hHandle
.text:42CF23F4                 call    ds:WaitForSingleObject
.text:42CF23FA                 mov     CompletionKey, 0
.text:42CF2404                 mov     ecx, [ebp+arg_0]
.text:42CF2407                 mov     dword_42D01DF8, ecx
.text:42CF240D                 mov     edx, hHandle
.text:42CF2413                 push    edx             ; hEvent
.text:42CF2414                 call    ds:SetEvent
.text:42CF241A                 push    0               ; dwExitCode
.text:42CF241C                 call    ds:ExitThread
.text:42CF241C sub_42CF23E9    endp
.text:42CF241C
.text:42CF2422 ; ---------------------------------------------------------------------------
.text:42CF2422                 pop     ebp
.text:42CF2423                 retn
.text:42CF2424
.text:42CF2424 ; =============== S U B R O U T I N E =======================================
.text:42CF2424
.text:42CF2424 ; Attributes: bp-based frame
.text:42CF2424
.text:42CF2424 ; DWORD __stdcall sub_42CF2424(LPVOID lpThreadParameter)
.text:42CF2424 sub_42CF2424    proc near               ; DATA XREF: sub_42CF69B4+18\u2193o
.text:42CF2424
.text:42CF2424 var_C           = dword ptr -0Ch
.text:42CF2424 var_8           = dword ptr -8
.text:42CF2424 var_4           = dword ptr -4
.text:42CF2424 lpThreadParameter= dword ptr  8
.text:42CF2424
.text:42CF2424                 push    ebp
.text:42CF2425                 mov     ebp, esp
.text:42CF2427                 sub     esp, 0Ch
.text:42CF242A                 mov     [ebp+var_C], 0
.text:42CF2431                 mov     [ebp+var_4], 0
.text:42CF2438                 jmp     short loc_42CF2443
.text:42CF243A ; ---------------------------------------------------------------------------
.text:42CF243A
.text:42CF243A loc_42CF243A:                           ; CODE XREF: sub_42CF2424:loc_42CF2490\u2193j
.text:42CF243A                 mov     eax, [ebp+var_4]
.text:42CF243D                 add     eax, 1
.text:42CF2440                 mov     [ebp+var_4], eax
.text:42CF2443
.text:42CF2443 loc_42CF2443:                           ; CODE XREF: sub_42CF2424+14\u2191j
.text:42CF2443                 mov     ecx, [ebp+var_4]
.text:42CF2446                 cmp     ecx, cEvents
.text:42CF244C                 jge     short loc_42CF2492
.text:42CF244E                 call    ds:WSACreateEvent
.text:42CF2454                 mov     edx, [ebp+var_4]
.text:42CF2457                 mov     hEventObject[edx*4], eax
.text:42CF245E                 push    8               ; lNetworkEvents
.text:42CF2460                 mov     eax, [ebp+var_4]
.text:42CF2463                 mov     ecx, hEventObject[eax*4]
.text:42CF246A                 push    ecx             ; hEventObject
.text:42CF246B                 mov     edx, [ebp+var_4]
.text:42CF246E                 mov     eax, s[edx*4]
.text:42CF2475                 push    eax             ; s
.text:42CF2476                 call    ds:WSAEventSelect
.text:42CF247C                 cmp     eax, 0FFFFFFFFh
.text:42CF247F                 jnz     short loc_42CF2490
.text:42CF2481                 call    ds:WSAGetLastError
.text:42CF2487                 push    eax
.text:42CF2488                 call    sub_42CF23E9
.text:42CF248D ; ---------------------------------------------------------------------------
.text:42CF248D                 add     esp, 4
.text:42CF2490
.text:42CF2490 loc_42CF2490:                           ; CODE XREF: sub_42CF2424+5B\u2191j
.text:42CF2490                 jmp     short loc_42CF243A
.text:42CF2492 ; ---------------------------------------------------------------------------
.text:42CF2492
.text:42CF2492 loc_42CF2492:                           ; CODE XREF: sub_42CF2424+28\u2191j
.text:42CF2492                 mov     dword_42D010E8, 1
.text:42CF249C
.text:42CF249C loc_42CF249C:                           ; CODE XREF: sub_42CF2424+BB\u2193j
.text:42CF249C                 mov     ecx, 1
.text:42CF24A1                 test    ecx, ecx
.text:42CF24A3                 jz      short loc_42CF24E1
.text:42CF24A5                 lea     edx, [ebp+var_8]
.text:42CF24A8                 push    edx
.text:42CF24A9                 call    sub_42CF2BC5
.text:42CF24AE                 add     esp, 4
.text:42CF24B1                 mov     [ebp+var_C], eax
.text:42CF24B4                 cmp     [ebp+var_C], 0
.text:42CF24B8                 jnz     short loc_42CF24C6
.text:42CF24BA                 mov     eax, [ebp+var_8]
.text:42CF24BD                 push    eax
.text:42CF24BE                 call    sub_42CF23E9
.text:42CF24C3 ; ---------------------------------------------------------------------------
.text:42CF24C3                 add     esp, 4
.text:42CF24C6
.text:42CF24C6 loc_42CF24C6:                           ; CODE XREF: sub_42CF2424+94\u2191j
.text:42CF24C6                 mov     ecx, [ebp+var_C]
.text:42CF24C9                 mov     dword ptr [ecx+80h], 0
.text:42CF24D3                 mov     edx, [ebp+var_C]
.text:42CF24D6                 push    edx
.text:42CF24D7                 call    sub_42CF6D55
.text:42CF24DC                 add     esp, 4
.text:42CF24DF                 jmp     short loc_42CF249C
.text:42CF24E1 ; ---------------------------------------------------------------------------
.text:42CF24E1
.text:42CF24E1 loc_42CF24E1:                           ; CODE XREF: sub_42CF2424+7F\u2191j
.text:42CF24E1                 mov     esp, ebp
.text:42CF24E3                 pop     ebp
.text:42CF24E4                 retn
.text:42CF24E4 sub_42CF2424    endp
.text:42CF24E4
.text:42CF24E5
.text:42CF24E5 ; =============== S U B R O U T I N E =======================================
.text:42CF24E5
.text:42CF24E5 ; Attributes: bp-based frame
.text:42CF24E5
.text:42CF24E5 ; DWORD __stdcall sub_42CF24E5(LPVOID lpThreadParameter)
.text:42CF24E5 sub_42CF24E5    proc near               ; DATA XREF: sub_42CF69B4+68\u2193o
.text:42CF24E5
.text:42CF24E5 argp            = dword ptr -0Ch
.text:42CF24E5 var_8           = dword ptr -8
.text:42CF24E5 var_4           = dword ptr -4
.text:42CF24E5 lpThreadParameter= dword ptr  8
.text:42CF24E5
.text:42CF24E5                 push    ebp
.text:42CF24E6                 mov     ebp, esp
.text:42CF24E8                 sub     esp, 0Ch
.text:42CF24EB                 mov     [ebp+var_8], 0
.text:42CF24F2                 mov     [ebp+argp], 0
.text:42CF24F9
.text:42CF24F9 loc_42CF24F9:                           ; CODE XREF: sub_42CF24E5+25\u2193j
.text:42CF24F9                 cmp     dword_42D010E8, 0
.text:42CF2500                 jnz     short loc_42CF250C
.text:42CF2502                 push    5               ; dwMilliseconds
.text:42CF2504                 call    ds:Sleep
.text:42CF250A                 jmp     short loc_42CF24F9
.text:42CF250C ; ---------------------------------------------------------------------------
.text:42CF250C
.text:42CF250C loc_42CF250C:                           ; CODE XREF: sub_42CF24E5+1B\u2191j
.text:42CF250C                 lea     eax, [ebp+argp]
.text:42CF250F                 push    eax             ; argp
.text:42CF2510                 push    8004667Eh       ; cmd
.text:42CF2515                 mov     ecx, dword_42D010D4
.text:42CF251B                 push    ecx             ; s
.text:42CF251C                 call    ds:ioctlsocket
.text:42CF2522                 cmp     eax, 0FFFFFFFFh
.text:42CF2525                 jnz     short loc_42CF253C
.text:42CF2527                 call    ds:WSAGetLastError
.text:42CF252D                 mov     [ebp+var_4], eax
.text:42CF2530                 mov     edx, [ebp+var_4]
.text:42CF2533                 push    edx
.text:42CF2534                 call    sub_42CF23E9
.text:42CF2539 ; ---------------------------------------------------------------------------
.text:42CF2539                 add     esp, 4
.text:42CF253C
.text:42CF253C loc_42CF253C:                           ; CODE XREF: sub_42CF24E5+40\u2191j
.text:42CF253C                                         ; sub_42CF24E5+9A\u2193j
.text:42CF253C                 mov     eax, 1
.text:42CF2541                 test    eax, eax
.text:42CF2543                 jz      short loc_42CF2581
.text:42CF2545                 lea     ecx, [ebp+var_4]
.text:42CF2548                 push    ecx
.text:42CF2549                 call    sub_42CF2F5B
.text:42CF254E                 add     esp, 4
.text:42CF2551                 mov     [ebp+var_8], eax
.text:42CF2554                 cmp     [ebp+var_8], 0
.text:42CF2558                 jnz     short loc_42CF2566
.text:42CF255A                 mov     edx, [ebp+var_4]
.text:42CF255D                 push    edx
.text:42CF255E                 call    sub_42CF23E9
.text:42CF2563 ; ---------------------------------------------------------------------------
.text:42CF2563                 add     esp, 4
.text:42CF2566
.text:42CF2566 loc_42CF2566:                           ; CODE XREF: sub_42CF24E5+73\u2191j
.text:42CF2566                 mov     eax, [ebp+var_8]
.text:42CF2569                 mov     dword ptr [eax+80h], 0
.text:42CF2573                 mov     ecx, [ebp+var_8]
.text:42CF2576                 push    ecx
.text:42CF2577                 call    sub_42CF6D55
.text:42CF257C                 add     esp, 4
.text:42CF257F                 jmp     short loc_42CF253C
.text:42CF2581 ; ---------------------------------------------------------------------------
.text:42CF2581
.text:42CF2581 loc_42CF2581:                           ; CODE XREF: sub_42CF24E5+5E\u2191j
.text:42CF2581                 mov     esp, ebp
.text:42CF2583                 pop     ebp
.text:42CF2584                 retn
.text:42CF2584 sub_42CF24E5    endp
.text:42CF2584
.text:42CF2585
.text:42CF2585 ; =============== S U B R O U T I N E =======================================
.text:42CF2585
.text:42CF2585 ; Attributes: bp-based frame
.text:42CF2585
.text:42CF2585 ; DWORD __stdcall sub_42CF2585(LPVOID lpThreadParameter)
.text:42CF2585 sub_42CF2585    proc near               ; DATA XREF: sub_42CF69B4+BD\u2193o
.text:42CF2585
.text:42CF2585 var_10          = dword ptr -10h
.text:42CF2585 Size            = dword ptr -0Ch
.text:42CF2585 var_8           = dword ptr -8
.text:42CF2585 var_4           = dword ptr -4
.text:42CF2585 lpThreadParameter= dword ptr  8
.text:42CF2585
.text:42CF2585                 push    ebp
.text:42CF2586                 mov     ebp, esp
.text:42CF2588                 sub     esp, 10h
.text:42CF258B                 call    dword_42D01BD0
.text:42CF2591                 mov     [ebp+Size], eax
.text:42CF2594                 push    0               ; lpName
.text:42CF2596                 push    0               ; bInitialState
.text:42CF2598                 push    1               ; bManualReset
.text:42CF259A                 push    0               ; lpEventAttributes
.text:42CF259C                 call    ds:CreateEventA
.text:42CF25A2                 mov     [ebp+var_4], eax
.text:42CF25A5
.text:42CF25A5 loc_42CF25A5:                           ; CODE XREF: sub_42CF2585+F5\u2193j
.text:42CF25A5                 mov     eax, 1
.text:42CF25AA                 test    eax, eax
.text:42CF25AC                 jz      loc_42CF267F
.text:42CF25B2                 mov     [ebp+var_10], 0
.text:42CF25B9                 push    0A8h ; '¨'      ; Size
.text:42CF25BE                 call    ds:malloc
.text:42CF25C4                 add     esp, 4
.text:42CF25C7                 mov     [ebp+var_10], eax
.text:42CF25CA                 cmp     [ebp+var_10], 0
.text:42CF25CE                 jnz     short loc_42CF25DA
.text:42CF25D0                 push    1
.text:42CF25D2                 call    sub_42CF23E9
.text:42CF25D7 ; ---------------------------------------------------------------------------
.text:42CF25D7                 add     esp, 4
.text:42CF25DA
.text:42CF25DA loc_42CF25DA:                           ; CODE XREF: sub_42CF2585+49\u2191j
.text:42CF25DA                 push    0A8h ; '¨'      ; Size
.text:42CF25DF                 push    0               ; Val
.text:42CF25E1                 mov     ecx, [ebp+var_10]
.text:42CF25E4                 push    ecx             ; void *
.text:42CF25E5                 call    memset
.text:42CF25EA                 add     esp, 0Ch
.text:42CF25ED                 mov     edx, [ebp+var_10]
.text:42CF25F0                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF25F6                 mov     eax, [ebp+Size]
.text:42CF25F9                 push    eax             ; Size
.text:42CF25FA                 call    ds:malloc
.text:42CF2600                 add     esp, 4
.text:42CF2603                 mov     ecx, [ebp+var_10]
.text:42CF2606                 mov     [ecx+88h], eax
.text:42CF260C                 mov     edx, [ebp+var_10]
.text:42CF260F                 cmp     dword ptr [edx+88h], 0
.text:42CF2616                 jnz     short loc_42CF2622
.text:42CF2618                 push    1
.text:42CF261A                 call    sub_42CF23E9
.text:42CF261F ; ---------------------------------------------------------------------------
.text:42CF261F                 add     esp, 4
.text:42CF2622
.text:42CF2622 loc_42CF2622:                           ; CODE XREF: sub_42CF2585+91\u2191j
.text:42CF2622                 lea     eax, [ebp+var_8]
.text:42CF2625                 push    eax
.text:42CF2626                 mov     ecx, [ebp+var_4]
.text:42CF2629                 push    ecx
.text:42CF262A                 mov     edx, [ebp+var_10]
.text:42CF262D                 mov     eax, [edx+88h]
.text:42CF2633                 push    eax
.text:42CF2634                 mov     ecx, dword_42D01BA0
.text:42CF263A                 push    ecx
.text:42CF263B                 call    dword_42D01BB8
.text:42CF2641                 add     esp, 10h
.text:42CF2644                 test    eax, eax
.text:42CF2646                 jnz     short loc_42CF2654
.text:42CF2648                 mov     edx, [ebp+var_8]
.text:42CF264B                 push    edx
.text:42CF264C                 call    sub_42CF23E9
.text:42CF2651 ; ---------------------------------------------------------------------------
.text:42CF2651                 add     esp, 4
.text:42CF2654
.text:42CF2654 loc_42CF2654:                           ; CODE XREF: sub_42CF2585+C1\u2191j
.text:42CF2654                 mov     eax, [ebp+var_10]
.text:42CF2657                 mov     dword ptr [eax+80h], 1
.text:42CF2661                 mov     ecx, [ebp+var_10]
.text:42CF2664                 mov     dword ptr [ecx+84h], 6
.text:42CF266E                 mov     edx, [ebp+var_10]
.text:42CF2671                 push    edx
.text:42CF2672                 call    sub_42CF6D55
.text:42CF2677                 add     esp, 4
.text:42CF267A                 jmp     loc_42CF25A5
.text:42CF267F ; ---------------------------------------------------------------------------
.text:42CF267F
.text:42CF267F loc_42CF267F:                           ; CODE XREF: sub_42CF2585+27\u2191j
.text:42CF267F                 mov     esp, ebp
.text:42CF2681                 pop     ebp
.text:42CF2682                 retn
.text:42CF2682 sub_42CF2585    endp
.text:42CF2682
.text:42CF2683
.text:42CF2683 ; =============== S U B R O U T I N E =======================================
.text:42CF2683
.text:42CF2683 ; Attributes: bp-based frame
.text:42CF2683
.text:42CF2683 ; DWORD __stdcall sub_42CF2683(LPVOID lpThreadParameter)
.text:42CF2683 sub_42CF2683    proc near               ; DATA XREF: sub_42CF69B4+123\u2193o
.text:42CF2683
.text:42CF2683 var_10          = dword ptr -10h
.text:42CF2683 Size            = dword ptr -0Ch
.text:42CF2683 var_8           = dword ptr -8
.text:42CF2683 var_4           = dword ptr -4
.text:42CF2683 lpThreadParameter= dword ptr  8
.text:42CF2683
.text:42CF2683                 push    ebp
.text:42CF2684                 mov     ebp, esp
.text:42CF2686                 sub     esp, 10h
.text:42CF2689                 call    dword_42D01E30
.text:42CF268F                 mov     [ebp+Size], eax
.text:42CF2692                 push    0               ; lpName
.text:42CF2694                 push    0               ; bInitialState
.text:42CF2696                 push    1               ; bManualReset
.text:42CF2698                 push    0               ; lpEventAttributes
.text:42CF269A                 call    ds:CreateEventA
.text:42CF26A0                 mov     [ebp+var_4], eax
.text:42CF26A3
.text:42CF26A3 loc_42CF26A3:                           ; CODE XREF: sub_42CF2683+141\u2193j
.text:42CF26A3                 mov     eax, 1
.text:42CF26A8                 test    eax, eax
.text:42CF26AA                 jz      loc_42CF27C9
.text:42CF26B0                 mov     [ebp+var_10], 0
.text:42CF26B7                 push    0A8h ; '¨'      ; Size
.text:42CF26BC                 call    ds:malloc
.text:42CF26C2                 add     esp, 4
.text:42CF26C5                 mov     [ebp+var_10], eax
.text:42CF26C8                 cmp     [ebp+var_10], 0
.text:42CF26CC                 jnz     short loc_42CF26D8
.text:42CF26CE                 push    1
.text:42CF26D0                 call    sub_42CF23E9
.text:42CF26D5 ; ---------------------------------------------------------------------------
.text:42CF26D5                 add     esp, 4
.text:42CF26D8
.text:42CF26D8 loc_42CF26D8:                           ; CODE XREF: sub_42CF2683+49\u2191j
.text:42CF26D8                 push    0A8h ; '¨'      ; Size
.text:42CF26DD                 push    0               ; Val
.text:42CF26DF                 mov     ecx, [ebp+var_10]
.text:42CF26E2                 push    ecx             ; void *
.text:42CF26E3                 call    memset
.text:42CF26E8                 add     esp, 0Ch
.text:42CF26EB                 mov     edx, [ebp+var_10]
.text:42CF26EE                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF26F4                 mov     eax, [ebp+Size]
.text:42CF26F7                 push    eax             ; Size
.text:42CF26F8                 call    ds:malloc
.text:42CF26FE                 add     esp, 4
.text:42CF2701                 mov     ecx, [ebp+var_10]
.text:42CF2704                 mov     [ecx+88h], eax
.text:42CF270A                 mov     edx, [ebp+var_10]
.text:42CF270D                 cmp     dword ptr [edx+88h], 0
.text:42CF2714                 jnz     short loc_42CF2720
.text:42CF2716                 push    1
.text:42CF2718                 call    sub_42CF23E9
.text:42CF271D ; ---------------------------------------------------------------------------
.text:42CF271D                 add     esp, 4
.text:42CF2720
.text:42CF2720 loc_42CF2720:                           ; CODE XREF: sub_42CF2683+91\u2191j
.text:42CF2720                 lea     eax, [ebp+var_8]
.text:42CF2723                 push    eax
.text:42CF2724                 mov     ecx, [ebp+var_4]
.text:42CF2727                 push    ecx
.text:42CF2728                 mov     edx, [ebp+var_10]
.text:42CF272B                 mov     eax, [edx+88h]
.text:42CF2731                 push    eax
.text:42CF2732                 mov     ecx, Block
.text:42CF2738                 push    ecx
.text:42CF2739                 call    dword_42D01E18
.text:42CF273F                 add     esp, 10h
.text:42CF2742                 test    eax, eax
.text:42CF2744                 jnz     short loc_42CF2752
.text:42CF2746                 mov     edx, [ebp+var_8]
.text:42CF2749                 push    edx
.text:42CF274A                 call    sub_42CF23E9
.text:42CF274F ; ---------------------------------------------------------------------------
.text:42CF274F                 add     esp, 4
.text:42CF2752
.text:42CF2752 loc_42CF2752:                           ; CODE XREF: sub_42CF2683+C1\u2191j
.text:42CF2752                 mov     eax, [ebp+var_10]
.text:42CF2755                 mov     dword ptr [eax+80h], 1
.text:42CF275F                 mov     ecx, [ebp+var_10]
.text:42CF2762                 mov     dword ptr [ecx+84h], 1
.text:42CF276C                 push    offset CriticalSection ; lpCriticalSection
.text:42CF2771                 call    ds:EnterCriticalSection
.text:42CF2777
.text:42CF2777 loc_42CF2777:                           ; CODE XREF: sub_42CF2683+123\u2193j
.text:42CF2777                 push    offset unk_42D01DE0
.text:42CF277C                 call    sub_42CF775F
.text:42CF2781                 add     esp, 4
.text:42CF2784                 test    eax, eax
.text:42CF2786                 jz      short loc_42CF27A8
.text:42CF2788                 push    offset CriticalSection ; lpCriticalSection
.text:42CF278D                 call    ds:LeaveCriticalSection
.text:42CF2793                 push    1               ; dwMilliseconds
.text:42CF2795                 call    ds:Sleep
.text:42CF279B                 push    offset CriticalSection ; lpCriticalSection
.text:42CF27A0                 call    ds:EnterCriticalSection
.text:42CF27A6                 jmp     short loc_42CF2777
.text:42CF27A8 ; ---------------------------------------------------------------------------
.text:42CF27A8
.text:42CF27A8 loc_42CF27A8:                           ; CODE XREF: sub_42CF2683+103\u2191j
.text:42CF27A8                 mov     edx, [ebp+var_10]
.text:42CF27AB                 push    edx
.text:42CF27AC                 push    offset unk_42D01DE0
.text:42CF27B1                 call    sub_42CF7634
.text:42CF27B6                 add     esp, 8
.text:42CF27B9                 push    offset CriticalSection ; lpCriticalSection
.text:42CF27BE                 call    ds:LeaveCriticalSection
.text:42CF27C4                 jmp     loc_42CF26A3
.text:42CF27C9 ; ---------------------------------------------------------------------------
.text:42CF27C9
.text:42CF27C9 loc_42CF27C9:                           ; CODE XREF: sub_42CF2683+27\u2191j
.text:42CF27C9                 mov     esp, ebp
.text:42CF27CB                 pop     ebp
.text:42CF27CC                 retn
.text:42CF27CC sub_42CF2683    endp
.text:42CF27CC
.text:42CF27CD
.text:42CF27CD ; =============== S U B R O U T I N E =======================================
.text:42CF27CD
.text:42CF27CD ; Attributes: bp-based frame
.text:42CF27CD
.text:42CF27CD ; DWORD __stdcall sub_42CF27CD(LPVOID lpThreadParameter)
.text:42CF27CD sub_42CF27CD    proc near               ; DATA XREF: sub_42CF69B4+1D7\u2193o
.text:42CF27CD
.text:42CF27CD var_10          = dword ptr -10h
.text:42CF27CD Size            = dword ptr -0Ch
.text:42CF27CD var_8           = dword ptr -8
.text:42CF27CD var_4           = dword ptr -4
.text:42CF27CD lpThreadParameter= dword ptr  8
.text:42CF27CD
.text:42CF27CD                 push    ebp
.text:42CF27CE                 mov     ebp, esp
.text:42CF27D0                 sub     esp, 10h
.text:42CF27D3                 call    dword_42D01F70
.text:42CF27D9                 mov     [ebp+Size], eax
.text:42CF27DC                 push    0               ; lpName
.text:42CF27DE                 push    0               ; bInitialState
.text:42CF27E0                 push    1               ; bManualReset
.text:42CF27E2                 push    0               ; lpEventAttributes
.text:42CF27E4                 call    ds:CreateEventA
.text:42CF27EA                 mov     [ebp+var_4], eax
.text:42CF27ED
.text:42CF27ED loc_42CF27ED:                           ; CODE XREF: sub_42CF27CD+F5\u2193j
.text:42CF27ED                 mov     eax, 1
.text:42CF27F2                 test    eax, eax
.text:42CF27F4                 jz      loc_42CF28C7
.text:42CF27FA                 mov     [ebp+var_10], 0
.text:42CF2801                 push    0A8h ; '¨'      ; Size
.text:42CF2806                 call    ds:malloc
.text:42CF280C                 add     esp, 4
.text:42CF280F                 mov     [ebp+var_10], eax
.text:42CF2812                 cmp     [ebp+var_10], 0
.text:42CF2816                 jnz     short loc_42CF2822
.text:42CF2818                 push    1
.text:42CF281A                 call    sub_42CF23E9
.text:42CF281F ; ---------------------------------------------------------------------------
.text:42CF281F                 add     esp, 4
.text:42CF2822
.text:42CF2822 loc_42CF2822:                           ; CODE XREF: sub_42CF27CD+49\u2191j
.text:42CF2822                 push    0A8h ; '¨'      ; Size
.text:42CF2827                 push    0               ; Val
.text:42CF2829                 mov     ecx, [ebp+var_10]
.text:42CF282C                 push    ecx             ; void *
.text:42CF282D                 call    memset
.text:42CF2832                 add     esp, 0Ch
.text:42CF2835                 mov     edx, [ebp+var_10]
.text:42CF2838                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF283E                 mov     eax, [ebp+Size]
.text:42CF2841                 push    eax             ; Size
.text:42CF2842                 call    ds:malloc
.text:42CF2848                 add     esp, 4
.text:42CF284B                 mov     ecx, [ebp+var_10]
.text:42CF284E                 mov     [ecx+88h], eax
.text:42CF2854                 mov     edx, [ebp+var_10]
.text:42CF2857                 cmp     dword ptr [edx+88h], 0
.text:42CF285E                 jnz     short loc_42CF286A
.text:42CF2860                 push    1
.text:42CF2862                 call    sub_42CF23E9
.text:42CF2867 ; ---------------------------------------------------------------------------
.text:42CF2867                 add     esp, 4
.text:42CF286A
.text:42CF286A loc_42CF286A:                           ; CODE XREF: sub_42CF27CD+91\u2191j
.text:42CF286A                 lea     eax, [ebp+var_8]
.text:42CF286D                 push    eax
.text:42CF286E                 mov     ecx, [ebp+var_4]
.text:42CF2871                 push    ecx
.text:42CF2872                 mov     edx, [ebp+var_10]
.text:42CF2875                 mov     eax, [edx+88h]
.text:42CF287B                 push    eax
.text:42CF287C                 mov     ecx, dword_42D01F40
.text:42CF2882                 push    ecx
.text:42CF2883                 call    dword_42D01F58
.text:42CF2889                 add     esp, 10h
.text:42CF288C                 test    eax, eax
.text:42CF288E                 jnz     short loc_42CF289C
.text:42CF2890                 mov     edx, [ebp+var_8]
.text:42CF2893                 push    edx
.text:42CF2894                 call    sub_42CF23E9
.text:42CF2899 ; ---------------------------------------------------------------------------
.text:42CF2899                 add     esp, 4
.text:42CF289C
.text:42CF289C loc_42CF289C:                           ; CODE XREF: sub_42CF27CD+C1\u2191j
.text:42CF289C                 mov     eax, [ebp+var_10]
.text:42CF289F                 mov     dword ptr [eax+80h], 1
.text:42CF28A9                 mov     ecx, [ebp+var_10]
.text:42CF28AC                 mov     dword ptr [ecx+84h], 4
.text:42CF28B6                 mov     edx, [ebp+var_10]
.text:42CF28B9                 push    edx
.text:42CF28BA                 call    sub_42CF6D55
.text:42CF28BF                 add     esp, 4
.text:42CF28C2                 jmp     loc_42CF27ED
.text:42CF28C7 ; ---------------------------------------------------------------------------
.text:42CF28C7
.text:42CF28C7 loc_42CF28C7:                           ; CODE XREF: sub_42CF27CD+27\u2191j
.text:42CF28C7                 mov     esp, ebp
.text:42CF28C9                 pop     ebp
.text:42CF28CA                 retn
.text:42CF28CA sub_42CF27CD    endp
.text:42CF28CA
.text:42CF28CB
.text:42CF28CB ; =============== S U B R O U T I N E =======================================
.text:42CF28CB
.text:42CF28CB ; Attributes: bp-based frame
.text:42CF28CB
.text:42CF28CB ; DWORD __stdcall sub_42CF28CB(LPVOID lpThreadParameter)
.text:42CF28CB sub_42CF28CB    proc near               ; DATA XREF: sub_42CF69B4+23A\u2193o
.text:42CF28CB
.text:42CF28CB var_10          = dword ptr -10h
.text:42CF28CB Size            = dword ptr -0Ch
.text:42CF28CB var_8           = dword ptr -8
.text:42CF28CB var_4           = dword ptr -4
.text:42CF28CB lpThreadParameter= dword ptr  8
.text:42CF28CB
.text:42CF28CB                 push    ebp
.text:42CF28CC                 mov     ebp, esp
.text:42CF28CE                 sub     esp, 10h
.text:42CF28D1                 call    dword_42D01C90
.text:42CF28D7                 mov     [ebp+Size], eax
.text:42CF28DA                 push    0               ; lpName
.text:42CF28DC                 push    0               ; bInitialState
.text:42CF28DE                 push    1               ; bManualReset
.text:42CF28E0                 push    0               ; lpEventAttributes
.text:42CF28E2                 call    ds:CreateEventA
.text:42CF28E8                 mov     [ebp+var_4], eax
.text:42CF28EB
.text:42CF28EB loc_42CF28EB:                           ; CODE XREF: sub_42CF28CB+F5\u2193j
.text:42CF28EB                 mov     eax, 1
.text:42CF28F0                 test    eax, eax
.text:42CF28F2                 jz      loc_42CF29C5
.text:42CF28F8                 mov     [ebp+var_10], 0
.text:42CF28FF                 push    0A8h ; '¨'      ; Size
.text:42CF2904                 call    ds:malloc
.text:42CF290A                 add     esp, 4
.text:42CF290D                 mov     [ebp+var_10], eax
.text:42CF2910                 cmp     [ebp+var_10], 0
.text:42CF2914                 jnz     short loc_42CF2920
.text:42CF2916                 push    1
.text:42CF2918                 call    sub_42CF23E9
.text:42CF291D ; ---------------------------------------------------------------------------
.text:42CF291D                 add     esp, 4
.text:42CF2920
.text:42CF2920 loc_42CF2920:                           ; CODE XREF: sub_42CF28CB+49\u2191j
.text:42CF2920                 push    0A8h ; '¨'      ; Size
.text:42CF2925                 push    0               ; Val
.text:42CF2927                 mov     ecx, [ebp+var_10]
.text:42CF292A                 push    ecx             ; void *
.text:42CF292B                 call    memset
.text:42CF2930                 add     esp, 0Ch
.text:42CF2933                 mov     edx, [ebp+var_10]
.text:42CF2936                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF293C                 mov     eax, [ebp+Size]
.text:42CF293F                 push    eax             ; Size
.text:42CF2940                 call    ds:malloc
.text:42CF2946                 add     esp, 4
.text:42CF2949                 mov     ecx, [ebp+var_10]
.text:42CF294C                 mov     [ecx+88h], eax
.text:42CF2952                 mov     edx, [ebp+var_10]
.text:42CF2955                 cmp     dword ptr [edx+88h], 0
.text:42CF295C                 jnz     short loc_42CF2968
.text:42CF295E                 push    1
.text:42CF2960                 call    sub_42CF23E9
.text:42CF2965 ; ---------------------------------------------------------------------------
.text:42CF2965                 add     esp, 4
.text:42CF2968
.text:42CF2968 loc_42CF2968:                           ; CODE XREF: sub_42CF28CB+91\u2191j
.text:42CF2968                 lea     eax, [ebp+var_8]
.text:42CF296B                 push    eax
.text:42CF296C                 mov     ecx, [ebp+var_4]
.text:42CF296F                 push    ecx
.text:42CF2970                 mov     edx, [ebp+var_10]
.text:42CF2973                 mov     eax, [edx+88h]
.text:42CF2979                 push    eax
.text:42CF297A                 mov     ecx, dword_42D01C60
.text:42CF2980                 push    ecx
.text:42CF2981                 call    dword_42D01C78
.text:42CF2987                 add     esp, 10h
.text:42CF298A                 test    eax, eax
.text:42CF298C                 jnz     short loc_42CF299A
.text:42CF298E                 mov     edx, [ebp+var_8]
.text:42CF2991                 push    edx
.text:42CF2992                 call    sub_42CF23E9
.text:42CF2997 ; ---------------------------------------------------------------------------
.text:42CF2997                 add     esp, 4
.text:42CF299A
.text:42CF299A loc_42CF299A:                           ; CODE XREF: sub_42CF28CB+C1\u2191j
.text:42CF299A                 mov     eax, [ebp+var_10]
.text:42CF299D                 mov     dword ptr [eax+80h], 1
.text:42CF29A7                 mov     ecx, [ebp+var_10]
.text:42CF29AA                 mov     dword ptr [ecx+84h], 3
.text:42CF29B4                 mov     edx, [ebp+var_10]
.text:42CF29B7                 push    edx
.text:42CF29B8                 call    sub_42CF6D55
.text:42CF29BD                 add     esp, 4
.text:42CF29C0                 jmp     loc_42CF28EB
.text:42CF29C5 ; ---------------------------------------------------------------------------
.text:42CF29C5
.text:42CF29C5 loc_42CF29C5:                           ; CODE XREF: sub_42CF28CB+27\u2191j
.text:42CF29C5                 mov     esp, ebp
.text:42CF29C7                 pop     ebp
.text:42CF29C8                 retn
.text:42CF29C8 sub_42CF28CB    endp
.text:42CF29C8
.text:42CF29C9
.text:42CF29C9 ; =============== S U B R O U T I N E =======================================
.text:42CF29C9
.text:42CF29C9 ; Attributes: bp-based frame
.text:42CF29C9
.text:42CF29C9 ; DWORD __stdcall sub_42CF29C9(LPVOID lpThreadParameter)
.text:42CF29C9 sub_42CF29C9    proc near               ; DATA XREF: sub_42CF69B4+29E\u2193o
.text:42CF29C9
.text:42CF29C9 var_10          = dword ptr -10h
.text:42CF29C9 Size            = dword ptr -0Ch
.text:42CF29C9 var_8           = dword ptr -8
.text:42CF29C9 var_4           = dword ptr -4
.text:42CF29C9 lpThreadParameter= dword ptr  8
.text:42CF29C9
.text:42CF29C9                 push    ebp
.text:42CF29CA                 mov     ebp, esp
.text:42CF29CC                 sub     esp, 10h
.text:42CF29CF                 call    dword_42D01C30
.text:42CF29D5                 mov     [ebp+Size], eax
.text:42CF29D8                 push    0               ; lpName
.text:42CF29DA                 push    0               ; bInitialState
.text:42CF29DC                 push    1               ; bManualReset
.text:42CF29DE                 push    0               ; lpEventAttributes
.text:42CF29E0                 call    ds:CreateEventA
.text:42CF29E6                 mov     [ebp+var_4], eax
.text:42CF29E9
.text:42CF29E9 loc_42CF29E9:                           ; CODE XREF: sub_42CF29C9+F5\u2193j
.text:42CF29E9                 mov     eax, 1
.text:42CF29EE                 test    eax, eax
.text:42CF29F0                 jz      loc_42CF2AC3
.text:42CF29F6                 mov     [ebp+var_10], 0
.text:42CF29FD                 push    0A8h ; '¨'      ; Size
.text:42CF2A02                 call    ds:malloc
.text:42CF2A08                 add     esp, 4
.text:42CF2A0B                 mov     [ebp+var_10], eax
.text:42CF2A0E                 cmp     [ebp+var_10], 0
.text:42CF2A12                 jnz     short loc_42CF2A1E
.text:42CF2A14                 push    1
.text:42CF2A16                 call    sub_42CF23E9
.text:42CF2A1B ; ---------------------------------------------------------------------------
.text:42CF2A1B                 add     esp, 4
.text:42CF2A1E
.text:42CF2A1E loc_42CF2A1E:                           ; CODE XREF: sub_42CF29C9+49\u2191j
.text:42CF2A1E                 push    0A8h ; '¨'      ; Size
.text:42CF2A23                 push    0               ; Val
.text:42CF2A25                 mov     ecx, [ebp+var_10]
.text:42CF2A28                 push    ecx             ; void *
.text:42CF2A29                 call    memset
.text:42CF2A2E                 add     esp, 0Ch
.text:42CF2A31                 mov     edx, [ebp+var_10]
.text:42CF2A34                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF2A3A                 mov     eax, [ebp+Size]
.text:42CF2A3D                 push    eax             ; Size
.text:42CF2A3E                 call    ds:malloc
.text:42CF2A44                 add     esp, 4
.text:42CF2A47                 mov     ecx, [ebp+var_10]
.text:42CF2A4A                 mov     [ecx+88h], eax
.text:42CF2A50                 mov     edx, [ebp+var_10]
.text:42CF2A53                 cmp     dword ptr [edx+88h], 0
.text:42CF2A5A                 jnz     short loc_42CF2A66
.text:42CF2A5C                 push    1
.text:42CF2A5E                 call    sub_42CF23E9
.text:42CF2A63 ; ---------------------------------------------------------------------------
.text:42CF2A63                 add     esp, 4
.text:42CF2A66
.text:42CF2A66 loc_42CF2A66:                           ; CODE XREF: sub_42CF29C9+91\u2191j
.text:42CF2A66                 lea     eax, [ebp+var_8]
.text:42CF2A69                 push    eax
.text:42CF2A6A                 mov     ecx, [ebp+var_4]
.text:42CF2A6D                 push    ecx
.text:42CF2A6E                 mov     edx, [ebp+var_10]
.text:42CF2A71                 mov     eax, [edx+88h]
.text:42CF2A77                 push    eax
.text:42CF2A78                 mov     ecx, dword_42D01C00
.text:42CF2A7E                 push    ecx
.text:42CF2A7F                 call    dword_42D01C18
.text:42CF2A85                 add     esp, 10h
.text:42CF2A88                 test    eax, eax
.text:42CF2A8A                 jnz     short loc_42CF2A98
.text:42CF2A8C                 mov     edx, [ebp+var_8]
.text:42CF2A8F                 push    edx
.text:42CF2A90                 call    sub_42CF23E9
.text:42CF2A95 ; ---------------------------------------------------------------------------
.text:42CF2A95                 add     esp, 4
.text:42CF2A98
.text:42CF2A98 loc_42CF2A98:                           ; CODE XREF: sub_42CF29C9+C1\u2191j
.text:42CF2A98                 mov     eax, [ebp+var_10]
.text:42CF2A9B                 mov     dword ptr [eax+80h], 1
.text:42CF2AA5                 mov     ecx, [ebp+var_10]
.text:42CF2AA8                 mov     dword ptr [ecx+84h], 2
.text:42CF2AB2                 mov     edx, [ebp+var_10]
.text:42CF2AB5                 push    edx
.text:42CF2AB6                 call    sub_42CF6D55
.text:42CF2ABB                 add     esp, 4
.text:42CF2ABE                 jmp     loc_42CF29E9
.text:42CF2AC3 ; ---------------------------------------------------------------------------
.text:42CF2AC3
.text:42CF2AC3 loc_42CF2AC3:                           ; CODE XREF: sub_42CF29C9+27\u2191j
.text:42CF2AC3                 mov     esp, ebp
.text:42CF2AC5                 pop     ebp
.text:42CF2AC6                 retn
.text:42CF2AC6 sub_42CF29C9    endp
.text:42CF2AC6
.text:42CF2AC7
.text:42CF2AC7 ; =============== S U B R O U T I N E =======================================
.text:42CF2AC7
.text:42CF2AC7 ; Attributes: bp-based frame
.text:42CF2AC7
.text:42CF2AC7 ; DWORD __stdcall sub_42CF2AC7(LPVOID lpThreadParameter)
.text:42CF2AC7 sub_42CF2AC7    proc near               ; DATA XREF: sub_42CF69B4+34F\u2193o
.text:42CF2AC7
.text:42CF2AC7 var_10          = dword ptr -10h
.text:42CF2AC7 Size            = dword ptr -0Ch
.text:42CF2AC7 var_8           = dword ptr -8
.text:42CF2AC7 var_4           = dword ptr -4
.text:42CF2AC7 lpThreadParameter= dword ptr  8
.text:42CF2AC7
.text:42CF2AC7                 push    ebp
.text:42CF2AC8                 mov     ebp, esp
.text:42CF2ACA                 sub     esp, 10h
.text:42CF2ACD                 call    dword_42D020F0
.text:42CF2AD3                 mov     [ebp+Size], eax
.text:42CF2AD6                 push    0               ; lpName
.text:42CF2AD8                 push    0               ; bInitialState
.text:42CF2ADA                 push    1               ; bManualReset
.text:42CF2ADC                 push    0               ; lpEventAttributes
.text:42CF2ADE                 call    ds:CreateEventA
.text:42CF2AE4                 mov     [ebp+var_4], eax
.text:42CF2AE7
.text:42CF2AE7 loc_42CF2AE7:                           ; CODE XREF: sub_42CF2AC7+F5\u2193j
.text:42CF2AE7                 mov     eax, 1
.text:42CF2AEC                 test    eax, eax
.text:42CF2AEE                 jz      loc_42CF2BC1
.text:42CF2AF4                 mov     [ebp+var_10], 0
.text:42CF2AFB                 push    0A8h ; '¨'      ; Size
.text:42CF2B00                 call    ds:malloc
.text:42CF2B06                 add     esp, 4
.text:42CF2B09                 mov     [ebp+var_10], eax
.text:42CF2B0C                 cmp     [ebp+var_10], 0
.text:42CF2B10                 jnz     short loc_42CF2B1C
.text:42CF2B12                 push    1
.text:42CF2B14                 call    sub_42CF23E9
.text:42CF2B19 ; ---------------------------------------------------------------------------
.text:42CF2B19                 add     esp, 4
.text:42CF2B1C
.text:42CF2B1C loc_42CF2B1C:                           ; CODE XREF: sub_42CF2AC7+49\u2191j
.text:42CF2B1C                 push    0A8h ; '¨'      ; Size
.text:42CF2B21                 push    0               ; Val
.text:42CF2B23                 mov     ecx, [ebp+var_10]
.text:42CF2B26                 push    ecx             ; void *
.text:42CF2B27                 call    memset
.text:42CF2B2C                 add     esp, 0Ch
.text:42CF2B2F                 mov     edx, [ebp+var_10]
.text:42CF2B32                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF2B38                 mov     eax, [ebp+Size]
.text:42CF2B3B                 push    eax             ; Size
.text:42CF2B3C                 call    ds:malloc
.text:42CF2B42                 add     esp, 4
.text:42CF2B45                 mov     ecx, [ebp+var_10]
.text:42CF2B48                 mov     [ecx+88h], eax
.text:42CF2B4E                 mov     edx, [ebp+var_10]
.text:42CF2B51                 cmp     dword ptr [edx+88h], 0
.text:42CF2B58                 jnz     short loc_42CF2B64
.text:42CF2B5A                 push    1
.text:42CF2B5C                 call    sub_42CF23E9
.text:42CF2B61 ; ---------------------------------------------------------------------------
.text:42CF2B61                 add     esp, 4
.text:42CF2B64
.text:42CF2B64 loc_42CF2B64:                           ; CODE XREF: sub_42CF2AC7+91\u2191j
.text:42CF2B64                 lea     eax, [ebp+var_8]
.text:42CF2B67                 push    eax
.text:42CF2B68                 mov     ecx, [ebp+var_4]
.text:42CF2B6B                 push    ecx
.text:42CF2B6C                 mov     edx, [ebp+var_10]
.text:42CF2B6F                 mov     eax, [edx+88h]
.text:42CF2B75                 push    eax
.text:42CF2B76                 mov     ecx, dword_42D020C0
.text:42CF2B7C                 push    ecx
.text:42CF2B7D                 call    dword_42D020D8
.text:42CF2B83                 add     esp, 10h
.text:42CF2B86                 test    eax, eax
.text:42CF2B88                 jnz     short loc_42CF2B96
.text:42CF2B8A                 mov     edx, [ebp+var_8]
.text:42CF2B8D                 push    edx
.text:42CF2B8E                 call    sub_42CF23E9
.text:42CF2B93 ; ---------------------------------------------------------------------------
.text:42CF2B93                 add     esp, 4
.text:42CF2B96
.text:42CF2B96 loc_42CF2B96:                           ; CODE XREF: sub_42CF2AC7+C1\u2191j
.text:42CF2B96                 mov     eax, [ebp+var_10]
.text:42CF2B99                 mov     dword ptr [eax+80h], 1
.text:42CF2BA3                 mov     ecx, [ebp+var_10]
.text:42CF2BA6                 mov     dword ptr [ecx+84h], 8
.text:42CF2BB0                 mov     edx, [ebp+var_10]
.text:42CF2BB3                 push    edx
.text:42CF2BB4                 call    sub_42CF6D55
.text:42CF2BB9                 add     esp, 4
.text:42CF2BBC                 jmp     loc_42CF2AE7
.text:42CF2BC1 ; ---------------------------------------------------------------------------
.text:42CF2BC1
.text:42CF2BC1 loc_42CF2BC1:                           ; CODE XREF: sub_42CF2AC7+27\u2191j
.text:42CF2BC1                 mov     esp, ebp
.text:42CF2BC3                 pop     ebp
.text:42CF2BC4                 retn
.text:42CF2BC4 sub_42CF2AC7    endp
.text:42CF2BC4
.text:42CF2BC5
.text:42CF2BC5 ; =============== S U B R O U T I N E =======================================
.text:42CF2BC5
.text:42CF2BC5 ; Attributes: bp-based frame
.text:42CF2BC5
.text:42CF2BC5 sub_42CF2BC5    proc near               ; CODE XREF: sub_42CF2424+85\u2191p
.text:42CF2BC5
.text:42CF2BC5 vInBuffer       = dword ptr -5Ch
.text:42CF2BC5 var_58          = dword ptr -58h
.text:42CF2BC5 var_54          = dword ptr -54h
.text:42CF2BC5 cbBytesReturned = dword ptr -50h
.text:42CF2BC5 optlen          = dword ptr -4Ch
.text:42CF2BC5 Block           = dword ptr -48h
.text:42CF2BC5 var_44          = dword ptr -44h
.text:42CF2BC5 optval          = byte ptr -40h
.text:42CF2BC5 NetworkEvents   = _WSANETWORKEVENTS ptr -3Ch
.text:42CF2BC5 var_10          = byte ptr -10h
.text:42CF2BC5 var_E           = word ptr -0Eh
.text:42CF2BC5 var_C           = dword ptr -0Ch
.text:42CF2BC5 argp            = dword ptr -8
.text:42CF2BC5 var_4           = dword ptr -4
.text:42CF2BC5 arg_0           = dword ptr  8
.text:42CF2BC5
.text:42CF2BC5                 push    ebp
.text:42CF2BC6                 mov     ebp, esp
.text:42CF2BC8                 sub     esp, 5Ch
.text:42CF2BCB                 mov     [ebp+var_44], 0
.text:42CF2BD2                 mov     dword ptr [ebp+optval], 1
.text:42CF2BD9                 mov     [ebp+optlen], 4
.text:42CF2BE0                 mov     [ebp+argp], 0
.text:42CF2BE7                 mov     [ebp+var_4], 0
.text:42CF2BEE                 push    0A8h ; '¨'      ; Size
.text:42CF2BF3                 call    ds:malloc
.text:42CF2BF9                 add     esp, 4
.text:42CF2BFC                 mov     [ebp+Block], eax
.text:42CF2BFF                 cmp     [ebp+Block], 0
.text:42CF2C03                 jnz     short loc_42CF2C15
.text:42CF2C05                 mov     eax, [ebp+arg_0]
.text:42CF2C08                 mov     dword ptr [eax], 1
.text:42CF2C0E                 xor     eax, eax
.text:42CF2C10                 jmp     loc_42CF2F57
.text:42CF2C15 ; ---------------------------------------------------------------------------
.text:42CF2C15
.text:42CF2C15 loc_42CF2C15:                           ; CODE XREF: sub_42CF2BC5+3E\u2191j
.text:42CF2C15                 push    0A8h ; '¨'      ; Size
.text:42CF2C1A                 push    0               ; Val
.text:42CF2C1C                 mov     ecx, [ebp+Block]
.text:42CF2C1F                 push    ecx             ; void *
.text:42CF2C20                 call    memset
.text:42CF2C25                 add     esp, 0Ch
.text:42CF2C28                 mov     edx, [ebp+Block]
.text:42CF2C2B                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF2C31
.text:42CF2C31 loc_42CF2C31:                           ; CODE XREF: sub_42CF2BC5+2D8\u2193j
.text:42CF2C31                 push    0               ; fAlertable
.text:42CF2C33                 push    0FFFFFFFFh      ; dwTimeout
.text:42CF2C35                 push    0               ; fWaitAll
.text:42CF2C37                 push    offset hEventObject ; lphEvents
.text:42CF2C3C                 mov     eax, cEvents
.text:42CF2C41                 push    eax             ; cEvents
.text:42CF2C42                 call    ds:WSAWaitForMultipleEvents
.text:42CF2C48                 mov     [ebp+var_C], eax
.text:42CF2C4B                 cmp     [ebp+var_C], 0FFFFFFFFh
.text:42CF2C4F                 jnz     short loc_42CF2C61
.text:42CF2C51                 call    ds:WSAGetLastError
.text:42CF2C57                 mov     ecx, [ebp+arg_0]
.text:42CF2C5A                 mov     [ecx], eax
.text:42CF2C5C                 jmp     loc_42CF2F48
.text:42CF2C61 ; ---------------------------------------------------------------------------
.text:42CF2C61
.text:42CF2C61 loc_42CF2C61:                           ; CODE XREF: sub_42CF2BC5+8A\u2191j
.text:42CF2C61                 mov     [ebp+NetworkEvents.lNetworkEvents], 0
.text:42CF2C68                 lea     edx, [ebp+NetworkEvents]
.text:42CF2C6B                 push    edx             ; lpNetworkEvents
.text:42CF2C6C                 mov     eax, [ebp+var_C]
.text:42CF2C6F                 mov     ecx, hEventObject[eax*4]
.text:42CF2C76                 push    ecx             ; hEventObject
.text:42CF2C77                 mov     edx, [ebp+var_C]
.text:42CF2C7A                 mov     eax, s[edx*4]
.text:42CF2C81                 push    eax             ; s
.text:42CF2C82                 call    ds:WSAEnumNetworkEvents
.text:42CF2C88                 cmp     eax, 0FFFFFFFFh
.text:42CF2C8B                 jnz     short loc_42CF2C9D
.text:42CF2C8D                 call    ds:WSAGetLastError
.text:42CF2C93                 mov     ecx, [ebp+arg_0]
.text:42CF2C96                 mov     [ecx], eax
.text:42CF2C98                 jmp     loc_42CF2F48
.text:42CF2C9D ; ---------------------------------------------------------------------------
.text:42CF2C9D
.text:42CF2C9D loc_42CF2C9D:                           ; CODE XREF: sub_42CF2BC5+C6\u2191j
.text:42CF2C9D                 mov     edx, [ebp+NetworkEvents.lNetworkEvents]
.text:42CF2CA0                 and     edx, 8
.text:42CF2CA3                 test    edx, edx
.text:42CF2CA5                 jnz     short loc_42CF2CB3
.text:42CF2CA7                 mov     [ebp+var_4], 1
.text:42CF2CAE                 jmp     loc_42CF2E33
.text:42CF2CB3 ; ---------------------------------------------------------------------------
.text:42CF2CB3
.text:42CF2CB3 loc_42CF2CB3:                           ; CODE XREF: sub_42CF2BC5+E0\u2191j
.text:42CF2CB3                 push    0               ; addrlen
.text:42CF2CB5                 push    0               ; addr
.text:42CF2CB7                 mov     eax, [ebp+var_C]
.text:42CF2CBA                 mov     ecx, s[eax*4]
.text:42CF2CC1                 push    ecx             ; s
.text:42CF2CC2                 call    ds:accept
.text:42CF2CC8                 mov     edx, [ebp+Block]
.text:42CF2CCB                 mov     [edx+0Ch], eax
.text:42CF2CCE                 mov     eax, [ebp+Block]
.text:42CF2CD1                 cmp     dword ptr [eax+0Ch], 0FFFFFFFFh
.text:42CF2CD5                 jnz     short loc_42CF2CFE
.text:42CF2CD7                 call    ds:WSAGetLastError
.text:42CF2CDD                 mov     ecx, [ebp+arg_0]
.text:42CF2CE0                 mov     [ecx], eax
.text:42CF2CE2                 mov     edx, [ebp+arg_0]
.text:42CF2CE5                 cmp     dword ptr [edx], 2733h
.text:42CF2CEB                 jnz     short loc_42CF2CF9
.text:42CF2CED                 mov     [ebp+var_4], 1
.text:42CF2CF4                 jmp     loc_42CF2E33
.text:42CF2CF9 ; ---------------------------------------------------------------------------
.text:42CF2CF9
.text:42CF2CF9 loc_42CF2CF9:                           ; CODE XREF: sub_42CF2BC5+126\u2191j
.text:42CF2CF9                 jmp     loc_42CF2F48
.text:42CF2CFE ; ---------------------------------------------------------------------------
.text:42CF2CFE
.text:42CF2CFE loc_42CF2CFE:                           ; CODE XREF: sub_42CF2BC5+110\u2191j
.text:42CF2CFE                 push    0               ; lpName
.text:42CF2D00                 push    0               ; bInitialState
.text:42CF2D02                 push    0               ; bManualReset
.text:42CF2D04                 push    0               ; lpEventAttributes
.text:42CF2D06                 call    ds:CreateEventA
.text:42CF2D0C                 mov     [ebp+var_44], eax
.text:42CF2D0F                 cmp     [ebp+var_44], 0
.text:42CF2D13                 jnz     short loc_42CF2D25
.text:42CF2D15                 call    ds:GetLastError
.text:42CF2D1B                 mov     ecx, [ebp+arg_0]
.text:42CF2D1E                 mov     [ecx], eax
.text:42CF2D20                 jmp     loc_42CF2F48
.text:42CF2D25 ; ---------------------------------------------------------------------------
.text:42CF2D25
.text:42CF2D25 loc_42CF2D25:                           ; CODE XREF: sub_42CF2BC5+14E\u2191j
.text:42CF2D25                 cmp     dword_42D01A1C, 0
.text:42CF2D2C                 jz      short loc_42CF2D3C
.text:42CF2D2E                 mov     edx, [ebp+var_44]
.text:42CF2D31                 or      edx, 1
.text:42CF2D34                 mov     eax, [ebp+Block]
.text:42CF2D37                 mov     [eax+20h], edx
.text:42CF2D3A                 jmp     short loc_42CF2D45
.text:42CF2D3C ; ---------------------------------------------------------------------------
.text:42CF2D3C
.text:42CF2D3C loc_42CF2D3C:                           ; CODE XREF: sub_42CF2BC5+167\u2191j
.text:42CF2D3C                 mov     ecx, [ebp+Block]
.text:42CF2D3F                 mov     edx, [ebp+var_44]
.text:42CF2D42                 mov     [ecx+20h], edx
.text:42CF2D45
.text:42CF2D45 loc_42CF2D45:                           ; CODE XREF: sub_42CF2BC5+175\u2191j
.text:42CF2D45                 mov     eax, [ebp+optlen]
.text:42CF2D48                 push    eax             ; optlen
.text:42CF2D49                 lea     ecx, [ebp+optval]
.text:42CF2D4C                 push    ecx             ; optval
.text:42CF2D4D                 push    8               ; optname
.text:42CF2D4F                 push    0FFFFh          ; level
.text:42CF2D54                 mov     edx, [ebp+Block]
.text:42CF2D57                 mov     eax, [edx+0Ch]
.text:42CF2D5A                 push    eax             ; s
.text:42CF2D5B                 call    ds:setsockopt
.text:42CF2D61                 mov     ecx, [ebp+optlen]
.text:42CF2D64                 push    ecx             ; optlen
.text:42CF2D65                 lea     edx, [ebp+optval]
.text:42CF2D68                 push    edx             ; optval
.text:42CF2D69                 push    100h            ; optname
.text:42CF2D6E                 push    0FFFFh          ; level
.text:42CF2D73                 mov     eax, [ebp+Block]
.text:42CF2D76                 mov     ecx, [eax+0Ch]
.text:42CF2D79                 push    ecx             ; s
.text:42CF2D7A                 call    ds:setsockopt
.text:42CF2D80                 cmp     dword_42D010DC, 0
.text:42CF2D87                 jz      short loc_42CF2DB2
.text:42CF2D89                 mov     word ptr [ebp+var_10], 1
.text:42CF2D8F                 mov     [ebp+var_E], 0
.text:42CF2D95                 push    4               ; optlen
.text:42CF2D97                 lea     edx, [ebp+var_10]
.text:42CF2D9A                 push    edx             ; optval
.text:42CF2D9B                 push    80h ; '€'       ; optname
.text:42CF2DA0                 push    0FFFFh          ; level
.text:42CF2DA5                 mov     eax, [ebp+Block]
.text:42CF2DA8                 mov     ecx, [eax+0Ch]
.text:42CF2DAB                 push    ecx             ; s
.text:42CF2DAC                 call    ds:setsockopt
.text:42CF2DB2
.text:42CF2DB2 loc_42CF2DB2:                           ; CODE XREF: sub_42CF2BC5+1C2\u2191j
.text:42CF2DB2                 cmp     dword_42D01C40, 0
.text:42CF2DB9                 jz      short loc_42CF2DC6
.text:42CF2DBB                 mov     edx, [ebp+var_C]
.text:42CF2DBE                 cmp     edx, dword_42D010D0
.text:42CF2DC4                 jz      short loc_42CF2DD5
.text:42CF2DC6
.text:42CF2DC6 loc_42CF2DC6:                           ; CODE XREF: sub_42CF2BC5+1F4\u2191j
.text:42CF2DC6                 mov     eax, [ebp+Block]
.text:42CF2DC9                 mov     dword ptr [eax+84h], 5
.text:42CF2DD3                 jmp     short loc_42CF2DE2
.text:42CF2DD5 ; ---------------------------------------------------------------------------
.text:42CF2DD5
.text:42CF2DD5 loc_42CF2DD5:                           ; CODE XREF: sub_42CF2BC5+1FF\u2191j
.text:42CF2DD5                 mov     ecx, [ebp+Block]
.text:42CF2DD8                 mov     dword ptr [ecx+84h], 7
.text:42CF2DE2
.text:42CF2DE2 loc_42CF2DE2:                           ; CODE XREF: sub_42CF2BC5+20E\u2191j
.text:42CF2DE2                 push    0               ; lNetworkEvents
.text:42CF2DE4                 push    0               ; hEventObject
.text:42CF2DE6                 mov     edx, [ebp+Block]
.text:42CF2DE9                 mov     eax, [edx+0Ch]
.text:42CF2DEC                 push    eax             ; s
.text:42CF2DED                 call    ds:WSAEventSelect
.text:42CF2DF3                 cmp     eax, 0FFFFFFFFh
.text:42CF2DF6                 jnz     short loc_42CF2E08
.text:42CF2DF8                 call    ds:WSAGetLastError
.text:42CF2DFE                 mov     ecx, [ebp+arg_0]
.text:42CF2E01                 mov     [ecx], eax
.text:42CF2E03                 jmp     loc_42CF2F48
.text:42CF2E08 ; ---------------------------------------------------------------------------
.text:42CF2E08
.text:42CF2E08 loc_42CF2E08:                           ; CODE XREF: sub_42CF2BC5+231\u2191j
.text:42CF2E08                 lea     edx, [ebp+argp]
.text:42CF2E0B                 push    edx             ; argp
.text:42CF2E0C                 push    8004667Eh       ; cmd
.text:42CF2E11                 mov     eax, [ebp+Block]
.text:42CF2E14                 mov     ecx, [eax+0Ch]
.text:42CF2E17                 push    ecx             ; s
.text:42CF2E18                 call    ds:ioctlsocket
.text:42CF2E1E                 cmp     eax, 0FFFFFFFFh
.text:42CF2E21                 jnz     short loc_42CF2E33
.text:42CF2E23                 call    ds:WSAGetLastError
.text:42CF2E29                 mov     edx, [ebp+arg_0]
.text:42CF2E2C                 mov     [edx], eax
.text:42CF2E2E                 jmp     loc_42CF2F48
.text:42CF2E33 ; ---------------------------------------------------------------------------
.text:42CF2E33
.text:42CF2E33 loc_42CF2E33:                           ; CODE XREF: sub_42CF2BC5+E9\u2191j
.text:42CF2E33                                         ; sub_42CF2BC5+12F\u2191j ...
.text:42CF2E33                 push    0               ; lNetworkEvents
.text:42CF2E35                 push    0               ; hEventObject
.text:42CF2E37                 mov     eax, [ebp+var_C]
.text:42CF2E3A                 mov     ecx, s[eax*4]
.text:42CF2E41                 push    ecx             ; s
.text:42CF2E42                 call    ds:WSAEventSelect
.text:42CF2E48                 cmp     eax, 0FFFFFFFFh
.text:42CF2E4B                 jnz     short loc_42CF2E5D
.text:42CF2E4D                 call    ds:WSAGetLastError
.text:42CF2E53                 mov     edx, [ebp+arg_0]
.text:42CF2E56                 mov     [edx], eax
.text:42CF2E58                 jmp     loc_42CF2F48
.text:42CF2E5D ; ---------------------------------------------------------------------------
.text:42CF2E5D
.text:42CF2E5D loc_42CF2E5D:                           ; CODE XREF: sub_42CF2BC5+286\u2191j
.text:42CF2E5D                 push    8               ; lNetworkEvents
.text:42CF2E5F                 mov     eax, [ebp+var_C]
.text:42CF2E62                 mov     ecx, hEventObject[eax*4]
.text:42CF2E69                 push    ecx             ; hEventObject
.text:42CF2E6A                 mov     edx, [ebp+var_C]
.text:42CF2E6D                 mov     eax, s[edx*4]
.text:42CF2E74                 push    eax             ; s
.text:42CF2E75                 call    ds:WSAEventSelect
.text:42CF2E7B                 cmp     eax, 0FFFFFFFFh
.text:42CF2E7E                 jnz     short loc_42CF2E90
.text:42CF2E80                 call    ds:WSAGetLastError
.text:42CF2E86                 mov     ecx, [ebp+arg_0]
.text:42CF2E89                 mov     [ecx], eax
.text:42CF2E8B                 jmp     loc_42CF2F48
.text:42CF2E90 ; ---------------------------------------------------------------------------
.text:42CF2E90
.text:42CF2E90 loc_42CF2E90:                           ; CODE XREF: sub_42CF2BC5+2B9\u2191j
.text:42CF2E90                 cmp     [ebp+var_4], 0
.text:42CF2E94                 jz      short loc_42CF2EA2
.text:42CF2E96                 mov     [ebp+var_4], 0
.text:42CF2E9D                 jmp     loc_42CF2C31
.text:42CF2EA2 ; ---------------------------------------------------------------------------
.text:42CF2EA2
.text:42CF2EA2 loc_42CF2EA2:                           ; CODE XREF: sub_42CF2BC5+2CF\u2191j
.text:42CF2EA2                 cmp     dword_42D01A1C, 0
.text:42CF2EA9                 jz      loc_42CF2F43
.text:42CF2EAF                 cmp     VersionInformation.dwMajorVersion, 5
.text:42CF2EB6                 jb      loc_42CF2F43
.text:42CF2EBC                 cmp     dword_42D01C40, 0
.text:42CF2EC3                 jz      short loc_42CF2ED0
.text:42CF2EC5                 mov     edx, [ebp+var_C]
.text:42CF2EC8                 cmp     edx, dword_42D010D0
.text:42CF2ECE                 jz      short loc_42CF2F43
.text:42CF2ED0
.text:42CF2ED0 loc_42CF2ED0:                           ; CODE XREF: sub_42CF2BC5+2FE\u2191j
.text:42CF2ED0                 mov     [ebp+cbBytesReturned], 0
.text:42CF2ED7                 mov     [ebp+vInBuffer], 1
.text:42CF2EDE                 mov     [ebp+var_58], 493E0h
.text:42CF2EE5                 mov     [ebp+var_54], 3E8h
.text:42CF2EEC                 push    0               ; lpCompletionRoutine
.text:42CF2EEE                 push    0               ; lpOverlapped
.text:42CF2EF0                 lea     eax, [ebp+cbBytesReturned]
.text:42CF2EF3                 push    eax             ; lpcbBytesReturned
.text:42CF2EF4                 push    0               ; cbOutBuffer
.text:42CF2EF6                 push    0               ; lpvOutBuffer
.text:42CF2EF8                 push    0Ch             ; cbInBuffer
.text:42CF2EFA                 lea     ecx, [ebp+vInBuffer]
.text:42CF2EFD                 push    ecx             ; lpvInBuffer
.text:42CF2EFE                 push    98000004h       ; dwIoControlCode
.text:42CF2F03                 mov     edx, [ebp+Block]
.text:42CF2F06                 mov     eax, [edx+0Ch]
.text:42CF2F09                 push    eax             ; s
.text:42CF2F0A                 call    ds:WSAIoctl
.text:42CF2F10                 cmp     eax, 0FFFFFFFFh
.text:42CF2F13                 jnz     short loc_42CF2F43
.text:42CF2F15                 call    ds:WSAGetLastError
.text:42CF2F1B                 mov     ecx, [ebp+arg_0]
.text:42CF2F1E                 mov     [ecx], eax
.text:42CF2F20                 mov     edx, [ebp+arg_0]
.text:42CF2F23                 mov     eax, [edx]
.text:42CF2F25                 push    eax
.text:42CF2F26                 push    offset Format   ; "Error SIO_KEEPALIVE_VALS: %d\n"
.text:42CF2F2B                 call    ds:printf
.text:42CF2F31                 add     esp, 8
.text:42CF2F34                 mov     ecx, [ebp+Block]
.text:42CF2F37                 mov     edx, [ecx+0Ch]
.text:42CF2F3A                 push    edx             ; s
.text:42CF2F3B                 call    ds:closesocket
.text:42CF2F41                 jmp     short loc_42CF2F48
.text:42CF2F43 ; ---------------------------------------------------------------------------
.text:42CF2F43
.text:42CF2F43 loc_42CF2F43:                           ; CODE XREF: sub_42CF2BC5+2E4\u2191j
.text:42CF2F43                                         ; sub_42CF2BC5+2F1\u2191j ...
.text:42CF2F43                 mov     eax, [ebp+Block]
.text:42CF2F46                 jmp     short loc_42CF2F57
.text:42CF2F48 ; ---------------------------------------------------------------------------
.text:42CF2F48
.text:42CF2F48 loc_42CF2F48:                           ; CODE XREF: sub_42CF2BC5+97\u2191j
.text:42CF2F48                                         ; sub_42CF2BC5+D3\u2191j ...
.text:42CF2F48                 mov     eax, [ebp+Block]
.text:42CF2F4B                 push    eax             ; Block
.text:42CF2F4C                 call    ds:free
.text:42CF2F52                 add     esp, 4
.text:42CF2F55                 xor     eax, eax
.text:42CF2F57
.text:42CF2F57 loc_42CF2F57:                           ; CODE XREF: sub_42CF2BC5+4B\u2191j
.text:42CF2F57                                         ; sub_42CF2BC5+381\u2191j
.text:42CF2F57                 mov     esp, ebp
.text:42CF2F59                 pop     ebp
.text:42CF2F5A                 retn
.text:42CF2F5A sub_42CF2BC5    endp
.text:42CF2F5A
.text:42CF2F5B
.text:42CF2F5B ; =============== S U B R O U T I N E =======================================
.text:42CF2F5B
.text:42CF2F5B ; Attributes: bp-based frame
.text:42CF2F5B
.text:42CF2F5B sub_42CF2F5B    proc near               ; CODE XREF: sub_42CF24E5+64\u2191p
.text:42CF2F5B
.text:42CF2F5B optlen          = dword ptr -14h
.text:42CF2F5B Block           = dword ptr -10h
.text:42CF2F5B var_C           = dword ptr -0Ch
.text:42CF2F5B optval          = byte ptr -8
.text:42CF2F5B argp            = dword ptr -4
.text:42CF2F5B arg_0           = dword ptr  8
.text:42CF2F5B
.text:42CF2F5B                 push    ebp
.text:42CF2F5C                 mov     ebp, esp
.text:42CF2F5E                 sub     esp, 14h
.text:42CF2F61                 mov     [ebp+var_C], 0
.text:42CF2F68                 mov     dword ptr [ebp+optval], 1
.text:42CF2F6F                 mov     [ebp+optlen], 4
.text:42CF2F76                 mov     [ebp+argp], 0
.text:42CF2F7D                 push    0A8h ; '¨'      ; Size
.text:42CF2F82                 call    ds:malloc
.text:42CF2F88                 add     esp, 4
.text:42CF2F8B                 mov     [ebp+Block], eax
.text:42CF2F8E                 cmp     [ebp+Block], 0
.text:42CF2F92                 jnz     short loc_42CF2FA4
.text:42CF2F94                 mov     eax, [ebp+arg_0]
.text:42CF2F97                 mov     dword ptr [eax], 1
.text:42CF2F9D                 xor     eax, eax
.text:42CF2F9F                 jmp     loc_42CF30AC
.text:42CF2FA4 ; ---------------------------------------------------------------------------
.text:42CF2FA4
.text:42CF2FA4 loc_42CF2FA4:                           ; CODE XREF: sub_42CF2F5B+37\u2191j
.text:42CF2FA4                 push    0A8h ; '¨'      ; Size
.text:42CF2FA9                 push    0               ; Val
.text:42CF2FAB                 mov     ecx, [ebp+Block]
.text:42CF2FAE                 push    ecx             ; void *
.text:42CF2FAF                 call    memset
.text:42CF2FB4                 add     esp, 0Ch
.text:42CF2FB7                 mov     edx, [ebp+Block]
.text:42CF2FBA                 mov     dword ptr [edx], 0FFFF0002h
.text:42CF2FC0                 push    0               ; addrlen
.text:42CF2FC2                 push    0               ; addr
.text:42CF2FC4                 mov     eax, dword_42D010D4
.text:42CF2FC9                 push    eax             ; s
.text:42CF2FCA                 call    ds:accept
.text:42CF2FD0                 mov     ecx, [ebp+Block]
.text:42CF2FD3                 mov     [ecx+0Ch], eax
.text:42CF2FD6                 mov     edx, [ebp+Block]
.text:42CF2FD9                 cmp     dword ptr [edx+0Ch], 0FFFFFFFFh
.text:42CF2FDD                 jnz     short loc_42CF2FEF
.text:42CF2FDF                 call    ds:WSAGetLastError
.text:42CF2FE5                 mov     ecx, [ebp+arg_0]
.text:42CF2FE8                 mov     [ecx], eax
.text:42CF2FEA                 jmp     loc_42CF309D
.text:42CF2FEF ; ---------------------------------------------------------------------------
.text:42CF2FEF
.text:42CF2FEF loc_42CF2FEF:                           ; CODE XREF: sub_42CF2F5B+82\u2191j
.text:42CF2FEF                 push    0               ; lpName
.text:42CF2FF1                 push    0               ; bInitialState
.text:42CF2FF3                 push    0               ; bManualReset
.text:42CF2FF5                 push    0               ; lpEventAttributes
.text:42CF2FF7                 call    ds:CreateEventA
.text:42CF2FFD                 mov     [ebp+var_C], eax
.text:42CF3000                 cmp     [ebp+var_C], 0
.text:42CF3004                 jnz     short loc_42CF3016
.text:42CF3006                 call    ds:GetLastError
.text:42CF300C                 mov     edx, [ebp+arg_0]
.text:42CF300F                 mov     [edx], eax
.text:42CF3011                 jmp     loc_42CF309D
.text:42CF3016 ; ---------------------------------------------------------------------------
.text:42CF3016
.text:42CF3016 loc_42CF3016:                           ; CODE XREF: sub_42CF2F5B+A9\u2191j
.text:42CF3016                 cmp     dword_42D01A1C, 0
.text:42CF301D                 jz      short loc_42CF302C
.text:42CF301F                 mov     eax, [ebp+var_C]
.text:42CF3022                 or      al, 1
.text:42CF3024                 mov     ecx, [ebp+Block]
.text:42CF3027                 mov     [ecx+20h], eax
.text:42CF302A                 jmp     short loc_42CF3035
.text:42CF302C ; ---------------------------------------------------------------------------
.text:42CF302C
.text:42CF302C loc_42CF302C:                           ; CODE XREF: sub_42CF2F5B+C2\u2191j
.text:42CF302C                 mov     edx, [ebp+Block]
.text:42CF302F                 mov     eax, [ebp+var_C]
.text:42CF3032                 mov     [edx+20h], eax
.text:42CF3035
.text:42CF3035 loc_42CF3035:                           ; CODE XREF: sub_42CF2F5B+CF\u2191j
.text:42CF3035                 mov     ecx, [ebp+optlen]
.text:42CF3038                 push    ecx             ; optlen
.text:42CF3039                 lea     edx, [ebp+optval]
.text:42CF303C                 push    edx             ; optval
.text:42CF303D                 push    8               ; optname
.text:42CF303F                 push    0FFFFh          ; level
.text:42CF3044                 mov     eax, [ebp+Block]
.text:42CF3047                 mov     ecx, [eax+0Ch]
.text:42CF304A                 push    ecx             ; s
.text:42CF304B                 call    ds:setsockopt
.text:42CF3051                 mov     edx, [ebp+optlen]
.text:42CF3054                 push    edx             ; optlen
.text:42CF3055                 lea     eax, [ebp+optval]
.text:42CF3058                 push    eax             ; optval
.text:42CF3059                 push    100h            ; optname
.text:42CF305E                 push    0FFFFh          ; level
.text:42CF3063                 mov     ecx, [ebp+Block]
.text:42CF3066                 mov     edx, [ecx+0Ch]
.text:42CF3069                 push    edx             ; s
.text:42CF306A                 call    ds:setsockopt
.text:42CF3070                 lea     eax, [ebp+argp]
.text:42CF3073                 push    eax             ; argp
.text:42CF3074                 push    8004667Eh       ; cmd
.text:42CF3079                 mov     ecx, [ebp+Block]
.text:42CF307C                 mov     edx, [ecx+0Ch]
.text:42CF307F                 push    edx             ; s
.text:42CF3080                 call    ds:ioctlsocket
.text:42CF3086                 cmp     eax, 0FFFFFFFFh
.text:42CF3089                 jnz     short loc_42CF3098
.text:42CF308B                 call    ds:WSAGetLastError
.text:42CF3091                 mov     ecx, [ebp+arg_0]
.text:42CF3094                 mov     [ecx], eax
.text:42CF3096                 jmp     short loc_42CF309D
.text:42CF3098 ; ---------------------------------------------------------------------------
.text:42CF3098
.text:42CF3098 loc_42CF3098:                           ; CODE XREF: sub_42CF2F5B+12E\u2191j
.text:42CF3098                 mov     eax, [ebp+Block]
.text:42CF309B                 jmp     short loc_42CF30AC
.text:42CF309D ; ---------------------------------------------------------------------------
.text:42CF309D
.text:42CF309D loc_42CF309D:                           ; CODE XREF: sub_42CF2F5B+8F\u2191j
.text:42CF309D                                         ; sub_42CF2F5B+B6\u2191j ...
.text:42CF309D                 mov     edx, [ebp+Block]
.text:42CF30A0                 push    edx             ; Block
.text:42CF30A1                 call    ds:free
.text:42CF30A7                 add     esp, 4
.text:42CF30AA                 xor     eax, eax
.text:42CF30AC
.text:42CF30AC loc_42CF30AC:                           ; CODE XREF: sub_42CF2F5B+44\u2191j
.text:42CF30AC                                         ; sub_42CF2F5B+140\u2191j
.text:42CF30AC                 mov     esp, ebp
.text:42CF30AE                 pop     ebp
.text:42CF30AF                 retn
.text:42CF30AF sub_42CF2F5B    endp
.text:42CF30AF
.text:42CF30B0 ; Exported entry   5. ConnectionAccept
.text:42CF30B0
.text:42CF30B0 ; =============== S U B R O U T I N E =======================================
.text:42CF30B0
.text:42CF30B0 ; Attributes: bp-based frame
.text:42CF30B0
.text:42CF30B0                 public ConnectionAccept
.text:42CF30B0 ConnectionAccept proc near              ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF30B0
.text:42CF30B0 var_8           = dword ptr -8
.text:42CF30B0 var_4           = dword ptr -4
.text:42CF30B0 arg_0           = dword ptr  8
.text:42CF30B0 arg_4           = dword ptr  0Ch
.text:42CF30B0 arg_8           = dword ptr  10h
.text:42CF30B0 arg_C           = dword ptr  14h
.text:42CF30B0 arg_10          = dword ptr  18h
.text:42CF30B0
.text:42CF30B0                 push    ebp
.text:42CF30B1                 mov     ebp, esp
.text:42CF30B3                 sub     esp, 8
.text:42CF30B6                 mov     eax, [ebp+arg_0]
.text:42CF30B9                 mov     [ebp+var_4], eax
.text:42CF30BC                 mov     ecx, [ebp+arg_C]
.text:42CF30BF                 mov     dword ptr [ecx], 0
.text:42CF30C5                 push    0               ; lpPreviousCount
.text:42CF30C7                 push    1               ; lReleaseCount
.text:42CF30C9                 mov     edx, hSemaphore
.text:42CF30CF                 push    edx             ; hSemaphore
.text:42CF30D0                 call    ds:ReleaseSemaphore
.text:42CF30D6                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF30D8                 mov     eax, hHandle
.text:42CF30DD                 push    eax             ; hHandle
.text:42CF30DE                 call    ds:WaitForSingleObject
.text:42CF30E4                 cmp     CompletionKey, 0
.text:42CF30EB                 jnz     short loc_42CF30FD
.text:42CF30ED                 mov     ecx, [ebp+arg_C]
.text:42CF30F0                 mov     edx, dword_42D01DF8
.text:42CF30F6                 mov     [ecx], edx
.text:42CF30F8                 jmp     loc_42CF31E3
.text:42CF30FD ; ---------------------------------------------------------------------------
.text:42CF30FD
.text:42CF30FD loc_42CF30FD:                           ; CODE XREF: ConnectionAccept+3B\u2191j
.text:42CF30FD                 mov     eax, CompletionKey
.text:42CF3102                 mov     ecx, [ebp+arg_4]
.text:42CF3105                 mov     edx, [ecx]
.text:42CF3107                 mov     [eax+74h], edx
.text:42CF310A                 mov     eax, CompletionKey
.text:42CF310F                 mov     ecx, [ebp+arg_4]
.text:42CF3112                 mov     edx, [ecx+4]
.text:42CF3115                 mov     [eax+78h], edx
.text:42CF3118                 mov     eax, CompletionKey
.text:42CF311D                 mov     ecx, [ebp+arg_4]
.text:42CF3120                 mov     edx, [ecx+8]
.text:42CF3123                 mov     [eax+7Ch], edx
.text:42CF3126                 mov     eax, CompletionKey
.text:42CF312B                 mov     ecx, [ebp+arg_8]
.text:42CF312E                 mov     [eax+70h], ecx
.text:42CF3131                 cmp     dword_42D01A1C, 0
.text:42CF3138                 jz      short loc_42CF31AC
.text:42CF313A                 mov     edx, CompletionKey
.text:42CF3140                 cmp     dword ptr [edx+80h], 0
.text:42CF3147                 jnz     short loc_42CF3185
.text:42CF3149                 push    0               ; NumberOfConcurrentThreads
.text:42CF314B                 mov     eax, CompletionKey
.text:42CF3150                 push    eax             ; CompletionKey
.text:42CF3151                 mov     ecx, CompletionPort
.text:42CF3157                 push    ecx             ; ExistingCompletionPort
.text:42CF3158                 mov     edx, CompletionKey
.text:42CF315E                 mov     eax, [edx+0Ch]
.text:42CF3161                 push    eax             ; FileHandle
.text:42CF3162                 call    ds:CreateIoCompletionPort
.text:42CF3168                 mov     CompletionPort, eax
.text:42CF316D                 cmp     CompletionPort, 0
.text:42CF3174                 jnz     short loc_42CF3183
.text:42CF3176                 call    ds:GetLastError
.text:42CF317C                 mov     ecx, [ebp+arg_C]
.text:42CF317F                 mov     [ecx], eax
.text:42CF3181                 jmp     short loc_42CF31E3
.text:42CF3183 ; ---------------------------------------------------------------------------
.text:42CF3183
.text:42CF3183 loc_42CF3183:                           ; CODE XREF: ConnectionAccept+C4\u2191j
.text:42CF3183                 jmp     short loc_42CF31AC
.text:42CF3185 ; ---------------------------------------------------------------------------
.text:42CF3185
.text:42CF3185 loc_42CF3185:                           ; CODE XREF: ConnectionAccept+97\u2191j
.text:42CF3185                 mov     edx, [ebp+arg_C]
.text:42CF3188                 push    edx
.text:42CF3189                 push    offset CompletionPort
.text:42CF318E                 mov     eax, [ebp+var_4]
.text:42CF3191                 push    eax
.text:42CF3192                 mov     ecx, CompletionKey
.text:42CF3198                 push    ecx
.text:42CF3199                 call    sub_42CF5EAD
.text:42CF319E                 add     esp, 10h
.text:42CF31A1                 cmp     CompletionPort, 0
.text:42CF31A8                 jnz     short loc_42CF31AC
.text:42CF31AA                 jmp     short loc_42CF31E3
.text:42CF31AC ; ---------------------------------------------------------------------------
.text:42CF31AC
.text:42CF31AC loc_42CF31AC:                           ; CODE XREF: ConnectionAccept+88\u2191j
.text:42CF31AC                                         ; ConnectionAccept:loc_42CF3183\u2191j ...
.text:42CF31AC                 mov     edx, CompletionKey
.text:42CF31B2                 mov     dword ptr [edx+90h], 0
.text:42CF31BC                 mov     eax, CompletionKey
.text:42CF31C1                 mov     dword ptr [eax+94h], 1
.text:42CF31CB                 mov     ecx, [ebp+arg_10]
.text:42CF31CE                 mov     edx, CompletionKey
.text:42CF31D4                 mov     eax, [edx+84h]
.text:42CF31DA                 mov     [ecx], eax
.text:42CF31DC                 mov     eax, CompletionKey
.text:42CF31E1                 jmp     short loc_42CF3201
.text:42CF31E3 ; ---------------------------------------------------------------------------
.text:42CF31E3
.text:42CF31E3 loc_42CF31E3:                           ; CODE XREF: ConnectionAccept+48\u2191j
.text:42CF31E3                                         ; ConnectionAccept+D1\u2191j ...
.text:42CF31E3                 cmp     CompletionKey, 0
.text:42CF31EA                 jz      short loc_42CF31FF
.text:42CF31EC                 lea     ecx, [ebp+var_8]
.text:42CF31EF                 push    ecx             ; LONG *
.text:42CF31F0                 mov     edx, CompletionKey
.text:42CF31F6                 push    edx             ; void *
.text:42CF31F7                 call    ConnectionClose
.text:42CF31FC                 add     esp, 8
.text:42CF31FF
.text:42CF31FF loc_42CF31FF:                           ; CODE XREF: ConnectionAccept+13A\u2191j
.text:42CF31FF                 xor     eax, eax
.text:42CF3201
.text:42CF3201 loc_42CF3201:                           ; CODE XREF: ConnectionAccept+131\u2191j
.text:42CF3201                 mov     esp, ebp
.text:42CF3203                 pop     ebp
.text:42CF3204                 retn
.text:42CF3204 ConnectionAccept endp ; sp-analysis failed
.text:42CF3204
.text:42CF3205 ; Exported entry   3. ConnectionClose
.text:42CF3205
.text:42CF3205 ; =============== S U B R O U T I N E =======================================
.text:42CF3205
.text:42CF3205 ; Attributes: bp-based frame
.text:42CF3205
.text:42CF3205 ; int __stdcall ConnectionClose(void *, LONG *)
.text:42CF3205                 public ConnectionClose
.text:42CF3205 ConnectionClose proc near               ; CODE XREF: ConnectionAccept+147\u2191p
.text:42CF3205                                         ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF3205
.text:42CF3205 hObject         = dword ptr -10h
.text:42CF3205 var_C           = dword ptr -0Ch
.text:42CF3205 var_8           = dword ptr -8
.text:42CF3205 Block           = dword ptr -4
.text:42CF3205 arg_0           = dword ptr  8
.text:42CF3205 arg_4           = dword ptr  0Ch
.text:42CF3205
.text:42CF3205                 push    ebp
.text:42CF3206                 mov     ebp, esp
.text:42CF3208                 sub     esp, 10h
.text:42CF320B                 mov     eax, [ebp+arg_0]
.text:42CF320E                 mov     [ebp+Block], eax
.text:42CF3211                 mov     ecx, [ebp+arg_4]
.text:42CF3214                 mov     dword ptr [ecx], 0
.text:42CF321A                 mov     edx, [ebp+Block]
.text:42CF321D                 cmp     dword ptr [edx+8], 0
.text:42CF3221                 jnz     loc_42CF32C0
.text:42CF3227                 mov     eax, [ebp+Block]
.text:42CF322A                 cmp     dword ptr [eax+80h], 0
.text:42CF3231                 jnz     short loc_42CF32AF
.text:42CF3233                 mov     ecx, [ebp+Block]
.text:42CF3236                 cmp     dword ptr [ecx+0Ch], 0
.text:42CF323A                 jnz     short loc_42CF3246
.text:42CF323C                 mov     eax, 1
.text:42CF3241                 jmp     loc_42CF3674
.text:42CF3246 ; ---------------------------------------------------------------------------
.text:42CF3246
.text:42CF3246 loc_42CF3246:                           ; CODE XREF: ConnectionClose+35\u2191j
.text:42CF3246                 mov     edx, [ebp+Block]
.text:42CF3249                 mov     eax, [edx+0Ch]
.text:42CF324C                 push    eax             ; s
.text:42CF324D                 call    ds:closesocket
.text:42CF3253                 cmp     eax, 0FFFFFFFFh
.text:42CF3256                 jnz     short loc_42CF3268
.text:42CF3258                 call    ds:WSAGetLastError
.text:42CF325E                 mov     ecx, [ebp+arg_4]
.text:42CF3261                 mov     [ecx], eax
.text:42CF3263                 jmp     loc_42CF3672
.text:42CF3268 ; ---------------------------------------------------------------------------
.text:42CF3268
.text:42CF3268 loc_42CF3268:                           ; CODE XREF: ConnectionClose+51\u2191j
.text:42CF3268                 mov     edx, [ebp+Block]
.text:42CF326B                 cmp     dword ptr [edx+20h], 0
.text:42CF326F                 jz      short loc_42CF32AD
.text:42CF3271                 cmp     dword_42D01A1C, 0
.text:42CF3278                 jz      short loc_42CF32A0
.text:42CF327A                 mov     [ebp+hObject], 0
.text:42CF3281                 mov     [ebp+var_C], 0FFFFFFFEh
.text:42CF3288                 mov     eax, [ebp+Block]
.text:42CF328B                 mov     ecx, [eax+20h]
.text:42CF328E                 and     ecx, [ebp+var_C]
.text:42CF3291                 mov     [ebp+hObject], ecx
.text:42CF3294                 mov     edx, [ebp+hObject]
.text:42CF3297                 push    edx             ; hObject
.text:42CF3298                 call    ds:CloseHandle
.text:42CF329E                 jmp     short loc_42CF32AD
.text:42CF32A0 ; ---------------------------------------------------------------------------
.text:42CF32A0
.text:42CF32A0 loc_42CF32A0:                           ; CODE XREF: ConnectionClose+73\u2191j
.text:42CF32A0                 mov     eax, [ebp+Block]
.text:42CF32A3                 mov     ecx, [eax+20h]
.text:42CF32A6                 push    ecx             ; hObject
.text:42CF32A7                 call    ds:CloseHandle
.text:42CF32AD
.text:42CF32AD loc_42CF32AD:                           ; CODE XREF: ConnectionClose+6A\u2191j
.text:42CF32AD                                         ; ConnectionClose+99\u2191j
.text:42CF32AD                 jmp     short loc_42CF32BB
.text:42CF32AF ; ---------------------------------------------------------------------------
.text:42CF32AF
.text:42CF32AF loc_42CF32AF:                           ; CODE XREF: ConnectionClose+2C\u2191j
.text:42CF32AF                 mov     edx, [ebp+Block]
.text:42CF32B2                 push    edx
.text:42CF32B3                 call    sub_42CF5D98
.text:42CF32B8                 add     esp, 4
.text:42CF32BB
.text:42CF32BB loc_42CF32BB:                           ; CODE XREF: ConnectionClose:loc_42CF32AD\u2191j
.text:42CF32BB                 jmp     loc_42CF35BA
.text:42CF32C0 ; ---------------------------------------------------------------------------
.text:42CF32C0
.text:42CF32C0 loc_42CF32C0:                           ; CODE XREF: ConnectionClose+1C\u2191j
.text:42CF32C0                 cmp     dword_42D010E0, 0
.text:42CF32C7                 jz      short loc_42CF3302
.text:42CF32C9                 push    0
.text:42CF32CB                 push    0
.text:42CF32CD                 call    sub_42CFCA5A
.text:42CF32D2                 add     esp, 8
.text:42CF32D5                 mov     ecx, [ebp+arg_4]
.text:42CF32D8                 mov     [ecx], eax
.text:42CF32DA                 mov     edx, [ebp+arg_4]
.text:42CF32DD                 cmp     dword ptr [edx], 0
.text:42CF32E0                 jnz     short loc_42CF32E4
.text:42CF32E2                 jmp     short loc_42CF3302
.text:42CF32E4 ; ---------------------------------------------------------------------------
.text:42CF32E4
.text:42CF32E4 loc_42CF32E4:                           ; CODE XREF: ConnectionClose+DB\u2191j
.text:42CF32E4                 push    1               ; wType
.text:42CF32E6                 mov     eax, [ebp+arg_4]
.text:42CF32E9                 mov     ecx, [eax]
.text:42CF32EB                 push    ecx             ; int
.text:42CF32EC                 push    offset aSpnunregister ; "SpnUnRegister"
.text:42CF32F1                 push    offset unk_42D01100 ; int
.text:42CF32F6                 mov     edx, [ebp+Block]
.text:42CF32F9                 push    edx             ; int
.text:42CF32FA                 call    sub_42CF56FE
.text:42CF32FF                 add     esp, 14h
.text:42CF3302
.text:42CF3302 loc_42CF3302:                           ; CODE XREF: ConnectionClose+C2\u2191j
.text:42CF3302                                         ; ConnectionClose+DD\u2191j
.text:42CF3302                 mov     eax, [ebp+Block]
.text:42CF3305                 cmp     dword ptr [eax+20h], 0
.text:42CF3309                 jz      short loc_42CF3318
.text:42CF330B                 mov     ecx, [ebp+Block]
.text:42CF330E                 mov     edx, [ecx+20h]
.text:42CF3311                 push    edx             ; hObject
.text:42CF3312                 call    ds:CloseHandle
.text:42CF3318
.text:42CF3318 loc_42CF3318:                           ; CODE XREF: ConnectionClose+104\u2191j
.text:42CF3318                 cmp     dword_42D01DD0, 0
.text:42CF331F                 jz      short loc_42CF336B
.text:42CF3321                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF3323                 mov     eax, hMutex
.text:42CF3328                 push    eax             ; hHandle
.text:42CF3329                 call    ds:WaitForSingleObject
.text:42CF332F                 mov     dword_42D01B4C, 1
.text:42CF3339                 mov     ecx, hEvent
.text:42CF333F                 push    ecx             ; hEvent
.text:42CF3340                 call    ds:ResetEvent
.text:42CF3346                 mov     edx, hMutex
.text:42CF334C                 push    edx             ; hMutex
.text:42CF334D                 call    ds:ReleaseMutex
.text:42CF3353                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF3355                 mov     eax, hEvent
.text:42CF335A                 push    eax             ; hHandle
.text:42CF335B                 call    ds:WaitForSingleObject
.text:42CF3361                 mov     dword_42D01DD0, 0
.text:42CF336B
.text:42CF336B loc_42CF336B:                           ; CODE XREF: ConnectionClose+11A\u2191j
.text:42CF336B                 cmp     dword_42D01C40, 0
.text:42CF3372                 jz      short loc_42CF3379
.text:42CF3374                 call    sub_42CFC9C3
.text:42CF3379
.text:42CF3379 loc_42CF3379:                           ; CODE XREF: ConnectionClose+16D\u2191j
.text:42CF3379                 mov     [ebp+var_8], 0
.text:42CF3380                 jmp     short loc_42CF338B
.text:42CF3382 ; ---------------------------------------------------------------------------
.text:42CF3382
.text:42CF3382 loc_42CF3382:                           ; CODE XREF: ConnectionClose:loc_42CF33D5\u2193j
.text:42CF3382                 mov     ecx, [ebp+var_8]
.text:42CF3385                 add     ecx, 1
.text:42CF3388                 mov     [ebp+var_8], ecx
.text:42CF338B
.text:42CF338B loc_42CF338B:                           ; CODE XREF: ConnectionClose+17B\u2191j
.text:42CF338B                 mov     edx, [ebp+var_8]
.text:42CF338E                 cmp     edx, cEvents
.text:42CF3394                 jge     short loc_42CF33D7
.text:42CF3396                 mov     eax, [ebp+var_8]
.text:42CF3399                 mov     ecx, s[eax*4]
.text:42CF33A0                 push    ecx             ; s
.text:42CF33A1                 call    ds:closesocket
.text:42CF33A7                 cmp     eax, 0FFFFFFFFh
.text:42CF33AA                 jnz     short loc_42CF33D5
.text:42CF33AC                 call    ds:WSAGetLastError
.text:42CF33B2                 mov     edx, [ebp+arg_4]
.text:42CF33B5                 mov     [edx], eax
.text:42CF33B7                 push    1               ; wType
.text:42CF33B9                 mov     eax, [ebp+arg_4]
.text:42CF33BC                 mov     ecx, [eax]
.text:42CF33BE                 push    ecx             ; int
.text:42CF33BF                 push    offset aConnectionclos_0 ; "ConnectionClose"
.text:42CF33C4                 push    offset aTcpClosesocket ; "TCP: closesocket()"
.text:42CF33C9                 mov     edx, [ebp+Block]
.text:42CF33CC                 push    edx             ; int
.text:42CF33CD                 call    sub_42CF56FE
.text:42CF33D2                 add     esp, 14h
.text:42CF33D5
.text:42CF33D5 loc_42CF33D5:                           ; CODE XREF: ConnectionClose+1A5\u2191j
.text:42CF33D5                 jmp     short loc_42CF3382
.text:42CF33D7 ; ---------------------------------------------------------------------------
.text:42CF33D7
.text:42CF33D7 loc_42CF33D7:                           ; CODE XREF: ConnectionClose+18F\u2191j
.text:42CF33D7                 cmp     dword_42D010D4, 0
.text:42CF33DE                 jz      short loc_42CF341A
.text:42CF33E0                 mov     eax, dword_42D010D4
.text:42CF33E5                 push    eax             ; s
.text:42CF33E6                 call    ds:closesocket
.text:42CF33EC                 cmp     eax, 0FFFFFFFFh
.text:42CF33EF                 jnz     short loc_42CF341A
.text:42CF33F1                 call    ds:WSAGetLastError
.text:42CF33F7                 mov     ecx, [ebp+arg_4]
.text:42CF33FA                 mov     [ecx], eax
.text:42CF33FC                 push    1               ; wType
.text:42CF33FE                 mov     edx, [ebp+arg_4]
.text:42CF3401                 mov     eax, [edx]
.text:42CF3403                 push    eax             ; int
.text:42CF3404                 push    offset aConnectionclos_1 ; "ConnectionClose"
.text:42CF3409                 push    offset aWinsockProxyCl ; "Winsock Proxy: closesocket()"
.text:42CF340E                 mov     ecx, [ebp+Block]
.text:42CF3411                 push    ecx             ; int
.text:42CF3412                 call    sub_42CF56FE
.text:42CF3417                 add     esp, 14h
.text:42CF341A
.text:42CF341A loc_42CF341A:                           ; CODE XREF: ConnectionClose+1D9\u2191j
.text:42CF341A                                         ; ConnectionClose+1EA\u2191j
.text:42CF341A                 cmp     hThread, 0
.text:42CF3421                 jz      short loc_42CF3432
.text:42CF3423                 push    0               ; dwExitCode
.text:42CF3425                 mov     edx, hThread
.text:42CF342B                 push    edx             ; hThread
.text:42CF342C                 call    ds:TerminateThread
.text:42CF3432
.text:42CF3432 loc_42CF3432:                           ; CODE XREF: ConnectionClose+21C\u2191j
.text:42CF3432                 cmp     dword_42D01BE0, 0
.text:42CF3439                 jz      short loc_42CF3449
.text:42CF343B                 push    0               ; dwExitCode
.text:42CF343D                 mov     eax, dword_42D01BE0
.text:42CF3442                 push    eax             ; hThread
.text:42CF3443                 call    ds:TerminateThread
.text:42CF3449
.text:42CF3449 loc_42CF3449:                           ; CODE XREF: ConnectionClose+234\u2191j
.text:42CF3449                 mov     [ebp+var_8], 0
.text:42CF3450                 jmp     short loc_42CF345B
.text:42CF3452 ; ---------------------------------------------------------------------------
.text:42CF3452
.text:42CF3452 loc_42CF3452:                           ; CODE XREF: ConnectionClose:loc_42CF3486\u2193j
.text:42CF3452                 mov     ecx, [ebp+var_8]
.text:42CF3455                 add     ecx, 1
.text:42CF3458                 mov     [ebp+var_8], ecx
.text:42CF345B
.text:42CF345B loc_42CF345B:                           ; CODE XREF: ConnectionClose+24B\u2191j
.text:42CF345B                 mov     edx, [ebp+var_8]
.text:42CF345E                 cmp     edx, dword_42D01A14
.text:42CF3464                 jge     short loc_42CF3488
.text:42CF3466                 mov     eax, [ebp+var_8]
.text:42CF3469                 cmp     dword_42D01B60[eax*4], 0
.text:42CF3471                 jz      short loc_42CF3486
.text:42CF3473                 push    0               ; dwExitCode
.text:42CF3475                 mov     ecx, [ebp+var_8]
.text:42CF3478                 mov     edx, dword_42D01B60[ecx*4]
.text:42CF347F                 push    edx             ; hThread
.text:42CF3480                 call    ds:TerminateThread
.text:42CF3486
.text:42CF3486 loc_42CF3486:                           ; CODE XREF: ConnectionClose+26C\u2191j
.text:42CF3486                 jmp     short loc_42CF3452
.text:42CF3488 ; ---------------------------------------------------------------------------
.text:42CF3488
.text:42CF3488 loc_42CF3488:                           ; CODE XREF: ConnectionClose+25F\u2191j
.text:42CF3488                 cmp     Block, 0
.text:42CF348F                 jz      short loc_42CF34B5
.text:42CF3491                 mov     eax, [ebp+arg_4]
.text:42CF3494                 push    eax
.text:42CF3495                 mov     ecx, Block
.text:42CF349B                 push    ecx
.text:42CF349C                 call    dword_42D01E10
.text:42CF34A2                 add     esp, 8
.text:42CF34A5                 mov     edx, Block
.text:42CF34AB                 push    edx             ; Block
.text:42CF34AC                 call    ds:free
.text:42CF34B2                 add     esp, 4
.text:42CF34B5
.text:42CF34B5 loc_42CF34B5:                           ; CODE XREF: ConnectionClose+28A\u2191j
.text:42CF34B5                 mov     Block, 0
.text:42CF34BF                 cmp     dword_42D01F40, 0
.text:42CF34C6                 jz      short loc_42CF34EC
.text:42CF34C8                 mov     eax, [ebp+arg_4]
.text:42CF34CB                 push    eax
.text:42CF34CC                 mov     ecx, dword_42D01F40
.text:42CF34D2                 push    ecx
.text:42CF34D3                 call    dword_42D01F50
.text:42CF34D9                 add     esp, 8
.text:42CF34DC                 mov     edx, dword_42D01F40
.text:42CF34E2                 push    edx             ; Block
.text:42CF34E3                 call    ds:free
.text:42CF34E9                 add     esp, 4
.text:42CF34EC
.text:42CF34EC loc_42CF34EC:                           ; CODE XREF: ConnectionClose+2C1\u2191j
.text:42CF34EC                 mov     dword_42D01F40, 0
.text:42CF34F6                 cmp     dword_42D01C60, 0
.text:42CF34FD                 jz      short loc_42CF3523
.text:42CF34FF                 mov     eax, [ebp+arg_4]
.text:42CF3502                 push    eax
.text:42CF3503                 mov     ecx, dword_42D01C60
.text:42CF3509                 push    ecx
.text:42CF350A                 call    dword_42D01C70
.text:42CF3510                 add     esp, 8
.text:42CF3513                 mov     edx, dword_42D01C60
.text:42CF3519                 push    edx             ; Block
.text:42CF351A                 call    ds:free
.text:42CF3520                 add     esp, 4
.text:42CF3523
.text:42CF3523 loc_42CF3523:                           ; CODE XREF: ConnectionClose+2F8\u2191j
.text:42CF3523                 mov     dword_42D01C60, 0
.text:42CF352D                 cmp     dword_42D01C00, 0
.text:42CF3534                 jz      short loc_42CF355A
.text:42CF3536                 mov     eax, [ebp+arg_4]
.text:42CF3539                 push    eax
.text:42CF353A                 mov     ecx, dword_42D01C00
.text:42CF3540                 push    ecx
.text:42CF3541                 call    dword_42D01C10
.text:42CF3547                 add     esp, 8
.text:42CF354A                 mov     edx, dword_42D01C00
.text:42CF3550                 push    edx             ; Block
.text:42CF3551                 call    ds:free
.text:42CF3557                 add     esp, 4
.text:42CF355A
.text:42CF355A loc_42CF355A:                           ; CODE XREF: ConnectionClose+32F\u2191j
.text:42CF355A                 mov     dword_42D01C00, 0
.text:42CF3564                 cmp     dword_42D020C0, 0
.text:42CF356B                 jz      short loc_42CF3591
.text:42CF356D                 mov     eax, [ebp+arg_4]
.text:42CF3570                 push    eax
.text:42CF3571                 mov     ecx, dword_42D020C0
.text:42CF3577                 push    ecx
.text:42CF3578                 call    dword_42D020D0
.text:42CF357E                 add     esp, 8
.text:42CF3581                 mov     edx, dword_42D020C0
.text:42CF3587                 push    edx             ; Block
.text:42CF3588                 call    ds:free
.text:42CF358E                 add     esp, 4
.text:42CF3591
.text:42CF3591 loc_42CF3591:                           ; CODE XREF: ConnectionClose+366\u2191j
.text:42CF3591                 mov     dword_42D020C0, 0
.text:42CF359B                 cmp     hEventLog, 0
.text:42CF35A2                 jz      short loc_42CF35BA
.text:42CF35A4                 mov     eax, hEventLog
.text:42CF35A9                 push    eax             ; hEventLog
.text:42CF35AA                 call    ds:DeregisterEventSource
.text:42CF35B0                 mov     hEventLog, 0
.text:42CF35BA
.text:42CF35BA loc_42CF35BA:                           ; CODE XREF: ConnectionClose:loc_42CF32BB\u2191j
.text:42CF35BA                                         ; ConnectionClose+39D\u2191j
.text:42CF35BA                 mov     ecx, [ebp+Block]
.text:42CF35BD                 cmp     dword ptr [ecx+8], 0
.text:42CF35C1                 jz      short loc_42CF35D5
.text:42CF35C3                 mov     edx, [ebp+Block]
.text:42CF35C6                 push    edx             ; Block
.text:42CF35C7                 call    ds:free
.text:42CF35CD                 add     esp, 4
.text:42CF35D0                 jmp     loc_42CF3664
.text:42CF35D5 ; ---------------------------------------------------------------------------
.text:42CF35D5
.text:42CF35D5 loc_42CF35D5:                           ; CODE XREF: ConnectionClose+3BC\u2191j
.text:42CF35D5                 mov     eax, [ebp+Block]
.text:42CF35D8                 add     eax, 8Ch ; 'Œ'
.text:42CF35DD                 push    eax             ; lpAddend
.text:42CF35DE                 call    ds:InterlockedDecrement
.text:42CF35E4                 test    eax, eax
.text:42CF35E6                 jnz     short loc_42CF3664
.text:42CF35E8                 mov     ecx, [ebp+Block]
.text:42CF35EB                 cmp     dword ptr [ecx+44h], 0
.text:42CF35EF                 jz      short loc_42CF3612
.text:42CF35F1                 mov     edx, [ebp+Block]
.text:42CF35F4                 mov     eax, [edx+44h]
.text:42CF35F7                 push    eax
.text:42CF35F8                 mov     ecx, [ebp+Block]
.text:42CF35FB                 mov     edx, [ecx+74h]
.text:42CF35FE                 push    edx
.text:42CF35FF                 mov     eax, [ebp+Block]
.text:42CF3602                 call    dword ptr [eax+7Ch]
.text:42CF3605                 add     esp, 8
.text:42CF3608                 mov     ecx, [ebp+Block]
.text:42CF360B                 mov     dword ptr [ecx+44h], 0
.text:42CF3612
.text:42CF3612 loc_42CF3612:                           ; CODE XREF: ConnectionClose+3EA\u2191j
.text:42CF3612                 mov     edx, [ebp+Block]
.text:42CF3615                 cmp     dword ptr [edx+4Ch], 0
.text:42CF3619                 jz      short loc_42CF363C
.text:42CF361B                 mov     eax, [ebp+Block]
.text:42CF361E                 mov     ecx, [eax+4Ch]
.text:42CF3621                 push    ecx
.text:42CF3622                 mov     edx, [ebp+Block]
.text:42CF3625                 mov     eax, [edx+74h]
.text:42CF3628                 push    eax
.text:42CF3629                 mov     ecx, [ebp+Block]
.text:42CF362C                 call    dword ptr [ecx+7Ch]
.text:42CF362F                 add     esp, 8
.text:42CF3632                 mov     edx, [ebp+Block]
.text:42CF3635                 mov     dword ptr [edx+4Ch], 0
.text:42CF363C
.text:42CF363C loc_42CF363C:                           ; CODE XREF: ConnectionClose+414\u2191j
.text:42CF363C                 mov     eax, [ebp+Block]
.text:42CF363F                 cmp     dword ptr [eax+0A0h], 1
.text:42CF3646                 jnz     short loc_42CF3657
.text:42CF3648                 mov     ecx, [ebp+Block]
.text:42CF364B                 add     ecx, 54h ; 'T'
.text:42CF364E                 push    ecx
.text:42CF364F                 call    sub_42CF7F60
.text:42CF3654                 add     esp, 4
.text:42CF3657
.text:42CF3657 loc_42CF3657:                           ; CODE XREF: ConnectionClose+441\u2191j
.text:42CF3657                 mov     edx, [ebp+Block]
.text:42CF365A                 push    edx             ; Block
.text:42CF365B                 call    ds:free
.text:42CF3661                 add     esp, 4
.text:42CF3664
.text:42CF3664 loc_42CF3664:                           ; CODE XREF: ConnectionClose+3CB\u2191j
.text:42CF3664                                         ; ConnectionClose+3E1\u2191j
.text:42CF3664                 mov     [ebp+Block], 0
.text:42CF366B                 mov     eax, 1
.text:42CF3670                 jmp     short loc_42CF3674
.text:42CF3672 ; ---------------------------------------------------------------------------
.text:42CF3672
.text:42CF3672 loc_42CF3672:                           ; CODE XREF: ConnectionClose+5E\u2191j
.text:42CF3672                 xor     eax, eax
.text:42CF3674
.text:42CF3674 loc_42CF3674:                           ; CODE XREF: ConnectionClose+3C\u2191j
.text:42CF3674                                         ; ConnectionClose+46B\u2191j
.text:42CF3674                 mov     esp, ebp
.text:42CF3676                 pop     ebp
.text:42CF3677                 retn
.text:42CF3677 ConnectionClose endp
.text:42CF3677
.text:42CF3678 ; Exported entry   1. ConnectionRead
.text:42CF3678
.text:42CF3678 ; =============== S U B R O U T I N E =======================================
.text:42CF3678
.text:42CF3678 ; Attributes: bp-based frame
.text:42CF3678
.text:42CF3678 ; USHORT __stdcall ConnectionRead(void *, BYTE *, USHORT, USHORT, USHORT, LONG *)
.text:42CF3678                 public ConnectionRead
.text:42CF3678 ConnectionRead  proc near               ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF3678
.text:42CF3678 var_3C          = dword ptr -3Ch
.text:42CF3678 var_38          = dword ptr -38h
.text:42CF3678 var_34          = dword ptr -34h
.text:42CF3678 var_30          = dword ptr -30h
.text:42CF3678 Src             = dword ptr -2Ch
.text:42CF3678 var_28          = dword ptr -28h
.text:42CF3678 var_24          = dword ptr -24h
.text:42CF3678 var_20          = dword ptr -20h
.text:42CF3678 var_1C          = dword ptr -1Ch
.text:42CF3678 var_18          = dword ptr -18h
.text:42CF3678 var_14          = dword ptr -14h
.text:42CF3678 var_10          = dword ptr -10h
.text:42CF3678 optval          = byte ptr -0Ch
.text:42CF3678 flags           = dword ptr -8
.text:42CF3678 var_4           = dword ptr -4
.text:42CF3678 arg_0           = dword ptr  8
.text:42CF3678 arg_4           = dword ptr  0Ch
.text:42CF3678 arg_8           = word ptr  10h
.text:42CF3678 arg_C           = word ptr  14h
.text:42CF3678 arg_10          = word ptr  18h
.text:42CF3678 arg_14          = dword ptr  1Ch
.text:42CF3678
.text:42CF3678                 push    ebp
.text:42CF3679                 mov     ebp, esp
.text:42CF367B                 sub     esp, 3Ch
.text:42CF367E                 mov     eax, [ebp+arg_0]
.text:42CF3681                 mov     [ebp+var_4], eax
.text:42CF3684                 mov     [ebp+var_24], 0
.text:42CF368B                 mov     [ebp+var_1C], 0
.text:42CF3692                 mov     [ebp+flags], 0
.text:42CF3699                 mov     ecx, [ebp+arg_14]
.text:42CF369C                 mov     dword ptr [ecx], 0
.text:42CF36A2                 mov     edx, dword ptr [ebp+arg_8]
.text:42CF36A5                 cmp     edx, dword ptr [ebp+arg_C]
.text:42CF36A8                 jbe     short loc_42CF36B8
.text:42CF36AA                 mov     eax, [ebp+arg_14]
.text:42CF36AD                 mov     dword ptr [eax], 0Bh
.text:42CF36B3                 jmp     loc_42CF3BF5
.text:42CF36B8 ; ---------------------------------------------------------------------------
.text:42CF36B8
.text:42CF36B8 loc_42CF36B8:                           ; CODE XREF: ConnectionRead+30\u2191j
.text:42CF36B8                 mov     ecx, [ebp+var_4]
.text:42CF36BB                 cmp     dword ptr [ecx+80h], 0
.text:42CF36C2                 jnz     short loc_42CF3715
.text:42CF36C4                 mov     dword ptr [ebp+optval], 7FFFFFFFh
.text:42CF36CB                 cmp     dword ptr [ebp+arg_10], 0
.text:42CF36CF                 jz      short loc_42CF36E1
.text:42CF36D1                 cmp     dword ptr [ebp+arg_10], 0FFFFh
.text:42CF36D8                 jnz     short loc_42CF36E1
.text:42CF36DA                 mov     dword ptr [ebp+optval], 1
.text:42CF36E1
.text:42CF36E1 loc_42CF36E1:                           ; CODE XREF: ConnectionRead+57\u2191j
.text:42CF36E1                                         ; ConnectionRead+60\u2191j
.text:42CF36E1                 push    4               ; optlen
.text:42CF36E3                 lea     edx, [ebp+optval]
.text:42CF36E6                 push    edx             ; optval
.text:42CF36E7                 push    1006h           ; optname
.text:42CF36EC                 push    0FFFFh          ; level
.text:42CF36F1                 mov     eax, [ebp+var_4]
.text:42CF36F4                 mov     ecx, [eax+0Ch]
.text:42CF36F7                 push    ecx             ; s
.text:42CF36F8                 call    ds:setsockopt
.text:42CF36FE                 mov     [ebp+var_1C], eax
.text:42CF3701                 cmp     [ebp+var_1C], 0
.text:42CF3705                 jz      short loc_42CF3715
.text:42CF3707                 mov     edx, [ebp+arg_14]
.text:42CF370A                 mov     dword ptr [edx], 0Bh
.text:42CF3710                 jmp     loc_42CF3BF5
.text:42CF3715 ; ---------------------------------------------------------------------------
.text:42CF3715
.text:42CF3715 loc_42CF3715:                           ; CODE XREF: ConnectionRead+4A\u2191j
.text:42CF3715                                         ; ConnectionRead+8D\u2191j
.text:42CF3715                 mov     eax, [ebp+var_4]
.text:42CF3718                 cmp     dword ptr [eax+64h], 0
.text:42CF371C                 jnz     short loc_42CF3738
.text:42CF371E                 mov     ecx, [ebp+var_4]
.text:42CF3721                 cmp     dword ptr [ecx+68h], 0
.text:42CF3725                 jz      loc_42CF392A
.text:42CF372B                 mov     edx, [ebp+var_4]
.text:42CF372E                 cmp     dword ptr [edx+6Ch], 0
.text:42CF3732                 jz      loc_42CF392A
.text:42CF3738
.text:42CF3738 loc_42CF3738:                           ; CODE XREF: ConnectionRead+A4\u2191j
.text:42CF3738                 mov     eax, [ebp+var_4]
.text:42CF373B                 cmp     dword ptr [eax+0A0h], 0
.text:42CF3742                 jz      loc_42CF392A
.text:42CF3748                 mov     ecx, Size
.text:42CF374E                 add     ecx, dword_42D01CA4
.text:42CF3754                 mov     edx, dword ptr [ebp+arg_8]
.text:42CF3757                 add     edx, ecx
.text:42CF3759                 mov     [ebp+var_20], edx
.text:42CF375C                 mov     eax, Size
.text:42CF3761                 add     eax, dword_42D01CA4
.text:42CF3767                 mov     ecx, dword ptr [ebp+arg_C]
.text:42CF376A                 add     ecx, eax
.text:42CF376C                 mov     dword ptr [ebp+arg_C], ecx
.text:42CF376F                 mov     edx, [ebp+var_4]
.text:42CF3772                 mov     eax, dword ptr [ebp+arg_C]
.text:42CF3775                 mov     [edx+5Ch], eax
.text:42CF3778                 mov     ecx, [ebp+var_4]
.text:42CF377B                 cmp     dword ptr [ecx+44h], 0
.text:42CF377F                 jnz     short loc_42CF3800
.text:42CF3781                 mov     edx, dword ptr [ebp+arg_C]
.text:42CF3784                 add     edx, Size
.text:42CF378A                 add     edx, dword_42D01CA4
.text:42CF3790                 mov     [ebp+var_28], edx
.text:42CF3793                 mov     eax, [ebp+var_28]
.text:42CF3796                 shl     eax, 1
.text:42CF3798                 push    eax
.text:42CF3799                 mov     ecx, [ebp+var_4]
.text:42CF379C                 mov     edx, [ecx+74h]
.text:42CF379F                 push    edx
.text:42CF37A0                 mov     eax, [ebp+var_4]
.text:42CF37A3                 call    dword ptr [eax+78h]
.text:42CF37A6                 add     esp, 8
.text:42CF37A9                 mov     ecx, [ebp+var_4]
.text:42CF37AC                 mov     [ecx+44h], eax
.text:42CF37AF                 mov     edx, [ebp+var_4]
.text:42CF37B2                 cmp     dword ptr [edx+44h], 0
.text:42CF37B6                 jnz     short loc_42CF37C6
.text:42CF37B8                 mov     eax, [ebp+arg_14]
.text:42CF37BB                 mov     dword ptr [eax], 1
.text:42CF37C1                 jmp     loc_42CF3BF5
.text:42CF37C6 ; ---------------------------------------------------------------------------
.text:42CF37C6
.text:42CF37C6 loc_42CF37C6:                           ; CODE XREF: ConnectionRead+13E\u2191j
.text:42CF37C6                 mov     ecx, [ebp+var_28]
.text:42CF37C9                 push    ecx
.text:42CF37CA                 mov     edx, [ebp+var_4]
.text:42CF37CD                 mov     eax, [edx+74h]
.text:42CF37D0                 push    eax
.text:42CF37D1                 mov     ecx, [ebp+var_4]
.text:42CF37D4                 call    dword ptr [ecx+78h]
.text:42CF37D7                 add     esp, 8
.text:42CF37DA                 mov     edx, [ebp+var_4]
.text:42CF37DD                 mov     [edx+4Ch], eax
.text:42CF37E0                 mov     eax, [ebp+var_4]
.text:42CF37E3                 cmp     dword ptr [eax+4Ch], 0
.text:42CF37E7                 jnz     short loc_42CF37F7
.text:42CF37E9                 mov     ecx, [ebp+arg_14]
.text:42CF37EC                 mov     dword ptr [ecx], 1
.text:42CF37F2                 jmp     loc_42CF3BF5
.text:42CF37F7 ; ---------------------------------------------------------------------------
.text:42CF37F7
.text:42CF37F7 loc_42CF37F7:                           ; CODE XREF: ConnectionRead+16F\u2191j
.text:42CF37F7                 mov     edx, [ebp+var_4]
.text:42CF37FA                 mov     eax, dword ptr [ebp+arg_C]
.text:42CF37FD                 mov     [edx+48h], eax
.text:42CF3800
.text:42CF3800 loc_42CF3800:                           ; CODE XREF: ConnectionRead+107\u2191j
.text:42CF3800                 mov     ecx, [ebp+var_4]
.text:42CF3803                 mov     edx, [ecx+48h]
.text:42CF3806                 cmp     edx, dword ptr [ebp+arg_C]
.text:42CF3809                 jnb     loc_42CF391F
.text:42CF380F                 mov     eax, dword ptr [ebp+arg_C]
.text:42CF3812                 add     eax, Size
.text:42CF3818                 add     eax, dword_42D01CA4
.text:42CF381E                 mov     [ebp+var_30], eax
.text:42CF3821                 mov     ecx, [ebp+var_4]
.text:42CF3824                 cmp     dword ptr [ecx+60h], 0
.text:42CF3828                 jle     short loc_42CF386B
.text:42CF382A                 mov     edx, [ebp+var_4]
.text:42CF382D                 mov     eax, [edx+60h]
.text:42CF3830                 push    eax             ; Size
.text:42CF3831                 call    ds:malloc
.text:42CF3837                 add     esp, 4
.text:42CF383A                 mov     [ebp+Src], eax
.text:42CF383D                 cmp     [ebp+Src], 0
.text:42CF3841                 jnz     short loc_42CF3851
.text:42CF3843                 mov     ecx, [ebp+arg_14]
.text:42CF3846                 mov     dword ptr [ecx], 1
.text:42CF384C                 jmp     loc_42CF3BF5
.text:42CF3851 ; ---------------------------------------------------------------------------
.text:42CF3851
.text:42CF3851 loc_42CF3851:                           ; CODE XREF: ConnectionRead+1C9\u2191j
.text:42CF3851                 mov     edx, [ebp+var_4]
.text:42CF3854                 mov     eax, [edx+60h]
.text:42CF3857                 push    eax             ; Size
.text:42CF3858                 mov     ecx, [ebp+var_4]
.text:42CF385B                 mov     edx, [ecx+44h]
.text:42CF385E                 push    edx             ; Src
.text:42CF385F                 mov     eax, [ebp+Src]
.text:42CF3862                 push    eax             ; void *
.text:42CF3863                 call    memcpy
.text:42CF3868                 add     esp, 0Ch
.text:42CF386B
.text:42CF386B loc_42CF386B:                           ; CODE XREF: ConnectionRead+1B0\u2191j
.text:42CF386B                 mov     ecx, [ebp+var_4]
.text:42CF386E                 mov     edx, [ecx+44h]
.text:42CF3871                 push    edx
.text:42CF3872                 mov     eax, [ebp+var_4]
.text:42CF3875                 mov     ecx, [eax+74h]
.text:42CF3878                 push    ecx
.text:42CF3879                 mov     edx, [ebp+var_4]
.text:42CF387C                 call    dword ptr [edx+7Ch]
.text:42CF387F                 add     esp, 8
.text:42CF3882                 mov     eax, [ebp+var_30]
.text:42CF3885                 shl     eax, 1
.text:42CF3887                 push    eax
.text:42CF3888                 mov     ecx, [ebp+var_4]
.text:42CF388B                 mov     edx, [ecx+74h]
.text:42CF388E                 push    edx
.text:42CF388F                 mov     eax, [ebp+var_4]
.text:42CF3892                 call    dword ptr [eax+78h]
.text:42CF3895                 add     esp, 8
.text:42CF3898                 mov     ecx, [ebp+var_4]
.text:42CF389B                 mov     [ecx+44h], eax
.text:42CF389E                 mov     edx, [ebp+var_4]
.text:42CF38A1                 cmp     dword ptr [edx+44h], 0
.text:42CF38A5                 jnz     short loc_42CF38B5
.text:42CF38A7                 mov     eax, [ebp+arg_14]
.text:42CF38AA                 mov     dword ptr [eax], 1
.text:42CF38B0                 jmp     loc_42CF3BF5
.text:42CF38B5 ; ---------------------------------------------------------------------------
.text:42CF38B5
.text:42CF38B5 loc_42CF38B5:                           ; CODE XREF: ConnectionRead+22D\u2191j
.text:42CF38B5                 mov     ecx, [ebp+var_4]
.text:42CF38B8                 cmp     dword ptr [ecx+60h], 0
.text:42CF38BC                 jle     short loc_42CF38E5
.text:42CF38BE                 mov     edx, [ebp+var_4]
.text:42CF38C1                 mov     eax, [edx+60h]
.text:42CF38C4                 push    eax             ; Size
.text:42CF38C5                 mov     ecx, [ebp+Src]
.text:42CF38C8                 push    ecx             ; Src
.text:42CF38C9                 mov     edx, [ebp+var_4]
.text:42CF38CC                 mov     eax, [edx+44h]
.text:42CF38CF                 push    eax             ; void *
.text:42CF38D0                 call    memcpy
.text:42CF38D5                 add     esp, 0Ch
.text:42CF38D8                 mov     ecx, [ebp+Src]
.text:42CF38DB                 push    ecx             ; Block
.text:42CF38DC                 call    ds:free
.text:42CF38E2                 add     esp, 4
.text:42CF38E5
.text:42CF38E5 loc_42CF38E5:                           ; CODE XREF: ConnectionRead+244\u2191j
.text:42CF38E5                 mov     edx, [ebp+var_30]
.text:42CF38E8                 push    edx
.text:42CF38E9                 mov     eax, [ebp+var_4]
.text:42CF38EC                 mov     ecx, [eax+74h]
.text:42CF38EF                 push    ecx
.text:42CF38F0                 mov     edx, [ebp+var_4]
.text:42CF38F3                 call    dword ptr [edx+78h]
.text:42CF38F6                 add     esp, 8
.text:42CF38F9                 mov     ecx, [ebp+var_4]
.text:42CF38FC                 mov     [ecx+4Ch], eax
.text:42CF38FF                 mov     edx, [ebp+var_4]
.text:42CF3902                 cmp     dword ptr [edx+4Ch], 0
.text:42CF3906                 jnz     short loc_42CF3916
.text:42CF3908                 mov     eax, [ebp+arg_14]
.text:42CF390B                 mov     dword ptr [eax], 1
.text:42CF3911                 jmp     loc_42CF3BF5
.text:42CF3916 ; ---------------------------------------------------------------------------
.text:42CF3916
.text:42CF3916 loc_42CF3916:                           ; CODE XREF: ConnectionRead+28E\u2191j
.text:42CF3916                 mov     ecx, [ebp+var_4]
.text:42CF3919                 mov     edx, dword ptr [ebp+arg_C]
.text:42CF391C                 mov     [ecx+48h], edx
.text:42CF391F
.text:42CF391F loc_42CF391F:                           ; CODE XREF: ConnectionRead+191\u2191j
.text:42CF391F                 mov     eax, [ebp+var_4]
.text:42CF3922                 mov     ecx, [eax+44h]
.text:42CF3925                 mov     [ebp+var_14], ecx
.text:42CF3928                 jmp     short loc_42CF3940
.text:42CF392A ; ---------------------------------------------------------------------------
.text:42CF392A
.text:42CF392A loc_42CF392A:                           ; CODE XREF: ConnectionRead+AD\u2191j
.text:42CF392A                                         ; ConnectionRead+BA\u2191j ...
.text:42CF392A                 mov     edx, dword ptr [ebp+arg_8]
.text:42CF392D                 mov     [ebp+var_20], edx
.text:42CF3930                 mov     eax, [ebp+var_4]
.text:42CF3933                 mov     dword ptr [eax+60h], 0
.text:42CF393A                 mov     ecx, [ebp+arg_4]
.text:42CF393D                 mov     [ebp+var_14], ecx
.text:42CF3940
.text:42CF3940 loc_42CF3940:                           ; CODE XREF: ConnectionRead+2B0\u2191j
.text:42CF3940                 mov     edx, [ebp+var_4]
.text:42CF3943                 cmp     dword ptr [edx+80h], 0
.text:42CF394A                 jnz     loc_42CF3A0A
.text:42CF3950
.text:42CF3950 loc_42CF3950:                           ; CODE XREF: ConnectionRead:loc_42CF3A03\u2193j
.text:42CF3950                 mov     eax, [ebp+var_4]
.text:42CF3953                 mov     ecx, [ebp+var_24]
.text:42CF3956                 add     ecx, [eax+60h]
.text:42CF3959                 cmp     ecx, [ebp+var_20]
.text:42CF395C                 jge     loc_42CF3A08
.text:42CF3962                 mov     edx, [ebp+flags]
.text:42CF3965                 push    edx             ; flags
.text:42CF3966                 mov     eax, dword ptr [ebp+arg_C]
.text:42CF3969                 sub     eax, [ebp+var_24]
.text:42CF396C                 push    eax             ; len
.text:42CF396D                 mov     ecx, [ebp+var_4]
.text:42CF3970                 mov     edx, [ebp+var_14]
.text:42CF3973                 add     edx, [ecx+60h]
.text:42CF3976                 add     edx, [ebp+var_24]
.text:42CF3979                 push    edx             ; buf
.text:42CF397A                 mov     eax, [ebp+var_4]
.text:42CF397D                 mov     ecx, [eax+0Ch]
.text:42CF3980                 push    ecx             ; s
.text:42CF3981                 call    ds:recv
.text:42CF3987                 mov     [ebp+var_1C], eax
.text:42CF398A                 cmp     [ebp+var_1C], 0FFFFFFFFh
.text:42CF398E                 jnz     short loc_42CF39C2
.text:42CF3990                 call    ds:WSAGetLastError
.text:42CF3996                 mov     edx, [ebp+arg_14]
.text:42CF3999                 mov     [edx], eax
.text:42CF399B                 mov     eax, [ebp+arg_14]
.text:42CF399E                 cmp     dword ptr [eax], 274Ch
.text:42CF39A4                 jnz     short loc_42CF39BD
.text:42CF39A6                 cmp     dword ptr [ebp+arg_10], 0FFFFh
.text:42CF39AD                 jz      short loc_42CF39B8
.text:42CF39AF                 mov     ecx, [ebp+arg_14]
.text:42CF39B2                 mov     dword ptr [ecx], 0FFFFFFFEh
.text:42CF39B8
.text:42CF39B8 loc_42CF39B8:                           ; CODE XREF: ConnectionRead+335\u2191j
.text:42CF39B8                 jmp     loc_42CF3BF5
.text:42CF39BD ; ---------------------------------------------------------------------------
.text:42CF39BD
.text:42CF39BD loc_42CF39BD:                           ; CODE XREF: ConnectionRead+32C\u2191j
.text:42CF39BD                 jmp     loc_42CF3BF5
.text:42CF39C2 ; ---------------------------------------------------------------------------
.text:42CF39C2
.text:42CF39C2 loc_42CF39C2:                           ; CODE XREF: ConnectionRead+316\u2191j
.text:42CF39C2                 cmp     [ebp+var_1C], 0
.text:42CF39C6                 jnz     short loc_42CF39E4
.text:42CF39C8                 mov     edx, [ebp+var_4]
.text:42CF39CB                 mov     eax, [ebp+var_24]
.text:42CF39CE                 add     eax, [edx+60h]
.text:42CF39D1                 cmp     eax, [ebp+var_20]
.text:42CF39D4                 jge     short loc_42CF39E4
.text:42CF39D6                 mov     ecx, [ebp+arg_14]
.text:42CF39D9                 mov     dword ptr [ecx], 0Bh
.text:42CF39DF                 jmp     loc_42CF3BF5
.text:42CF39E4 ; ---------------------------------------------------------------------------
.text:42CF39E4
.text:42CF39E4 loc_42CF39E4:                           ; CODE XREF: ConnectionRead+34E\u2191j
.text:42CF39E4                                         ; ConnectionRead+35C\u2191j
.text:42CF39E4                 mov     edx, [ebp+var_24]
.text:42CF39E7                 add     edx, [ebp+var_1C]
.text:42CF39EA                 mov     [ebp+var_24], edx
.text:42CF39ED                 cmp     [ebp+var_24], 0
.text:42CF39F1                 ja      short loc_42CF3A03
.text:42CF39F3                 call    ds:WSAGetLastError
.text:42CF39F9                 mov     ecx, [ebp+arg_14]
.text:42CF39FC                 mov     [ecx], eax
.text:42CF39FE                 jmp     loc_42CF3BF5
.text:42CF3A03 ; ---------------------------------------------------------------------------
.text:42CF3A03
.text:42CF3A03 loc_42CF3A03:                           ; CODE XREF: ConnectionRead+379\u2191j
.text:42CF3A03                 jmp     loc_42CF3950
.text:42CF3A08 ; ---------------------------------------------------------------------------
.text:42CF3A08
.text:42CF3A08 loc_42CF3A08:                           ; CODE XREF: ConnectionRead+2E4\u2191j
.text:42CF3A08                 jmp     short loc_42CF3A44
.text:42CF3A0A ; ---------------------------------------------------------------------------
.text:42CF3A0A
.text:42CF3A0A loc_42CF3A0A:                           ; CODE XREF: ConnectionRead+2D2\u2191j
.text:42CF3A0A                 lea     edx, [ebp+var_34]
.text:42CF3A0D                 push    edx
.text:42CF3A0E                 mov     eax, dword ptr [ebp+arg_10]
.text:42CF3A11                 push    eax
.text:42CF3A12                 mov     ecx, dword ptr [ebp+arg_C]
.text:42CF3A15                 push    ecx
.text:42CF3A16                 push    1
.text:42CF3A18                 mov     edx, [ebp+var_4]
.text:42CF3A1B                 mov     eax, [ebp+var_14]
.text:42CF3A1E                 add     eax, [edx+60h]
.text:42CF3A21                 push    eax
.text:42CF3A22                 mov     ecx, [ebp+var_4]
.text:42CF3A25                 push    ecx
.text:42CF3A26                 call    sub_42CF63E6
.text:42CF3A2B                 add     esp, 18h
.text:42CF3A2E                 mov     [ebp+var_24], eax
.text:42CF3A31                 cmp     [ebp+var_24], 0
.text:42CF3A35                 ja      short loc_42CF3A44
.text:42CF3A37                 mov     edx, [ebp+arg_14]
.text:42CF3A3A                 mov     eax, [ebp+var_34]
.text:42CF3A3D                 mov     [edx], eax
.text:42CF3A3F                 jmp     loc_42CF3BF5
.text:42CF3A44 ; ---------------------------------------------------------------------------
.text:42CF3A44
.text:42CF3A44 loc_42CF3A44:                           ; CODE XREF: ConnectionRead:loc_42CF3A08\u2191j
.text:42CF3A44                                         ; ConnectionRead+3BD\u2191j
.text:42CF3A44                 mov     ecx, [ebp+var_4]
.text:42CF3A47                 cmp     dword ptr [ecx+64h], 0
.text:42CF3A4B                 jnz     short loc_42CF3A67
.text:42CF3A4D                 mov     edx, [ebp+var_4]
.text:42CF3A50                 cmp     dword ptr [edx+68h], 0
.text:42CF3A54                 jz      loc_42CF3BF0
.text:42CF3A5A                 mov     eax, [ebp+var_4]
.text:42CF3A5D                 cmp     dword ptr [eax+6Ch], 0
.text:42CF3A61                 jz      loc_42CF3BF0
.text:42CF3A67
.text:42CF3A67 loc_42CF3A67:                           ; CODE XREF: ConnectionRead+3D3\u2191j
.text:42CF3A67                 mov     ecx, [ebp+var_4]
.text:42CF3A6A                 cmp     dword ptr [ecx+0A0h], 0
.text:42CF3A71                 jz      loc_42CF3BF0
.text:42CF3A77                 mov     [ebp+var_38], 0
.text:42CF3A7E                 mov     edx, [ebp+var_24]
.text:42CF3A81                 mov     [ebp+var_1C], edx
.text:42CF3A84                 mov     eax, [ebp+var_4]
.text:42CF3A87                 mov     dword ptr [eax+6Ch], 0
.text:42CF3A8E
.text:42CF3A8E loc_42CF3A8E:                           ; CODE XREF: ConnectionRead+553\u2193j
.text:42CF3A8E                 mov     ecx, [ebp+var_4]
.text:42CF3A91                 mov     edx, [ebp+var_1C]
.text:42CF3A94                 add     edx, [ecx+60h]
.text:42CF3A97                 mov     [ebp+var_1C], edx
.text:42CF3A9A                 mov     eax, [ebp+var_4]
.text:42CF3A9D                 mov     ecx, [eax+58h]
.text:42CF3AA0                 push    ecx
.text:42CF3AA1                 mov     edx, [eax+54h]
.text:42CF3AA4                 push    edx             ; char
.text:42CF3AA5                 mov     eax, [ebp+var_4]
.text:42CF3AA8                 add     eax, 60h ; '`'
.text:42CF3AAB                 push    eax             ; int
.text:42CF3AAC                 lea     ecx, [ebp+var_1C]
.text:42CF3AAF                 push    ecx             ; int
.text:42CF3AB0                 mov     edx, [ebp+arg_4]
.text:42CF3AB3                 push    edx             ; void *
.text:42CF3AB4                 mov     eax, [ebp+var_4]
.text:42CF3AB7                 mov     ecx, [eax+44h]
.text:42CF3ABA                 push    ecx             ; void *
.text:42CF3ABB                 call    sub_42CF7BBF
.text:42CF3AC0                 add     esp, 18h
.text:42CF3AC3                 mov     [ebp+var_10], eax
.text:42CF3AC6                 cmp     [ebp+var_10], 0
.text:42CF3ACA                 jnz     short loc_42CF3AE4
.text:42CF3ACC                 mov     edx, [ebp+var_38]
.text:42CF3ACF                 add     edx, [ebp+var_1C]
.text:42CF3AD2                 mov     [ebp+var_38], edx
.text:42CF3AD5                 mov     eax, [ebp+var_4]
.text:42CF3AD8                 mov     dword ptr [eax+60h], 0
.text:42CF3ADF                 jmp     loc_42CF3BEA
.text:42CF3AE4 ; ---------------------------------------------------------------------------
.text:42CF3AE4
.text:42CF3AE4 loc_42CF3AE4:                           ; CODE XREF: ConnectionRead+452\u2191j
.text:42CF3AE4                 cmp     [ebp+var_10], 80090318h
.text:42CF3AEB                 jnz     loc_42CF3BD2
.text:42CF3AF1                 mov     ecx, [ebp+var_38]
.text:42CF3AF4                 add     ecx, [ebp+var_1C]
.text:42CF3AF7                 mov     [ebp+var_38], ecx
.text:42CF3AFA                 mov     edx, [ebp+var_38]
.text:42CF3AFD                 cmp     edx, dword ptr [ebp+arg_8]
.text:42CF3B00                 jnb     loc_42CF3BD0
.text:42CF3B06                 mov     eax, [ebp+var_4]
.text:42CF3B09                 cmp     dword ptr [eax+80h], 0
.text:42CF3B10                 jnz     short loc_42CF3B74
.text:42CF3B12                 mov     ecx, [ebp+flags]
.text:42CF3B15                 push    ecx             ; flags
.text:42CF3B16                 mov     edx, dword ptr [ebp+arg_C]
.text:42CF3B19                 sub     edx, [ebp+var_24]
.text:42CF3B1C                 push    edx             ; len
.text:42CF3B1D                 mov     eax, [ebp+var_4]
.text:42CF3B20                 mov     ecx, [eax+44h]
.text:42CF3B23                 mov     edx, [ebp+var_4]
.text:42CF3B26                 add     ecx, [edx+60h]
.text:42CF3B29                 push    ecx             ; buf
.text:42CF3B2A                 mov     eax, [ebp+var_4]
.text:42CF3B2D                 mov     ecx, [eax+0Ch]
.text:42CF3B30                 push    ecx             ; s
.text:42CF3B31                 call    ds:recv
.text:42CF3B37                 mov     [ebp+var_1C], eax
.text:42CF3B3A                 cmp     [ebp+var_1C], 0FFFFFFFFh
.text:42CF3B3E                 jnz     short loc_42CF3B72
.text:42CF3B40                 call    ds:WSAGetLastError
.text:42CF3B46                 mov     edx, [ebp+arg_14]
.text:42CF3B49                 mov     [edx], eax
.text:42CF3B4B                 mov     eax, [ebp+arg_14]
.text:42CF3B4E                 cmp     dword ptr [eax], 274Ch
.text:42CF3B54                 jnz     short loc_42CF3B6D
.text:42CF3B56                 cmp     dword ptr [ebp+arg_10], 0FFFFh
.text:42CF3B5D                 jz      short loc_42CF3B68
.text:42CF3B5F                 mov     ecx, [ebp+arg_14]
.text:42CF3B62                 mov     dword ptr [ecx], 0FFFFFFFEh
.text:42CF3B68
.text:42CF3B68 loc_42CF3B68:                           ; CODE XREF: ConnectionRead+4E5\u2191j
.text:42CF3B68                 jmp     loc_42CF3BF5
.text:42CF3B6D ; ---------------------------------------------------------------------------
.text:42CF3B6D
.text:42CF3B6D loc_42CF3B6D:                           ; CODE XREF: ConnectionRead+4DC\u2191j
.text:42CF3B6D                 jmp     loc_42CF3BF5
.text:42CF3B72 ; ---------------------------------------------------------------------------
.text:42CF3B72
.text:42CF3B72 loc_42CF3B72:                           ; CODE XREF: ConnectionRead+4C6\u2191j
.text:42CF3B72                 jmp     short loc_42CF3BB1
.text:42CF3B74 ; ---------------------------------------------------------------------------
.text:42CF3B74
.text:42CF3B74 loc_42CF3B74:                           ; CODE XREF: ConnectionRead+498\u2191j
.text:42CF3B74                 lea     edx, [ebp+var_3C]
.text:42CF3B77                 push    edx
.text:42CF3B78                 mov     eax, dword ptr [ebp+arg_10]
.text:42CF3B7B                 push    eax
.text:42CF3B7C                 mov     ecx, dword ptr [ebp+arg_C]
.text:42CF3B7F                 sub     ecx, [ebp+var_24]
.text:42CF3B82                 push    ecx
.text:42CF3B83                 push    1
.text:42CF3B85                 mov     edx, [ebp+var_4]
.text:42CF3B88                 mov     eax, [edx+44h]
.text:42CF3B8B                 mov     ecx, [ebp+var_4]
.text:42CF3B8E                 add     eax, [ecx+60h]
.text:42CF3B91                 push    eax
.text:42CF3B92                 mov     edx, [ebp+var_4]
.text:42CF3B95                 push    edx
.text:42CF3B96                 call    sub_42CF63E6
.text:42CF3B9B                 add     esp, 18h
.text:42CF3B9E                 mov     [ebp+var_1C], eax
.text:42CF3BA1                 cmp     [ebp+var_1C], 0
.text:42CF3BA5                 jnz     short loc_42CF3BB1
.text:42CF3BA7                 mov     eax, [ebp+arg_14]
.text:42CF3BAA                 mov     ecx, [ebp+var_3C]
.text:42CF3BAD                 mov     [eax], ecx
.text:42CF3BAF                 jmp     short loc_42CF3BF5
.text:42CF3BB1 ; ---------------------------------------------------------------------------
.text:42CF3BB1
.text:42CF3BB1 loc_42CF3BB1:                           ; CODE XREF: ConnectionRead:loc_42CF3B72\u2191j
.text:42CF3BB1                                         ; ConnectionRead+52D\u2191j
.text:42CF3BB1                 cmp     [ebp+var_1C], 0
.text:42CF3BB5                 jnz     short loc_42CF3BC2
.text:42CF3BB7                 mov     edx, [ebp+arg_14]
.text:42CF3BBA                 mov     dword ptr [edx], 0Bh
.text:42CF3BC0                 jmp     short loc_42CF3BF5
.text:42CF3BC2 ; ---------------------------------------------------------------------------
.text:42CF3BC2
.text:42CF3BC2 loc_42CF3BC2:                           ; CODE XREF: ConnectionRead+53D\u2191j
.text:42CF3BC2                 mov     eax, [ebp+var_24]
.text:42CF3BC5                 add     eax, [ebp+var_1C]
.text:42CF3BC8                 mov     [ebp+var_24], eax
.text:42CF3BCB                 jmp     loc_42CF3A8E
.text:42CF3BD0 ; ---------------------------------------------------------------------------
.text:42CF3BD0
.text:42CF3BD0 loc_42CF3BD0:                           ; CODE XREF: ConnectionRead+488\u2191j
.text:42CF3BD0                 jmp     short loc_42CF3BEA
.text:42CF3BD2 ; ---------------------------------------------------------------------------
.text:42CF3BD2
.text:42CF3BD2 loc_42CF3BD2:                           ; CODE XREF: ConnectionRead+473\u2191j
.text:42CF3BD2                 mov     [ebp+var_18], offset aSecdecryptdata ; "SECDecryptData"
.text:42CF3BD9                 mov     [ebp+var_38], 0
.text:42CF3BE0                 mov     ecx, [ebp+arg_14]
.text:42CF3BE3                 mov     edx, [ebp+var_10]
.text:42CF3BE6                 mov     [ecx], edx
.text:42CF3BE8                 jmp     short loc_42CF3BF5
.text:42CF3BEA ; ---------------------------------------------------------------------------
.text:42CF3BEA
.text:42CF3BEA loc_42CF3BEA:                           ; CODE XREF: ConnectionRead+467\u2191j
.text:42CF3BEA                                         ; ConnectionRead:loc_42CF3BD0\u2191j
.text:42CF3BEA                 mov     eax, [ebp+var_38]
.text:42CF3BED                 mov     [ebp+var_24], eax
.text:42CF3BF0
.text:42CF3BF0 loc_42CF3BF0:                           ; CODE XREF: ConnectionRead+3DC\u2191j
.text:42CF3BF0                                         ; ConnectionRead+3E9\u2191j ...
.text:42CF3BF0                 mov     eax, [ebp+var_24]
.text:42CF3BF3                 jmp     short loc_42CF3BF7
.text:42CF3BF5 ; ---------------------------------------------------------------------------
.text:42CF3BF5
.text:42CF3BF5 loc_42CF3BF5:                           ; CODE XREF: ConnectionRead+3B\u2191j
.text:42CF3BF5                                         ; ConnectionRead+98\u2191j ...
.text:42CF3BF5                 xor     eax, eax
.text:42CF3BF7
.text:42CF3BF7 loc_42CF3BF7:                           ; CODE XREF: ConnectionRead+57B\u2191j
.text:42CF3BF7                 mov     esp, ebp
.text:42CF3BF9                 pop     ebp
.text:42CF3BFA                 retn
.text:42CF3BFA ConnectionRead  endp
.text:42CF3BFA
.text:42CF3BFB ; Exported entry   7. ConnectionReadAsync
.text:42CF3BFB
.text:42CF3BFB ; =============== S U B R O U T I N E =======================================
.text:42CF3BFB
.text:42CF3BFB ; Attributes: bp-based frame
.text:42CF3BFB
.text:42CF3BFB                 public ConnectionReadAsync
.text:42CF3BFB ConnectionReadAsync proc near           ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF3BFB
.text:42CF3BFB var_30          = dword ptr -30h
.text:42CF3BFB var_2C          = dword ptr -2Ch
.text:42CF3BFB var_28          = dword ptr -28h
.text:42CF3BFB Src             = dword ptr -24h
.text:42CF3BFB var_20          = dword ptr -20h
.text:42CF3BFB NumberOfBytesRecvd= dword ptr -1Ch
.text:42CF3BFB Flags           = dword ptr -18h
.text:42CF3BFB var_14          = dword ptr -14h
.text:42CF3BFB Buffers         = _WSABUF ptr -10h
.text:42CF3BFB var_8           = dword ptr -8
.text:42CF3BFB var_4           = dword ptr -4
.text:42CF3BFB arg_0           = dword ptr  8
.text:42CF3BFB arg_4           = dword ptr  0Ch
.text:42CF3BFB arg_8           = dword ptr  10h
.text:42CF3BFB arg_C           = dword ptr  14h
.text:42CF3BFB arg_10          = dword ptr  18h
.text:42CF3BFB
.text:42CF3BFB                 push    ebp
.text:42CF3BFC                 mov     ebp, esp
.text:42CF3BFE                 sub     esp, 30h
.text:42CF3C01                 mov     eax, [ebp+arg_0]
.text:42CF3C04                 mov     [ebp+var_4], eax
.text:42CF3C07                 mov     [ebp+NumberOfBytesRecvd], 0
.text:42CF3C0E                 mov     [ebp+Flags], 0
.text:42CF3C15                 mov     ecx, [ebp+var_4]
.text:42CF3C18                 cmp     dword ptr [ecx+90h], 0
.text:42CF3C1F                 jz      short loc_42CF3C39
.text:42CF3C21                 push    0D08h
.text:42CF3C26                 push    offset aQSphinxNetlibs ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF3C2B                 push    offset aFalsePconnecti ; "FALSE == pConnectionObject->fReadFlag"
.text:42CF3C30                 call    ds:_assert
.text:42CF3C36 ; ---------------------------------------------------------------------------
.text:42CF3C36                 add     esp, 0Ch
.text:42CF3C39
.text:42CF3C39 loc_42CF3C39:                           ; CODE XREF: ConnectionReadAsync+24\u2191j
.text:42CF3C39                 mov     eax, [ebp+var_4]
.text:42CF3C3C                 mov     dword ptr [eax+90h], 1
.text:42CF3C46                 mov     ecx, [ebp+var_4]
.text:42CF3C49                 add     ecx, 8Ch ; 'Œ'
.text:42CF3C4F                 push    ecx             ; lpAddend
.text:42CF3C50                 call    ds:InterlockedIncrement
.text:42CF3C56                 mov     edx, [ebp+arg_10]
.text:42CF3C59                 mov     dword ptr [edx], 0
.text:42CF3C5F                 mov     eax, [ebp+arg_8]
.text:42CF3C62                 cmp     eax, [ebp+arg_C]
.text:42CF3C65                 jbe     short loc_42CF3C75
.text:42CF3C67                 mov     ecx, [ebp+arg_10]
.text:42CF3C6A                 mov     dword ptr [ecx], 0Bh
.text:42CF3C70                 jmp     loc_42CF3FCA
.text:42CF3C75 ; ---------------------------------------------------------------------------
.text:42CF3C75
.text:42CF3C75 loc_42CF3C75:                           ; CODE XREF: ConnectionReadAsync+6A\u2191j
.text:42CF3C75                 mov     edx, [ebp+var_4]
.text:42CF3C78                 cmp     dword ptr [edx+64h], 0
.text:42CF3C7C                 jnz     short loc_42CF3C98
.text:42CF3C7E                 mov     eax, [ebp+var_4]
.text:42CF3C81                 cmp     dword ptr [eax+68h], 0
.text:42CF3C85                 jz      loc_42CF3F30
.text:42CF3C8B                 mov     ecx, [ebp+var_4]
.text:42CF3C8E                 cmp     dword ptr [ecx+6Ch], 0
.text:42CF3C92                 jz      loc_42CF3F30
.text:42CF3C98
.text:42CF3C98 loc_42CF3C98:                           ; CODE XREF: ConnectionReadAsync+81\u2191j
.text:42CF3C98                 mov     edx, [ebp+var_4]
.text:42CF3C9B                 cmp     dword ptr [edx+0A0h], 0
.text:42CF3CA2                 jz      loc_42CF3F30
.text:42CF3CA8                 mov     eax, [ebp+var_4]
.text:42CF3CAB                 cmp     dword ptr [eax+44h], 0
.text:42CF3CAF                 jnz     short loc_42CF3D30
.text:42CF3CB1                 mov     ecx, [ebp+arg_C]
.text:42CF3CB4                 add     ecx, Size
.text:42CF3CBA                 add     ecx, dword_42D01CA4
.text:42CF3CC0                 mov     [ebp+var_20], ecx
.text:42CF3CC3                 mov     edx, [ebp+var_20]
.text:42CF3CC6                 shl     edx, 1
.text:42CF3CC8                 push    edx
.text:42CF3CC9                 mov     eax, [ebp+var_4]
.text:42CF3CCC                 mov     ecx, [eax+74h]
.text:42CF3CCF                 push    ecx
.text:42CF3CD0                 mov     edx, [ebp+var_4]
.text:42CF3CD3                 call    dword ptr [edx+78h]
.text:42CF3CD6                 add     esp, 8
.text:42CF3CD9                 mov     ecx, [ebp+var_4]
.text:42CF3CDC                 mov     [ecx+44h], eax
.text:42CF3CDF                 mov     edx, [ebp+var_4]
.text:42CF3CE2                 cmp     dword ptr [edx+44h], 0
.text:42CF3CE6                 jnz     short loc_42CF3CF6
.text:42CF3CE8                 mov     eax, [ebp+arg_10]
.text:42CF3CEB                 mov     dword ptr [eax], 1
.text:42CF3CF1                 jmp     loc_42CF3FCA
.text:42CF3CF6 ; ---------------------------------------------------------------------------
.text:42CF3CF6
.text:42CF3CF6 loc_42CF3CF6:                           ; CODE XREF: ConnectionReadAsync+EB\u2191j
.text:42CF3CF6                 mov     ecx, [ebp+var_20]
.text:42CF3CF9                 push    ecx
.text:42CF3CFA                 mov     edx, [ebp+var_4]
.text:42CF3CFD                 mov     eax, [edx+74h]
.text:42CF3D00                 push    eax
.text:42CF3D01                 mov     ecx, [ebp+var_4]
.text:42CF3D04                 call    dword ptr [ecx+78h]
.text:42CF3D07                 add     esp, 8
.text:42CF3D0A                 mov     edx, [ebp+var_4]
.text:42CF3D0D                 mov     [edx+4Ch], eax
.text:42CF3D10                 mov     eax, [ebp+var_4]
.text:42CF3D13                 cmp     dword ptr [eax+4Ch], 0
.text:42CF3D17                 jnz     short loc_42CF3D27
.text:42CF3D19                 mov     ecx, [ebp+arg_10]
.text:42CF3D1C                 mov     dword ptr [ecx], 1
.text:42CF3D22                 jmp     loc_42CF3FCA
.text:42CF3D27 ; ---------------------------------------------------------------------------
.text:42CF3D27
.text:42CF3D27 loc_42CF3D27:                           ; CODE XREF: ConnectionReadAsync+11C\u2191j
.text:42CF3D27                 mov     edx, [ebp+var_4]
.text:42CF3D2A                 mov     eax, [ebp+arg_C]
.text:42CF3D2D                 mov     [edx+48h], eax
.text:42CF3D30
.text:42CF3D30 loc_42CF3D30:                           ; CODE XREF: ConnectionReadAsync+B4\u2191j
.text:42CF3D30                 mov     ecx, [ebp+var_4]
.text:42CF3D33                 mov     edx, [ecx+48h]
.text:42CF3D36                 cmp     edx, [ebp+arg_C]
.text:42CF3D39                 jnb     loc_42CF3E4F
.text:42CF3D3F                 mov     eax, [ebp+arg_C]
.text:42CF3D42                 add     eax, Size
.text:42CF3D48                 add     eax, dword_42D01CA4
.text:42CF3D4E                 mov     [ebp+var_28], eax
.text:42CF3D51                 mov     ecx, [ebp+var_4]
.text:42CF3D54                 cmp     dword ptr [ecx+60h], 0
.text:42CF3D58                 jle     short loc_42CF3D9B
.text:42CF3D5A                 mov     edx, [ebp+var_4]
.text:42CF3D5D                 mov     eax, [edx+60h]
.text:42CF3D60                 push    eax             ; Size
.text:42CF3D61                 call    ds:malloc
.text:42CF3D67                 add     esp, 4
.text:42CF3D6A                 mov     [ebp+Src], eax
.text:42CF3D6D                 cmp     [ebp+Src], 0
.text:42CF3D71                 jnz     short loc_42CF3D81
.text:42CF3D73                 mov     ecx, [ebp+arg_10]
.text:42CF3D76                 mov     dword ptr [ecx], 1
.text:42CF3D7C                 jmp     loc_42CF3FCA
.text:42CF3D81 ; ---------------------------------------------------------------------------
.text:42CF3D81
.text:42CF3D81 loc_42CF3D81:                           ; CODE XREF: ConnectionReadAsync+176\u2191j
.text:42CF3D81                 mov     edx, [ebp+var_4]
.text:42CF3D84                 mov     eax, [edx+60h]
.text:42CF3D87                 push    eax             ; Size
.text:42CF3D88                 mov     ecx, [ebp+var_4]
.text:42CF3D8B                 mov     edx, [ecx+44h]
.text:42CF3D8E                 push    edx             ; Src
.text:42CF3D8F                 mov     eax, [ebp+Src]
.text:42CF3D92                 push    eax             ; void *
.text:42CF3D93                 call    memcpy
.text:42CF3D98                 add     esp, 0Ch
.text:42CF3D9B
.text:42CF3D9B loc_42CF3D9B:                           ; CODE XREF: ConnectionReadAsync+15D\u2191j
.text:42CF3D9B                 mov     ecx, [ebp+var_4]
.text:42CF3D9E                 mov     edx, [ecx+44h]
.text:42CF3DA1                 push    edx
.text:42CF3DA2                 mov     eax, [ebp+var_4]
.text:42CF3DA5                 mov     ecx, [eax+74h]
.text:42CF3DA8                 push    ecx
.text:42CF3DA9                 mov     edx, [ebp+var_4]
.text:42CF3DAC                 call    dword ptr [edx+7Ch]
.text:42CF3DAF                 add     esp, 8
.text:42CF3DB2                 mov     eax, [ebp+var_28]
.text:42CF3DB5                 shl     eax, 1
.text:42CF3DB7                 push    eax
.text:42CF3DB8                 mov     ecx, [ebp+var_4]
.text:42CF3DBB                 mov     edx, [ecx+74h]
.text:42CF3DBE                 push    edx
.text:42CF3DBF                 mov     eax, [ebp+var_4]
.text:42CF3DC2                 call    dword ptr [eax+78h]
.text:42CF3DC5                 add     esp, 8
.text:42CF3DC8                 mov     ecx, [ebp+var_4]
.text:42CF3DCB                 mov     [ecx+44h], eax
.text:42CF3DCE                 mov     edx, [ebp+var_4]
.text:42CF3DD1                 cmp     dword ptr [edx+44h], 0
.text:42CF3DD5                 jnz     short loc_42CF3DE5
.text:42CF3DD7                 mov     eax, [ebp+arg_10]
.text:42CF3DDA                 mov     dword ptr [eax], 1
.text:42CF3DE0                 jmp     loc_42CF3FCA
.text:42CF3DE5 ; ---------------------------------------------------------------------------
.text:42CF3DE5
.text:42CF3DE5 loc_42CF3DE5:                           ; CODE XREF: ConnectionReadAsync+1DA\u2191j
.text:42CF3DE5                 mov     ecx, [ebp+var_4]
.text:42CF3DE8                 cmp     dword ptr [ecx+60h], 0
.text:42CF3DEC                 jle     short loc_42CF3E15
.text:42CF3DEE                 mov     edx, [ebp+var_4]
.text:42CF3DF1                 mov     eax, [edx+60h]
.text:42CF3DF4                 push    eax             ; Size
.text:42CF3DF5                 mov     ecx, [ebp+Src]
.text:42CF3DF8                 push    ecx             ; Src
.text:42CF3DF9                 mov     edx, [ebp+var_4]
.text:42CF3DFC                 mov     eax, [edx+44h]
.text:42CF3DFF                 push    eax             ; void *
.text:42CF3E00                 call    memcpy
.text:42CF3E05                 add     esp, 0Ch
.text:42CF3E08                 mov     ecx, [ebp+Src]
.text:42CF3E0B                 push    ecx             ; Block
.text:42CF3E0C                 call    ds:free
.text:42CF3E12                 add     esp, 4
.text:42CF3E15
.text:42CF3E15 loc_42CF3E15:                           ; CODE XREF: ConnectionReadAsync+1F1\u2191j
.text:42CF3E15                 mov     edx, [ebp+var_28]
.text:42CF3E18                 push    edx
.text:42CF3E19                 mov     eax, [ebp+var_4]
.text:42CF3E1C                 mov     ecx, [eax+74h]
.text:42CF3E1F                 push    ecx
.text:42CF3E20                 mov     edx, [ebp+var_4]
.text:42CF3E23                 call    dword ptr [edx+78h]
.text:42CF3E26                 add     esp, 8
.text:42CF3E29                 mov     ecx, [ebp+var_4]
.text:42CF3E2C                 mov     [ecx+4Ch], eax
.text:42CF3E2F                 mov     edx, [ebp+var_4]
.text:42CF3E32                 cmp     dword ptr [edx+4Ch], 0
.text:42CF3E36                 jnz     short loc_42CF3E46
.text:42CF3E38                 mov     eax, [ebp+arg_10]
.text:42CF3E3B                 mov     dword ptr [eax], 1
.text:42CF3E41                 jmp     loc_42CF3FCA
.text:42CF3E46 ; ---------------------------------------------------------------------------
.text:42CF3E46
.text:42CF3E46 loc_42CF3E46:                           ; CODE XREF: ConnectionReadAsync+23B\u2191j
.text:42CF3E46                 mov     ecx, [ebp+var_4]
.text:42CF3E49                 mov     edx, [ebp+arg_C]
.text:42CF3E4C                 mov     [ecx+48h], edx
.text:42CF3E4F
.text:42CF3E4F loc_42CF3E4F:                           ; CODE XREF: ConnectionReadAsync+13E\u2191j
.text:42CF3E4F                 mov     eax, [ebp+var_4]
.text:42CF3E52                 mov     ecx, [ebp+arg_4]
.text:42CF3E55                 mov     [eax+50h], ecx
.text:42CF3E58                 mov     edx, Size
.text:42CF3E5E                 add     edx, dword_42D01CA4
.text:42CF3E64                 mov     eax, [ebp+arg_C]
.text:42CF3E67                 add     eax, edx
.text:42CF3E69                 mov     ecx, [ebp+var_4]
.text:42CF3E6C                 mov     [ecx+5Ch], eax
.text:42CF3E6F                 mov     edx, Size
.text:42CF3E75                 add     edx, dword_42D01CA4
.text:42CF3E7B                 mov     eax, [ebp+arg_8]
.text:42CF3E7E                 add     eax, edx
.text:42CF3E80                 mov     [ebp+arg_8], eax
.text:42CF3E83                 mov     ecx, [ebp+var_4]
.text:42CF3E86                 cmp     dword ptr [ecx+80h], 1
.text:42CF3E8D                 jnz     short loc_42CF3ECF
.text:42CF3E8F                 lea     edx, [ebp+var_2C]
.text:42CF3E92                 push    edx
.text:42CF3E93                 mov     eax, [ebp+var_4]
.text:42CF3E96                 mov     ecx, [eax+5Ch]
.text:42CF3E99                 push    ecx
.text:42CF3E9A                 mov     edx, [ebp+arg_8]
.text:42CF3E9D                 push    edx
.text:42CF3E9E                 mov     eax, [ebp+var_4]
.text:42CF3EA1                 mov     ecx, [eax+44h]
.text:42CF3EA4                 mov     edx, [ebp+var_4]
.text:42CF3EA7                 add     ecx, [edx+60h]
.text:42CF3EAA                 push    ecx
.text:42CF3EAB                 mov     eax, [ebp+var_4]
.text:42CF3EAE                 push    eax
.text:42CF3EAF                 call    sub_42CF6030
.text:42CF3EB4                 add     esp, 14h
.text:42CF3EB7                 mov     [ebp+var_14], eax
.text:42CF3EBA                 cmp     [ebp+var_14], 0
.text:42CF3EBE                 jnz     short loc_42CF3ECD
.text:42CF3EC0                 mov     ecx, [ebp+arg_10]
.text:42CF3EC3                 mov     edx, [ebp+var_2C]
.text:42CF3EC6                 mov     [ecx], edx
.text:42CF3EC8                 jmp     loc_42CF3FCA
.text:42CF3ECD ; ---------------------------------------------------------------------------
.text:42CF3ECD
.text:42CF3ECD loc_42CF3ECD:                           ; CODE XREF: ConnectionReadAsync+2C3\u2191j
.text:42CF3ECD                 jmp     short loc_42CF3F2B
.text:42CF3ECF ; ---------------------------------------------------------------------------
.text:42CF3ECF
.text:42CF3ECF loc_42CF3ECF:                           ; CODE XREF: ConnectionReadAsync+292\u2191j
.text:42CF3ECF                 mov     eax, [ebp+var_4]
.text:42CF3ED2                 mov     ecx, [eax+44h]
.text:42CF3ED5                 mov     edx, [ebp+var_4]
.text:42CF3ED8                 add     ecx, [edx+60h]
.text:42CF3EDB                 mov     [ebp+Buffers.buf], ecx
.text:42CF3EDE                 mov     eax, [ebp+var_4]
.text:42CF3EE1                 mov     ecx, [eax+5Ch]
.text:42CF3EE4                 mov     [ebp+Buffers.len], ecx
.text:42CF3EE7                 push    0               ; lpCompletionRoutine
.text:42CF3EE9                 mov     edx, [ebp+var_4]
.text:42CF3EEC                 add     edx, 24h ; '$'
.text:42CF3EEF                 push    edx             ; lpOverlapped
.text:42CF3EF0                 lea     eax, [ebp+Flags]
.text:42CF3EF3                 push    eax             ; lpFlags
.text:42CF3EF4                 lea     ecx, [ebp+NumberOfBytesRecvd]
.text:42CF3EF7                 push    ecx             ; lpNumberOfBytesRecvd
.text:42CF3EF8                 push    1               ; dwBufferCount
.text:42CF3EFA                 lea     edx, [ebp+Buffers]
.text:42CF3EFD                 push    edx             ; lpBuffers
.text:42CF3EFE                 mov     eax, [ebp+var_4]
.text:42CF3F01                 mov     ecx, [eax+0Ch]
.text:42CF3F04                 push    ecx             ; s
.text:42CF3F05                 call    ds:WSARecv
.text:42CF3F0B                 cmp     eax, 0FFFFFFFFh
.text:42CF3F0E                 jnz     short loc_42CF3F2B
.text:42CF3F10                 call    ds:WSAGetLastError
.text:42CF3F16                 mov     edx, [ebp+arg_10]
.text:42CF3F19                 mov     [edx], eax
.text:42CF3F1B                 mov     eax, [ebp+arg_10]
.text:42CF3F1E                 cmp     dword ptr [eax], 3E5h
.text:42CF3F24                 jz      short loc_42CF3F2B
.text:42CF3F26                 jmp     loc_42CF3FCA
.text:42CF3F2B ; ---------------------------------------------------------------------------
.text:42CF3F2B
.text:42CF3F2B loc_42CF3F2B:                           ; CODE XREF: ConnectionReadAsync:loc_42CF3ECD\u2191j
.text:42CF3F2B                                         ; ConnectionReadAsync+313\u2191j ...
.text:42CF3F2B                 jmp     loc_42CF3FC3
.text:42CF3F30 ; ---------------------------------------------------------------------------
.text:42CF3F30
.text:42CF3F30 loc_42CF3F30:                           ; CODE XREF: ConnectionReadAsync+8A\u2191j
.text:42CF3F30                                         ; ConnectionReadAsync+97\u2191j ...
.text:42CF3F30                 mov     ecx, [ebp+var_4]
.text:42CF3F33                 mov     edx, [ebp+arg_4]
.text:42CF3F36                 mov     [ecx+50h], edx
.text:42CF3F39                 mov     eax, [ebp+var_4]
.text:42CF3F3C                 cmp     dword ptr [eax+80h], 1
.text:42CF3F43                 jnz     short loc_42CF3F76
.text:42CF3F45                 lea     ecx, [ebp+var_30]
.text:42CF3F48                 push    ecx
.text:42CF3F49                 mov     edx, [ebp+arg_C]
.text:42CF3F4C                 push    edx
.text:42CF3F4D                 mov     eax, [ebp+arg_8]
.text:42CF3F50                 push    eax
.text:42CF3F51                 mov     ecx, [ebp+arg_4]
.text:42CF3F54                 push    ecx
.text:42CF3F55                 mov     edx, [ebp+var_4]
.text:42CF3F58                 push    edx
.text:42CF3F59                 call    sub_42CF6030
.text:42CF3F5E                 add     esp, 14h
.text:42CF3F61                 mov     [ebp+var_14], eax
.text:42CF3F64                 cmp     [ebp+var_14], 0
.text:42CF3F68                 jnz     short loc_42CF3F74
.text:42CF3F6A                 mov     eax, [ebp+arg_10]
.text:42CF3F6D                 mov     ecx, [ebp+var_30]
.text:42CF3F70                 mov     [eax], ecx
.text:42CF3F72                 jmp     short loc_42CF3FCA
.text:42CF3F74 ; ---------------------------------------------------------------------------
.text:42CF3F74
.text:42CF3F74 loc_42CF3F74:                           ; CODE XREF: ConnectionReadAsync+36D\u2191j
.text:42CF3F74                 jmp     short loc_42CF3FC3
.text:42CF3F76 ; ---------------------------------------------------------------------------
.text:42CF3F76
.text:42CF3F76 loc_42CF3F76:                           ; CODE XREF: ConnectionReadAsync+348\u2191j
.text:42CF3F76                 mov     edx, [ebp+arg_4]
.text:42CF3F79                 mov     [ebp+Buffers.buf], edx
.text:42CF3F7C                 mov     eax, [ebp+arg_C]
.text:42CF3F7F                 mov     [ebp+Buffers.len], eax
.text:42CF3F82                 push    0               ; lpCompletionRoutine
.text:42CF3F84                 mov     ecx, [ebp+var_4]
.text:42CF3F87                 add     ecx, 24h ; '$'
.text:42CF3F8A                 push    ecx             ; lpOverlapped
.text:42CF3F8B                 lea     edx, [ebp+Flags]
.text:42CF3F8E                 push    edx             ; lpFlags
.text:42CF3F8F                 lea     eax, [ebp+NumberOfBytesRecvd]
.text:42CF3F92                 push    eax             ; lpNumberOfBytesRecvd
.text:42CF3F93                 push    1               ; dwBufferCount
.text:42CF3F95                 lea     ecx, [ebp+Buffers]
.text:42CF3F98                 push    ecx             ; lpBuffers
.text:42CF3F99                 mov     edx, [ebp+var_4]
.text:42CF3F9C                 mov     eax, [edx+0Ch]
.text:42CF3F9F                 push    eax             ; s
.text:42CF3FA0                 call    ds:WSARecv
.text:42CF3FA6                 cmp     eax, 0FFFFFFFFh
.text:42CF3FA9                 jnz     short loc_42CF3FC3
.text:42CF3FAB                 call    ds:WSAGetLastError
.text:42CF3FB1                 mov     ecx, [ebp+arg_10]
.text:42CF3FB4                 mov     [ecx], eax
.text:42CF3FB6                 mov     edx, [ebp+arg_10]
.text:42CF3FB9                 cmp     dword ptr [edx], 3E5h
.text:42CF3FBF                 jz      short loc_42CF3FC3
.text:42CF3FC1                 jmp     short loc_42CF3FCA
.text:42CF3FC3 ; ---------------------------------------------------------------------------
.text:42CF3FC3
.text:42CF3FC3 loc_42CF3FC3:                           ; CODE XREF: ConnectionReadAsync:loc_42CF3F2B\u2191j
.text:42CF3FC3                                         ; ConnectionReadAsync:loc_42CF3F74\u2191j ...
.text:42CF3FC3                 mov     eax, 1
.text:42CF3FC8                 jmp     short loc_42CF400A
.text:42CF3FCA ; ---------------------------------------------------------------------------
.text:42CF3FCA
.text:42CF3FCA loc_42CF3FCA:                           ; CODE XREF: ConnectionReadAsync+75\u2191j
.text:42CF3FCA                                         ; ConnectionReadAsync+F6\u2191j ...
.text:42CF3FCA                 mov     eax, [ebp+var_4]
.text:42CF3FCD                 mov     dword ptr [eax+90h], 0
.text:42CF3FD7                 mov     ecx, [ebp+var_4]
.text:42CF3FDA                 add     ecx, 8Ch ; 'Œ'
.text:42CF3FE0                 push    ecx             ; lpAddend
.text:42CF3FE1                 call    ds:InterlockedDecrement
.text:42CF3FE7                 mov     [ebp+var_8], eax
.text:42CF3FEA                 cmp     [ebp+var_8], 0
.text:42CF3FEE                 jg      short loc_42CF4008
.text:42CF3FF0                 push    0DF5h
.text:42CF3FF5                 push    offset aQSphinxNetlibs_0 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF3FFA                 push    offset aCref0   ; "cRef > 0"
.text:42CF3FFF                 call    ds:_assert
.text:42CF4005 ; ---------------------------------------------------------------------------
.text:42CF4005                 add     esp, 0Ch
.text:42CF4008
.text:42CF4008 loc_42CF4008:                           ; CODE XREF: ConnectionReadAsync+3F3\u2191j
.text:42CF4008                 xor     eax, eax
.text:42CF400A
.text:42CF400A loc_42CF400A:                           ; CODE XREF: ConnectionReadAsync+3CD\u2191j
.text:42CF400A                 mov     esp, ebp
.text:42CF400C                 pop     ebp
.text:42CF400D                 retn
.text:42CF400D ConnectionReadAsync endp
.text:42CF400D
.text:42CF400E ; Exported entry   8. ConnectionReadAsyncWait
.text:42CF400E
.text:42CF400E ; =============== S U B R O U T I N E =======================================
.text:42CF400E
.text:42CF400E ; Attributes: bp-based frame
.text:42CF400E
.text:42CF400E ; int __cdecl ConnectionReadAsyncWait(int, int, DWORD dwMilliseconds, int)
.text:42CF400E                 public ConnectionReadAsyncWait
.text:42CF400E ConnectionReadAsyncWait proc near       ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF400E
.text:42CF400E var_34          = dword ptr -34h
.text:42CF400E NumberOfBytesTransferred= dword ptr -30h
.text:42CF400E var_2C          = dword ptr -2Ch
.text:42CF400E var_28          = dword ptr -28h
.text:42CF400E var_24          = dword ptr -24h
.text:42CF400E var_20          = dword ptr -20h
.text:42CF400E var_1C          = dword ptr -1Ch
.text:42CF400E var_18          = dword ptr -18h
.text:42CF400E optval          = byte ptr -14h
.text:42CF400E var_10          = dword ptr -10h
.text:42CF400E CompletionKey   = dword ptr -0Ch
.text:42CF400E Overlapped      = dword ptr -8
.text:42CF400E Block           = dword ptr -4
.text:42CF400E arg_0           = dword ptr  8
.text:42CF400E arg_4           = dword ptr  0Ch
.text:42CF400E dwMilliseconds  = dword ptr  10h
.text:42CF400E arg_C           = dword ptr  14h
.text:42CF400E
.text:42CF400E                 push    ebp
.text:42CF400F                 mov     ebp, esp
.text:42CF4011                 sub     esp, 34h
.text:42CF4014                 mov     [ebp+NumberOfBytesTransferred], 0
.text:42CF401B                 mov     [ebp+var_10], 0
.text:42CF4022                 mov     [ebp+CompletionKey], 0
.text:42CF4029                 mov     eax, [ebp+arg_C]
.text:42CF402C                 mov     dword ptr [eax], 0
.text:42CF4032                 mov     ecx, [ebp+dwMilliseconds]
.text:42CF4035                 push    ecx             ; dwMilliseconds
.text:42CF4036                 lea     edx, [ebp+Overlapped]
.text:42CF4039                 push    edx             ; lpOverlapped
.text:42CF403A                 lea     eax, [ebp+CompletionKey]
.text:42CF403D                 push    eax             ; lpCompletionKey
.text:42CF403E                 lea     ecx, [ebp+NumberOfBytesTransferred]
.text:42CF4041                 push    ecx             ; lpNumberOfBytesTransferred
.text:42CF4042                 mov     edx, CompletionPort
.text:42CF4048                 push    edx             ; CompletionPort
.text:42CF4049                 call    ds:GetQueuedCompletionStatus
.text:42CF404F                 mov     [ebp+var_28], eax
.text:42CF4052                 mov     eax, [ebp+CompletionKey]
.text:42CF4055                 mov     [ebp+Block], eax
.text:42CF4058                 call    ds:GetLastError
.text:42CF405E                 mov     [ebp+var_24], eax
.text:42CF4061                 cmp     [ebp+NumberOfBytesTransferred], 0FFFFFFFFh
.text:42CF4065                 jnz     short loc_42CF40E6
.text:42CF4067                 mov     [ebp+NumberOfBytesTransferred], 0
.text:42CF406E                 mov     [ebp+var_28], 0
.text:42CF4075                 mov     [ebp+var_24], 3Bh ; ';'
.text:42CF407C                 cmp     [ebp+Block], 0
.text:42CF4080                 jz      short loc_42CF40C0
.text:42CF4082                 mov     ecx, [ebp+arg_4]
.text:42CF4085                 mov     edx, [ebp+Block]
.text:42CF4088                 mov     eax, [edx+70h]
.text:42CF408B                 mov     [ecx], eax
.text:42CF408D                 mov     ecx, [ebp+Block]
.text:42CF4090                 cmp     dword ptr [ecx+90h], 1
.text:42CF4097                 jz      short loc_42CF40B1
.text:42CF4099                 push    0E51h
.text:42CF409E                 push    offset aQSphinxNetlibs_1 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF40A3                 push    offset aTruePconnectio ; "TRUE == pConnectionObject->fReadFlag"
.text:42CF40A8                 call    ds:_assert
.text:42CF40AE ; ---------------------------------------------------------------------------
.text:42CF40AE                 add     esp, 0Ch
.text:42CF40B1
.text:42CF40B1 loc_42CF40B1:                           ; CODE XREF: ConnectionReadAsyncWait+89\u2191j
.text:42CF40B1                 mov     eax, [ebp+Block]
.text:42CF40B4                 mov     dword ptr [eax+90h], 0
.text:42CF40BE                 jmp     short loc_42CF40C9
.text:42CF40C0 ; ---------------------------------------------------------------------------
.text:42CF40C0
.text:42CF40C0 loc_42CF40C0:                           ; CODE XREF: ConnectionReadAsyncWait+72\u2191j
.text:42CF40C0                 mov     ecx, [ebp+arg_4]
.text:42CF40C3                 mov     dword ptr [ecx], 0
.text:42CF40C9
.text:42CF40C9 loc_42CF40C9:                           ; CODE XREF: ConnectionReadAsyncWait+B0\u2191j
.text:42CF40C9                 mov     edx, [ebp+arg_0]
.text:42CF40CC                 mov     dword ptr [edx], 0
.text:42CF40D2                 mov     eax, [ebp+arg_C]
.text:42CF40D5                 mov     ecx, [ebp+var_24]
.text:42CF40D8                 mov     [eax], ecx
.text:42CF40DA                 mov     [ebp+var_18], 0
.text:42CF40E1                 jmp     loc_42CF43EB
.text:42CF40E6 ; ---------------------------------------------------------------------------
.text:42CF40E6
.text:42CF40E6 loc_42CF40E6:                           ; CODE XREF: ConnectionReadAsyncWait+57\u2191j
.text:42CF40E6                 cmp     [ebp+NumberOfBytesTransferred], 0BAADBAADh
.text:42CF40ED                 jnz     short loc_42CF4145
.text:42CF40EF                 mov     [ebp+var_28], 0
.text:42CF40F6                 cmp     [ebp+Block], 0
.text:42CF40FA                 jz      short loc_42CF4116
.text:42CF40FC                 mov     edx, [ebp+arg_4]
.text:42CF40FF                 mov     eax, [ebp+Block]
.text:42CF4102                 mov     ecx, [eax+70h]
.text:42CF4105                 mov     [edx], ecx
.text:42CF4107                 mov     edx, [ebp+Block]
.text:42CF410A                 mov     dword ptr [edx+90h], 0
.text:42CF4114                 jmp     short loc_42CF411F
.text:42CF4116 ; ---------------------------------------------------------------------------
.text:42CF4116
.text:42CF4116 loc_42CF4116:                           ; CODE XREF: ConnectionReadAsyncWait+EC\u2191j
.text:42CF4116                 mov     eax, [ebp+arg_4]
.text:42CF4119                 mov     dword ptr [eax], 0
.text:42CF411F
.text:42CF411F loc_42CF411F:                           ; CODE XREF: ConnectionReadAsyncWait+106\u2191j
.text:42CF411F                 mov     ecx, [ebp+arg_0]
.text:42CF4122                 mov     dword ptr [ecx], 0
.text:42CF4128                 mov     edx, [ebp+arg_C]
.text:42CF412B                 mov     dword ptr [edx], 4
.text:42CF4131                 push    4               ; dwErrCode
.text:42CF4133                 call    ds:SetLastError
.text:42CF4139                 mov     [ebp+var_18], 0
.text:42CF4140                 jmp     loc_42CF43EB
.text:42CF4145 ; ---------------------------------------------------------------------------
.text:42CF4145
.text:42CF4145 loc_42CF4145:                           ; CODE XREF: ConnectionReadAsyncWait+DF\u2191j
.text:42CF4145                 cmp     [ebp+var_28], 0
.text:42CF4149                 jnz     short loc_42CF41BE
.text:42CF414B                 cmp     [ebp+var_24], 0EAh ; 'ê'
.text:42CF4152                 jz      short loc_42CF41BE
.text:42CF4154                 cmp     [ebp+Block], 0
.text:42CF4158                 jz      short loc_42CF4198
.text:42CF415A                 mov     eax, [ebp+arg_4]
.text:42CF415D                 mov     ecx, [ebp+Block]
.text:42CF4160                 mov     edx, [ecx+70h]
.text:42CF4163                 mov     [eax], edx
.text:42CF4165                 mov     eax, [ebp+Block]
.text:42CF4168                 cmp     dword ptr [eax+90h], 1
.text:42CF416F                 jz      short loc_42CF4189
.text:42CF4171                 push    0E92h
.text:42CF4176                 push    offset aQSphinxNetlibs_2 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF417B                 push    offset aTruePconnectio_0 ; "TRUE == pConnectionObject->fReadFlag"
.text:42CF4180                 call    ds:_assert
.text:42CF4186 ; ---------------------------------------------------------------------------
.text:42CF4186                 add     esp, 0Ch
.text:42CF4189
.text:42CF4189 loc_42CF4189:                           ; CODE XREF: ConnectionReadAsyncWait+161\u2191j
.text:42CF4189                 mov     edx, [ebp+Block]
.text:42CF418C                 mov     dword ptr [edx+90h], 0
.text:42CF4196                 jmp     short loc_42CF41A1
.text:42CF4198 ; ---------------------------------------------------------------------------
.text:42CF4198
.text:42CF4198 loc_42CF4198:                           ; CODE XREF: ConnectionReadAsyncWait+14A\u2191j
.text:42CF4198                 mov     eax, [ebp+arg_4]
.text:42CF419B                 mov     dword ptr [eax], 0
.text:42CF41A1
.text:42CF41A1 loc_42CF41A1:                           ; CODE XREF: ConnectionReadAsyncWait+188\u2191j
.text:42CF41A1                 mov     ecx, [ebp+arg_0]
.text:42CF41A4                 mov     dword ptr [ecx], 0
.text:42CF41AA                 mov     edx, [ebp+arg_C]
.text:42CF41AD                 mov     eax, [ebp+var_24]
.text:42CF41B0                 mov     [edx], eax
.text:42CF41B2                 mov     [ebp+var_18], 0
.text:42CF41B9                 jmp     loc_42CF43EB
.text:42CF41BE ; ---------------------------------------------------------------------------
.text:42CF41BE
.text:42CF41BE loc_42CF41BE:                           ; CODE XREF: ConnectionReadAsyncWait+13B\u2191j
.text:42CF41BE                                         ; ConnectionReadAsyncWait+144\u2191j
.text:42CF41BE                 mov     ecx, [ebp+arg_4]
.text:42CF41C1                 mov     edx, [ebp+Block]
.text:42CF41C4                 mov     eax, [edx+70h]
.text:42CF41C7                 mov     [ecx], eax
.text:42CF41C9                 mov     ecx, [ebp+Block]
.text:42CF41CC                 cmp     dword ptr [ecx+90h], 1
.text:42CF41D3                 jz      short loc_42CF41ED
.text:42CF41D5                 push    0EB9h
.text:42CF41DA                 push    offset aQSphinxNetlibs_3 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF41DF                 push    offset aTruePconnectio_1 ; "TRUE == pConnectionObject->fReadFlag"
.text:42CF41E4                 call    ds:_assert
.text:42CF41EA ; ---------------------------------------------------------------------------
.text:42CF41EA                 add     esp, 0Ch
.text:42CF41ED
.text:42CF41ED loc_42CF41ED:                           ; CODE XREF: ConnectionReadAsyncWait+1C5\u2191j
.text:42CF41ED                 mov     eax, [ebp+Block]
.text:42CF41F0                 mov     dword ptr [eax+90h], 0
.text:42CF41FA                 mov     ecx, [ebp+arg_0]
.text:42CF41FD                 mov     dword ptr [ecx], 0
.text:42CF4203                 mov     edx, [ebp+NumberOfBytesTransferred]
.text:42CF4206                 mov     [ebp+var_1C], edx
.text:42CF4209                 mov     eax, [ebp+NumberOfBytesTransferred]
.text:42CF420C                 mov     [ebp+var_10], eax
.text:42CF420F                 mov     ecx, [ebp+Block]
.text:42CF4212                 cmp     dword ptr [ecx+64h], 0
.text:42CF4216                 jnz     short loc_42CF4232
.text:42CF4218                 mov     edx, [ebp+Block]
.text:42CF421B                 cmp     dword ptr [edx+68h], 0
.text:42CF421F                 jz      loc_42CF43DC
.text:42CF4225                 mov     eax, [ebp+Block]
.text:42CF4228                 cmp     dword ptr [eax+6Ch], 0
.text:42CF422C                 jz      loc_42CF43DC
.text:42CF4232
.text:42CF4232 loc_42CF4232:                           ; CODE XREF: ConnectionReadAsyncWait+208\u2191j
.text:42CF4232                 mov     ecx, [ebp+Block]
.text:42CF4235                 cmp     dword ptr [ecx+0A0h], 0
.text:42CF423C                 jz      loc_42CF43DC
.text:42CF4242                 mov     edx, [ebp+Block]
.text:42CF4245                 mov     dword ptr [edx+6Ch], 0
.text:42CF424C                 cmp     [ebp+NumberOfBytesTransferred], 0
.text:42CF4250                 jnz     short loc_42CF4267
.text:42CF4252                 mov     eax, [ebp+arg_0]
.text:42CF4255                 mov     dword ptr [eax], 0
.text:42CF425B                 mov     [ebp+var_18], 1
.text:42CF4262                 jmp     loc_42CF43EB
.text:42CF4267 ; ---------------------------------------------------------------------------
.text:42CF4267
.text:42CF4267 loc_42CF4267:                           ; CODE XREF: ConnectionReadAsyncWait+242\u2191j
.text:42CF4267                                         ; ConnectionReadAsyncWait+3A8\u2193j
.text:42CF4267                 mov     ecx, [ebp+var_10]
.text:42CF426A                 mov     [ebp+var_1C], ecx
.text:42CF426D                 mov     edx, [ebp+Block]
.text:42CF4270                 mov     eax, [edx+58h]
.text:42CF4273                 push    eax
.text:42CF4274                 mov     ecx, [edx+54h]
.text:42CF4277                 push    ecx             ; char
.text:42CF4278                 mov     edx, [ebp+Block]
.text:42CF427B                 add     edx, 60h ; '`'
.text:42CF427E                 push    edx             ; int
.text:42CF427F                 lea     eax, [ebp+var_1C]
.text:42CF4282                 push    eax             ; int
.text:42CF4283                 mov     ecx, [ebp+Block]
.text:42CF4286                 mov     edx, [ecx+50h]
.text:42CF4289                 push    edx             ; void *
.text:42CF428A                 mov     eax, [ebp+Block]
.text:42CF428D                 mov     ecx, [eax+44h]
.text:42CF4290                 push    ecx             ; void *
.text:42CF4291                 call    sub_42CF7BBF
.text:42CF4296                 add     esp, 18h
.text:42CF4299                 mov     [ebp+var_20], eax
.text:42CF429C                 cmp     [ebp+var_20], 0
.text:42CF42A0                 jnz     short loc_42CF42C5
.text:42CF42A2                 mov     edx, [ebp+arg_0]
.text:42CF42A5                 mov     eax, [edx]
.text:42CF42A7                 add     eax, [ebp+var_1C]
.text:42CF42AA                 mov     ecx, [ebp+arg_0]
.text:42CF42AD                 mov     [ecx], eax
.text:42CF42AF                 mov     edx, [ebp+Block]
.text:42CF42B2                 mov     dword ptr [edx+60h], 0
.text:42CF42B9                 mov     [ebp+var_18], 1
.text:42CF42C0                 jmp     loc_42CF43EB
.text:42CF42C5 ; ---------------------------------------------------------------------------
.text:42CF42C5
.text:42CF42C5 loc_42CF42C5:                           ; CODE XREF: ConnectionReadAsyncWait+292\u2191j
.text:42CF42C5                 cmp     [ebp+var_20], 80090318h
.text:42CF42CC                 jnz     loc_42CF43BB
.text:42CF42D2                 cmp     [ebp+var_1C], 0
.text:42CF42D6                 jbe     short loc_42CF42F1
.text:42CF42D8                 mov     eax, [ebp+arg_0]
.text:42CF42DB                 mov     ecx, [eax]
.text:42CF42DD                 add     ecx, [ebp+var_1C]
.text:42CF42E0                 mov     edx, [ebp+arg_0]
.text:42CF42E3                 mov     [edx], ecx
.text:42CF42E5                 mov     [ebp+var_18], 1
.text:42CF42EC                 jmp     loc_42CF43EB
.text:42CF42F1 ; ---------------------------------------------------------------------------
.text:42CF42F1
.text:42CF42F1 loc_42CF42F1:                           ; CODE XREF: ConnectionReadAsyncWait+2C8\u2191j
.text:42CF42F1                 mov     dword ptr [ebp+optval], 7FFFFFFFh
.text:42CF42F8                 mov     eax, [ebp+Block]
.text:42CF42FB                 cmp     dword ptr [eax+80h], 0
.text:42CF4302                 jnz     short loc_42CF4362
.text:42CF4304                 push    4               ; optlen
.text:42CF4306                 lea     ecx, [ebp+optval]
.text:42CF4309                 push    ecx             ; optval
.text:42CF430A                 push    1006h           ; optname
.text:42CF430F                 push    0FFFFh          ; level
.text:42CF4314                 mov     edx, [ebp+Block]
.text:42CF4317                 mov     eax, [edx+0Ch]
.text:42CF431A                 push    eax             ; s
.text:42CF431B                 call    ds:setsockopt
.text:42CF4321                 push    0               ; flags
.text:42CF4323                 mov     ecx, [ebp+Block]
.text:42CF4326                 mov     edx, [ecx+5Ch]
.text:42CF4329                 sub     edx, [ebp+var_10]
.text:42CF432C                 push    edx             ; len
.text:42CF432D                 mov     eax, [ebp+Block]
.text:42CF4330                 mov     ecx, [eax+44h]
.text:42CF4333                 mov     edx, [ebp+Block]
.text:42CF4336                 add     ecx, [edx+60h]
.text:42CF4339                 push    ecx             ; buf
.text:42CF433A                 mov     eax, [ebp+Block]
.text:42CF433D                 mov     ecx, [eax+0Ch]
.text:42CF4340                 push    ecx             ; s
.text:42CF4341                 call    ds:recv
.text:42CF4347                 mov     [ebp+var_24], eax
.text:42CF434A                 cmp     [ebp+var_24], 0FFFFFFFFh
.text:42CF434E                 jnz     short loc_42CF4352
.text:42CF4350                 jmp     short loc_42CF43BB
.text:42CF4352 ; ---------------------------------------------------------------------------
.text:42CF4352
.text:42CF4352 loc_42CF4352:                           ; CODE XREF: ConnectionReadAsyncWait+340\u2191j
.text:42CF4352                 mov     edx, [ebp+var_24]
.text:42CF4355                 mov     [ebp+NumberOfBytesTransferred], edx
.text:42CF4358                 cmp     [ebp+var_24], 0
.text:42CF435C                 jnz     short loc_42CF4360
.text:42CF435E                 jmp     short loc_42CF43BB
.text:42CF4360 ; ---------------------------------------------------------------------------
.text:42CF4360
.text:42CF4360 loc_42CF4360:                           ; CODE XREF: ConnectionReadAsyncWait+34E\u2191j
.text:42CF4360                 jmp     short loc_42CF43AD
.text:42CF4362 ; ---------------------------------------------------------------------------
.text:42CF4362
.text:42CF4362 loc_42CF4362:                           ; CODE XREF: ConnectionReadAsyncWait+2F4\u2191j
.text:42CF4362                 lea     eax, [ebp+var_34]
.text:42CF4365                 push    eax
.text:42CF4366                 mov     ecx, [ebp+dwMilliseconds]
.text:42CF4369                 push    ecx
.text:42CF436A                 mov     edx, [ebp+Block]
.text:42CF436D                 mov     eax, [edx+5Ch]
.text:42CF4370                 sub     eax, [ebp+NumberOfBytesTransferred]
.text:42CF4373                 push    eax
.text:42CF4374                 mov     ecx, [ebp+Block]
.text:42CF4377                 mov     edx, [ecx+5Ch]
.text:42CF437A                 sub     edx, [ebp+NumberOfBytesTransferred]
.text:42CF437D                 push    edx
.text:42CF437E                 mov     eax, [ebp+Block]
.text:42CF4381                 mov     ecx, [eax+44h]
.text:42CF4384                 mov     edx, [ebp+Block]
.text:42CF4387                 add     ecx, [edx+60h]
.text:42CF438A                 add     ecx, [ebp+var_10]
.text:42CF438D                 push    ecx
.text:42CF438E                 mov     eax, [ebp+Block]
.text:42CF4391                 push    eax
.text:42CF4392                 call    sub_42CF63E6
.text:42CF4397                 add     esp, 18h
.text:42CF439A                 mov     [ebp+NumberOfBytesTransferred], eax
.text:42CF439D                 cmp     [ebp+NumberOfBytesTransferred], 0
.text:42CF43A1                 jnz     short loc_42CF43AD
.text:42CF43A3                 mov     ecx, [ebp+arg_C]
.text:42CF43A6                 mov     edx, [ebp+var_34]
.text:42CF43A9                 mov     [ecx], edx
.text:42CF43AB                 jmp     short loc_42CF43BB
.text:42CF43AD ; ---------------------------------------------------------------------------
.text:42CF43AD
.text:42CF43AD loc_42CF43AD:                           ; CODE XREF: ConnectionReadAsyncWait:loc_42CF4360\u2191j
.text:42CF43AD                                         ; ConnectionReadAsyncWait+393\u2191j
.text:42CF43AD                 mov     eax, [ebp+var_10]
.text:42CF43B0                 add     eax, [ebp+NumberOfBytesTransferred]
.text:42CF43B3                 mov     [ebp+var_10], eax
.text:42CF43B6                 jmp     loc_42CF4267
.text:42CF43BB ; ---------------------------------------------------------------------------
.text:42CF43BB
.text:42CF43BB loc_42CF43BB:                           ; CODE XREF: ConnectionReadAsyncWait+2BE\u2191j
.text:42CF43BB                                         ; ConnectionReadAsyncWait+342\u2191j ...
.text:42CF43BB                 mov     [ebp+var_2C], offset aSecdecryptdata_0 ; "SECDecryptData"
.text:42CF43C2                 mov     ecx, [ebp+arg_C]
.text:42CF43C5                 mov     edx, [ebp+var_20]
.text:42CF43C8                 mov     [ecx], edx
.text:42CF43CA                 mov     eax, [ebp+arg_0]
.text:42CF43CD                 mov     dword ptr [eax], 0
.text:42CF43D3                 mov     [ebp+var_18], 0
.text:42CF43DA                 jmp     short loc_42CF43EB
.text:42CF43DC ; ---------------------------------------------------------------------------
.text:42CF43DC
.text:42CF43DC loc_42CF43DC:                           ; CODE XREF: ConnectionReadAsyncWait+211\u2191j
.text:42CF43DC                                         ; ConnectionReadAsyncWait+21E\u2191j ...
.text:42CF43DC                 mov     ecx, [ebp+arg_0]
.text:42CF43DF                 mov     edx, [ebp+var_10]
.text:42CF43E2                 mov     [ecx], edx
.text:42CF43E4                 mov     [ebp+var_18], 1
.text:42CF43EB
.text:42CF43EB loc_42CF43EB:                           ; CODE XREF: ConnectionReadAsyncWait+D3\u2191j
.text:42CF43EB                                         ; ConnectionReadAsyncWait+132\u2191j ...
.text:42CF43EB                 mov     eax, [ebp+Block]
.text:42CF43EE                 add     eax, 8Ch ; 'Œ'
.text:42CF43F3                 push    eax             ; lpAddend
.text:42CF43F4                 call    ds:InterlockedDecrement
.text:42CF43FA                 test    eax, eax
.text:42CF43FC                 jnz     short loc_42CF445F
.text:42CF43FE                 mov     ecx, [ebp+Block]
.text:42CF4401                 cmp     dword ptr [ecx+44h], 0
.text:42CF4405                 jz      short loc_42CF4428
.text:42CF4407                 mov     edx, [ebp+Block]
.text:42CF440A                 mov     eax, [edx+44h]
.text:42CF440D                 push    eax
.text:42CF440E                 mov     ecx, [ebp+Block]
.text:42CF4411                 mov     edx, [ecx+74h]
.text:42CF4414                 push    edx
.text:42CF4415                 mov     eax, [ebp+Block]
.text:42CF4418                 call    dword ptr [eax+7Ch]
.text:42CF441B                 add     esp, 8
.text:42CF441E                 mov     ecx, [ebp+Block]
.text:42CF4421                 mov     dword ptr [ecx+44h], 0
.text:42CF4428
.text:42CF4428 loc_42CF4428:                           ; CODE XREF: ConnectionReadAsyncWait+3F7\u2191j
.text:42CF4428                 mov     edx, [ebp+Block]
.text:42CF442B                 cmp     dword ptr [edx+4Ch], 0
.text:42CF442F                 jz      short loc_42CF4452
.text:42CF4431                 mov     eax, [ebp+Block]
.text:42CF4434                 mov     ecx, [eax+4Ch]
.text:42CF4437                 push    ecx
.text:42CF4438                 mov     edx, [ebp+Block]
.text:42CF443B                 mov     eax, [edx+74h]
.text:42CF443E                 push    eax
.text:42CF443F                 mov     ecx, [ebp+Block]
.text:42CF4442                 call    dword ptr [ecx+7Ch]
.text:42CF4445                 add     esp, 8
.text:42CF4448                 mov     edx, [ebp+Block]
.text:42CF444B                 mov     dword ptr [edx+4Ch], 0
.text:42CF4452
.text:42CF4452 loc_42CF4452:                           ; CODE XREF: ConnectionReadAsyncWait+421\u2191j
.text:42CF4452                 mov     eax, [ebp+Block]
.text:42CF4455                 push    eax             ; Block
.text:42CF4456                 call    ds:free
.text:42CF445C                 add     esp, 4
.text:42CF445F
.text:42CF445F loc_42CF445F:                           ; CODE XREF: ConnectionReadAsyncWait+3EE\u2191j
.text:42CF445F                 mov     eax, [ebp+var_18]
.text:42CF4462                 mov     esp, ebp
.text:42CF4464                 pop     ebp
.text:42CF4465                 retn
.text:42CF4465 ConnectionReadAsyncWait endp
.text:42CF4465
.text:42CF4466 ; Exported entry   6. ConnectionPeek
.text:42CF4466
.text:42CF4466 ; =============== S U B R O U T I N E =======================================
.text:42CF4466
.text:42CF4466 ; Attributes: bp-based frame
.text:42CF4466
.text:42CF4466                 public ConnectionPeek
.text:42CF4466 ConnectionPeek  proc near               ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4466
.text:42CF4466 var_128         = dword ptr -128h
.text:42CF4466 s               = dword ptr -124h
.text:42CF4466 var_120         = dword ptr -120h
.text:42CF4466 timeout         = timeval ptr -11Ch
.text:42CF4466 optval          = byte ptr -114h
.text:42CF4466 readfds         = fd_set ptr -110h
.text:42CF4466 flags           = dword ptr -0Ch
.text:42CF4466 var_8           = dword ptr -8
.text:42CF4466 var_4           = dword ptr -4
.text:42CF4466 arg_0           = dword ptr  8
.text:42CF4466 arg_4           = dword ptr  0Ch
.text:42CF4466 arg_8           = dword ptr  10h
.text:42CF4466 arg_C           = dword ptr  14h
.text:42CF4466 arg_10          = dword ptr  18h
.text:42CF4466 arg_14          = dword ptr  1Ch
.text:42CF4466
.text:42CF4466                 push    ebp
.text:42CF4467                 mov     ebp, esp
.text:42CF4469                 sub     esp, 128h
.text:42CF446F                 mov     eax, [ebp+arg_0]
.text:42CF4472                 mov     [ebp+var_8], eax
.text:42CF4475                 mov     ecx, [ebp+var_8]
.text:42CF4478                 mov     edx, [ecx+0Ch]
.text:42CF447B                 mov     [ebp+s], edx
.text:42CF4481                 mov     [ebp+var_4], 0
.text:42CF4488                 mov     [ebp+flags], 2
.text:42CF448F                 mov     eax, [ebp+arg_14]
.text:42CF4492                 mov     dword ptr [eax], 0
.text:42CF4498                 mov     ecx, [ebp+arg_8]
.text:42CF449B                 cmp     ecx, [ebp+arg_C]
.text:42CF449E                 jbe     short loc_42CF44AE
.text:42CF44A0                 mov     edx, [ebp+arg_14]
.text:42CF44A3                 mov     dword ptr [edx], 0Bh
.text:42CF44A9                 jmp     loc_42CF474E
.text:42CF44AE ; ---------------------------------------------------------------------------
.text:42CF44AE
.text:42CF44AE loc_42CF44AE:                           ; CODE XREF: ConnectionPeek+38\u2191j
.text:42CF44AE                 mov     eax, [ebp+var_8]
.text:42CF44B1                 cmp     dword ptr [eax+80h], 0
.text:42CF44B8                 jnz     loc_42CF46F9
.text:42CF44BE                 mov     [ebp+timeout.tv_sec], 7FFFFFFFh
.text:42CF44C8                 mov     [ebp+timeout.tv_usec], 0
.text:42CF44D2                 mov     dword ptr [ebp+optval], 7FFFFFFFh
.text:42CF44DC                 cmp     [ebp+arg_10], 0
.text:42CF44E0                 jz      short loc_42CF4535
.text:42CF44E2                 cmp     [ebp+arg_10], 0FFFFh
.text:42CF44E9                 jnz     short loc_42CF450B
.text:42CF44EB                 mov     dword ptr [ebp+optval], 1
.text:42CF44F5                 mov     [ebp+timeout.tv_sec], 0
.text:42CF44FF                 mov     [ebp+timeout.tv_usec], 0
.text:42CF4509                 jmp     short loc_42CF4535
.text:42CF450B ; ---------------------------------------------------------------------------
.text:42CF450B
.text:42CF450B loc_42CF450B:                           ; CODE XREF: ConnectionPeek+83\u2191j
.text:42CF450B                 mov     ecx, [ebp+arg_10]
.text:42CF450E                 mov     dword ptr [ebp+optval], ecx
.text:42CF4514                 mov     eax, [ebp+arg_10]
.text:42CF4517                 xor     edx, edx
.text:42CF4519                 mov     ecx, 3E8h
.text:42CF451E                 div     ecx
.text:42CF4520                 mov     [ebp+timeout.tv_sec], eax
.text:42CF4526                 mov     edx, [ebp+arg_10]
.text:42CF4529                 imul    edx, 3E8h
.text:42CF452F                 mov     [ebp+timeout.tv_usec], edx
.text:42CF4535
.text:42CF4535 loc_42CF4535:                           ; CODE XREF: ConnectionPeek+7A\u2191j
.text:42CF4535                                         ; ConnectionPeek+A3\u2191j
.text:42CF4535                 mov     [ebp+readfds.fd_count], 0
.text:42CF453F
.text:42CF453F loc_42CF453F:                           ; CODE XREF: ConnectionPeek+158\u2193j
.text:42CF453F                 mov     [ebp+var_128], 0
.text:42CF4549                 jmp     short loc_42CF455A
.text:42CF454B ; ---------------------------------------------------------------------------
.text:42CF454B
.text:42CF454B loc_42CF454B:                           ; CODE XREF: ConnectionPeek:loc_42CF457F\u2193j
.text:42CF454B                 mov     eax, [ebp+var_128]
.text:42CF4551                 add     eax, 1
.text:42CF4554                 mov     [ebp+var_128], eax
.text:42CF455A
.text:42CF455A loc_42CF455A:                           ; CODE XREF: ConnectionPeek+E3\u2191j
.text:42CF455A                 mov     ecx, [ebp+var_128]
.text:42CF4560                 cmp     ecx, [ebp+readfds.fd_count]
.text:42CF4566                 jnb     short loc_42CF4581
.text:42CF4568                 mov     edx, [ebp+var_128]
.text:42CF456E                 mov     eax, [ebp+edx*4+readfds.fd_array]
.text:42CF4575                 cmp     eax, [ebp+s]
.text:42CF457B                 jnz     short loc_42CF457F
.text:42CF457D                 jmp     short loc_42CF4581
.text:42CF457F ; ---------------------------------------------------------------------------
.text:42CF457F
.text:42CF457F loc_42CF457F:                           ; CODE XREF: ConnectionPeek+115\u2191j
.text:42CF457F                 jmp     short loc_42CF454B
.text:42CF4581 ; ---------------------------------------------------------------------------
.text:42CF4581
.text:42CF4581 loc_42CF4581:                           ; CODE XREF: ConnectionPeek+100\u2191j
.text:42CF4581                                         ; ConnectionPeek+117\u2191j
.text:42CF4581                 mov     ecx, [ebp+var_128]
.text:42CF4587                 cmp     ecx, [ebp+readfds.fd_count]
.text:42CF458D                 jnz     short loc_42CF45BA
.text:42CF458F                 cmp     [ebp+readfds.fd_count], 40h ; '@'
.text:42CF4596                 jnb     short loc_42CF45BA
.text:42CF4598                 mov     edx, [ebp+var_128]
.text:42CF459E                 mov     eax, [ebp+s]
.text:42CF45A4                 mov     [ebp+edx*4+readfds.fd_array], eax
.text:42CF45AB                 mov     ecx, [ebp+readfds.fd_count]
.text:42CF45B1                 add     ecx, 1
.text:42CF45B4                 mov     [ebp+readfds.fd_count], ecx
.text:42CF45BA
.text:42CF45BA loc_42CF45BA:                           ; CODE XREF: ConnectionPeek+127\u2191j
.text:42CF45BA                                         ; ConnectionPeek+130\u2191j
.text:42CF45BA                 xor     edx, edx
.text:42CF45BC                 test    edx, edx
.text:42CF45BE                 jnz     loc_42CF453F
.text:42CF45C4                 lea     eax, [ebp+timeout]
.text:42CF45CA                 push    eax             ; timeout
.text:42CF45CB                 push    0               ; exceptfds
.text:42CF45CD                 push    0               ; writefds
.text:42CF45CF                 lea     ecx, [ebp+readfds]
.text:42CF45D5                 push    ecx             ; readfds
.text:42CF45D6                 push    0               ; nfds
.text:42CF45D8                 call    ds:select
.text:42CF45DE                 mov     [ebp+var_120], eax
.text:42CF45E4                 cmp     [ebp+var_120], 0
.text:42CF45EB                 jnz     short loc_42CF4609
.text:42CF45ED                 cmp     [ebp+arg_10], 0FFFFh
.text:42CF45F4                 jz      short loc_42CF4604
.text:42CF45F6                 mov     edx, [ebp+arg_14]
.text:42CF45F9                 mov     dword ptr [edx], 0FFFFFFFEh
.text:42CF45FF                 jmp     loc_42CF474E
.text:42CF4604 ; ---------------------------------------------------------------------------
.text:42CF4604
.text:42CF4604 loc_42CF4604:                           ; CODE XREF: ConnectionPeek+18E\u2191j
.text:42CF4604                 jmp     loc_42CF4741
.text:42CF4609 ; ---------------------------------------------------------------------------
.text:42CF4609
.text:42CF4609 loc_42CF4609:                           ; CODE XREF: ConnectionPeek+185\u2191j
.text:42CF4609                 cmp     [ebp+var_120], 0FFFFFFFFh
.text:42CF4610                 jnz     short loc_42CF4622
.text:42CF4612                 call    ds:WSAGetLastError
.text:42CF4618                 mov     ecx, [ebp+arg_14]
.text:42CF461B                 mov     [ecx], eax
.text:42CF461D                 jmp     loc_42CF474E
.text:42CF4622 ; ---------------------------------------------------------------------------
.text:42CF4622
.text:42CF4622 loc_42CF4622:                           ; CODE XREF: ConnectionPeek+1AA\u2191j
.text:42CF4622                 push    4               ; optlen
.text:42CF4624                 lea     edx, [ebp+optval]
.text:42CF462A                 push    edx             ; optval
.text:42CF462B                 push    1006h           ; optname
.text:42CF4630                 push    0FFFFh          ; level
.text:42CF4635                 mov     eax, [ebp+s]
.text:42CF463B                 push    eax             ; s
.text:42CF463C                 call    ds:setsockopt
.text:42CF4642                 mov     [ebp+var_120], eax
.text:42CF4648                 cmp     [ebp+var_120], 0
.text:42CF464F                 jz      short loc_42CF4661
.text:42CF4651                 call    ds:WSAGetLastError
.text:42CF4657                 mov     ecx, [ebp+arg_14]
.text:42CF465A                 mov     [ecx], eax
.text:42CF465C                 jmp     loc_42CF474E
.text:42CF4661 ; ---------------------------------------------------------------------------
.text:42CF4661
.text:42CF4661 loc_42CF4661:                           ; CODE XREF: ConnectionPeek+1E9\u2191j
.text:42CF4661                                         ; ConnectionPeek+28C\u2193j
.text:42CF4661                 mov     edx, [ebp+var_4]
.text:42CF4664                 cmp     edx, [ebp+arg_8]
.text:42CF4667                 jnb     loc_42CF46F7
.text:42CF466D                 mov     eax, [ebp+flags]
.text:42CF4670                 push    eax             ; flags
.text:42CF4671                 mov     ecx, [ebp+arg_C]
.text:42CF4674                 sub     ecx, [ebp+var_4]
.text:42CF4677                 push    ecx             ; len
.text:42CF4678                 mov     edx, [ebp+arg_4]
.text:42CF467B                 add     edx, [ebp+var_4]
.text:42CF467E                 push    edx             ; buf
.text:42CF467F                 mov     eax, [ebp+s]
.text:42CF4685                 push    eax             ; s
.text:42CF4686                 call    ds:recv
.text:42CF468C                 mov     [ebp+var_120], eax
.text:42CF4692                 cmp     [ebp+var_120], 0FFFFFFFFh
.text:42CF4699                 jnz     short loc_42CF46CA
.text:42CF469B                 call    ds:WSAGetLastError
.text:42CF46A1                 mov     ecx, [ebp+arg_14]
.text:42CF46A4                 mov     [ecx], eax
.text:42CF46A6                 mov     edx, [ebp+arg_14]
.text:42CF46A9                 cmp     dword ptr [edx], 274Ch
.text:42CF46AF                 jnz     short loc_42CF46CA
.text:42CF46B1                 cmp     [ebp+arg_10], 0FFFFh
.text:42CF46B8                 jz      short loc_42CF46C8
.text:42CF46BA                 mov     eax, [ebp+arg_14]
.text:42CF46BD                 mov     dword ptr [eax], 0FFFFFFFEh
.text:42CF46C3                 jmp     loc_42CF474E
.text:42CF46C8 ; ---------------------------------------------------------------------------
.text:42CF46C8
.text:42CF46C8 loc_42CF46C8:                           ; CODE XREF: ConnectionPeek+252\u2191j
.text:42CF46C8                 jmp     short loc_42CF4741
.text:42CF46CA ; ---------------------------------------------------------------------------
.text:42CF46CA
.text:42CF46CA loc_42CF46CA:                           ; CODE XREF: ConnectionPeek+233\u2191j
.text:42CF46CA                                         ; ConnectionPeek+249\u2191j
.text:42CF46CA                 cmp     [ebp+var_120], 0
.text:42CF46D1                 jnz     short loc_42CF46E6
.text:42CF46D3                 mov     ecx, [ebp+var_4]
.text:42CF46D6                 cmp     ecx, [ebp+arg_8]
.text:42CF46D9                 jnb     short loc_42CF46E6
.text:42CF46DB                 mov     edx, [ebp+arg_14]
.text:42CF46DE                 mov     dword ptr [edx], 0Bh
.text:42CF46E4                 jmp     short loc_42CF474E
.text:42CF46E6 ; ---------------------------------------------------------------------------
.text:42CF46E6
.text:42CF46E6 loc_42CF46E6:                           ; CODE XREF: ConnectionPeek+26B\u2191j
.text:42CF46E6                                         ; ConnectionPeek+273\u2191j
.text:42CF46E6                 mov     eax, [ebp+var_4]
.text:42CF46E9                 add     eax, [ebp+var_120]
.text:42CF46EF                 mov     [ebp+var_4], eax
.text:42CF46F2                 jmp     loc_42CF4661
.text:42CF46F7 ; ---------------------------------------------------------------------------
.text:42CF46F7
.text:42CF46F7 loc_42CF46F7:                           ; CODE XREF: ConnectionPeek+201\u2191j
.text:42CF46F7                 jmp     short loc_42CF473C
.text:42CF46F9 ; ---------------------------------------------------------------------------
.text:42CF46F9
.text:42CF46F9 loc_42CF46F9:                           ; CODE XREF: ConnectionPeek+52\u2191j
.text:42CF46F9                 mov     ecx, [ebp+arg_14]
.text:42CF46FC                 push    ecx
.text:42CF46FD                 mov     edx, [ebp+arg_10]
.text:42CF4700                 push    edx
.text:42CF4701                 mov     eax, [ebp+arg_C]
.text:42CF4704                 push    eax
.text:42CF4705                 mov     ecx, [ebp+arg_4]
.text:42CF4708                 push    ecx
.text:42CF4709                 mov     edx, [ebp+var_8]
.text:42CF470C                 push    edx
.text:42CF470D                 call    sub_42CF664E
.text:42CF4712                 add     esp, 14h
.text:42CF4715                 mov     [ebp+var_4], eax
.text:42CF4718                 mov     eax, [ebp+arg_14]
.text:42CF471B                 cmp     dword ptr [eax], 0FFFFFFFEh
.text:42CF471E                 jnz     short loc_42CF4722
.text:42CF4720                 jmp     short loc_42CF4741
.text:42CF4722 ; ---------------------------------------------------------------------------
.text:42CF4722
.text:42CF4722 loc_42CF4722:                           ; CODE XREF: ConnectionPeek+2B8\u2191j
.text:42CF4722                 mov     ecx, [ebp+arg_14]
.text:42CF4725                 cmp     dword ptr [ecx], 0
.text:42CF4728                 jnz     short loc_42CF4732
.text:42CF472A                 cmp     [ebp+var_4], 0
.text:42CF472E                 jnz     short loc_42CF4732
.text:42CF4730                 jmp     short loc_42CF4741
.text:42CF4732 ; ---------------------------------------------------------------------------
.text:42CF4732
.text:42CF4732 loc_42CF4732:                           ; CODE XREF: ConnectionPeek+2C2\u2191j
.text:42CF4732                                         ; ConnectionPeek+2C8\u2191j
.text:42CF4732                 mov     edx, [ebp+arg_14]
.text:42CF4735                 cmp     dword ptr [edx], 0
.text:42CF4738                 jz      short loc_42CF473C
.text:42CF473A                 jmp     short loc_42CF474E
.text:42CF473C ; ---------------------------------------------------------------------------
.text:42CF473C
.text:42CF473C loc_42CF473C:                           ; CODE XREF: ConnectionPeek:loc_42CF46F7\u2191j
.text:42CF473C                                         ; ConnectionPeek+2D2\u2191j
.text:42CF473C                 mov     eax, [ebp+var_4]
.text:42CF473F                 jmp     short loc_42CF4750
.text:42CF4741 ; ---------------------------------------------------------------------------
.text:42CF4741
.text:42CF4741 loc_42CF4741:                           ; CODE XREF: ConnectionPeek:loc_42CF4604\u2191j
.text:42CF4741                                         ; ConnectionPeek:loc_42CF46C8\u2191j ...
.text:42CF4741                 mov     eax, [ebp+arg_14]
.text:42CF4744                 mov     dword ptr [eax], 0
.text:42CF474A                 xor     eax, eax
.text:42CF474C                 jmp     short loc_42CF4750
.text:42CF474E ; ---------------------------------------------------------------------------
.text:42CF474E
.text:42CF474E loc_42CF474E:                           ; CODE XREF: ConnectionPeek+43\u2191j
.text:42CF474E                                         ; ConnectionPeek+199\u2191j ...
.text:42CF474E                 xor     eax, eax
.text:42CF4750
.text:42CF4750 loc_42CF4750:                           ; CODE XREF: ConnectionPeek+2D9\u2191j
.text:42CF4750                                         ; ConnectionPeek+2E6\u2191j
.text:42CF4750                 mov     esp, ebp
.text:42CF4752                 pop     ebp
.text:42CF4753                 retn
.text:42CF4753 ConnectionPeek  endp
.text:42CF4753
.text:42CF4754 ; Exported entry   2. ConnectionWrite
.text:42CF4754
.text:42CF4754 ; =============== S U B R O U T I N E =======================================
.text:42CF4754
.text:42CF4754 ; Attributes: bp-based frame
.text:42CF4754
.text:42CF4754 ; USHORT __stdcall ConnectionWrite(void *, BYTE *, USHORT, LONG *)
.text:42CF4754                 public ConnectionWrite
.text:42CF4754 ConnectionWrite proc near               ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4754
.text:42CF4754 optval          = byte ptr -20h
.text:42CF4754 var_1C          = dword ptr -1Ch
.text:42CF4754 s               = dword ptr -18h
.text:42CF4754 var_14          = dword ptr -14h
.text:42CF4754 var_10          = dword ptr -10h
.text:42CF4754 var_C           = dword ptr -0Ch
.text:42CF4754 var_8           = dword ptr -8
.text:42CF4754 var_4           = dword ptr -4
.text:42CF4754 arg_0           = dword ptr  8
.text:42CF4754 arg_4           = dword ptr  0Ch
.text:42CF4754 arg_8           = word ptr  10h
.text:42CF4754 arg_C           = dword ptr  14h
.text:42CF4754
.text:42CF4754                 push    ebp
.text:42CF4755                 mov     ebp, esp
.text:42CF4757                 sub     esp, 20h
.text:42CF475A                 push    esi
.text:42CF475B                 push    edi
.text:42CF475C                 mov     eax, [ebp+arg_0]
.text:42CF475F                 mov     [ebp+var_4], eax
.text:42CF4762                 mov     [ebp+var_10], 0
.text:42CF4769                 mov     [ebp+var_8], 0
.text:42CF4770                 mov     ecx, [ebp+var_4]
.text:42CF4773                 mov     edx, [ecx+0Ch]
.text:42CF4776                 mov     [ebp+s], edx
.text:42CF4779                 mov     [ebp+var_14], 0
.text:42CF4780                 mov     eax, [ebp+arg_C]
.text:42CF4783                 mov     dword ptr [eax], 0
.text:42CF4789                 mov     ecx, [ebp+var_4]
.text:42CF478C                 cmp     dword ptr [ecx+64h], 0
.text:42CF4790                 jz      loc_42CF4881
.text:42CF4796                 mov     edx, [ebp+var_4]
.text:42CF4799                 cmp     dword ptr [edx+0A0h], 0
.text:42CF47A0                 jz      loc_42CF4881
.text:42CF47A6                 mov     eax, [ebp+var_4]
.text:42CF47A9                 cmp     dword ptr [eax+0A4h], 0
.text:42CF47B0                 jz      loc_42CF4881
.text:42CF47B6                 mov     ecx, [ebp+var_4]
.text:42CF47B9                 cmp     dword ptr [ecx+4Ch], 0
.text:42CF47BD                 jnz     short loc_42CF47D7
.text:42CF47BF                 push    10D7h
.text:42CF47C4                 push    offset aQSphinxNetlibs_4 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF47C9                 push    offset aPconnectionobj ; "pConnectionObject->pEncryptBuffer != NU"...
.text:42CF47CE                 call    ds:_assert
.text:42CF47D4 ; ---------------------------------------------------------------------------
.text:42CF47D4                 add     esp, 0Ch
.text:42CF47D7
.text:42CF47D7 loc_42CF47D7:                           ; CODE XREF: ConnectionWrite+69\u2191j
.text:42CF47D7                 mov     eax, [ebp+var_4]
.text:42CF47DA                 mov     ecx, [eax+48h]
.text:42CF47DD                 cmp     ecx, dword ptr [ebp+arg_8]
.text:42CF47E0                 jnb     short loc_42CF47FA
.text:42CF47E2                 push    10D8h
.text:42CF47E7                 push    offset aQSphinxNetlibs_5 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF47EC                 push    offset aPconnectionobj_0 ; "pConnectionObject->dwMaxEncryptBufSize "...
.text:42CF47F1                 call    ds:_assert
.text:42CF47F7 ; ---------------------------------------------------------------------------
.text:42CF47F7                 add     esp, 0Ch
.text:42CF47FA
.text:42CF47FA loc_42CF47FA:                           ; CODE XREF: ConnectionWrite+8C\u2191j
.text:42CF47FA                 mov     eax, Size
.text:42CF47FF                 push    eax             ; Size
.text:42CF4800                 push    0               ; Val
.text:42CF4802                 mov     ecx, [ebp+var_4]
.text:42CF4805                 mov     edx, [ecx+4Ch]
.text:42CF4808                 push    edx             ; void *
.text:42CF4809                 call    memset
.text:42CF480E                 add     esp, 0Ch
.text:42CF4811                 mov     eax, dword ptr [ebp+arg_8]
.text:42CF4814                 push    eax             ; Size
.text:42CF4815                 mov     ecx, [ebp+arg_4]
.text:42CF4818                 push    ecx             ; Src
.text:42CF4819                 mov     edx, [ebp+var_4]
.text:42CF481C                 mov     eax, [edx+4Ch]
.text:42CF481F                 add     eax, Size
.text:42CF4825                 push    eax             ; void *
.text:42CF4826                 call    memcpy
.text:42CF482B                 add     esp, 0Ch
.text:42CF482E                 mov     ecx, [ebp+arg_C]
.text:42CF4831                 push    ecx
.text:42CF4832                 mov     edx, [ebp+var_4]
.text:42CF4835                 mov     eax, [edx+4Ch]
.text:42CF4838                 push    eax
.text:42CF4839                 sub     esp, 14h
.text:42CF483C                 mov     ecx, 5
.text:42CF4841                 mov     esi, offset Size
.text:42CF4846                 mov     edi, esp
.text:42CF4848                 rep movsd
.text:42CF484A                 mov     ecx, [ebp+var_4]
.text:42CF484D                 mov     edx, [ecx+58h]
.text:42CF4850                 push    edx
.text:42CF4851                 mov     eax, [ecx+54h]
.text:42CF4854                 push    eax
.text:42CF4855                 mov     ecx, dword ptr [ebp+arg_8]
.text:42CF4858                 push    ecx
.text:42CF4859                 call    sub_42CF7D75
.text:42CF485E                 add     esp, 28h
.text:42CF4861                 mov     dword ptr [ebp+arg_8], eax
.text:42CF4864                 mov     edx, [ebp+var_4]
.text:42CF4867                 mov     eax, [edx+4Ch]
.text:42CF486A                 mov     [ebp+var_C], eax
.text:42CF486D                 cmp     dword ptr [ebp+arg_8], 0
.text:42CF4871                 jnz     short loc_42CF487F
.text:42CF4873                 mov     [ebp+var_14], offset aSecencryptdata ; "SECEncryptData"
.text:42CF487A                 jmp     loc_42CF4980
.text:42CF487F ; ---------------------------------------------------------------------------
.text:42CF487F
.text:42CF487F loc_42CF487F:                           ; CODE XREF: ConnectionWrite+11D\u2191j
.text:42CF487F                 jmp     short loc_42CF4887
.text:42CF4881 ; ---------------------------------------------------------------------------
.text:42CF4881
.text:42CF4881 loc_42CF4881:                           ; CODE XREF: ConnectionWrite+3C\u2191j
.text:42CF4881                                         ; ConnectionWrite+4C\u2191j ...
.text:42CF4881                 mov     ecx, [ebp+arg_4]
.text:42CF4884                 mov     [ebp+var_C], ecx
.text:42CF4887
.text:42CF4887 loc_42CF4887:                           ; CODE XREF: ConnectionWrite:loc_42CF487F\u2191j
.text:42CF4887                 mov     edx, [ebp+var_4]
.text:42CF488A                 cmp     dword ptr [edx+0A0h], 0
.text:42CF4891                 jz      short loc_42CF48AC
.text:42CF4893                 mov     eax, [ebp+var_4]
.text:42CF4896                 cmp     dword ptr [eax+0A4h], 0
.text:42CF489D                 jnz     short loc_42CF48AC
.text:42CF489F                 mov     ecx, [ebp+var_4]
.text:42CF48A2                 mov     dword ptr [ecx+0A4h], 1
.text:42CF48AC
.text:42CF48AC loc_42CF48AC:                           ; CODE XREF: ConnectionWrite+13D\u2191j
.text:42CF48AC                                         ; ConnectionWrite+149\u2191j
.text:42CF48AC                 mov     edx, [ebp+var_4]
.text:42CF48AF                 cmp     dword ptr [edx+80h], 1
.text:42CF48B6                 jnz     short loc_42CF48E8
.text:42CF48B8                 lea     eax, [ebp+var_1C]
.text:42CF48BB                 push    eax
.text:42CF48BC                 mov     ecx, dword ptr [ebp+arg_8]
.text:42CF48BF                 push    ecx
.text:42CF48C0                 mov     edx, [ebp+var_C]
.text:42CF48C3                 push    edx
.text:42CF48C4                 mov     eax, [ebp+var_4]
.text:42CF48C7                 push    eax
.text:42CF48C8                 call    sub_42CF652F
.text:42CF48CD                 add     esp, 10h
.text:42CF48D0                 mov     [ebp+var_8], eax
.text:42CF48D3                 cmp     [ebp+var_8], 0
.text:42CF48D7                 jnz     short loc_42CF48E6
.text:42CF48D9                 mov     ecx, [ebp+arg_C]
.text:42CF48DC                 mov     edx, [ebp+var_1C]
.text:42CF48DF                 mov     [ecx], edx
.text:42CF48E1                 jmp     loc_42CF4980
.text:42CF48E6 ; ---------------------------------------------------------------------------
.text:42CF48E6
.text:42CF48E6 loc_42CF48E6:                           ; CODE XREF: ConnectionWrite+183\u2191j
.text:42CF48E6                 jmp     short loc_42CF494C
.text:42CF48E8 ; ---------------------------------------------------------------------------
.text:42CF48E8
.text:42CF48E8 loc_42CF48E8:                           ; CODE XREF: ConnectionWrite+162\u2191j
.text:42CF48E8                 mov     dword ptr [ebp+optval], 7FFFFFFFh
.text:42CF48EF                 push    4               ; optlen
.text:42CF48F1                 lea     eax, [ebp+optval]
.text:42CF48F4                 push    eax             ; optval
.text:42CF48F5                 push    1005h           ; optname
.text:42CF48FA                 push    0FFFFh          ; level
.text:42CF48FF                 mov     ecx, [ebp+s]
.text:42CF4902                 push    ecx             ; s
.text:42CF4903                 call    ds:setsockopt
.text:42CF4909
.text:42CF4909 loc_42CF4909:                           ; CODE XREF: ConnectionWrite+1F6\u2193j
.text:42CF4909                 mov     edx, [ebp+var_8]
.text:42CF490C                 cmp     edx, dword ptr [ebp+arg_8]
.text:42CF490F                 jnb     short loc_42CF494C
.text:42CF4911                 push    0               ; flags
.text:42CF4913                 mov     eax, dword ptr [ebp+arg_8]
.text:42CF4916                 sub     eax, [ebp+var_8]
.text:42CF4919                 push    eax             ; len
.text:42CF491A                 mov     ecx, [ebp+var_C]
.text:42CF491D                 add     ecx, [ebp+var_8]
.text:42CF4920                 push    ecx             ; buf
.text:42CF4921                 mov     edx, [ebp+s]
.text:42CF4924                 push    edx             ; s
.text:42CF4925                 call    ds:send
.text:42CF492B                 mov     [ebp+var_10], eax
.text:42CF492E                 cmp     [ebp+var_10], 0FFFFFFFFh
.text:42CF4932                 jnz     short loc_42CF4941
.text:42CF4934                 call    ds:WSAGetLastError
.text:42CF493A                 mov     ecx, [ebp+arg_C]
.text:42CF493D                 mov     [ecx], eax
.text:42CF493F                 jmp     short loc_42CF4980
.text:42CF4941 ; ---------------------------------------------------------------------------
.text:42CF4941
.text:42CF4941 loc_42CF4941:                           ; CODE XREF: ConnectionWrite+1DE\u2191j
.text:42CF4941                 mov     edx, [ebp+var_8]
.text:42CF4944                 add     edx, [ebp+var_10]
.text:42CF4947                 mov     [ebp+var_8], edx
.text:42CF494A                 jmp     short loc_42CF4909
.text:42CF494C ; ---------------------------------------------------------------------------
.text:42CF494C
.text:42CF494C loc_42CF494C:                           ; CODE XREF: ConnectionWrite:loc_42CF48E6\u2191j
.text:42CF494C                                         ; ConnectionWrite+1BB\u2191j
.text:42CF494C                 mov     eax, [ebp+var_4]
.text:42CF494F                 cmp     dword ptr [eax+64h], 0
.text:42CF4953                 jnz     short loc_42CF4967
.text:42CF4955                 mov     ecx, [ebp+var_4]
.text:42CF4958                 cmp     dword ptr [ecx+68h], 0
.text:42CF495C                 jz      short loc_42CF497B
.text:42CF495E                 mov     edx, [ebp+var_4]
.text:42CF4961                 cmp     dword ptr [edx+6Ch], 0
.text:42CF4965                 jz      short loc_42CF497B
.text:42CF4967
.text:42CF4967 loc_42CF4967:                           ; CODE XREF: ConnectionWrite+1FF\u2191j
.text:42CF4967                 mov     eax, Size
.text:42CF496C                 add     eax, dword_42D01CA4
.text:42CF4972                 mov     ecx, [ebp+var_8]
.text:42CF4975                 sub     ecx, eax
.text:42CF4977                 mov     eax, ecx
.text:42CF4979                 jmp     short loc_42CF4982
.text:42CF497B ; ---------------------------------------------------------------------------
.text:42CF497B
.text:42CF497B loc_42CF497B:                           ; CODE XREF: ConnectionWrite+208\u2191j
.text:42CF497B                                         ; ConnectionWrite+211\u2191j
.text:42CF497B                 mov     eax, [ebp+var_8]
.text:42CF497E                 jmp     short loc_42CF4982
.text:42CF4980 ; ---------------------------------------------------------------------------
.text:42CF4980
.text:42CF4980 loc_42CF4980:                           ; CODE XREF: ConnectionWrite+126\u2191j
.text:42CF4980                                         ; ConnectionWrite+18D\u2191j ...
.text:42CF4980                 xor     eax, eax
.text:42CF4982
.text:42CF4982 loc_42CF4982:                           ; CODE XREF: ConnectionWrite+225\u2191j
.text:42CF4982                                         ; ConnectionWrite+22A\u2191j
.text:42CF4982                 pop     edi
.text:42CF4983                 pop     esi
.text:42CF4984                 mov     esp, ebp
.text:42CF4986                 pop     ebp
.text:42CF4987                 retn
.text:42CF4987 ConnectionWrite endp
.text:42CF4987
.text:42CF4988 ; Exported entry  10. ConnectionWriteAsync
.text:42CF4988
.text:42CF4988 ; =============== S U B R O U T I N E =======================================
.text:42CF4988
.text:42CF4988 ; Attributes: bp-based frame
.text:42CF4988
.text:42CF4988 ; int __cdecl ConnectionWriteAsync(int, void *Src, size_t Size, int)
.text:42CF4988                 public ConnectionWriteAsync
.text:42CF4988 ConnectionWriteAsync proc near          ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4988
.text:42CF4988 var_28          = dword ptr -28h
.text:42CF4988 var_24          = dword ptr -24h
.text:42CF4988 s               = dword ptr -20h
.text:42CF4988 Buffers         = _WSABUF ptr -1Ch
.text:42CF4988 NumberOfBytesSent= dword ptr -14h
.text:42CF4988 var_10          = dword ptr -10h
.text:42CF4988 var_C           = dword ptr -0Ch
.text:42CF4988 var_8           = dword ptr -8
.text:42CF4988 var_4           = dword ptr -4
.text:42CF4988 arg_0           = dword ptr  8
.text:42CF4988 Src             = dword ptr  0Ch
.text:42CF4988 Size            = dword ptr  10h
.text:42CF4988 arg_C           = dword ptr  14h
.text:42CF4988
.text:42CF4988                 push    ebp
.text:42CF4989                 mov     ebp, esp
.text:42CF498B                 sub     esp, 28h
.text:42CF498E                 push    esi
.text:42CF498F                 push    edi
.text:42CF4990                 mov     eax, [ebp+arg_0]
.text:42CF4993                 mov     [ebp+var_4], eax
.text:42CF4996                 mov     [ebp+NumberOfBytesSent], 0
.text:42CF499D                 mov     [ebp+var_8], 0
.text:42CF49A4                 mov     ecx, [ebp+var_4]
.text:42CF49A7                 mov     edx, [ecx+0Ch]
.text:42CF49AA                 mov     [ebp+s], edx
.text:42CF49AD                 mov     [ebp+var_10], 0
.text:42CF49B4                 mov     eax, [ebp+arg_C]
.text:42CF49B7                 mov     dword ptr [eax], 0
.text:42CF49BD                 mov     ecx, [ebp+var_4]
.text:42CF49C0                 cmp     dword ptr [ecx+64h], 0
.text:42CF49C4                 jz      loc_42CF4AB5
.text:42CF49CA                 mov     edx, [ebp+var_4]
.text:42CF49CD                 cmp     dword ptr [edx+0A0h], 0
.text:42CF49D4                 jz      loc_42CF4AB5
.text:42CF49DA                 mov     eax, [ebp+var_4]
.text:42CF49DD                 cmp     dword ptr [eax+0A4h], 0
.text:42CF49E4                 jz      loc_42CF4AB5
.text:42CF49EA                 mov     ecx, [ebp+var_4]
.text:42CF49ED                 cmp     dword ptr [ecx+4Ch], 0
.text:42CF49F1                 jnz     short loc_42CF4A0B
.text:42CF49F3                 push    118Dh
.text:42CF49F8                 push    offset aQSphinxNetlibs_6 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF49FD                 push    offset aPconnectionobj_1 ; "pConnectionObject->pEncryptBuffer != NU"...
.text:42CF4A02                 call    ds:_assert
.text:42CF4A08 ; ---------------------------------------------------------------------------
.text:42CF4A08                 add     esp, 0Ch
.text:42CF4A0B
.text:42CF4A0B loc_42CF4A0B:                           ; CODE XREF: ConnectionWriteAsync+69\u2191j
.text:42CF4A0B                 mov     eax, [ebp+var_4]
.text:42CF4A0E                 mov     ecx, [eax+48h]
.text:42CF4A11                 cmp     ecx, [ebp+Size]
.text:42CF4A14                 jnb     short loc_42CF4A2E
.text:42CF4A16                 push    118Eh
.text:42CF4A1B                 push    offset aQSphinxNetlibs_7 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF4A20                 push    offset aPconnectionobj_2 ; "pConnectionObject->dwMaxEncryptBufSize "...
.text:42CF4A25                 call    ds:_assert
.text:42CF4A2B ; ---------------------------------------------------------------------------
.text:42CF4A2B                 add     esp, 0Ch
.text:42CF4A2E
.text:42CF4A2E loc_42CF4A2E:                           ; CODE XREF: ConnectionWriteAsync+8C\u2191j
.text:42CF4A2E                 mov     eax, Size
.text:42CF4A33                 push    eax             ; Size
.text:42CF4A34                 push    0               ; Val
.text:42CF4A36                 mov     ecx, [ebp+var_4]
.text:42CF4A39                 mov     edx, [ecx+4Ch]
.text:42CF4A3C                 push    edx             ; void *
.text:42CF4A3D                 call    memset
.text:42CF4A42                 add     esp, 0Ch
.text:42CF4A45                 mov     eax, [ebp+Size]
.text:42CF4A48                 push    eax             ; Size
.text:42CF4A49                 mov     ecx, [ebp+Src]
.text:42CF4A4C                 push    ecx             ; Src
.text:42CF4A4D                 mov     edx, [ebp+var_4]
.text:42CF4A50                 mov     eax, [edx+4Ch]
.text:42CF4A53                 add     eax, Size
.text:42CF4A59                 push    eax             ; void *
.text:42CF4A5A                 call    memcpy
.text:42CF4A5F                 add     esp, 0Ch
.text:42CF4A62                 mov     ecx, [ebp+arg_C]
.text:42CF4A65                 push    ecx
.text:42CF4A66                 mov     edx, [ebp+var_4]
.text:42CF4A69                 mov     eax, [edx+4Ch]
.text:42CF4A6C                 push    eax
.text:42CF4A6D                 sub     esp, 14h
.text:42CF4A70                 mov     ecx, 5
.text:42CF4A75                 mov     esi, offset Size
.text:42CF4A7A                 mov     edi, esp
.text:42CF4A7C                 rep movsd
.text:42CF4A7E                 mov     ecx, [ebp+var_4]
.text:42CF4A81                 mov     edx, [ecx+58h]
.text:42CF4A84                 push    edx
.text:42CF4A85                 mov     eax, [ecx+54h]
.text:42CF4A88                 push    eax
.text:42CF4A89                 mov     ecx, [ebp+Size]
.text:42CF4A8C                 push    ecx
.text:42CF4A8D                 call    sub_42CF7D75
.text:42CF4A92                 add     esp, 28h
.text:42CF4A95                 mov     [ebp+Size], eax
.text:42CF4A98                 mov     edx, [ebp+var_4]
.text:42CF4A9B                 mov     eax, [edx+4Ch]
.text:42CF4A9E                 mov     [ebp+var_C], eax
.text:42CF4AA1                 cmp     [ebp+Size], 0
.text:42CF4AA5                 jnz     short loc_42CF4AB3
.text:42CF4AA7                 mov     [ebp+var_10], offset aSecencryptdata_0 ; "SECEncryptData"
.text:42CF4AAE                 jmp     loc_42CF4BE0
.text:42CF4AB3 ; ---------------------------------------------------------------------------
.text:42CF4AB3
.text:42CF4AB3 loc_42CF4AB3:                           ; CODE XREF: ConnectionWriteAsync+11D\u2191j
.text:42CF4AB3                 jmp     short loc_42CF4ABB
.text:42CF4AB5 ; ---------------------------------------------------------------------------
.text:42CF4AB5
.text:42CF4AB5 loc_42CF4AB5:                           ; CODE XREF: ConnectionWriteAsync+3C\u2191j
.text:42CF4AB5                                         ; ConnectionWriteAsync+4C\u2191j ...
.text:42CF4AB5                 mov     ecx, [ebp+Src]
.text:42CF4AB8                 mov     [ebp+var_C], ecx
.text:42CF4ABB
.text:42CF4ABB loc_42CF4ABB:                           ; CODE XREF: ConnectionWriteAsync:loc_42CF4AB3\u2191j
.text:42CF4ABB                 mov     edx, [ebp+var_4]
.text:42CF4ABE                 cmp     dword ptr [edx+0A0h], 0
.text:42CF4AC5                 jz      short loc_42CF4AE0
.text:42CF4AC7                 mov     eax, [ebp+var_4]
.text:42CF4ACA                 cmp     dword ptr [eax+0A4h], 0
.text:42CF4AD1                 jnz     short loc_42CF4AE0
.text:42CF4AD3                 mov     ecx, [ebp+var_4]
.text:42CF4AD6                 mov     dword ptr [ecx+0A4h], 1
.text:42CF4AE0
.text:42CF4AE0 loc_42CF4AE0:                           ; CODE XREF: ConnectionWriteAsync+13D\u2191j
.text:42CF4AE0                                         ; ConnectionWriteAsync+149\u2191j
.text:42CF4AE0                 mov     edx, [ebp+var_4]
.text:42CF4AE3                 cmp     dword ptr [edx+80h], 1
.text:42CF4AEA                 jnz     short loc_42CF4B60
.text:42CF4AEC                 lea     eax, [ebp+var_24]
.text:42CF4AEF                 push    eax
.text:42CF4AF0                 lea     ecx, [ebp+NumberOfBytesSent]
.text:42CF4AF3                 push    ecx
.text:42CF4AF4                 mov     edx, [ebp+Size]
.text:42CF4AF7                 push    edx
.text:42CF4AF8                 mov     eax, [ebp+var_C]
.text:42CF4AFB                 push    eax
.text:42CF4AFC                 mov     ecx, [ebp+var_4]
.text:42CF4AFF                 push    ecx
.text:42CF4B00                 call    sub_42CF618A
.text:42CF4B05                 add     esp, 14h
.text:42CF4B08                 mov     [ebp+var_28], eax
.text:42CF4B0B                 cmp     [ebp+var_28], 2
.text:42CF4B0F                 jnz     short loc_42CF4B1E
.text:42CF4B11                 mov     edx, [ebp+arg_C]
.text:42CF4B14                 mov     eax, [ebp+var_24]
.text:42CF4B17                 mov     [edx], eax
.text:42CF4B19                 jmp     loc_42CF4BE0
.text:42CF4B1E ; ---------------------------------------------------------------------------
.text:42CF4B1E
.text:42CF4B1E loc_42CF4B1E:                           ; CODE XREF: ConnectionWriteAsync+187\u2191j
.text:42CF4B1E                 cmp     [ebp+var_28], 1
.text:42CF4B22                 jnz     short loc_42CF4B49
.text:42CF4B24                 mov     ecx, [ebp+arg_C]
.text:42CF4B27                 mov     dword ptr [ecx], 1
.text:42CF4B2D                 mov     edx, [ebp+var_4]
.text:42CF4B30                 mov     eax, [ebp+Size]
.text:42CF4B33                 mov     [edx+38h], eax
.text:42CF4B36                 mov     ecx, [ebp+var_4]
.text:42CF4B39                 mov     edx, [ebp+NumberOfBytesSent]
.text:42CF4B3C                 mov     [ecx+3Ch], edx
.text:42CF4B3F                 mov     eax, 1
.text:42CF4B44                 jmp     loc_42CF4BE2
.text:42CF4B49 ; ---------------------------------------------------------------------------
.text:42CF4B49
.text:42CF4B49 loc_42CF4B49:                           ; CODE XREF: ConnectionWriteAsync+19A\u2191j
.text:42CF4B49                 cmp     [ebp+var_28], 0
.text:42CF4B4D                 jnz     short loc_42CF4B5E
.text:42CF4B4F                 mov     eax, [ebp+NumberOfBytesSent]
.text:42CF4B52                 mov     [ebp+var_8], eax
.text:42CF4B55                 mov     ecx, [ebp+arg_C]
.text:42CF4B58                 mov     dword ptr [ecx], 0
.text:42CF4B5E
.text:42CF4B5E loc_42CF4B5E:                           ; CODE XREF: ConnectionWriteAsync+1C5\u2191j
.text:42CF4B5E                 jmp     short loc_42CF4BD0
.text:42CF4B60 ; ---------------------------------------------------------------------------
.text:42CF4B60
.text:42CF4B60 loc_42CF4B60:                           ; CODE XREF: ConnectionWriteAsync+162\u2191j
.text:42CF4B60                 mov     edx, [ebp+var_C]
.text:42CF4B63                 mov     [ebp+Buffers.buf], edx
.text:42CF4B66                 mov     eax, [ebp+Size]
.text:42CF4B69                 mov     [ebp+Buffers.len], eax
.text:42CF4B6C                 push    0               ; lpCompletionRoutine
.text:42CF4B6E                 mov     ecx, [ebp+var_4]
.text:42CF4B71                 add     ecx, 10h
.text:42CF4B74                 push    ecx             ; lpOverlapped
.text:42CF4B75                 push    0               ; dwFlags
.text:42CF4B77                 lea     edx, [ebp+NumberOfBytesSent]
.text:42CF4B7A                 push    edx             ; lpNumberOfBytesSent
.text:42CF4B7B                 push    1               ; dwBufferCount
.text:42CF4B7D                 lea     eax, [ebp+Buffers]
.text:42CF4B80                 push    eax             ; lpBuffers
.text:42CF4B81                 mov     ecx, [ebp+s]
.text:42CF4B84                 push    ecx             ; s
.text:42CF4B85                 call    ds:WSASend
.text:42CF4B8B                 cmp     eax, 0FFFFFFFFh
.text:42CF4B8E                 jnz     short loc_42CF4BCA
.text:42CF4B90                 call    ds:WSAGetLastError
.text:42CF4B96                 mov     edx, [ebp+arg_C]
.text:42CF4B99                 mov     [edx], eax
.text:42CF4B9B                 mov     eax, [ebp+arg_C]
.text:42CF4B9E                 cmp     dword ptr [eax], 3E5h
.text:42CF4BA4                 jz      short loc_42CF4BA8
.text:42CF4BA6                 jmp     short loc_42CF4BE0
.text:42CF4BA8 ; ---------------------------------------------------------------------------
.text:42CF4BA8
.text:42CF4BA8 loc_42CF4BA8:                           ; CODE XREF: ConnectionWriteAsync+21C\u2191j
.text:42CF4BA8                 mov     ecx, [ebp+arg_C]
.text:42CF4BAB                 mov     dword ptr [ecx], 1
.text:42CF4BB1                 mov     edx, [ebp+var_4]
.text:42CF4BB4                 mov     eax, [ebp+Size]
.text:42CF4BB7                 mov     [edx+38h], eax
.text:42CF4BBA                 mov     ecx, [ebp+var_4]
.text:42CF4BBD                 mov     edx, [ebp+NumberOfBytesSent]
.text:42CF4BC0                 mov     [ecx+3Ch], edx
.text:42CF4BC3                 mov     eax, 1
.text:42CF4BC8                 jmp     short loc_42CF4BE2
.text:42CF4BCA ; ---------------------------------------------------------------------------
.text:42CF4BCA
.text:42CF4BCA loc_42CF4BCA:                           ; CODE XREF: ConnectionWriteAsync+206\u2191j
.text:42CF4BCA                 mov     eax, [ebp+NumberOfBytesSent]
.text:42CF4BCD                 mov     [ebp+var_8], eax
.text:42CF4BD0
.text:42CF4BD0 loc_42CF4BD0:                           ; CODE XREF: ConnectionWriteAsync:loc_42CF4B5E\u2191j
.text:42CF4BD0                 mov     ecx, [ebp+arg_C]
.text:42CF4BD3                 mov     dword ptr [ecx], 0
.text:42CF4BD9                 mov     eax, 1
.text:42CF4BDE                 jmp     short loc_42CF4BE2
.text:42CF4BE0 ; ---------------------------------------------------------------------------
.text:42CF4BE0
.text:42CF4BE0 loc_42CF4BE0:                           ; CODE XREF: ConnectionWriteAsync+126\u2191j
.text:42CF4BE0                                         ; ConnectionWriteAsync+191\u2191j ...
.text:42CF4BE0                 xor     eax, eax
.text:42CF4BE2
.text:42CF4BE2 loc_42CF4BE2:                           ; CODE XREF: ConnectionWriteAsync+1BC\u2191j
.text:42CF4BE2                                         ; ConnectionWriteAsync+240\u2191j ...
.text:42CF4BE2                 pop     edi
.text:42CF4BE3                 pop     esi
.text:42CF4BE4                 mov     esp, ebp
.text:42CF4BE6                 pop     ebp
.text:42CF4BE7                 retn
.text:42CF4BE7 ConnectionWriteAsync endp
.text:42CF4BE7
.text:42CF4BE8 ; Exported entry  11. ConnectionWriteStatus
.text:42CF4BE8
.text:42CF4BE8 ; =============== S U B R O U T I N E =======================================
.text:42CF4BE8
.text:42CF4BE8 ; Attributes: bp-based frame
.text:42CF4BE8
.text:42CF4BE8 ; int __cdecl ConnectionWriteStatus(int, DWORD dwMilliseconds, int)
.text:42CF4BE8                 public ConnectionWriteStatus
.text:42CF4BE8 ConnectionWriteStatus proc near         ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4BE8
.text:42CF4BE8 var_1C          = dword ptr -1Ch
.text:42CF4BE8 var_18          = dword ptr -18h
.text:42CF4BE8 s               = dword ptr -14h
.text:42CF4BE8 dwFlags         = dword ptr -10h
.text:42CF4BE8 var_C           = dword ptr -0Ch
.text:42CF4BE8 cbTransfer      = dword ptr -8
.text:42CF4BE8 var_4           = dword ptr -4
.text:42CF4BE8 arg_0           = dword ptr  8
.text:42CF4BE8 dwMilliseconds  = dword ptr  0Ch
.text:42CF4BE8 arg_8           = dword ptr  10h
.text:42CF4BE8
.text:42CF4BE8                 push    ebp
.text:42CF4BE9                 mov     ebp, esp
.text:42CF4BEB                 sub     esp, 1Ch
.text:42CF4BEE                 mov     eax, [ebp+arg_0]
.text:42CF4BF1                 mov     [ebp+var_4], eax
.text:42CF4BF4                 mov     [ebp+cbTransfer], 0
.text:42CF4BFB                 mov     ecx, [ebp+var_4]
.text:42CF4BFE                 mov     edx, [ecx+0Ch]
.text:42CF4C01                 mov     [ebp+s], edx
.text:42CF4C04                 mov     eax, [ebp+arg_8]
.text:42CF4C07                 mov     dword ptr [eax], 0
.text:42CF4C0D                 mov     ecx, [ebp+var_4]
.text:42CF4C10                 cmp     dword ptr [ecx+80h], 1
.text:42CF4C17                 jnz     short loc_42CF4C97
.text:42CF4C19                 lea     edx, [ebp+var_18]
.text:42CF4C1C                 push    edx
.text:42CF4C1D                 lea     eax, [ebp+cbTransfer]
.text:42CF4C20                 push    eax
.text:42CF4C21                 mov     ecx, [ebp+dwMilliseconds]
.text:42CF4C24                 push    ecx
.text:42CF4C25                 mov     edx, [ebp+var_4]
.text:42CF4C28                 push    edx
.text:42CF4C29                 call    sub_42CF62C4
.text:42CF4C2E                 add     esp, 10h
.text:42CF4C31                 mov     [ebp+var_1C], eax
.text:42CF4C34                 cmp     [ebp+var_1C], 2
.text:42CF4C38                 jnz     short loc_42CF4C47
.text:42CF4C3A                 mov     eax, [ebp+arg_8]
.text:42CF4C3D                 mov     ecx, [ebp+var_18]
.text:42CF4C40                 mov     [eax], ecx
.text:42CF4C42                 jmp     loc_42CF4D2F
.text:42CF4C47 ; ---------------------------------------------------------------------------
.text:42CF4C47
.text:42CF4C47 loc_42CF4C47:                           ; CODE XREF: ConnectionWriteStatus+50\u2191j
.text:42CF4C47                 cmp     [ebp+var_1C], 1
.text:42CF4C4B                 jnz     short loc_42CF4C60
.text:42CF4C4D                 mov     edx, [ebp+arg_8]
.text:42CF4C50                 mov     dword ptr [edx], 1
.text:42CF4C56                 mov     eax, 1
.text:42CF4C5B                 jmp     loc_42CF4D31
.text:42CF4C60 ; ---------------------------------------------------------------------------
.text:42CF4C60
.text:42CF4C60 loc_42CF4C60:                           ; CODE XREF: ConnectionWriteStatus+63\u2191j
.text:42CF4C60                 cmp     [ebp+var_1C], 0
.text:42CF4C64                 jnz     short loc_42CF4C79
.text:42CF4C66                 mov     eax, [ebp+var_4]
.text:42CF4C69                 mov     ecx, [ebp+var_4]
.text:42CF4C6C                 mov     edx, [eax+38h]
.text:42CF4C6F                 cmp     edx, [ecx+3Ch]
.text:42CF4C72                 jnz     short loc_42CF4C79
.text:42CF4C74                 jmp     loc_42CF4D1F
.text:42CF4C79 ; ---------------------------------------------------------------------------
.text:42CF4C79
.text:42CF4C79 loc_42CF4C79:                           ; CODE XREF: ConnectionWriteStatus+7C\u2191j
.text:42CF4C79                                         ; ConnectionWriteStatus+8A\u2191j
.text:42CF4C79                 mov     eax, [ebp+var_4]
.text:42CF4C7C                 mov     ecx, [ebp+cbTransfer]
.text:42CF4C7F                 cmp     ecx, [eax+38h]
.text:42CF4C82                 jz      short loc_42CF4C92
.text:42CF4C84                 mov     edx, [ebp+arg_8]
.text:42CF4C87                 mov     dword ptr [edx], 0Bh
.text:42CF4C8D                 jmp     loc_42CF4D2F
.text:42CF4C92 ; ---------------------------------------------------------------------------
.text:42CF4C92
.text:42CF4C92 loc_42CF4C92:                           ; CODE XREF: ConnectionWriteStatus+9A\u2191j
.text:42CF4C92                 jmp     loc_42CF4D1F
.text:42CF4C97 ; ---------------------------------------------------------------------------
.text:42CF4C97
.text:42CF4C97 loc_42CF4C97:                           ; CODE XREF: ConnectionWriteStatus+2F\u2191j
.text:42CF4C97                 push    1               ; bAlertable
.text:42CF4C99                 mov     eax, [ebp+dwMilliseconds]
.text:42CF4C9C                 push    eax             ; dwMilliseconds
.text:42CF4C9D                 mov     ecx, [ebp+var_4]
.text:42CF4CA0                 mov     edx, [ecx+20h]
.text:42CF4CA3                 push    edx             ; hHandle
.text:42CF4CA4                 call    ds:WaitForSingleObjectEx
.text:42CF4CAA                 mov     [ebp+var_C], eax
.text:42CF4CAD                 cmp     [ebp+var_C], 0
.text:42CF4CB1                 jz      short loc_42CF4CDD
.text:42CF4CB3                 call    ds:GetLastError
.text:42CF4CB9                 cmp     eax, 3E5h
.text:42CF4CBE                 jnz     short loc_42CF4CD0
.text:42CF4CC0                 mov     eax, [ebp+arg_8]
.text:42CF4CC3                 mov     dword ptr [eax], 1
.text:42CF4CC9                 mov     eax, 1
.text:42CF4CCE                 jmp     short loc_42CF4D31
.text:42CF4CD0 ; ---------------------------------------------------------------------------
.text:42CF4CD0
.text:42CF4CD0 loc_42CF4CD0:                           ; CODE XREF: ConnectionWriteStatus+D6\u2191j
.text:42CF4CD0                 call    ds:GetLastError
.text:42CF4CD6                 mov     ecx, [ebp+arg_8]
.text:42CF4CD9                 mov     [ecx], eax
.text:42CF4CDB                 jmp     short loc_42CF4D2F
.text:42CF4CDD ; ---------------------------------------------------------------------------
.text:42CF4CDD
.text:42CF4CDD loc_42CF4CDD:                           ; CODE XREF: ConnectionWriteStatus+C9\u2191j
.text:42CF4CDD                 lea     edx, [ebp+dwFlags]
.text:42CF4CE0                 push    edx             ; lpdwFlags
.text:42CF4CE1                 push    1               ; fWait
.text:42CF4CE3                 lea     eax, [ebp+cbTransfer]
.text:42CF4CE6                 push    eax             ; lpcbTransfer
.text:42CF4CE7                 mov     ecx, [ebp+var_4]
.text:42CF4CEA                 add     ecx, 10h
.text:42CF4CED                 push    ecx             ; lpOverlapped
.text:42CF4CEE                 mov     edx, [ebp+s]
.text:42CF4CF1                 push    edx             ; s
.text:42CF4CF2                 call    ds:WSAGetOverlappedResult
.text:42CF4CF8                 test    eax, eax
.text:42CF4CFA                 jnz     short loc_42CF4D09
.text:42CF4CFC                 call    ds:GetLastError
.text:42CF4D02                 mov     ecx, [ebp+arg_8]
.text:42CF4D05                 mov     [ecx], eax
.text:42CF4D07                 jmp     short loc_42CF4D2F
.text:42CF4D09 ; ---------------------------------------------------------------------------
.text:42CF4D09
.text:42CF4D09 loc_42CF4D09:                           ; CODE XREF: ConnectionWriteStatus+112\u2191j
.text:42CF4D09                 mov     edx, [ebp+var_4]
.text:42CF4D0C                 mov     eax, [ebp+cbTransfer]
.text:42CF4D0F                 cmp     eax, [edx+38h]
.text:42CF4D12                 jz      short loc_42CF4D1F
.text:42CF4D14                 mov     ecx, [ebp+arg_8]
.text:42CF4D17                 mov     dword ptr [ecx], 0Bh
.text:42CF4D1D                 jmp     short loc_42CF4D2F
.text:42CF4D1F ; ---------------------------------------------------------------------------
.text:42CF4D1F
.text:42CF4D1F loc_42CF4D1F:                           ; CODE XREF: ConnectionWriteStatus+8C\u2191j
.text:42CF4D1F                                         ; ConnectionWriteStatus:loc_42CF4C92\u2191j ...
.text:42CF4D1F                 mov     edx, [ebp+arg_8]
.text:42CF4D22                 mov     dword ptr [edx], 0
.text:42CF4D28                 mov     eax, 1
.text:42CF4D2D                 jmp     short loc_42CF4D31
.text:42CF4D2F ; ---------------------------------------------------------------------------
.text:42CF4D2F
.text:42CF4D2F loc_42CF4D2F:                           ; CODE XREF: ConnectionWriteStatus+5A\u2191j
.text:42CF4D2F                                         ; ConnectionWriteStatus+A5\u2191j ...
.text:42CF4D2F                 xor     eax, eax
.text:42CF4D31
.text:42CF4D31 loc_42CF4D31:                           ; CODE XREF: ConnectionWriteStatus+73\u2191j
.text:42CF4D31                                         ; ConnectionWriteStatus+E6\u2191j ...
.text:42CF4D31                 mov     esp, ebp
.text:42CF4D33                 pop     ebp
.text:42CF4D34                 retn
.text:42CF4D34 ConnectionWriteStatus endp
.text:42CF4D34
.text:42CF4D35 ; Exported entry  12. ConnectionSecureClient
.text:42CF4D35
.text:42CF4D35 ; =============== S U B R O U T I N E =======================================
.text:42CF4D35
.text:42CF4D35 ; Attributes: bp-based frame
.text:42CF4D35
.text:42CF4D35                 public ConnectionSecureClient
.text:42CF4D35 ConnectionSecureClient proc near        ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4D35
.text:42CF4D35 var_8           = dword ptr -8
.text:42CF4D35 var_4           = dword ptr -4
.text:42CF4D35 arg_0           = dword ptr  8
.text:42CF4D35 arg_4           = dword ptr  0Ch
.text:42CF4D35 arg_8           = dword ptr  10h
.text:42CF4D35 arg_C           = dword ptr  14h
.text:42CF4D35 arg_10          = dword ptr  18h
.text:42CF4D35
.text:42CF4D35                 push    ebp
.text:42CF4D36                 mov     ebp, esp
.text:42CF4D38                 sub     esp, 8
.text:42CF4D3B                 mov     [ebp+var_4], 0
.text:42CF4D42                 mov     eax, [ebp+arg_0]
.text:42CF4D45                 mov     [ebp+var_8], eax
.text:42CF4D48                 mov     ecx, [ebp+var_8]
.text:42CF4D4B                 cmp     dword ptr [ecx+98h], 0
.text:42CF4D52                 jnz     short loc_42CF4DBD
.text:42CF4D54                 push    1Ch
.text:42CF4D56                 mov     edx, [ebp+var_8]
.text:42CF4D59                 mov     eax, [edx+74h]
.text:42CF4D5C                 push    eax
.text:42CF4D5D                 mov     ecx, [ebp+var_8]
.text:42CF4D60                 call    dword ptr [ecx+78h]
.text:42CF4D63                 add     esp, 8
.text:42CF4D66                 mov     edx, [ebp+var_8]
.text:42CF4D69                 mov     [edx+98h], eax
.text:42CF4D6F                 mov     eax, [ebp+var_8]
.text:42CF4D72                 cmp     dword ptr [eax+98h], 0
.text:42CF4D79                 jnz     short loc_42CF4D8E
.text:42CF4D7B                 mov     ecx, [ebp+arg_10]
.text:42CF4D7E                 mov     dword ptr [ecx], 0
.text:42CF4D84                 mov     eax, 3
.text:42CF4D89                 jmp     loc_42CF4E8A
.text:42CF4D8E ; ---------------------------------------------------------------------------
.text:42CF4D8E
.text:42CF4D8E loc_42CF4D8E:                           ; CODE XREF: ConnectionSecureClient+44\u2191j
.text:42CF4D8E                 mov     edx, [ebp+var_8]
.text:42CF4D91                 mov     eax, [edx+98h]
.text:42CF4D97                 mov     dword ptr [eax], 1
.text:42CF4D9D                 mov     ecx, [ebp+var_8]
.text:42CF4DA0                 mov     edx, [ecx+98h]
.text:42CF4DA6                 mov     dword ptr [edx+0Ch], 0
.text:42CF4DAD                 mov     eax, [ebp+var_8]
.text:42CF4DB0                 mov     ecx, [eax+98h]
.text:42CF4DB6                 mov     dword ptr [ecx+10h], 0
.text:42CF4DBD
.text:42CF4DBD loc_42CF4DBD:                           ; CODE XREF: ConnectionSecureClient+1D\u2191j
.text:42CF4DBD                 mov     edx, [ebp+var_8]
.text:42CF4DC0                 cmp     dword ptr [edx+98h], 0
.text:42CF4DC7                 jnz     short loc_42CF4DE1
.text:42CF4DC9                 push    12F1h
.text:42CF4DCE                 push    offset aQSphinxNetlibs_8 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF4DD3                 push    offset aPconnobjPas ; "pConnObj->pAS"
.text:42CF4DD8                 call    ds:_assert
.text:42CF4DDE ; ---------------------------------------------------------------------------
.text:42CF4DDE                 add     esp, 0Ch
.text:42CF4DE1
.text:42CF4DE1 loc_42CF4DE1:                           ; CODE XREF: ConnectionSecureClient+92\u2191j
.text:42CF4DE1                 mov     ecx, [ebp+arg_10]
.text:42CF4DE4                 mov     edx, [ecx]
.text:42CF4DE6                 sub     edx, 3
.text:42CF4DE9                 mov     eax, [ebp+arg_10]
.text:42CF4DEC                 mov     [eax], edx
.text:42CF4DEE                 lea     ecx, [ebp+var_4]
.text:42CF4DF1                 push    ecx
.text:42CF4DF2                 mov     edx, [ebp+arg_10]
.text:42CF4DF5                 push    edx
.text:42CF4DF6                 mov     eax, [ebp+arg_C]
.text:42CF4DF9                 add     eax, 3
.text:42CF4DFC                 push    eax
.text:42CF4DFD                 mov     ecx, [ebp+arg_8]
.text:42CF4E00                 push    ecx
.text:42CF4E01                 mov     edx, [ebp+arg_4]
.text:42CF4E04                 push    edx
.text:42CF4E05                 mov     eax, [ebp+var_8]
.text:42CF4E08                 mov     ecx, [eax+98h]
.text:42CF4E0E                 push    ecx
.text:42CF4E0F                 call    sub_42CFC325
.text:42CF4E14                 add     esp, 18h
.text:42CF4E17                 test    eax, eax
.text:42CF4E19                 jnz     short loc_42CF4E3E
.text:42CF4E1B                 mov     edx, [ebp+arg_10]
.text:42CF4E1E                 cmp     dword ptr [edx], 0
.text:42CF4E21                 jnz     short loc_42CF4E2A
.text:42CF4E23                 mov     eax, 3
.text:42CF4E28                 jmp     short loc_42CF4E8A
.text:42CF4E2A ; ---------------------------------------------------------------------------
.text:42CF4E2A
.text:42CF4E2A loc_42CF4E2A:                           ; CODE XREF: ConnectionSecureClient+EC\u2191j
.text:42CF4E2A                 mov     eax, [ebp+arg_10]
.text:42CF4E2D                 mov     ecx, [eax]
.text:42CF4E2F                 add     ecx, 3
.text:42CF4E32                 mov     edx, [ebp+arg_10]
.text:42CF4E35                 mov     [edx], ecx
.text:42CF4E37                 mov     eax, 4
.text:42CF4E3C                 jmp     short loc_42CF4E8A
.text:42CF4E3E ; ---------------------------------------------------------------------------
.text:42CF4E3E
.text:42CF4E3E loc_42CF4E3E:                           ; CODE XREF: ConnectionSecureClient+E4\u2191j
.text:42CF4E3E                 mov     eax, [ebp+arg_10]
.text:42CF4E41                 cmp     dword ptr [eax], 0
.text:42CF4E44                 jbe     short loc_42CF4E72
.text:42CF4E46                 mov     ecx, [ebp+arg_C]
.text:42CF4E49                 mov     byte ptr [ecx], 0EDh ; 'í'
.text:42CF4E4C                 mov     edx, [ebp+arg_C]
.text:42CF4E4F                 mov     eax, [ebp+arg_10]
.text:42CF4E52                 mov     cl, [eax]
.text:42CF4E54                 mov     [edx+1], cl
.text:42CF4E57                 mov     edx, [ebp+arg_10]
.text:42CF4E5A                 mov     eax, [edx]
.text:42CF4E5C                 shr     eax, 8
.text:42CF4E5F                 mov     ecx, [ebp+arg_C]
.text:42CF4E62                 mov     [ecx+2], al
.text:42CF4E65                 mov     edx, [ebp+arg_10]
.text:42CF4E68                 mov     eax, [edx]
.text:42CF4E6A                 add     eax, 3
.text:42CF4E6D                 mov     ecx, [ebp+arg_10]
.text:42CF4E70                 mov     [ecx], eax
.text:42CF4E72
.text:42CF4E72 loc_42CF4E72:                           ; CODE XREF: ConnectionSecureClient+10F\u2191j
.text:42CF4E72                 cmp     [ebp+var_4], 0
.text:42CF4E76                 jz      short loc_42CF4E85
.text:42CF4E78                 mov     edx, [ebp+arg_10]
.text:42CF4E7B                 mov     dword ptr [edx], 0
.text:42CF4E81                 xor     eax, eax
.text:42CF4E83                 jmp     short loc_42CF4E8A
.text:42CF4E85 ; ---------------------------------------------------------------------------
.text:42CF4E85
.text:42CF4E85 loc_42CF4E85:                           ; CODE XREF: ConnectionSecureClient+141\u2191j
.text:42CF4E85                 mov     eax, 1
.text:42CF4E8A
.text:42CF4E8A loc_42CF4E8A:                           ; CODE XREF: ConnectionSecureClient+54\u2191j
.text:42CF4E8A                                         ; ConnectionSecureClient+F3\u2191j ...
.text:42CF4E8A                 mov     esp, ebp
.text:42CF4E8C                 pop     ebp
.text:42CF4E8D                 retn
.text:42CF4E8D ConnectionSecureClient endp
.text:42CF4E8D
.text:42CF4E8E ; Exported entry  13. ConnectionImpersonate
.text:42CF4E8E
.text:42CF4E8E ; =============== S U B R O U T I N E =======================================
.text:42CF4E8E
.text:42CF4E8E ; Attributes: bp-based frame
.text:42CF4E8E
.text:42CF4E8E                 public ConnectionImpersonate
.text:42CF4E8E ConnectionImpersonate proc near         ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4E8E
.text:42CF4E8E hNamedPipe      = dword ptr -14h
.text:42CF4E8E var_10          = dword ptr -10h
.text:42CF4E8E var_C           = dword ptr -0Ch
.text:42CF4E8E var_8           = dword ptr -8
.text:42CF4E8E var_4           = dword ptr -4
.text:42CF4E8E arg_0           = dword ptr  8
.text:42CF4E8E
.text:42CF4E8E                 push    ebp
.text:42CF4E8F                 mov     ebp, esp
.text:42CF4E91                 sub     esp, 14h
.text:42CF4E94                 mov     eax, [ebp+arg_0]
.text:42CF4E97                 mov     [ebp+var_4], eax
.text:42CF4E9A                 mov     [ebp+var_C], 0
.text:42CF4EA1                 mov     ecx, [ebp+var_4]
.text:42CF4EA4                 mov     edx, [ecx+84h]
.text:42CF4EAA                 mov     [ebp+var_10], edx
.text:42CF4EAD                 cmp     [ebp+var_10], 1
.text:42CF4EB1                 jz      short loc_42CF4EBB
.text:42CF4EB3                 cmp     [ebp+var_10], 3
.text:42CF4EB7                 jz      short loc_42CF4EC9
.text:42CF4EB9                 jmp     short loc_42CF4EDE
.text:42CF4EBB ; ---------------------------------------------------------------------------
.text:42CF4EBB
.text:42CF4EBB loc_42CF4EBB:                           ; CODE XREF: ConnectionImpersonate+23\u2191j
.text:42CF4EBB                 mov     eax, [ebp+var_4]
.text:42CF4EBE                 mov     ecx, [eax+88h]
.text:42CF4EC4                 mov     [ebp+var_C], ecx
.text:42CF4EC7                 jmp     short loc_42CF4EDE
.text:42CF4EC9 ; ---------------------------------------------------------------------------
.text:42CF4EC9
.text:42CF4EC9 loc_42CF4EC9:                           ; CODE XREF: ConnectionImpersonate+29\u2191j
.text:42CF4EC9                 mov     edx, [ebp+var_4]
.text:42CF4ECC                 mov     eax, [edx+88h]
.text:42CF4ED2                 mov     [ebp+var_C], eax
.text:42CF4ED5                 mov     ecx, [ebp+var_C]
.text:42CF4ED8                 add     ecx, 4
.text:42CF4EDB                 mov     [ebp+var_C], ecx
.text:42CF4EDE
.text:42CF4EDE loc_42CF4EDE:                           ; CODE XREF: ConnectionImpersonate+2B\u2191j
.text:42CF4EDE                                         ; ConnectionImpersonate+39\u2191j
.text:42CF4EDE                 cmp     [ebp+var_C], 0
.text:42CF4EE2                 jnz     short loc_42CF4EED
.text:42CF4EE4                 mov     [ebp+hNamedPipe], 0
.text:42CF4EEB                 jmp     short loc_42CF4EF5
.text:42CF4EED ; ---------------------------------------------------------------------------
.text:42CF4EED
.text:42CF4EED loc_42CF4EED:                           ; CODE XREF: ConnectionImpersonate+54\u2191j
.text:42CF4EED                 mov     edx, [ebp+var_C]
.text:42CF4EF0                 mov     eax, [edx]
.text:42CF4EF2                 mov     [ebp+hNamedPipe], eax
.text:42CF4EF5
.text:42CF4EF5 loc_42CF4EF5:                           ; CODE XREF: ConnectionImpersonate+5D\u2191j
.text:42CF4EF5                 mov     ecx, [ebp+var_4]
.text:42CF4EF8                 mov     edx, [ecx+84h]
.text:42CF4EFE                 push    edx             ; int
.text:42CF4EFF                 mov     eax, [ebp+var_4]
.text:42CF4F02                 mov     ecx, [eax+98h]
.text:42CF4F08                 push    ecx             ; int
.text:42CF4F09                 mov     edx, [ebp+hNamedPipe]
.text:42CF4F0C                 push    edx             ; hNamedPipe
.text:42CF4F0D                 call    sub_42CFC4F9
.text:42CF4F12                 add     esp, 0Ch
.text:42CF4F15                 mov     [ebp+var_8], eax
.text:42CF4F18                 mov     eax, [ebp+var_8]
.text:42CF4F1B                 mov     esp, ebp
.text:42CF4F1D                 pop     ebp
.text:42CF4F1E                 retn
.text:42CF4F1E ConnectionImpersonate endp
.text:42CF4F1E
.text:42CF4F1F ; Exported entry  14. ConnectionRevert
.text:42CF4F1F
.text:42CF4F1F ; =============== S U B R O U T I N E =======================================
.text:42CF4F1F
.text:42CF4F1F ; Attributes: bp-based frame
.text:42CF4F1F
.text:42CF4F1F                 public ConnectionRevert
.text:42CF4F1F ConnectionRevert proc near              ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4F1F
.text:42CF4F1F var_4           = dword ptr -4
.text:42CF4F1F arg_0           = dword ptr  8
.text:42CF4F1F
.text:42CF4F1F                 push    ebp
.text:42CF4F20                 mov     ebp, esp
.text:42CF4F22                 push    ecx
.text:42CF4F23                 mov     eax, [ebp+arg_0]
.text:42CF4F26                 mov     [ebp+var_4], eax
.text:42CF4F29                 mov     ecx, [ebp+var_4]
.text:42CF4F2C                 mov     edx, [ecx+84h]
.text:42CF4F32                 push    edx
.text:42CF4F33                 mov     eax, [ebp+var_4]
.text:42CF4F36                 mov     ecx, [eax+98h]
.text:42CF4F3C                 push    ecx
.text:42CF4F3D                 call    sub_42CFC577
.text:42CF4F42                 add     esp, 8
.text:42CF4F45                 mov     esp, ebp
.text:42CF4F47                 pop     ebp
.text:42CF4F48                 retn
.text:42CF4F48 ConnectionRevert endp
.text:42CF4F48
.text:42CF4F49 ; Exported entry  15. ConnectionTermSec
.text:42CF4F49
.text:42CF4F49 ; =============== S U B R O U T I N E =======================================
.text:42CF4F49
.text:42CF4F49 ; Attributes: bp-based frame
.text:42CF4F49
.text:42CF4F49                 public ConnectionTermSec
.text:42CF4F49 ConnectionTermSec proc near             ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF4F49
.text:42CF4F49 var_4           = dword ptr -4
.text:42CF4F49 arg_0           = dword ptr  8
.text:42CF4F49
.text:42CF4F49                 push    ebp
.text:42CF4F4A                 mov     ebp, esp
.text:42CF4F4C                 push    ecx
.text:42CF4F4D                 mov     eax, [ebp+arg_0]
.text:42CF4F50                 mov     [ebp+var_4], eax
.text:42CF4F53                 cmp     [ebp+var_4], 0
.text:42CF4F57                 jz      short loc_42CF4F65
.text:42CF4F59                 mov     ecx, [ebp+var_4]
.text:42CF4F5C                 cmp     dword ptr [ecx+98h], 0
.text:42CF4F63                 jnz     short loc_42CF4F69
.text:42CF4F65
.text:42CF4F65 loc_42CF4F65:                           ; CODE XREF: ConnectionTermSec+E\u2191j
.text:42CF4F65                 xor     eax, eax
.text:42CF4F67                 jmp     short loc_42CF4F9C
.text:42CF4F69 ; ---------------------------------------------------------------------------
.text:42CF4F69
.text:42CF4F69 loc_42CF4F69:                           ; CODE XREF: ConnectionTermSec+1A\u2191j
.text:42CF4F69                 mov     edx, [ebp+arg_0]
.text:42CF4F6C                 mov     [ebp+var_4], edx
.text:42CF4F6F                 mov     eax, [ebp+var_4]
.text:42CF4F72                 add     eax, 74h ; 't'
.text:42CF4F75                 sub     esp, 0Ch
.text:42CF4F78                 mov     ecx, esp
.text:42CF4F7A                 mov     edx, [eax]
.text:42CF4F7C                 mov     [ecx], edx
.text:42CF4F7E                 mov     edx, [eax+4]
.text:42CF4F81                 mov     [ecx+4], edx
.text:42CF4F84                 mov     eax, [eax+8]
.text:42CF4F87                 mov     [ecx+8], eax
.text:42CF4F8A                 mov     ecx, [ebp+var_4]
.text:42CF4F8D                 mov     edx, [ecx+98h]
.text:42CF4F93                 push    edx
.text:42CF4F94                 call    sub_42CFC2D1
.text:42CF4F99                 add     esp, 10h
.text:42CF4F9C
.text:42CF4F9C loc_42CF4F9C:                           ; CODE XREF: ConnectionTermSec+1E\u2191j
.text:42CF4F9C                 mov     esp, ebp
.text:42CF4F9E                 pop     ebp
.text:42CF4F9F                 retn
.text:42CF4F9F ConnectionTermSec endp
.text:42CF4F9F
.text:42CF4FA0
.text:42CF4FA0 ; =============== S U B R O U T I N E =======================================
.text:42CF4FA0
.text:42CF4FA0 ; Attributes: bp-based frame
.text:42CF4FA0
.text:42CF4FA0 sub_42CF4FA0    proc near               ; CODE XREF: ConnectionListen+A8B\u2191p
.text:42CF4FA0
.text:42CF4FA0 var_8           = dword ptr -8
.text:42CF4FA0 var_4           = dword ptr -4
.text:42CF4FA0 arg_0           = dword ptr  8
.text:42CF4FA0 arg_4           = dword ptr  0Ch
.text:42CF4FA0 arg_8           = dword ptr  10h
.text:42CF4FA0 arg_C           = dword ptr  14h
.text:42CF4FA0
.text:42CF4FA0                 push    ebp
.text:42CF4FA1                 mov     ebp, esp
.text:42CF4FA3                 sub     esp, 8
.text:42CF4FA6                 mov     eax, [ebp+arg_4]
.text:42CF4FA9                 cmp     dword ptr [eax+4Ch], 2
.text:42CF4FAD                 jnz     short loc_42CF4FEF
.text:42CF4FAF                 mov     ecx, [ebp+arg_C]
.text:42CF4FB2                 cmp     dword ptr [ecx+2750h], 1
.text:42CF4FB9                 jnz     short loc_42CF4FEF
.text:42CF4FBB                 mov     edx, [ebp+arg_0]
.text:42CF4FBE                 mov     [ebp+var_4], edx
.text:42CF4FC1                 mov     eax, [ebp+var_4]
.text:42CF4FC4                 mov     word ptr [eax], 2
.text:42CF4FC9                 mov     ecx, [ebp+var_4]
.text:42CF4FCC                 mov     edx, [ebp+arg_8]
.text:42CF4FCF                 mov     eax, [edx+4]
.text:42CF4FD2                 mov     [ecx+4], eax
.text:42CF4FD5                 mov     ecx, [ebp+arg_8]
.text:42CF4FD8                 mov     dx, [ecx+2]
.text:42CF4FDC                 push    edx             ; hostshort
.text:42CF4FDD                 call    ds:htons
.text:42CF4FE3                 mov     ecx, [ebp+var_4]
.text:42CF4FE6                 mov     [ecx+2], ax
.text:42CF4FEA                 jmp     loc_42CF5084
.text:42CF4FEF ; ---------------------------------------------------------------------------
.text:42CF4FEF
.text:42CF4FEF loc_42CF4FEF:                           ; CODE XREF: sub_42CF4FA0+D\u2191j
.text:42CF4FEF                                         ; sub_42CF4FA0+19\u2191j
.text:42CF4FEF                 mov     edx, [ebp+arg_4]
.text:42CF4FF2                 cmp     dword ptr [edx+4Ch], 2
.text:42CF4FF6                 jnz     short loc_42CF5029
.text:42CF4FF8                 mov     eax, [ebp+arg_0]
.text:42CF4FFB                 mov     [ebp+var_4], eax
.text:42CF4FFE                 mov     ecx, [ebp+var_4]
.text:42CF5001                 mov     word ptr [ecx], 2
.text:42CF5006                 mov     edx, [ebp+var_4]
.text:42CF5009                 mov     eax, [ebp+arg_8]
.text:42CF500C                 mov     ecx, [eax+4]
.text:42CF500F                 mov     [edx+4], ecx
.text:42CF5012                 mov     edx, [ebp+arg_8]
.text:42CF5015                 mov     ax, [edx+2]
.text:42CF5019                 push    eax             ; hostshort
.text:42CF501A                 call    ds:htons
.text:42CF5020                 mov     ecx, [ebp+var_4]
.text:42CF5023                 mov     [ecx+2], ax
.text:42CF5027                 jmp     short loc_42CF5084
.text:42CF5029 ; ---------------------------------------------------------------------------
.text:42CF5029
.text:42CF5029 loc_42CF5029:                           ; CODE XREF: sub_42CF4FA0+56\u2191j
.text:42CF5029                 mov     edx, [ebp+arg_4]
.text:42CF502C                 cmp     dword ptr [edx+4Ch], 6
.text:42CF5030                 jnz     short loc_42CF5080
.text:42CF5032                 mov     eax, [ebp+arg_0]
.text:42CF5035                 mov     [ebp+var_8], eax
.text:42CF5038                 push    4               ; Size
.text:42CF503A                 push    0               ; Val
.text:42CF503C                 mov     ecx, [ebp+var_8]
.text:42CF503F                 add     ecx, 2
.text:42CF5042                 push    ecx             ; void *
.text:42CF5043                 call    memset
.text:42CF5048                 add     esp, 0Ch
.text:42CF504B                 push    6               ; Size
.text:42CF504D                 push    0               ; Val
.text:42CF504F                 mov     edx, [ebp+var_8]
.text:42CF5052                 add     edx, 6
.text:42CF5055                 push    edx             ; void *
.text:42CF5056                 call    memset
.text:42CF505B                 add     esp, 0Ch
.text:42CF505E                 mov     eax, [ebp+var_8]
.text:42CF5061                 mov     word ptr [eax], 6
.text:42CF5066                 mov     ecx, [ebp+arg_C]
.text:42CF5069                 mov     dx, [ecx+318h]
.text:42CF5070                 push    edx             ; hostshort
.text:42CF5071                 call    ds:htons
.text:42CF5077                 mov     ecx, [ebp+var_8]
.text:42CF507A                 mov     [ecx+0Ch], ax
.text:42CF507E                 jmp     short loc_42CF5084
.text:42CF5080 ; ---------------------------------------------------------------------------
.text:42CF5080
.text:42CF5080 loc_42CF5080:                           ; CODE XREF: sub_42CF4FA0+90\u2191j
.text:42CF5080                 xor     eax, eax
.text:42CF5082                 jmp     short loc_42CF5089
.text:42CF5084 ; ---------------------------------------------------------------------------
.text:42CF5084
.text:42CF5084 loc_42CF5084:                           ; CODE XREF: sub_42CF4FA0+4A\u2191j
.text:42CF5084                                         ; sub_42CF4FA0+87\u2191j ...
.text:42CF5084                 mov     eax, 1
.text:42CF5089
.text:42CF5089 loc_42CF5089:                           ; CODE XREF: sub_42CF4FA0+E2\u2191j
.text:42CF5089                 mov     esp, ebp
.text:42CF508B                 pop     ebp
.text:42CF508C                 retn
.text:42CF508C sub_42CF4FA0    endp
.text:42CF508C
.text:42CF508D
.text:42CF508D ; =============== S U B R O U T I N E =======================================
.text:42CF508D
.text:42CF508D ; Attributes: bp-based frame
.text:42CF508D
.text:42CF508D sub_42CF508D    proc near               ; CODE XREF: ConnectionListen+107E\u2191p
.text:42CF508D
.text:42CF508D arg_0           = dword ptr  8
.text:42CF508D arg_4           = dword ptr  0Ch
.text:42CF508D arg_8           = dword ptr  10h
.text:42CF508D
.text:42CF508D                 push    ebp
.text:42CF508E                 mov     ebp, esp
.text:42CF5090                 push    0               ; lpName
.text:42CF5092                 push    0               ; bInitialState
.text:42CF5094                 push    1               ; bManualReset
.text:42CF5096                 push    0               ; lpEventAttributes
.text:42CF5098                 call    ds:CreateEventA
.text:42CF509E                 mov     ecx, [ebp+arg_0]
.text:42CF50A1                 mov     [ecx+40h], eax
.text:42CF50A4                 mov     edx, [ebp+arg_0]
.text:42CF50A7                 mov     eax, [edx+40h]
.text:42CF50AA                 push    eax             ; hEvent
.text:42CF50AB                 call    ds:ResetEvent
.text:42CF50B1                 push    0               ; lpName
.text:42CF50B3                 push    0               ; bInitialOwner
.text:42CF50B5                 push    0               ; lpMutexAttributes
.text:42CF50B7                 call    ds:CreateMutexA
.text:42CF50BD                 mov     hMutex, eax
.text:42CF50C2                 push    0               ; lpName
.text:42CF50C4                 push    0               ; bInitialState
.text:42CF50C6                 push    1               ; bManualReset
.text:42CF50C8                 push    0               ; lpEventAttributes
.text:42CF50CA                 call    ds:CreateEventA
.text:42CF50D0                 mov     hEvent, eax
.text:42CF50D5                 mov     dword_42D01B4C, 0
.text:42CF50DF                 push    offset ThreadId ; lpThreadId
.text:42CF50E4                 push    0               ; dwCreationFlags
.text:42CF50E6                 push    offset MultiByteStr ; lpParameter
.text:42CF50EB                 push    offset StartAddress ; lpStartAddress
.text:42CF50F0                 push    1000h           ; dwStackSize
.text:42CF50F5                 push    0               ; lpThreadAttributes
.text:42CF50F7                 call    ds:CreateThread
.text:42CF50FD                 mov     dword_42D01DD0, eax
.text:42CF5102                 cmp     dword_42D01DD0, 0
.text:42CF5109                 jnz     short loc_42CF5121
.text:42CF510B                 call    ds:GetLastError
.text:42CF5111                 mov     ecx, [ebp+arg_4]
.text:42CF5114                 mov     [ecx], eax
.text:42CF5116                 mov     [ebp+arg_8], offset aAdvertiseservi ; "AdvertiseService: Tcp - CreateThread"
.text:42CF511D                 xor     eax, eax
.text:42CF511F                 jmp     short loc_42CF5126
.text:42CF5121 ; ---------------------------------------------------------------------------
.text:42CF5121
.text:42CF5121 loc_42CF5121:                           ; CODE XREF: sub_42CF508D+7C\u2191j
.text:42CF5121                 mov     eax, 1
.text:42CF5126
.text:42CF5126 loc_42CF5126:                           ; CODE XREF: sub_42CF508D+92\u2191j
.text:42CF5126                 pop     ebp
.text:42CF5127                 retn
.text:42CF5127 sub_42CF508D    endp
.text:42CF5127
.text:42CF5128
.text:42CF5128 ; =============== S U B R O U T I N E =======================================
.text:42CF5128
.text:42CF5128 ; Attributes: bp-based frame
.text:42CF5128
.text:42CF5128 sub_42CF5128    proc near               ; CODE XREF: ConnectionListen+10BA\u2191p
.text:42CF5128
.text:42CF5128 var_38          = dword ptr -38h
.text:42CF5128 var_34          = dword ptr -34h
.text:42CF5128 lpProcName      = dword ptr -30h
.text:42CF5128 var_2C          = dword ptr -2Ch
.text:42CF5128 var_28          = dword ptr -28h
.text:42CF5128 var_24          = dword ptr -24h
.text:42CF5128 var_20          = dword ptr -20h
.text:42CF5128 var_1C          = dword ptr -1Ch
.text:42CF5128 var_18          = dword ptr -18h
.text:42CF5128 var_14          = dword ptr -14h
.text:42CF5128 var_10          = dword ptr -10h
.text:42CF5128 var_C           = dword ptr -0Ch
.text:42CF5128 var_8           = dword ptr -8
.text:42CF5128 var_4           = dword ptr -4
.text:42CF5128 arg_0           = dword ptr  8
.text:42CF5128
.text:42CF5128                 push    ebp
.text:42CF5129                 mov     ebp, esp
.text:42CF512B                 sub     esp, 38h
.text:42CF512E                 mov     [ebp+lpProcName], offset aConnectionread_2 ; "ConnectionRead"
.text:42CF5135                 mov     [ebp+var_2C], offset aConnectionwrit_2 ; "ConnectionWrite"
.text:42CF513C                 mov     [ebp+var_28], offset aConnectionclos_2 ; "ConnectionClose"
.text:42CF5143                 mov     [ebp+var_24], offset aConnectionlist_0 ; "ConnectionListen"
.text:42CF514A                 mov     [ebp+var_20], offset aConnectionacce_0 ; "ConnectionAccept"
.text:42CF5151                 mov     [ebp+var_1C], offset aConnectionpeek_0 ; "ConnectionPeek"
.text:42CF5158                 mov     [ebp+var_18], offset aConnectionread_3 ; "ConnectionReadAsync"
.text:42CF515F                 mov     [ebp+var_14], offset aConnectionver_0 ; "ConnectionVer"
.text:42CF5166                 mov     [ebp+var_10], offset aConnectionwrit_3 ; "ConnectionWriteAsync"
.text:42CF516D                 mov     [ebp+var_C], offset aConnectionwrit_4 ; "ConnectionWriteStatus"
.text:42CF5174                 mov     [ebp+var_8], offset aConnectionobje ; "ConnectionObjectSize"
.text:42CF517B                 mov     [ebp+var_4], offset aConnectioninit_0 ; "ConnectionInitAsync"
.text:42CF5182                 mov     [ebp+var_38], 0Bh
.text:42CF5189                 cmp     dword_42D01A1C, 0
.text:42CF5190                 jz      short loc_42CF51A4
.text:42CF5192                 push    offset LibFileName ; "SSmsLPCn.dll"
.text:42CF5197                 call    ds:LoadLibraryA
.text:42CF519D                 mov     hModule, eax
.text:42CF51A2                 jmp     short loc_42CF51B4
.text:42CF51A4 ; ---------------------------------------------------------------------------
.text:42CF51A4
.text:42CF51A4 loc_42CF51A4:                           ; CODE XREF: sub_42CF5128+68\u2191j
.text:42CF51A4                 push    offset aSsmssh70Dll ; "SSmsSH70.dll"
.text:42CF51A9                 call    ds:LoadLibraryA
.text:42CF51AF                 mov     hModule, eax
.text:42CF51B4
.text:42CF51B4 loc_42CF51B4:                           ; CODE XREF: sub_42CF5128+7A\u2191j
.text:42CF51B4                 cmp     hModule, 0
.text:42CF51BB                 jz      short loc_42CF521A
.text:42CF51BD                 mov     [ebp+var_34], 0
.text:42CF51C4                 jmp     short loc_42CF51CF
.text:42CF51C6 ; ---------------------------------------------------------------------------
.text:42CF51C6
.text:42CF51C6 loc_42CF51C6:                           ; CODE XREF: sub_42CF5128:loc_42CF5218\u2193j
.text:42CF51C6                 mov     eax, [ebp+var_34]
.text:42CF51C9                 add     eax, 1
.text:42CF51CC                 mov     [ebp+var_34], eax
.text:42CF51CF
.text:42CF51CF loc_42CF51CF:                           ; CODE XREF: sub_42CF5128+9C\u2191j
.text:42CF51CF                 cmp     [ebp+var_34], 0Ch
.text:42CF51D3                 jge     short loc_42CF521A
.text:42CF51D5                 mov     ecx, [ebp+var_34]
.text:42CF51D8                 mov     edx, [ebp+ecx*4+lpProcName]
.text:42CF51DC                 push    edx             ; lpProcName
.text:42CF51DD                 mov     eax, hModule
.text:42CF51E2                 push    eax             ; hModule
.text:42CF51E3                 call    ds:GetProcAddress
.text:42CF51E9                 mov     ecx, [ebp+var_34]
.text:42CF51EC                 mov     dword_42D01BA8[ecx*4], eax
.text:42CF51F3                 mov     edx, [ebp+var_34]
.text:42CF51F6                 cmp     dword_42D01BA8[edx*4], 0
.text:42CF51FE                 jnz     short loc_42CF5218
.text:42CF5200                 mov     eax, hModule
.text:42CF5205                 push    eax             ; hLibModule
.text:42CF5206                 call    ds:FreeLibrary
.text:42CF520C                 mov     hModule, 0
.text:42CF5216                 jmp     short loc_42CF521A
.text:42CF5218 ; ---------------------------------------------------------------------------
.text:42CF5218
.text:42CF5218 loc_42CF5218:                           ; CODE XREF: sub_42CF5128+D6\u2191j
.text:42CF5218                 jmp     short loc_42CF51C6
.text:42CF521A ; ---------------------------------------------------------------------------
.text:42CF521A
.text:42CF521A loc_42CF521A:                           ; CODE XREF: sub_42CF5128+93\u2191j
.text:42CF521A                                         ; sub_42CF5128+AB\u2191j ...
.text:42CF521A                 cmp     hModule, 0
.text:42CF5221                 jnz     short loc_42CF5242
.text:42CF5223                 push    1               ; wType
.text:42CF5225                 mov     ecx, [ebp+var_38]
.text:42CF5228                 push    ecx             ; int
.text:42CF5229                 push    offset aLoadnetlibs ; "LoadNetlibs"
.text:42CF522E                 push    offset aSharedMemoryLp ; "Shared-Memory (LPC)"
.text:42CF5233                 mov     edx, dword_42D010D8
.text:42CF5239                 push    edx             ; int
.text:42CF523A                 call    sub_42CF56FE
.text:42CF523F                 add     esp, 14h
.text:42CF5242
.text:42CF5242 loc_42CF5242:                           ; CODE XREF: sub_42CF5128+F9\u2191j
.text:42CF5242                 mov     eax, [ebp+arg_0]
.text:42CF5245                 cmp     dword ptr [eax+2744h], 1
.text:42CF524C                 jnz     loc_42CF52F1
.text:42CF5252                 push    offset aSsnmpn70Dll ; "SSnmPN70.dll"
.text:42CF5257                 call    ds:LoadLibraryA
.text:42CF525D                 mov     hLibModule, eax
.text:42CF5262                 cmp     hLibModule, 0
.text:42CF5269                 jz      short loc_42CF52CA
.text:42CF526B                 mov     [ebp+var_34], 0
.text:42CF5272                 jmp     short loc_42CF527D
.text:42CF5274 ; ---------------------------------------------------------------------------
.text:42CF5274
.text:42CF5274 loc_42CF5274:                           ; CODE XREF: sub_42CF5128:loc_42CF52C8\u2193j
.text:42CF5274                 mov     ecx, [ebp+var_34]
.text:42CF5277                 add     ecx, 1
.text:42CF527A                 mov     [ebp+var_34], ecx
.text:42CF527D
.text:42CF527D loc_42CF527D:                           ; CODE XREF: sub_42CF5128+14A\u2191j
.text:42CF527D                 cmp     [ebp+var_34], 0Ch
.text:42CF5281                 jge     short loc_42CF52CA
.text:42CF5283                 mov     edx, [ebp+var_34]
.text:42CF5286                 mov     eax, [ebp+edx*4+lpProcName]
.text:42CF528A                 push    eax             ; lpProcName
.text:42CF528B                 mov     ecx, hLibModule
.text:42CF5291                 push    ecx             ; hModule
.text:42CF5292                 call    ds:GetProcAddress
.text:42CF5298                 mov     edx, [ebp+var_34]
.text:42CF529B                 mov     dword_42D01E08[edx*4], eax
.text:42CF52A2                 mov     eax, [ebp+var_34]
.text:42CF52A5                 cmp     dword_42D01E08[eax*4], 0
.text:42CF52AD                 jnz     short loc_42CF52C8
.text:42CF52AF                 mov     ecx, hLibModule
.text:42CF52B5                 push    ecx             ; hLibModule
.text:42CF52B6                 call    ds:FreeLibrary
.text:42CF52BC                 mov     hLibModule, 0
.text:42CF52C6                 jmp     short loc_42CF52CA
.text:42CF52C8 ; ---------------------------------------------------------------------------
.text:42CF52C8
.text:42CF52C8 loc_42CF52C8:                           ; CODE XREF: sub_42CF5128+185\u2191j
.text:42CF52C8                 jmp     short loc_42CF5274
.text:42CF52CA ; ---------------------------------------------------------------------------
.text:42CF52CA
.text:42CF52CA loc_42CF52CA:                           ; CODE XREF: sub_42CF5128+141\u2191j
.text:42CF52CA                                         ; sub_42CF5128+159\u2191j ...
.text:42CF52CA                 cmp     hLibModule, 0
.text:42CF52D1                 jnz     short loc_42CF52F1
.text:42CF52D3                 push    1               ; wType
.text:42CF52D5                 mov     edx, [ebp+var_38]
.text:42CF52D8                 push    edx             ; int
.text:42CF52D9                 push    offset aLoadnetlibs_0 ; "LoadNetlibs"
.text:42CF52DE                 push    offset aNamedPipes ; "Named Pipes"
.text:42CF52E3                 mov     eax, dword_42D010D8
.text:42CF52E8                 push    eax             ; int
.text:42CF52E9                 call    sub_42CF56FE
.text:42CF52EE                 add     esp, 14h
.text:42CF52F1
.text:42CF52F1 loc_42CF52F1:                           ; CODE XREF: sub_42CF5128+124\u2191j
.text:42CF52F1                                         ; sub_42CF5128+1A9\u2191j
.text:42CF52F1                 mov     ecx, [ebp+arg_0]
.text:42CF52F4                 cmp     dword ptr [ecx+273Ch], 1
.text:42CF52FB                 jnz     loc_42CF53A0
.text:42CF5301                 push    offset aSsmsad70Dll ; "SSmsAD70.dll"
.text:42CF5306                 call    ds:LoadLibraryA
.text:42CF530C                 mov     dword_42D01F44, eax
.text:42CF5311                 cmp     dword_42D01F44, 0
.text:42CF5318                 jz      short loc_42CF5378
.text:42CF531A                 mov     [ebp+var_34], 0
.text:42CF5321                 jmp     short loc_42CF532C
.text:42CF5323 ; ---------------------------------------------------------------------------
.text:42CF5323
.text:42CF5323 loc_42CF5323:                           ; CODE XREF: sub_42CF5128:loc_42CF5376\u2193j
.text:42CF5323                 mov     edx, [ebp+var_34]
.text:42CF5326                 add     edx, 1
.text:42CF5329                 mov     [ebp+var_34], edx
.text:42CF532C
.text:42CF532C loc_42CF532C:                           ; CODE XREF: sub_42CF5128+1F9\u2191j
.text:42CF532C                 cmp     [ebp+var_34], 0Ch
.text:42CF5330                 jge     short loc_42CF5378
.text:42CF5332                 mov     eax, [ebp+var_34]
.text:42CF5335                 mov     ecx, [ebp+eax*4+lpProcName]
.text:42CF5339                 push    ecx             ; lpProcName
.text:42CF533A                 mov     edx, dword_42D01F44
.text:42CF5340                 push    edx             ; hModule
.text:42CF5341                 call    ds:GetProcAddress
.text:42CF5347                 mov     ecx, [ebp+var_34]
.text:42CF534A                 mov     dword_42D01F48[ecx*4], eax
.text:42CF5351                 mov     edx, [ebp+var_34]
.text:42CF5354                 cmp     dword_42D01F48[edx*4], 0
.text:42CF535C                 jnz     short loc_42CF5376
.text:42CF535E                 mov     eax, dword_42D01F44
.text:42CF5363                 push    eax             ; hLibModule
.text:42CF5364                 call    ds:FreeLibrary
.text:42CF536A                 mov     dword_42D01F44, 0
.text:42CF5374                 jmp     short loc_42CF5378
.text:42CF5376 ; ---------------------------------------------------------------------------
.text:42CF5376
.text:42CF5376 loc_42CF5376:                           ; CODE XREF: sub_42CF5128+234\u2191j
.text:42CF5376                 jmp     short loc_42CF5323
.text:42CF5378 ; ---------------------------------------------------------------------------
.text:42CF5378
.text:42CF5378 loc_42CF5378:                           ; CODE XREF: sub_42CF5128+1F0\u2191j
.text:42CF5378                                         ; sub_42CF5128+208\u2191j ...
.text:42CF5378                 cmp     dword_42D01F44, 0
.text:42CF537F                 jnz     short loc_42CF53A0
.text:42CF5381                 push    1               ; wType
.text:42CF5383                 mov     ecx, [ebp+var_38]
.text:42CF5386                 push    ecx             ; int
.text:42CF5387                 push    offset aLoadnetlibs_1 ; "LoadNetlibs"
.text:42CF538C                 push    offset aAdsp_1  ; "Adsp"
.text:42CF5391                 mov     edx, dword_42D010D8
.text:42CF5397                 push    edx             ; int
.text:42CF5398                 call    sub_42CF56FE
.text:42CF539D                 add     esp, 14h
.text:42CF53A0
.text:42CF53A0 loc_42CF53A0:                           ; CODE XREF: sub_42CF5128+1D3\u2191j
.text:42CF53A0                                         ; sub_42CF5128+257\u2191j
.text:42CF53A0                 mov     eax, [ebp+arg_0]
.text:42CF53A3                 cmp     dword ptr [eax+2748h], 1
.text:42CF53AA                 jnz     loc_42CF544F
.text:42CF53B0                 push    offset aSsmsrp70Dll ; "SSmsRP70.dll"
.text:42CF53B5                 call    ds:LoadLibraryA
.text:42CF53BB                 mov     dword_42D01C64, eax
.text:42CF53C0                 cmp     dword_42D01C64, 0
.text:42CF53C7                 jz      short loc_42CF5428
.text:42CF53C9                 mov     [ebp+var_34], 0
.text:42CF53D0                 jmp     short loc_42CF53DB
.text:42CF53D2 ; ---------------------------------------------------------------------------
.text:42CF53D2
.text:42CF53D2 loc_42CF53D2:                           ; CODE XREF: sub_42CF5128:loc_42CF5426\u2193j
.text:42CF53D2                 mov     ecx, [ebp+var_34]
.text:42CF53D5                 add     ecx, 1
.text:42CF53D8                 mov     [ebp+var_34], ecx
.text:42CF53DB
.text:42CF53DB loc_42CF53DB:                           ; CODE XREF: sub_42CF5128+2A8\u2191j
.text:42CF53DB                 cmp     [ebp+var_34], 0Ch
.text:42CF53DF                 jge     short loc_42CF5428
.text:42CF53E1                 mov     edx, [ebp+var_34]
.text:42CF53E4                 mov     eax, [ebp+edx*4+lpProcName]
.text:42CF53E8                 push    eax             ; lpProcName
.text:42CF53E9                 mov     ecx, dword_42D01C64
.text:42CF53EF                 push    ecx             ; hModule
.text:42CF53F0                 call    ds:GetProcAddress
.text:42CF53F6                 mov     edx, [ebp+var_34]
.text:42CF53F9                 mov     dword_42D01C68[edx*4], eax
.text:42CF5400                 mov     eax, [ebp+var_34]
.text:42CF5403                 cmp     dword_42D01C68[eax*4], 0
.text:42CF540B                 jnz     short loc_42CF5426
.text:42CF540D                 mov     ecx, dword_42D01C64
.text:42CF5413                 push    ecx             ; hLibModule
.text:42CF5414                 call    ds:FreeLibrary
.text:42CF541A                 mov     dword_42D01C64, 0
.text:42CF5424                 jmp     short loc_42CF5428
.text:42CF5426 ; ---------------------------------------------------------------------------
.text:42CF5426
.text:42CF5426 loc_42CF5426:                           ; CODE XREF: sub_42CF5128+2E3\u2191j
.text:42CF5426                 jmp     short loc_42CF53D2
.text:42CF5428 ; ---------------------------------------------------------------------------
.text:42CF5428
.text:42CF5428 loc_42CF5428:                           ; CODE XREF: sub_42CF5128+29F\u2191j
.text:42CF5428                                         ; sub_42CF5128+2B7\u2191j ...
.text:42CF5428                 cmp     dword_42D01C64, 0
.text:42CF542F                 jnz     short loc_42CF544F
.text:42CF5431                 push    1               ; wType
.text:42CF5433                 mov     edx, [ebp+var_38]
.text:42CF5436                 push    edx             ; int
.text:42CF5437                 push    offset aLoadnetlibs_2 ; "LoadNetlibs"
.text:42CF543C                 push    offset aRpc_1   ; "Rpc"
.text:42CF5441                 mov     eax, dword_42D010D8
.text:42CF5446                 push    eax             ; int
.text:42CF5447                 call    sub_42CF56FE
.text:42CF544C                 add     esp, 14h
.text:42CF544F
.text:42CF544F loc_42CF544F:                           ; CODE XREF: sub_42CF5128+282\u2191j
.text:42CF544F                                         ; sub_42CF5128+307\u2191j
.text:42CF544F                 mov     ecx, [ebp+arg_0]
.text:42CF5452                 cmp     dword ptr [ecx+274Ch], 1
.text:42CF5459                 jnz     loc_42CF54FE
.text:42CF545F                 push    offset aSsmsvi70Dll ; "SSmsVI70.dll"
.text:42CF5464                 call    ds:LoadLibraryA
.text:42CF546A                 mov     dword_42D01C04, eax
.text:42CF546F                 cmp     dword_42D01C04, 0
.text:42CF5476                 jz      short loc_42CF54D6
.text:42CF5478                 mov     [ebp+var_34], 0
.text:42CF547F                 jmp     short loc_42CF548A
.text:42CF5481 ; ---------------------------------------------------------------------------
.text:42CF5481
.text:42CF5481 loc_42CF5481:                           ; CODE XREF: sub_42CF5128:loc_42CF54D4\u2193j
.text:42CF5481                 mov     edx, [ebp+var_34]
.text:42CF5484                 add     edx, 1
.text:42CF5487                 mov     [ebp+var_34], edx
.text:42CF548A
.text:42CF548A loc_42CF548A:                           ; CODE XREF: sub_42CF5128+357\u2191j
.text:42CF548A                 cmp     [ebp+var_34], 0Ch
.text:42CF548E                 jge     short loc_42CF54D6
.text:42CF5490                 mov     eax, [ebp+var_34]
.text:42CF5493                 mov     ecx, [ebp+eax*4+lpProcName]
.text:42CF5497                 push    ecx             ; lpProcName
.text:42CF5498                 mov     edx, dword_42D01C04
.text:42CF549E                 push    edx             ; hModule
.text:42CF549F                 call    ds:GetProcAddress
.text:42CF54A5                 mov     ecx, [ebp+var_34]
.text:42CF54A8                 mov     dword_42D01C08[ecx*4], eax
.text:42CF54AF                 mov     edx, [ebp+var_34]
.text:42CF54B2                 cmp     dword_42D01C08[edx*4], 0
.text:42CF54BA                 jnz     short loc_42CF54D4
.text:42CF54BC                 mov     eax, dword_42D01C04
.text:42CF54C1                 push    eax             ; hLibModule
.text:42CF54C2                 call    ds:FreeLibrary
.text:42CF54C8                 mov     dword_42D01C04, 0
.text:42CF54D2                 jmp     short loc_42CF54D6
.text:42CF54D4 ; ---------------------------------------------------------------------------
.text:42CF54D4
.text:42CF54D4 loc_42CF54D4:                           ; CODE XREF: sub_42CF5128+392\u2191j
.text:42CF54D4                 jmp     short loc_42CF5481
.text:42CF54D6 ; ---------------------------------------------------------------------------
.text:42CF54D6
.text:42CF54D6 loc_42CF54D6:                           ; CODE XREF: sub_42CF5128+34E\u2191j
.text:42CF54D6                                         ; sub_42CF5128+366\u2191j ...
.text:42CF54D6                 cmp     dword_42D01C04, 0
.text:42CF54DD                 jnz     short loc_42CF54FE
.text:42CF54DF                 push    1               ; wType
.text:42CF54E1                 mov     ecx, [ebp+var_38]
.text:42CF54E4                 push    ecx             ; int
.text:42CF54E5                 push    offset aLoadnetlibs_3 ; "LoadNetlibs"
.text:42CF54EA                 push    offset aBanyanVines_1 ; "Banyan Vines"
.text:42CF54EF                 mov     edx, dword_42D010D8
.text:42CF54F5                 push    edx             ; int
.text:42CF54F6                 call    sub_42CF56FE
.text:42CF54FB                 add     esp, 14h
.text:42CF54FE
.text:42CF54FE loc_42CF54FE:                           ; CODE XREF: sub_42CF5128+331\u2191j
.text:42CF54FE                                         ; sub_42CF5128+3B5\u2191j
.text:42CF54FE                 mov     eax, [ebp+arg_0]
.text:42CF5501                 cmp     dword ptr [eax+2754h], 1
.text:42CF5508                 jnz     loc_42CF55F6
.text:42CF550E                 push    offset aGiganet ; "GigaNet"
.text:42CF5513                 mov     ecx, [ebp+arg_0]
.text:42CF5516                 add     ecx, 112Ch
.text:42CF551C                 push    ecx             ; String1
.text:42CF551D                 call    ds:_stricmp
.text:42CF5523                 add     esp, 8
.text:42CF5526                 test    eax, eax
.text:42CF5528                 jnz     short loc_42CF553C
.text:42CF552A                 push    offset aSsmsgnetDll ; "SSmsGNet.dll"
.text:42CF552F                 call    ds:LoadLibraryA
.text:42CF5535                 mov     dword_42D020C4, eax
.text:42CF553A                 jmp     short loc_42CF5568
.text:42CF553C ; ---------------------------------------------------------------------------
.text:42CF553C
.text:42CF553C loc_42CF553C:                           ; CODE XREF: sub_42CF5128+400\u2191j
.text:42CF553C                 push    offset aServernetIi ; "ServerNet II"
.text:42CF5541                 mov     edx, [ebp+arg_0]
.text:42CF5544                 add     edx, 112Ch
.text:42CF554A                 push    edx             ; String1
.text:42CF554B                 call    ds:_stricmp
.text:42CF5551                 add     esp, 8
.text:42CF5554                 test    eax, eax
.text:42CF5556                 jnz     short loc_42CF5568
.text:42CF5558                 push    offset aSsmssnetDll ; "SSmsSNet.dll"
.text:42CF555D                 call    ds:LoadLibraryA
.text:42CF5563                 mov     dword_42D020C4, eax
.text:42CF5568
.text:42CF5568 loc_42CF5568:                           ; CODE XREF: sub_42CF5128+412\u2191j
.text:42CF5568                                         ; sub_42CF5128+42E\u2191j
.text:42CF5568                 cmp     dword_42D020C4, 0
.text:42CF556F                 jz      short loc_42CF55CE
.text:42CF5571                 mov     [ebp+var_34], 0
.text:42CF5578                 jmp     short loc_42CF5583
.text:42CF557A ; ---------------------------------------------------------------------------
.text:42CF557A
.text:42CF557A loc_42CF557A:                           ; CODE XREF: sub_42CF5128:loc_42CF55CC\u2193j
.text:42CF557A                 mov     eax, [ebp+var_34]
.text:42CF557D                 add     eax, 1
.text:42CF5580                 mov     [ebp+var_34], eax
.text:42CF5583
.text:42CF5583 loc_42CF5583:                           ; CODE XREF: sub_42CF5128+450\u2191j
.text:42CF5583                 cmp     [ebp+var_34], 0Ch
.text:42CF5587                 jge     short loc_42CF55CE
.text:42CF5589                 mov     ecx, [ebp+var_34]
.text:42CF558C                 mov     edx, [ebp+ecx*4+lpProcName]
.text:42CF5590                 push    edx             ; lpProcName
.text:42CF5591                 mov     eax, dword_42D020C4
.text:42CF5596                 push    eax             ; hModule
.text:42CF5597                 call    ds:GetProcAddress
.text:42CF559D                 mov     ecx, [ebp+var_34]
.text:42CF55A0                 mov     dword_42D020C8[ecx*4], eax
.text:42CF55A7                 mov     edx, [ebp+var_34]
.text:42CF55AA                 cmp     dword_42D020C8[edx*4], 0
.text:42CF55B2                 jnz     short loc_42CF55CC
.text:42CF55B4                 mov     eax, dword_42D020C4
.text:42CF55B9                 push    eax             ; hLibModule
.text:42CF55BA                 call    ds:FreeLibrary
.text:42CF55C0                 mov     dword_42D020C4, 0
.text:42CF55CA                 jmp     short loc_42CF55CE
.text:42CF55CC ; ---------------------------------------------------------------------------
.text:42CF55CC
.text:42CF55CC loc_42CF55CC:                           ; CODE XREF: sub_42CF5128+48A\u2191j
.text:42CF55CC                 jmp     short loc_42CF557A
.text:42CF55CE ; ---------------------------------------------------------------------------
.text:42CF55CE
.text:42CF55CE loc_42CF55CE:                           ; CODE XREF: sub_42CF5128+447\u2191j
.text:42CF55CE                                         ; sub_42CF5128+45F\u2191j ...
.text:42CF55CE                 cmp     dword_42D020C4, 0
.text:42CF55D5                 jnz     short loc_42CF55F6
.text:42CF55D7                 push    1               ; wType
.text:42CF55D9                 mov     ecx, [ebp+var_38]
.text:42CF55DC                 push    ecx             ; int
.text:42CF55DD                 push    offset aLoadnetlibs_4 ; "LoadNetlibs"
.text:42CF55E2                 push    offset aVia     ; "Via"
.text:42CF55E7                 mov     edx, dword_42D010D8
.text:42CF55ED                 push    edx             ; int
.text:42CF55EE                 call    sub_42CF56FE
.text:42CF55F3                 add     esp, 14h
.text:42CF55F6
.text:42CF55F6 loc_42CF55F6:                           ; CODE XREF: sub_42CF5128+3E0\u2191j
.text:42CF55F6                                         ; sub_42CF5128+4AD\u2191j
.text:42CF55F6                 mov     esp, ebp
.text:42CF55F8                 pop     ebp
.text:42CF55F9                 retn
.text:42CF55F9 sub_42CF5128    endp
.text:42CF55F9
.text:42CF55FA ; ---------------------------------------------------------------------------
.text:42CF55FA                 push    ebp
.text:42CF55FB                 mov     ebp, esp
.text:42CF55FD                 sub     esp, 38h
.text:42CF5600                 mov     dword ptr [ebp-38h], 0Bh
.text:42CF5607                 mov     dword ptr [ebp-30h], offset aConnectionread_4 ; "ConnectionRead"
.text:42CF560E                 mov     dword ptr [ebp-2Ch], offset aConnectionwrit_5 ; "ConnectionWrite"
.text:42CF5615                 mov     dword ptr [ebp-28h], offset aConnectionclos_3 ; "ConnectionClose"
.text:42CF561C                 mov     dword ptr [ebp-24h], offset aConnectionlist_1 ; "ConnectionListen"
.text:42CF5623                 mov     dword ptr [ebp-20h], offset aConnectionacce_1 ; "ConnectionAccept"
.text:42CF562A                 mov     dword ptr [ebp-1Ch], offset aConnectionpeek_1 ; "ConnectionPeek"
.text:42CF5631                 mov     dword ptr [ebp-18h], offset aConnectionread_5 ; "ConnectionReadAsync"
.text:42CF5638                 mov     dword ptr [ebp-14h], offset aConnectionver_1 ; "ConnectionVer"
.text:42CF563F                 mov     dword ptr [ebp-10h], offset aConnectionwrit_6 ; "ConnectionWriteAsync"
.text:42CF5646                 mov     dword ptr [ebp-0Ch], offset aConnectionwrit_7 ; "ConnectionWriteStatus"
.text:42CF564D                 mov     dword ptr [ebp-8], offset aConnectionobje_0 ; "ConnectionObjectSize"
.text:42CF5654                 mov     dword ptr [ebp-4], offset aConnectioninit_1 ; "ConnectionInitAsync"
.text:42CF565B                 mov     eax, [ebp+8]
.text:42CF565E                 push    eax
.text:42CF565F                 call    ds:LoadLibraryA
.text:42CF5665                 mov     ecx, [ebp+0Ch]
.text:42CF5668                 mov     [ecx+4], eax
.text:42CF566B                 mov     edx, [ebp+0Ch]
.text:42CF566E                 cmp     dword ptr [edx+4], 0
.text:42CF5672                 jz      short loc_42CF56D3
.text:42CF5674                 mov     dword ptr [ebp-34h], 0
.text:42CF567B                 jmp     short loc_42CF5686
.text:42CF567D ; ---------------------------------------------------------------------------
.text:42CF567D
.text:42CF567D loc_42CF567D:                           ; CODE XREF: .text:loc_42CF56D1\u2193j
.text:42CF567D                 mov     eax, [ebp-34h]
.text:42CF5680                 add     eax, 1
.text:42CF5683                 mov     [ebp-34h], eax
.text:42CF5686
.text:42CF5686 loc_42CF5686:                           ; CODE XREF: .text:42CF567B\u2191j
.text:42CF5686                 cmp     dword ptr [ebp-34h], 0Ch
.text:42CF568A                 jge     short loc_42CF56D3
.text:42CF568C                 mov     ecx, [ebp-34h]
.text:42CF568F                 mov     edx, [ebp+ecx*4-30h]
.text:42CF5693                 push    edx
.text:42CF5694                 mov     eax, [ebp+0Ch]
.text:42CF5697                 mov     ecx, [eax+4]
.text:42CF569A                 push    ecx
.text:42CF569B                 call    ds:GetProcAddress
.text:42CF56A1                 mov     edx, [ebp-34h]
.text:42CF56A4                 mov     ecx, [ebp+0Ch]
.text:42CF56A7                 mov     [ecx+edx*4+8], eax
.text:42CF56AB                 mov     edx, [ebp-34h]
.text:42CF56AE                 mov     eax, [ebp+0Ch]
.text:42CF56B1                 cmp     dword ptr [eax+edx*4+8], 0
.text:42CF56B6                 jnz     short loc_42CF56D1
.text:42CF56B8                 mov     ecx, [ebp+0Ch]
.text:42CF56BB                 mov     edx, [ecx+4]
.text:42CF56BE                 push    edx
.text:42CF56BF                 call    ds:FreeLibrary
.text:42CF56C5                 mov     eax, [ebp+0Ch]
.text:42CF56C8                 mov     dword ptr [eax+4], 0
.text:42CF56CF                 jmp     short loc_42CF56D3
.text:42CF56D1 ; ---------------------------------------------------------------------------
.text:42CF56D1
.text:42CF56D1 loc_42CF56D1:                           ; CODE XREF: .text:42CF56B6\u2191j
.text:42CF56D1                 jmp     short loc_42CF567D
.text:42CF56D3 ; ---------------------------------------------------------------------------
.text:42CF56D3
.text:42CF56D3 loc_42CF56D3:                           ; CODE XREF: .text:42CF5672\u2191j
.text:42CF56D3                                         ; .text:42CF568A\u2191j ...
.text:42CF56D3                 mov     ecx, [ebp+0Ch]
.text:42CF56D6                 cmp     dword ptr [ecx+4], 0
.text:42CF56DA                 jnz     short loc_42CF56FA
.text:42CF56DC                 push    1
.text:42CF56DE                 mov     edx, [ebp-38h]
.text:42CF56E1                 push    edx
.text:42CF56E2                 push    offset aLoadnetlibs_5 ; "LoadNetlibs"
.text:42CF56E7                 mov     eax, [ebp+10h]
.text:42CF56EA                 push    eax
.text:42CF56EB                 mov     ecx, dword_42D010D8
.text:42CF56F1                 push    ecx
.text:42CF56F2                 call    sub_42CF56FE
.text:42CF56F7                 add     esp, 14h
.text:42CF56FA
.text:42CF56FA loc_42CF56FA:                           ; CODE XREF: .text:42CF56DA\u2191j
.text:42CF56FA                 mov     esp, ebp
.text:42CF56FC                 pop     ebp
.text:42CF56FD                 retn
.text:42CF56FE
.text:42CF56FE ; =============== S U B R O U T I N E =======================================
.text:42CF56FE
.text:42CF56FE ; Attributes: bp-based frame
.text:42CF56FE
.text:42CF56FE ; int __cdecl sub_42CF56FE(int, int, int, int, WORD wType)
.text:42CF56FE sub_42CF56FE    proc near               ; CODE XREF: ConnectionListen+710\u2191p
.text:42CF56FE                                         ; ConnectionListen+853\u2191p ...
.text:42CF56FE
.text:42CF56FE var_108         = dword ptr -108h
.text:42CF56FE Buffer          = byte ptr -104h
.text:42CF56FE Strings         = dword ptr -4
.text:42CF56FE arg_4           = dword ptr  0Ch
.text:42CF56FE arg_8           = dword ptr  10h
.text:42CF56FE arg_C           = dword ptr  14h
.text:42CF56FE wType           = word ptr  18h
.text:42CF56FE
.text:42CF56FE                 push    ebp
.text:42CF56FF                 mov     ebp, esp
.text:42CF5701                 sub     esp, 108h
.text:42CF5707                 mov     eax, [ebp+arg_C]
.text:42CF570A                 push    eax
.text:42CF570B                 mov     ecx, [ebp+arg_4]
.text:42CF570E                 push    ecx
.text:42CF570F                 mov     edx, [ebp+arg_8]
.text:42CF5712                 push    edx
.text:42CF5713                 push    offset aSSErrorD ; "%s(%s) : Error %d"
.text:42CF5718                 lea     eax, [ebp+Buffer]
.text:42CF571E                 push    eax             ; Buffer
.text:42CF571F                 call    ds:sprintf
.text:42CF5725                 add     esp, 14h
.text:42CF5728                 lea     ecx, [ebp+Buffer]
.text:42CF572E                 mov     [ebp+Strings], ecx
.text:42CF5731                 cmp     hEventLog, 0
.text:42CF5738                 jz      short loc_42CF5765
.text:42CF573A                 push    0               ; lpRawData
.text:42CF573C                 lea     edx, [ebp+Strings]
.text:42CF573F                 push    edx             ; lpStrings
.text:42CF5740                 push    0               ; dwDataSize
.text:42CF5742                 push    1               ; wNumStrings
.text:42CF5744                 push    0               ; lpUserSid
.text:42CF5746                 push    0C0004A43h      ; dwEventID
.text:42CF574B                 push    8               ; wCategory
.text:42CF574D                 mov     ax, [ebp+wType]
.text:42CF5751                 push    eax             ; wType
.text:42CF5752                 mov     ecx, hEventLog
.text:42CF5758                 push    ecx             ; hEventLog
.text:42CF5759                 call    ds:ReportEventA
.text:42CF575F                 mov     [ebp+var_108], eax
.text:42CF5765
.text:42CF5765 loc_42CF5765:                           ; CODE XREF: sub_42CF56FE+3A\u2191j
.text:42CF5765                 mov     esp, ebp
.text:42CF5767                 pop     ebp
.text:42CF5768                 retn
.text:42CF5768 sub_42CF56FE    endp
.text:42CF5768
.text:42CF5769
.text:42CF5769 ; =============== S U B R O U T I N E =======================================
.text:42CF5769
.text:42CF5769 ; Attributes: bp-based frame
.text:42CF5769
.text:42CF5769 ; int __cdecl sub_42CF5769(int, int, int, wchar_t *Destination)
.text:42CF5769 sub_42CF5769    proc near               ; CODE XREF: ConnectionListen+10D8\u2191p
.text:42CF5769
.text:42CF5769 var_4           = dword ptr -4
.text:42CF5769 arg_0           = dword ptr  8
.text:42CF5769 arg_4           = dword ptr  0Ch
.text:42CF5769 arg_8           = dword ptr  10h
.text:42CF5769 Destination     = dword ptr  14h
.text:42CF5769
.text:42CF5769                 push    ebp
.text:42CF576A                 mov     ebp, esp
.text:42CF576C                 push    ecx
.text:42CF576D                 mov     [ebp+var_4], 0
.text:42CF5774                 cmp     hModule, 0
.text:42CF577B                 jz      loc_42CF5856
.text:42CF5781                 call    dword_42D01BD0
.text:42CF5787                 push    eax             ; Size
.text:42CF5788                 call    ds:malloc
.text:42CF578E                 add     esp, 4
.text:42CF5791                 mov     dword_42D01BA0, eax
.text:42CF5796                 cmp     dword_42D01BA0, 0
.text:42CF579D                 jnz     short loc_42CF57B7
.text:42CF579F                 push    164Ah
.text:42CF57A4                 push    offset aQSphinxNetlibs_9 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF57A9                 push    offset aLpcstructPlist ; "lpcStruct.pListenConnObject != NULL"
.text:42CF57AE                 call    ds:_assert
.text:42CF57B4 ; ---------------------------------------------------------------------------
.text:42CF57B4                 add     esp, 0Ch
.text:42CF57B7
.text:42CF57B7 loc_42CF57B7:                           ; CODE XREF: sub_42CF5769+34\u2191j
.text:42CF57B7                 cmp     hModule, 0
.text:42CF57BE                 jz      loc_42CF5856
.text:42CF57C4                 cmp     dword_42D01BA0, 0
.text:42CF57CB                 jz      loc_42CF5856
.text:42CF57D1                 mov     ecx, [ebp+arg_4]
.text:42CF57D4                 push    ecx
.text:42CF57D5                 push    offset MultiByteStr
.text:42CF57DA                 mov     edx, dword_42D01BA0
.text:42CF57E0                 push    edx
.text:42CF57E1                 call    dword_42D01BB4
.text:42CF57E7                 add     esp, 0Ch
.text:42CF57EA                 cmp     eax, 1
.text:42CF57ED                 jnz     short loc_42CF5814
.text:42CF57EF                 mov     eax, dword_42D01BA0
.text:42CF57F4                 mov     dword_42D01BD8, eax
.text:42CF57F9                 mov     [ebp+var_4], 1
.text:42CF5800                 push    offset aSharedMemory ; ", Shared Memory"
.text:42CF5805                 mov     ecx, [ebp+Destination]
.text:42CF5808                 push    ecx             ; Destination
.text:42CF5809                 call    ds:wcscat
.text:42CF580F                 add     esp, 8
.text:42CF5812                 jmp     short loc_42CF5856
.text:42CF5814 ; ---------------------------------------------------------------------------
.text:42CF5814
.text:42CF5814 loc_42CF5814:                           ; CODE XREF: sub_42CF5769+84\u2191j
.text:42CF5814                 mov     edx, dword_42D01BA0
.text:42CF581A                 push    edx             ; Block
.text:42CF581B                 call    ds:free
.text:42CF5821                 add     esp, 4
.text:42CF5824                 mov     dword_42D01BA0, 0
.text:42CF582E                 mov     dword_42D01BD8, 0
.text:42CF5838                 push    1               ; wType
.text:42CF583A                 mov     eax, [ebp+arg_4]
.text:42CF583D                 mov     ecx, [eax]
.text:42CF583F                 push    ecx             ; int
.text:42CF5840                 push    offset aConnectionlist_2 ; "ConnectionListen"
.text:42CF5845                 push    offset aSharedMemoryLp_0 ; "Shared-Memory (LPC)"
.text:42CF584A                 mov     edx, [ebp+arg_0]
.text:42CF584D                 push    edx             ; int
.text:42CF584E                 call    sub_42CF56FE
.text:42CF5853                 add     esp, 14h
.text:42CF5856
.text:42CF5856 loc_42CF5856:                           ; CODE XREF: sub_42CF5769+12\u2191j
.text:42CF5856                                         ; sub_42CF5769+55\u2191j ...
.text:42CF5856                 cmp     hLibModule, 0
.text:42CF585D                 jz      loc_42CF593D
.text:42CF5863                 call    dword_42D01E30
.text:42CF5869                 push    eax             ; Size
.text:42CF586A                 call    ds:malloc
.text:42CF5870                 add     esp, 4
.text:42CF5873                 mov     Block, eax
.text:42CF5878                 cmp     Block, 0
.text:42CF587F                 jnz     short loc_42CF5899
.text:42CF5881                 push    1673h
.text:42CF5886                 push    offset aQSphinxNetlibs_10 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF588B                 push    offset aNpstructPliste ; "npStruct.pListenConnObject != NULL"
.text:42CF5890                 call    ds:_assert
.text:42CF5896 ; ---------------------------------------------------------------------------
.text:42CF5896                 add     esp, 0Ch
.text:42CF5899
.text:42CF5899 loc_42CF5899:                           ; CODE XREF: sub_42CF5769+116\u2191j
.text:42CF5899                 cmp     hLibModule, 0
.text:42CF58A0                 jz      loc_42CF593D
.text:42CF58A6                 cmp     Block, 0
.text:42CF58AD                 jz      loc_42CF593D
.text:42CF58B3                 mov     ecx, [ebp+arg_4]
.text:42CF58B6                 push    ecx
.text:42CF58B7                 mov     edx, [ebp+arg_8]
.text:42CF58BA                 add     edx, 92Ch
.text:42CF58C0                 push    edx
.text:42CF58C1                 mov     eax, Block
.text:42CF58C6                 push    eax
.text:42CF58C7                 call    dword_42D01E14
.text:42CF58CD                 add     esp, 0Ch
.text:42CF58D0                 cmp     eax, 1
.text:42CF58D3                 jnz     short loc_42CF58FC
.text:42CF58D5                 mov     ecx, Block
.text:42CF58DB                 mov     dword_42D01E38, ecx
.text:42CF58E1                 mov     [ebp+var_4], 1
.text:42CF58E8                 push    offset aNamedPipes_0 ; ", Named Pipes"
.text:42CF58ED                 mov     edx, [ebp+Destination]
.text:42CF58F0                 push    edx             ; Destination
.text:42CF58F1                 call    ds:wcscat
.text:42CF58F7                 add     esp, 8
.text:42CF58FA                 jmp     short loc_42CF593D
.text:42CF58FC ; ---------------------------------------------------------------------------
.text:42CF58FC
.text:42CF58FC loc_42CF58FC:                           ; CODE XREF: sub_42CF5769+16A\u2191j
.text:42CF58FC                 mov     eax, Block
.text:42CF5901                 push    eax             ; Block
.text:42CF5902                 call    ds:free
.text:42CF5908                 add     esp, 4
.text:42CF590B                 mov     Block, 0
.text:42CF5915                 mov     dword_42D01E38, 0
.text:42CF591F                 push    1               ; wType
.text:42CF5921                 mov     ecx, [ebp+arg_4]
.text:42CF5924                 mov     edx, [ecx]
.text:42CF5926                 push    edx             ; int
.text:42CF5927                 push    offset aConnectionlist_3 ; "ConnectionListen"
.text:42CF592C                 push    offset aNamedPipes_1 ; "Named Pipes"
.text:42CF5931                 mov     eax, [ebp+arg_0]
.text:42CF5934                 push    eax             ; int
.text:42CF5935                 call    sub_42CF56FE
.text:42CF593A                 add     esp, 14h
.text:42CF593D
.text:42CF593D loc_42CF593D:                           ; CODE XREF: sub_42CF5769+F4\u2191j
.text:42CF593D                                         ; sub_42CF5769+137\u2191j ...
.text:42CF593D                 cmp     dword_42D01F44, 0
.text:42CF5944                 jz      loc_42CF5A25
.text:42CF594A                 call    dword_42D01F70
.text:42CF5950                 push    eax             ; Size
.text:42CF5951                 call    ds:malloc
.text:42CF5957                 add     esp, 4
.text:42CF595A                 mov     dword_42D01F40, eax
.text:42CF595F                 cmp     dword_42D01F40, 0
.text:42CF5966                 jnz     short loc_42CF5980
.text:42CF5968                 push    169Ch
.text:42CF596D                 push    offset aQSphinxNetlibs_11 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF5972                 push    offset aAdspstructPlis ; "adspStruct.pListenConnObject != NULL"
.text:42CF5977                 call    ds:_assert
.text:42CF597D ; ---------------------------------------------------------------------------
.text:42CF597D                 add     esp, 0Ch
.text:42CF5980
.text:42CF5980 loc_42CF5980:                           ; CODE XREF: sub_42CF5769+1FD\u2191j
.text:42CF5980                 cmp     dword_42D01F44, 0
.text:42CF5987                 jz      loc_42CF5A25
.text:42CF598D                 cmp     dword_42D01F40, 0
.text:42CF5994                 jz      loc_42CF5A25
.text:42CF599A                 mov     edx, [ebp+arg_4]
.text:42CF599D                 push    edx
.text:42CF599E                 mov     eax, [ebp+arg_8]
.text:42CF59A1                 add     eax, 424h
.text:42CF59A6                 push    eax
.text:42CF59A7                 mov     ecx, dword_42D01F40
.text:42CF59AD                 push    ecx
.text:42CF59AE                 call    dword_42D01F54
.text:42CF59B4                 add     esp, 0Ch
.text:42CF59B7                 cmp     eax, 1
.text:42CF59BA                 jnz     short loc_42CF59E3
.text:42CF59BC                 mov     edx, dword_42D01F40
.text:42CF59C2                 mov     dword_42D01F78, edx
.text:42CF59C8                 mov     [ebp+var_4], 1
.text:42CF59CF                 push    offset aAdsp_2  ; ", Adsp"
.text:42CF59D4                 mov     eax, [ebp+Destination]
.text:42CF59D7                 push    eax             ; Destination
.text:42CF59D8                 call    ds:wcscat
.text:42CF59DE                 add     esp, 8
.text:42CF59E1                 jmp     short loc_42CF5A25
.text:42CF59E3 ; ---------------------------------------------------------------------------
.text:42CF59E3
.text:42CF59E3 loc_42CF59E3:                           ; CODE XREF: sub_42CF5769+251\u2191j
.text:42CF59E3                 mov     ecx, dword_42D01F40
.text:42CF59E9                 push    ecx             ; Block
.text:42CF59EA                 call    ds:free
.text:42CF59F0                 add     esp, 4
.text:42CF59F3                 mov     dword_42D01F40, 0
.text:42CF59FD                 mov     dword_42D01F78, 0
.text:42CF5A07                 push    1               ; wType
.text:42CF5A09                 mov     edx, [ebp+arg_4]
.text:42CF5A0C                 mov     eax, [edx]
.text:42CF5A0E                 push    eax             ; int
.text:42CF5A0F                 push    offset aConnectionlist_4 ; "ConnectionListen"
.text:42CF5A14                 push    offset aAdsp_3  ; "Adsp"
.text:42CF5A19                 mov     ecx, [ebp+arg_0]
.text:42CF5A1C                 push    ecx             ; int
.text:42CF5A1D                 call    sub_42CF56FE
.text:42CF5A22                 add     esp, 14h
.text:42CF5A25
.text:42CF5A25 loc_42CF5A25:                           ; CODE XREF: sub_42CF5769+1DB\u2191j
.text:42CF5A25                                         ; sub_42CF5769+21E\u2191j ...
.text:42CF5A25                 cmp     dword_42D01C64, 0
.text:42CF5A2C                 jz      loc_42CF5B09
.text:42CF5A32                 call    dword_42D01C90
.text:42CF5A38                 push    eax             ; Size
.text:42CF5A39                 call    ds:malloc
.text:42CF5A3F                 add     esp, 4
.text:42CF5A42                 mov     dword_42D01C60, eax
.text:42CF5A47                 cmp     dword_42D01C60, 0
.text:42CF5A4E                 jnz     short loc_42CF5A68
.text:42CF5A50                 push    16C5h
.text:42CF5A55                 push    offset aQSphinxNetlibs_12 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF5A5A                 push    offset aRpcstructPlist ; "rpcStruct.pListenConnObject != NULL"
.text:42CF5A5F                 call    ds:_assert
.text:42CF5A65 ; ---------------------------------------------------------------------------
.text:42CF5A65                 add     esp, 0Ch
.text:42CF5A68
.text:42CF5A68 loc_42CF5A68:                           ; CODE XREF: sub_42CF5769+2E5\u2191j
.text:42CF5A68                 cmp     dword_42D01C64, 0
.text:42CF5A6F                 jz      loc_42CF5B09
.text:42CF5A75                 cmp     dword_42D01C60, 0
.text:42CF5A7C                 jz      loc_42CF5B09
.text:42CF5A82                 mov     eax, [ebp+arg_4]
.text:42CF5A85                 push    eax
.text:42CF5A86                 push    offset name
.text:42CF5A8B                 mov     ecx, dword_42D01C60
.text:42CF5A91                 push    ecx
.text:42CF5A92                 call    dword_42D01C74
.text:42CF5A98                 add     esp, 0Ch
.text:42CF5A9B                 cmp     eax, 1
.text:42CF5A9E                 jnz     short loc_42CF5AC7
.text:42CF5AA0                 mov     edx, dword_42D01C60
.text:42CF5AA6                 mov     dword_42D01C98, edx
.text:42CF5AAC                 mov     [ebp+var_4], 1
.text:42CF5AB3                 push    offset aRpc_2   ; ", Rpc"
.text:42CF5AB8                 mov     eax, [ebp+Destination]
.text:42CF5ABB                 push    eax             ; Destination
.text:42CF5ABC                 call    ds:wcscat
.text:42CF5AC2                 add     esp, 8
.text:42CF5AC5                 jmp     short loc_42CF5B09
.text:42CF5AC7 ; ---------------------------------------------------------------------------
.text:42CF5AC7
.text:42CF5AC7 loc_42CF5AC7:                           ; CODE XREF: sub_42CF5769+335\u2191j
.text:42CF5AC7                 mov     ecx, dword_42D01C60
.text:42CF5ACD                 push    ecx             ; Block
.text:42CF5ACE                 call    ds:free
.text:42CF5AD4                 add     esp, 4
.text:42CF5AD7                 mov     dword_42D01C60, 0
.text:42CF5AE1                 mov     dword_42D01C98, 0
.text:42CF5AEB                 push    1               ; wType
.text:42CF5AED                 mov     edx, [ebp+arg_4]
.text:42CF5AF0                 mov     eax, [edx]
.text:42CF5AF2                 push    eax             ; int
.text:42CF5AF3                 push    offset aConnectionlist_5 ; "ConnectionListen"
.text:42CF5AF8                 push    offset aRpc_3   ; "Rpc"
.text:42CF5AFD                 mov     ecx, [ebp+arg_0]
.text:42CF5B00                 push    ecx             ; int
.text:42CF5B01                 call    sub_42CF56FE
.text:42CF5B06                 add     esp, 14h
.text:42CF5B09
.text:42CF5B09 loc_42CF5B09:                           ; CODE XREF: sub_42CF5769+2C3\u2191j
.text:42CF5B09                                         ; sub_42CF5769+306\u2191j ...
.text:42CF5B09                 cmp     dword_42D01C04, 0
.text:42CF5B10                 jz      loc_42CF5BF0
.text:42CF5B16                 call    dword_42D01C30
.text:42CF5B1C                 push    eax             ; Size
.text:42CF5B1D                 call    ds:malloc
.text:42CF5B23                 add     esp, 4
.text:42CF5B26                 mov     dword_42D01C00, eax
.text:42CF5B2B                 cmp     dword_42D01C00, 0
.text:42CF5B32                 jnz     short loc_42CF5B4C
.text:42CF5B34                 push    16EEh
.text:42CF5B39                 push    offset aQSphinxNetlibs_13 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF5B3E                 push    offset aBvstructPliste ; "bvStruct.pListenConnObject != NULL"
.text:42CF5B43                 call    ds:_assert
.text:42CF5B49 ; ---------------------------------------------------------------------------
.text:42CF5B49                 add     esp, 0Ch
.text:42CF5B4C
.text:42CF5B4C loc_42CF5B4C:                           ; CODE XREF: sub_42CF5769+3C9\u2191j
.text:42CF5B4C                 cmp     dword_42D01C04, 0
.text:42CF5B53                 jz      loc_42CF5BF0
.text:42CF5B59                 cmp     dword_42D01C00, 0
.text:42CF5B60                 jz      loc_42CF5BF0
.text:42CF5B66                 mov     eax, [ebp+arg_4]
.text:42CF5B69                 push    eax
.text:42CF5B6A                 mov     ecx, [ebp+arg_8]
.text:42CF5B6D                 add     ecx, 0D2Ch
.text:42CF5B73                 push    ecx
.text:42CF5B74                 mov     edx, dword_42D01C00
.text:42CF5B7A                 push    edx
.text:42CF5B7B                 call    dword_42D01C14
.text:42CF5B81                 add     esp, 0Ch
.text:42CF5B84                 cmp     eax, 1
.text:42CF5B87                 jnz     short loc_42CF5BAE
.text:42CF5B89                 mov     eax, dword_42D01C00
.text:42CF5B8E                 mov     dword_42D01C38, eax
.text:42CF5B93                 mov     [ebp+var_4], 1
.text:42CF5B9A                 push    offset aBanyanVines_2 ; ", Banyan Vines"
.text:42CF5B9F                 mov     ecx, [ebp+Destination]
.text:42CF5BA2                 push    ecx             ; Destination
.text:42CF5BA3                 call    ds:wcscat
.text:42CF5BA9                 add     esp, 8
.text:42CF5BAC                 jmp     short loc_42CF5BF0
.text:42CF5BAE ; ---------------------------------------------------------------------------
.text:42CF5BAE
.text:42CF5BAE loc_42CF5BAE:                           ; CODE XREF: sub_42CF5769+41E\u2191j
.text:42CF5BAE                 mov     edx, dword_42D01C00
.text:42CF5BB4                 push    edx             ; Block
.text:42CF5BB5                 call    ds:free
.text:42CF5BBB                 add     esp, 4
.text:42CF5BBE                 mov     dword_42D01C00, 0
.text:42CF5BC8                 mov     dword_42D01C38, 0
.text:42CF5BD2                 push    1               ; wType
.text:42CF5BD4                 mov     eax, [ebp+arg_4]
.text:42CF5BD7                 mov     ecx, [eax]
.text:42CF5BD9                 push    ecx             ; int
.text:42CF5BDA                 push    offset aConnectionlist_6 ; "ConnectionListen"
.text:42CF5BDF                 push    offset aBanyanVines_3 ; "Banyan Vines"
.text:42CF5BE4                 mov     edx, [ebp+arg_0]
.text:42CF5BE7                 push    edx             ; int
.text:42CF5BE8                 call    sub_42CF56FE
.text:42CF5BED                 add     esp, 14h
.text:42CF5BF0
.text:42CF5BF0 loc_42CF5BF0:                           ; CODE XREF: sub_42CF5769+3A7\u2191j
.text:42CF5BF0                                         ; sub_42CF5769+3EA\u2191j ...
.text:42CF5BF0                 cmp     dword_42D020C4, 0
.text:42CF5BF7                 jz      loc_42CF5CD7
.text:42CF5BFD                 call    dword_42D020F0
.text:42CF5C03                 push    eax             ; Size
.text:42CF5C04                 call    ds:malloc
.text:42CF5C0A                 add     esp, 4
.text:42CF5C0D                 mov     dword_42D020C0, eax
.text:42CF5C12                 cmp     dword_42D020C0, 0
.text:42CF5C19                 jnz     short loc_42CF5C33
.text:42CF5C1B                 push    1717h
.text:42CF5C20                 push    offset aQSphinxNetlibs_14 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF5C25                 push    offset aViastructPlist ; "viaStruct.pListenConnObject != NULL"
.text:42CF5C2A                 call    ds:_assert
.text:42CF5C30 ; ---------------------------------------------------------------------------
.text:42CF5C30                 add     esp, 0Ch
.text:42CF5C33
.text:42CF5C33 loc_42CF5C33:                           ; CODE XREF: sub_42CF5769+4B0\u2191j
.text:42CF5C33                 cmp     dword_42D020C4, 0
.text:42CF5C3A                 jz      loc_42CF5CD7
.text:42CF5C40                 cmp     dword_42D020C0, 0
.text:42CF5C47                 jz      loc_42CF5CD7
.text:42CF5C4D                 mov     ecx, [ebp+arg_4]
.text:42CF5C50                 push    ecx
.text:42CF5C51                 mov     edx, [ebp+arg_8]
.text:42CF5C54                 add     edx, 132Ch
.text:42CF5C5A                 push    edx
.text:42CF5C5B                 mov     eax, dword_42D020C0
.text:42CF5C60                 push    eax
.text:42CF5C61                 call    dword_42D020D4
.text:42CF5C67                 add     esp, 0Ch
.text:42CF5C6A                 cmp     eax, 1
.text:42CF5C6D                 jnz     short loc_42CF5C96
.text:42CF5C6F                 mov     ecx, dword_42D020C0
.text:42CF5C75                 mov     dword_42D020F8, ecx
.text:42CF5C7B                 mov     [ebp+var_4], 1
.text:42CF5C82                 push    offset aVia_0   ; ", Via"
.text:42CF5C87                 mov     edx, [ebp+Destination]
.text:42CF5C8A                 push    edx             ; Destination
.text:42CF5C8B                 call    ds:wcscat
.text:42CF5C91                 add     esp, 8
.text:42CF5C94                 jmp     short loc_42CF5CD7
.text:42CF5C96 ; ---------------------------------------------------------------------------
.text:42CF5C96
.text:42CF5C96 loc_42CF5C96:                           ; CODE XREF: sub_42CF5769+504\u2191j
.text:42CF5C96                 mov     eax, dword_42D020C0
.text:42CF5C9B                 push    eax             ; Block
.text:42CF5C9C                 call    ds:free
.text:42CF5CA2                 add     esp, 4
.text:42CF5CA5                 mov     dword_42D020C0, 0
.text:42CF5CAF                 mov     dword_42D020F8, 0
.text:42CF5CB9                 push    1               ; wType
.text:42CF5CBB                 mov     ecx, [ebp+arg_4]
.text:42CF5CBE                 mov     edx, [ecx]
.text:42CF5CC0                 push    edx             ; int
.text:42CF5CC1                 push    offset aConnectionlist_7 ; "ConnectionListen"
.text:42CF5CC6                 push    offset aVia_1   ; "Via"
.text:42CF5CCB                 mov     eax, [ebp+arg_0]
.text:42CF5CCE                 push    eax             ; int
.text:42CF5CCF                 call    sub_42CF56FE
.text:42CF5CD4                 add     esp, 14h
.text:42CF5CD7
.text:42CF5CD7 loc_42CF5CD7:                           ; CODE XREF: sub_42CF5769+48E\u2191j
.text:42CF5CD7                                         ; sub_42CF5769+4D1\u2191j ...
.text:42CF5CD7                 mov     eax, [ebp+var_4]
.text:42CF5CDA                 mov     esp, ebp
.text:42CF5CDC                 pop     ebp
.text:42CF5CDD                 retn
.text:42CF5CDD sub_42CF5769    endp
.text:42CF5CDD
.text:42CF5CDE ; ---------------------------------------------------------------------------
.text:42CF5CDE                 push    ebp
.text:42CF5CDF                 mov     ebp, esp
.text:42CF5CE1                 mov     eax, [ebp+8]
.text:42CF5CE4                 call    dword ptr [eax+30h]
.text:42CF5CE7                 push    eax
.text:42CF5CE8                 call    ds:malloc
.text:42CF5CEE                 add     esp, 4
.text:42CF5CF1                 mov     ecx, [ebp+8]
.text:42CF5CF4                 mov     [ecx], eax
.text:42CF5CF6                 mov     edx, [ebp+8]
.text:42CF5CF9                 cmp     dword ptr [edx], 0
.text:42CF5CFC                 jnz     short loc_42CF5D16
.text:42CF5CFE                 push    1748h
.text:42CF5D03                 push    offset aQSphinxNetlibs_15 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF5D08                 push    offset aPnlPlistenconn ; "pNl->pListenConnObject != NULL"
.text:42CF5D0D                 call    ds:_assert
.text:42CF5D13 ; ---------------------------------------------------------------------------
.text:42CF5D13                 add     esp, 0Ch
.text:42CF5D16
.text:42CF5D16 loc_42CF5D16:                           ; CODE XREF: .text:42CF5CFC\u2191j
.text:42CF5D16                 mov     ecx, [ebp+8]
.text:42CF5D19                 cmp     dword ptr [ecx+4], 0
.text:42CF5D1D                 jz      short loc_42CF5D94
.text:42CF5D1F                 mov     edx, [ebp+8]
.text:42CF5D22                 cmp     dword ptr [edx], 0
.text:42CF5D25                 jz      short loc_42CF5D94
.text:42CF5D27                 mov     eax, [ebp+18h]
.text:42CF5D2A                 push    eax
.text:42CF5D2B                 mov     ecx, [ebp+14h]
.text:42CF5D2E                 push    ecx
.text:42CF5D2F                 mov     edx, [ebp+8]
.text:42CF5D32                 mov     eax, [edx]
.text:42CF5D34                 push    eax
.text:42CF5D35                 mov     ecx, [ebp+8]
.text:42CF5D38                 call    dword ptr [ecx+14h]
.text:42CF5D3B                 add     esp, 0Ch
.text:42CF5D3E                 cmp     eax, 1
.text:42CF5D41                 jnz     short loc_42CF5D55
.text:42CF5D43                 mov     edx, [ebp+8]
.text:42CF5D46                 mov     eax, [ebp+8]
.text:42CF5D49                 mov     ecx, [eax]
.text:42CF5D4B                 mov     [edx+38h], ecx
.text:42CF5D4E                 mov     eax, 1
.text:42CF5D53                 jmp     short loc_42CF5D96
.text:42CF5D55 ; ---------------------------------------------------------------------------
.text:42CF5D55
.text:42CF5D55 loc_42CF5D55:                           ; CODE XREF: .text:42CF5D41\u2191j
.text:42CF5D55                 mov     edx, [ebp+8]
.text:42CF5D58                 mov     eax, [edx]
.text:42CF5D5A                 push    eax
.text:42CF5D5B                 call    ds:free
.text:42CF5D61                 add     esp, 4
.text:42CF5D64                 mov     ecx, [ebp+8]
.text:42CF5D67                 mov     dword ptr [ecx], 0
.text:42CF5D6D                 mov     edx, [ebp+8]
.text:42CF5D70                 mov     dword ptr [edx+38h], 0
.text:42CF5D77                 push    1
.text:42CF5D79                 mov     eax, [ebp+18h]
.text:42CF5D7C                 mov     ecx, [eax]
.text:42CF5D7E                 push    ecx
.text:42CF5D7F                 push    offset aConnectionlist_8 ; "ConnectionListen"
.text:42CF5D84                 mov     edx, [ebp+0Ch]
.text:42CF5D87                 push    edx
.text:42CF5D88                 mov     eax, [ebp+10h]
.text:42CF5D8B                 push    eax
.text:42CF5D8C                 call    sub_42CF56FE
.text:42CF5D91                 add     esp, 14h
.text:42CF5D94
.text:42CF5D94 loc_42CF5D94:                           ; CODE XREF: .text:42CF5D1D\u2191j
.text:42CF5D94                                         ; .text:42CF5D25\u2191j
.text:42CF5D94                 xor     eax, eax
.text:42CF5D96
.text:42CF5D96 loc_42CF5D96:                           ; CODE XREF: .text:42CF5D53\u2191j
.text:42CF5D96                 pop     ebp
.text:42CF5D97                 retn
.text:42CF5D98
.text:42CF5D98 ; =============== S U B R O U T I N E =======================================
.text:42CF5D98
.text:42CF5D98 ; Attributes: bp-based frame
.text:42CF5D98
.text:42CF5D98 sub_42CF5D98    proc near               ; CODE XREF: ConnectionClose+AE\u2191p
.text:42CF5D98
.text:42CF5D98 var_8           = dword ptr -8
.text:42CF5D98 var_4           = byte ptr -4
.text:42CF5D98 arg_0           = dword ptr  8
.text:42CF5D98
.text:42CF5D98                 push    ebp
.text:42CF5D99                 mov     ebp, esp
.text:42CF5D9B                 sub     esp, 8
.text:42CF5D9E                 mov     eax, [ebp+arg_0]
.text:42CF5DA1                 mov     ecx, [eax+84h]
.text:42CF5DA7                 mov     [ebp+var_8], ecx
.text:42CF5DAA                 mov     edx, [ebp+var_8]
.text:42CF5DAD                 sub     edx, 1          ; switch 8 cases
.text:42CF5DB0                 mov     [ebp+var_8], edx
.text:42CF5DB3                 cmp     [ebp+var_8], 7
.text:42CF5DB7                 ja      def_42CF5DC0    ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5DBD                 mov     eax, [ebp+var_8]
.text:42CF5DC0                 jmp     ds:jpt_42CF5DC0[eax*4] ; switch jump
.text:42CF5DC7 ; ---------------------------------------------------------------------------
.text:42CF5DC7
.text:42CF5DC7 loc_42CF5DC7:                           ; CODE XREF: sub_42CF5D98+28\u2191j
.text:42CF5DC7                                         ; DATA XREF: .text:jpt_42CF5DC0\u2193o
.text:42CF5DC7                 lea     ecx, [ebp+var_4] ; jumptable 42CF5DC0 case 6
.text:42CF5DCA                 push    ecx
.text:42CF5DCB                 mov     edx, [ebp+arg_0]
.text:42CF5DCE                 mov     eax, [edx+88h]
.text:42CF5DD4                 push    eax
.text:42CF5DD5                 call    dword_42D01BB0
.text:42CF5DDB                 add     esp, 8
.text:42CF5DDE                 jmp     short def_42CF5DC0 ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5DE0 ; ---------------------------------------------------------------------------
.text:42CF5DE0
.text:42CF5DE0 loc_42CF5DE0:                           ; CODE XREF: sub_42CF5D98+28\u2191j
.text:42CF5DE0                                         ; DATA XREF: .text:jpt_42CF5DC0\u2193o
.text:42CF5DE0                 lea     ecx, [ebp+var_4] ; jumptable 42CF5DC0 case 1
.text:42CF5DE3                 push    ecx
.text:42CF5DE4                 mov     edx, [ebp+arg_0]
.text:42CF5DE7                 mov     eax, [edx+88h]
.text:42CF5DED                 push    eax
.text:42CF5DEE                 call    dword_42D01E10
.text:42CF5DF4                 add     esp, 8
.text:42CF5DF7                 jmp     short def_42CF5DC0 ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5DF9 ; ---------------------------------------------------------------------------
.text:42CF5DF9
.text:42CF5DF9 loc_42CF5DF9:                           ; CODE XREF: sub_42CF5D98+28\u2191j
.text:42CF5DF9                                         ; DATA XREF: .text:jpt_42CF5DC0\u2193o
.text:42CF5DF9                 lea     ecx, [ebp+var_4] ; jumptable 42CF5DC0 case 4
.text:42CF5DFC                 push    ecx
.text:42CF5DFD                 mov     edx, [ebp+arg_0]
.text:42CF5E00                 mov     eax, [edx+88h]
.text:42CF5E06                 push    eax
.text:42CF5E07                 call    dword_42D01F50
.text:42CF5E0D                 add     esp, 8
.text:42CF5E10                 jmp     short def_42CF5DC0 ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5E12 ; ---------------------------------------------------------------------------
.text:42CF5E12
.text:42CF5E12 loc_42CF5E12:                           ; CODE XREF: sub_42CF5D98+28\u2191j
.text:42CF5E12                                         ; DATA XREF: .text:jpt_42CF5DC0\u2193o
.text:42CF5E12                 lea     ecx, [ebp+var_4] ; jumptable 42CF5DC0 case 3
.text:42CF5E15                 push    ecx
.text:42CF5E16                 mov     edx, [ebp+arg_0]
.text:42CF5E19                 mov     eax, [edx+88h]
.text:42CF5E1F                 push    eax
.text:42CF5E20                 call    dword_42D01C70
.text:42CF5E26                 add     esp, 8
.text:42CF5E29                 jmp     short def_42CF5DC0 ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5E2B ; ---------------------------------------------------------------------------
.text:42CF5E2B
.text:42CF5E2B loc_42CF5E2B:                           ; CODE XREF: sub_42CF5D98+28\u2191j
.text:42CF5E2B                                         ; DATA XREF: .text:jpt_42CF5DC0\u2193o
.text:42CF5E2B                 lea     ecx, [ebp+var_4] ; jumptable 42CF5DC0 case 2
.text:42CF5E2E                 push    ecx
.text:42CF5E2F                 mov     edx, [ebp+arg_0]
.text:42CF5E32                 mov     eax, [edx+88h]
.text:42CF5E38                 push    eax
.text:42CF5E39                 call    dword_42D01C10
.text:42CF5E3F                 add     esp, 8
.text:42CF5E42                 jmp     short def_42CF5DC0 ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5E44 ; ---------------------------------------------------------------------------
.text:42CF5E44
.text:42CF5E44 loc_42CF5E44:                           ; CODE XREF: sub_42CF5D98+28\u2191j
.text:42CF5E44                                         ; DATA XREF: .text:jpt_42CF5DC0\u2193o
.text:42CF5E44                 lea     ecx, [ebp+var_4] ; jumptable 42CF5DC0 case 8
.text:42CF5E47                 push    ecx
.text:42CF5E48                 mov     edx, [ebp+arg_0]
.text:42CF5E4B                 mov     eax, [edx+88h]
.text:42CF5E51                 push    eax
.text:42CF5E52                 call    dword_42D020D0
.text:42CF5E58                 add     esp, 8
.text:42CF5E5B                 jmp     short loc_42CF5E89
.text:42CF5E5D ; ---------------------------------------------------------------------------
.text:42CF5E5D
.text:42CF5E5D def_42CF5DC0:                           ; CODE XREF: sub_42CF5D98+1F\u2191j
.text:42CF5E5D                                         ; sub_42CF5D98+28\u2191j ...
.text:42CF5E5D                 mov     ecx, [ebp+arg_0] ; jumptable 42CF5DC0 default case, cases 5,7
.text:42CF5E60                 cmp     dword ptr [ecx+88h], 0
.text:42CF5E67                 jz      short loc_42CF5E7C
.text:42CF5E69                 mov     edx, [ebp+arg_0]
.text:42CF5E6C                 mov     eax, [edx+88h]
.text:42CF5E72                 push    eax             ; Block
.text:42CF5E73                 call    ds:free
.text:42CF5E79                 add     esp, 4
.text:42CF5E7C
.text:42CF5E7C loc_42CF5E7C:                           ; CODE XREF: sub_42CF5D98+CF\u2191j
.text:42CF5E7C                 mov     ecx, [ebp+arg_0]
.text:42CF5E7F                 mov     dword ptr [ecx+88h], 0
.text:42CF5E89
.text:42CF5E89 loc_42CF5E89:                           ; CODE XREF: sub_42CF5D98+C3\u2191j
.text:42CF5E89                 mov     esp, ebp
.text:42CF5E8B                 pop     ebp
.text:42CF5E8C                 retn
.text:42CF5E8C sub_42CF5D98    endp
.text:42CF5E8C
.text:42CF5E8C ; ---------------------------------------------------------------------------
.text:42CF5E8D jpt_42CF5DC0    dd offset loc_42CF5DE0  ; DATA XREF: sub_42CF5D98+28\u2191r
.text:42CF5E8D                 dd offset loc_42CF5E2B  ; jump table for switch statement
.text:42CF5E8D                 dd offset loc_42CF5E12
.text:42CF5E8D                 dd offset loc_42CF5DF9
.text:42CF5E8D                 dd offset def_42CF5DC0
.text:42CF5E8D                 dd offset loc_42CF5DC7
.text:42CF5E8D                 dd offset def_42CF5DC0
.text:42CF5E8D                 dd offset loc_42CF5E44
.text:42CF5EAD
.text:42CF5EAD ; =============== S U B R O U T I N E =======================================
.text:42CF5EAD
.text:42CF5EAD ; Attributes: bp-based frame
.text:42CF5EAD
.text:42CF5EAD sub_42CF5EAD    proc near               ; CODE XREF: ConnectionAccept+E9\u2191p
.text:42CF5EAD
.text:42CF5EAD var_4           = dword ptr -4
.text:42CF5EAD arg_0           = dword ptr  8
.text:42CF5EAD arg_8           = dword ptr  10h
.text:42CF5EAD arg_C           = dword ptr  14h
.text:42CF5EAD
.text:42CF5EAD                 push    ebp
.text:42CF5EAE                 mov     ebp, esp
.text:42CF5EB0                 push    ecx
.text:42CF5EB1                 mov     eax, [ebp+arg_0]
.text:42CF5EB4                 mov     ecx, [eax+84h]
.text:42CF5EBA                 mov     [ebp+var_4], ecx
.text:42CF5EBD                 mov     edx, [ebp+var_4]
.text:42CF5EC0                 sub     edx, 1          ; switch 8 cases
.text:42CF5EC3                 mov     [ebp+var_4], edx
.text:42CF5EC6                 cmp     [ebp+var_4], 7
.text:42CF5ECA                 ja      def_42CF5ED3    ; jumptable 42CF5ED3 default case, cases 5,7
.text:42CF5ED0                 mov     eax, [ebp+var_4]
.text:42CF5ED3                 jmp     ds:jpt_42CF5ED3[eax*4] ; switch jump
.text:42CF5EDA ; ---------------------------------------------------------------------------
.text:42CF5EDA
.text:42CF5EDA loc_42CF5EDA:                           ; CODE XREF: sub_42CF5EAD+26\u2191j
.text:42CF5EDA                                         ; DATA XREF: .text:jpt_42CF5ED3\u2193o
.text:42CF5EDA                 mov     ecx, [ebp+arg_C] ; jumptable 42CF5ED3 case 6
.text:42CF5EDD                 push    ecx
.text:42CF5EDE                 push    0
.text:42CF5EE0                 mov     edx, [ebp+arg_0]
.text:42CF5EE3                 push    edx
.text:42CF5EE4                 mov     eax, [ebp+arg_8]
.text:42CF5EE7                 push    eax
.text:42CF5EE8                 mov     ecx, [ebp+arg_0]
.text:42CF5EEB                 mov     edx, [ecx+88h]
.text:42CF5EF1                 push    edx
.text:42CF5EF2                 call    dword_42D01BD4
.text:42CF5EF8                 add     esp, 14h
.text:42CF5EFB                 test    eax, eax
.text:42CF5EFD                 jnz     short loc_42CF5F08
.text:42CF5EFF                 mov     eax, [ebp+arg_8]
.text:42CF5F02                 mov     dword ptr [eax], 0
.text:42CF5F08
.text:42CF5F08 loc_42CF5F08:                           ; CODE XREF: sub_42CF5EAD+50\u2191j
.text:42CF5F08                 jmp     loc_42CF600C
.text:42CF5F0D ; ---------------------------------------------------------------------------
.text:42CF5F0D
.text:42CF5F0D loc_42CF5F0D:                           ; CODE XREF: sub_42CF5EAD+26\u2191j
.text:42CF5F0D                                         ; DATA XREF: .text:jpt_42CF5ED3\u2193o
.text:42CF5F0D                 mov     ecx, [ebp+arg_C] ; jumptable 42CF5ED3 case 1
.text:42CF5F10                 push    ecx
.text:42CF5F11                 push    0
.text:42CF5F13                 mov     edx, [ebp+arg_0]
.text:42CF5F16                 push    edx
.text:42CF5F17                 mov     eax, [ebp+arg_8]
.text:42CF5F1A                 push    eax
.text:42CF5F1B                 mov     ecx, [ebp+arg_0]
.text:42CF5F1E                 mov     edx, [ecx+88h]
.text:42CF5F24                 push    edx
.text:42CF5F25                 call    dword_42D01E34
.text:42CF5F2B                 add     esp, 14h
.text:42CF5F2E                 test    eax, eax
.text:42CF5F30                 jnz     short loc_42CF5F3B
.text:42CF5F32                 mov     eax, [ebp+arg_8]
.text:42CF5F35                 mov     dword ptr [eax], 0
.text:42CF5F3B
.text:42CF5F3B loc_42CF5F3B:                           ; CODE XREF: sub_42CF5EAD+83\u2191j
.text:42CF5F3B                 jmp     loc_42CF600C
.text:42CF5F40 ; ---------------------------------------------------------------------------
.text:42CF5F40
.text:42CF5F40 loc_42CF5F40:                           ; CODE XREF: sub_42CF5EAD+26\u2191j
.text:42CF5F40                                         ; DATA XREF: .text:jpt_42CF5ED3\u2193o
.text:42CF5F40                 mov     ecx, [ebp+arg_C] ; jumptable 42CF5ED3 case 4
.text:42CF5F43                 push    ecx
.text:42CF5F44                 push    0
.text:42CF5F46                 mov     edx, [ebp+arg_0]
.text:42CF5F49                 push    edx
.text:42CF5F4A                 mov     eax, [ebp+arg_8]
.text:42CF5F4D                 push    eax
.text:42CF5F4E                 mov     ecx, [ebp+arg_0]
.text:42CF5F51                 mov     edx, [ecx+88h]
.text:42CF5F57                 push    edx
.text:42CF5F58                 call    dword_42D01F74
.text:42CF5F5E                 add     esp, 14h
.text:42CF5F61                 test    eax, eax
.text:42CF5F63                 jnz     short loc_42CF5F6E
.text:42CF5F65                 mov     eax, [ebp+arg_8]
.text:42CF5F68                 mov     dword ptr [eax], 0
.text:42CF5F6E
.text:42CF5F6E loc_42CF5F6E:                           ; CODE XREF: sub_42CF5EAD+B6\u2191j
.text:42CF5F6E                 jmp     loc_42CF600C
.text:42CF5F73 ; ---------------------------------------------------------------------------
.text:42CF5F73
.text:42CF5F73 loc_42CF5F73:                           ; CODE XREF: sub_42CF5EAD+26\u2191j
.text:42CF5F73                                         ; DATA XREF: .text:jpt_42CF5ED3\u2193o
.text:42CF5F73                 mov     ecx, [ebp+arg_C] ; jumptable 42CF5ED3 case 3
.text:42CF5F76                 push    ecx
.text:42CF5F77                 push    0
.text:42CF5F79                 mov     edx, [ebp+arg_0]
.text:42CF5F7C                 push    edx
.text:42CF5F7D                 mov     eax, [ebp+arg_8]
.text:42CF5F80                 push    eax
.text:42CF5F81                 mov     ecx, [ebp+arg_0]
.text:42CF5F84                 mov     edx, [ecx+88h]
.text:42CF5F8A                 push    edx
.text:42CF5F8B                 call    dword_42D01C94
.text:42CF5F91                 add     esp, 14h
.text:42CF5F94                 test    eax, eax
.text:42CF5F96                 jnz     short loc_42CF5FA1
.text:42CF5F98                 mov     eax, [ebp+arg_8]
.text:42CF5F9B                 mov     dword ptr [eax], 0
.text:42CF5FA1
.text:42CF5FA1 loc_42CF5FA1:                           ; CODE XREF: sub_42CF5EAD+E9\u2191j
.text:42CF5FA1                 jmp     short loc_42CF600C
.text:42CF5FA3 ; ---------------------------------------------------------------------------
.text:42CF5FA3
.text:42CF5FA3 loc_42CF5FA3:                           ; CODE XREF: sub_42CF5EAD+26\u2191j
.text:42CF5FA3                                         ; DATA XREF: .text:jpt_42CF5ED3\u2193o
.text:42CF5FA3                 mov     ecx, [ebp+arg_C] ; jumptable 42CF5ED3 case 2
.text:42CF5FA6                 push    ecx
.text:42CF5FA7                 push    0
.text:42CF5FA9                 mov     edx, [ebp+arg_0]
.text:42CF5FAC                 push    edx
.text:42CF5FAD                 mov     eax, [ebp+arg_8]
.text:42CF5FB0                 push    eax
.text:42CF5FB1                 mov     ecx, [ebp+arg_0]
.text:42CF5FB4                 mov     edx, [ecx+88h]
.text:42CF5FBA                 push    edx
.text:42CF5FBB                 call    dword_42D01C34
.text:42CF5FC1                 add     esp, 14h
.text:42CF5FC4                 test    eax, eax
.text:42CF5FC6                 jnz     short loc_42CF5FD1
.text:42CF5FC8                 mov     eax, [ebp+arg_8]
.text:42CF5FCB                 mov     dword ptr [eax], 0
.text:42CF5FD1
.text:42CF5FD1 loc_42CF5FD1:                           ; CODE XREF: sub_42CF5EAD+119\u2191j
.text:42CF5FD1                 jmp     short loc_42CF600C
.text:42CF5FD3 ; ---------------------------------------------------------------------------
.text:42CF5FD3
.text:42CF5FD3 loc_42CF5FD3:                           ; CODE XREF: sub_42CF5EAD+26\u2191j
.text:42CF5FD3                                         ; DATA XREF: .text:jpt_42CF5ED3\u2193o
.text:42CF5FD3                 mov     ecx, [ebp+arg_C] ; jumptable 42CF5ED3 case 8
.text:42CF5FD6                 push    ecx
.text:42CF5FD7                 push    0
.text:42CF5FD9                 mov     edx, [ebp+arg_0]
.text:42CF5FDC                 push    edx
.text:42CF5FDD                 mov     eax, [ebp+arg_8]
.text:42CF5FE0                 push    eax
.text:42CF5FE1                 mov     ecx, [ebp+arg_0]
.text:42CF5FE4                 mov     edx, [ecx+88h]
.text:42CF5FEA                 push    edx
.text:42CF5FEB                 call    dword_42D020F4
.text:42CF5FF1                 add     esp, 14h
.text:42CF5FF4                 test    eax, eax
.text:42CF5FF6                 jnz     short loc_42CF6001
.text:42CF5FF8                 mov     eax, [ebp+arg_8]
.text:42CF5FFB                 mov     dword ptr [eax], 0
.text:42CF6001
.text:42CF6001 loc_42CF6001:                           ; CODE XREF: sub_42CF5EAD+149\u2191j
.text:42CF6001                 jmp     short loc_42CF600C
.text:42CF6003 ; ---------------------------------------------------------------------------
.text:42CF6003
.text:42CF6003 def_42CF5ED3:                           ; CODE XREF: sub_42CF5EAD+1D\u2191j
.text:42CF6003                                         ; sub_42CF5EAD+26\u2191j
.text:42CF6003                                         ; DATA XREF: ...
.text:42CF6003                 mov     ecx, [ebp+arg_8] ; jumptable 42CF5ED3 default case, cases 5,7
.text:42CF6006                 mov     dword ptr [ecx], 0
.text:42CF600C
.text:42CF600C loc_42CF600C:                           ; CODE XREF: sub_42CF5EAD:loc_42CF5F08\u2191j
.text:42CF600C                                         ; sub_42CF5EAD:loc_42CF5F3B\u2191j ...
.text:42CF600C                 mov     esp, ebp
.text:42CF600E                 pop     ebp
.text:42CF600F                 retn
.text:42CF600F sub_42CF5EAD    endp
.text:42CF600F
.text:42CF600F ; ---------------------------------------------------------------------------
.text:42CF6010 jpt_42CF5ED3    dd offset loc_42CF5F0D  ; DATA XREF: sub_42CF5EAD+26\u2191r
.text:42CF6010                 dd offset loc_42CF5FA3  ; jump table for switch statement
.text:42CF6010                 dd offset loc_42CF5F73
.text:42CF6010                 dd offset loc_42CF5F40
.text:42CF6010                 dd offset def_42CF5ED3
.text:42CF6010                 dd offset loc_42CF5EDA
.text:42CF6010                 dd offset def_42CF5ED3
.text:42CF6010                 dd offset loc_42CF5FD3
.text:42CF6030
.text:42CF6030 ; =============== S U B R O U T I N E =======================================
.text:42CF6030
.text:42CF6030 ; Attributes: bp-based frame
.text:42CF6030
.text:42CF6030 sub_42CF6030    proc near               ; CODE XREF: ConnectionReadAsync+2B4\u2191p
.text:42CF6030                                         ; ConnectionReadAsync+35E\u2191p
.text:42CF6030
.text:42CF6030 var_4           = dword ptr -4
.text:42CF6030 arg_0           = dword ptr  8
.text:42CF6030 arg_4           = dword ptr  0Ch
.text:42CF6030 arg_8           = dword ptr  10h
.text:42CF6030 arg_C           = dword ptr  14h
.text:42CF6030 arg_10          = dword ptr  18h
.text:42CF6030
.text:42CF6030                 push    ebp
.text:42CF6031                 mov     ebp, esp
.text:42CF6033                 push    ecx
.text:42CF6034                 mov     eax, [ebp+arg_0]
.text:42CF6037                 mov     ecx, [eax+84h]
.text:42CF603D                 mov     [ebp+var_4], ecx
.text:42CF6040                 mov     edx, [ebp+var_4]
.text:42CF6043                 sub     edx, 1          ; switch 8 cases
.text:42CF6046                 mov     [ebp+var_4], edx
.text:42CF6049                 cmp     [ebp+var_4], 7
.text:42CF604D                 ja      def_42CF6056    ; jumptable 42CF6056 default case, cases 5,7
.text:42CF6053                 mov     eax, [ebp+var_4]
.text:42CF6056                 jmp     ds:jpt_42CF6056[eax*4] ; switch jump
.text:42CF605D ; ---------------------------------------------------------------------------
.text:42CF605D
.text:42CF605D loc_42CF605D:                           ; CODE XREF: sub_42CF6030+26\u2191j
.text:42CF605D                                         ; DATA XREF: .text:jpt_42CF6056\u2193o
.text:42CF605D                 mov     ecx, [ebp+arg_10] ; jumptable 42CF6056 case 6
.text:42CF6060                 push    ecx
.text:42CF6061                 mov     edx, [ebp+arg_0]
.text:42CF6064                 add     edx, 24h ; '$'
.text:42CF6067                 push    edx
.text:42CF6068                 mov     eax, [ebp+arg_C]
.text:42CF606B                 push    eax
.text:42CF606C                 push    0
.text:42CF606E                 mov     ecx, [ebp+arg_4]
.text:42CF6071                 push    ecx
.text:42CF6072                 mov     edx, [ebp+arg_0]
.text:42CF6075                 mov     eax, [edx+88h]
.text:42CF607B                 push    eax
.text:42CF607C                 call    dword_42D01BC0
.text:42CF6082                 add     esp, 18h
.text:42CF6085                 jmp     loc_42CF6166
.text:42CF608A ; ---------------------------------------------------------------------------
.text:42CF608A
.text:42CF608A loc_42CF608A:                           ; CODE XREF: sub_42CF6030+26\u2191j
.text:42CF608A                                         ; DATA XREF: .text:jpt_42CF6056\u2193o
.text:42CF608A                 mov     ecx, [ebp+arg_10] ; jumptable 42CF6056 case 1
.text:42CF608D                 push    ecx
.text:42CF608E                 mov     edx, [ebp+arg_0]
.text:42CF6091                 add     edx, 24h ; '$'
.text:42CF6094                 push    edx
.text:42CF6095                 mov     eax, [ebp+arg_C]
.text:42CF6098                 push    eax
.text:42CF6099                 push    0
.text:42CF609B                 mov     ecx, [ebp+arg_4]
.text:42CF609E                 push    ecx
.text:42CF609F                 mov     edx, [ebp+arg_0]
.text:42CF60A2                 mov     eax, [edx+88h]
.text:42CF60A8                 push    eax
.text:42CF60A9                 call    dword_42D01E20
.text:42CF60AF                 add     esp, 18h
.text:42CF60B2                 jmp     loc_42CF6166
.text:42CF60B7 ; ---------------------------------------------------------------------------
.text:42CF60B7
.text:42CF60B7 loc_42CF60B7:                           ; CODE XREF: sub_42CF6030+26\u2191j
.text:42CF60B7                                         ; DATA XREF: .text:jpt_42CF6056\u2193o
.text:42CF60B7                 mov     ecx, [ebp+arg_10] ; jumptable 42CF6056 case 4
.text:42CF60BA                 push    ecx
.text:42CF60BB                 mov     edx, [ebp+arg_0]
.text:42CF60BE                 add     edx, 24h ; '$'
.text:42CF60C1                 push    edx
.text:42CF60C2                 mov     eax, [ebp+arg_C]
.text:42CF60C5                 push    eax
.text:42CF60C6                 mov     ecx, [ebp+arg_8]
.text:42CF60C9                 push    ecx
.text:42CF60CA                 mov     edx, [ebp+arg_4]
.text:42CF60CD                 push    edx
.text:42CF60CE                 mov     eax, [ebp+arg_0]
.text:42CF60D1                 mov     ecx, [eax+88h]
.text:42CF60D7                 push    ecx
.text:42CF60D8                 call    dword_42D01F60
.text:42CF60DE                 add     esp, 18h
.text:42CF60E1                 jmp     loc_42CF6166
.text:42CF60E6 ; ---------------------------------------------------------------------------
.text:42CF60E6
.text:42CF60E6 loc_42CF60E6:                           ; CODE XREF: sub_42CF6030+26\u2191j
.text:42CF60E6                                         ; DATA XREF: .text:jpt_42CF6056\u2193o
.text:42CF60E6                 mov     edx, [ebp+arg_10] ; jumptable 42CF6056 case 3
.text:42CF60E9                 push    edx
.text:42CF60EA                 mov     eax, [ebp+arg_0]
.text:42CF60ED                 add     eax, 24h ; '$'
.text:42CF60F0                 push    eax
.text:42CF60F1                 mov     ecx, [ebp+arg_C]
.text:42CF60F4                 push    ecx
.text:42CF60F5                 push    0
.text:42CF60F7                 mov     edx, [ebp+arg_4]
.text:42CF60FA                 push    edx
.text:42CF60FB                 mov     eax, [ebp+arg_0]
.text:42CF60FE                 mov     ecx, [eax+88h]
.text:42CF6104                 push    ecx
.text:42CF6105                 call    dword_42D01C80
.text:42CF610B                 add     esp, 18h
.text:42CF610E                 jmp     short loc_42CF6166
.text:42CF6110 ; ---------------------------------------------------------------------------
.text:42CF6110
.text:42CF6110 loc_42CF6110:                           ; CODE XREF: sub_42CF6030+26\u2191j
.text:42CF6110                                         ; DATA XREF: .text:jpt_42CF6056\u2193o
.text:42CF6110                 mov     edx, [ebp+arg_10] ; jumptable 42CF6056 case 2
.text:42CF6113                 push    edx
.text:42CF6114                 mov     eax, [ebp+arg_0]
.text:42CF6117                 add     eax, 24h ; '$'
.text:42CF611A                 push    eax
.text:42CF611B                 mov     ecx, [ebp+arg_C]
.text:42CF611E                 push    ecx
.text:42CF611F                 push    0
.text:42CF6121                 mov     edx, [ebp+arg_4]
.text:42CF6124                 push    edx
.text:42CF6125                 mov     eax, [ebp+arg_0]
.text:42CF6128                 mov     ecx, [eax+88h]
.text:42CF612E                 push    ecx
.text:42CF612F                 call    dword_42D01C20
.text:42CF6135                 add     esp, 18h
.text:42CF6138                 jmp     short loc_42CF6166
.text:42CF613A ; ---------------------------------------------------------------------------
.text:42CF613A
.text:42CF613A loc_42CF613A:                           ; CODE XREF: sub_42CF6030+26\u2191j
.text:42CF613A                                         ; DATA XREF: .text:jpt_42CF6056\u2193o
.text:42CF613A                 mov     edx, [ebp+arg_10] ; jumptable 42CF6056 case 8
.text:42CF613D                 push    edx
.text:42CF613E                 mov     eax, [ebp+arg_0]
.text:42CF6141                 add     eax, 24h ; '$'
.text:42CF6144                 push    eax
.text:42CF6145                 mov     ecx, [ebp+arg_C]
.text:42CF6148                 push    ecx
.text:42CF6149                 push    0
.text:42CF614B                 mov     edx, [ebp+arg_4]
.text:42CF614E                 push    edx
.text:42CF614F                 mov     eax, [ebp+arg_0]
.text:42CF6152                 mov     ecx, [eax+88h]
.text:42CF6158                 push    ecx
.text:42CF6159                 call    dword_42D020E0
.text:42CF615F                 add     esp, 18h
.text:42CF6162                 jmp     short loc_42CF6166
.text:42CF6164 ; ---------------------------------------------------------------------------
.text:42CF6164
.text:42CF6164 def_42CF6056:                           ; CODE XREF: sub_42CF6030+1D\u2191j
.text:42CF6164                                         ; sub_42CF6030+26\u2191j
.text:42CF6164                                         ; DATA XREF: ...
.text:42CF6164                 xor     eax, eax        ; jumptable 42CF6056 default case, cases 5,7
.text:42CF6166
.text:42CF6166 loc_42CF6166:                           ; CODE XREF: sub_42CF6030+55\u2191j
.text:42CF6166                                         ; sub_42CF6030+82\u2191j ...
.text:42CF6166                 mov     esp, ebp
.text:42CF6168                 pop     ebp
.text:42CF6169                 retn
.text:42CF6169 sub_42CF6030    endp
.text:42CF6169
.text:42CF6169 ; ---------------------------------------------------------------------------
.text:42CF616A jpt_42CF6056    dd offset loc_42CF608A  ; DATA XREF: sub_42CF6030+26\u2191r
.text:42CF616A                 dd offset loc_42CF6110  ; jump table for switch statement
.text:42CF616A                 dd offset loc_42CF60E6
.text:42CF616A                 dd offset loc_42CF60B7
.text:42CF616A                 dd offset def_42CF6056
.text:42CF616A                 dd offset loc_42CF605D
.text:42CF616A                 dd offset def_42CF6056
.text:42CF616A                 dd offset loc_42CF613A
.text:42CF618A
.text:42CF618A ; =============== S U B R O U T I N E =======================================
.text:42CF618A
.text:42CF618A ; Attributes: bp-based frame
.text:42CF618A
.text:42CF618A sub_42CF618A    proc near               ; CODE XREF: ConnectionWriteAsync+178\u2191p
.text:42CF618A
.text:42CF618A var_4           = dword ptr -4
.text:42CF618A arg_0           = dword ptr  8
.text:42CF618A arg_4           = dword ptr  0Ch
.text:42CF618A arg_8           = dword ptr  10h
.text:42CF618A arg_C           = dword ptr  14h
.text:42CF618A arg_10          = dword ptr  18h
.text:42CF618A
.text:42CF618A                 push    ebp
.text:42CF618B                 mov     ebp, esp
.text:42CF618D                 push    ecx
.text:42CF618E                 mov     eax, [ebp+arg_0]
.text:42CF6191                 mov     ecx, [eax+84h]
.text:42CF6197                 mov     [ebp+var_4], ecx
.text:42CF619A                 mov     edx, [ebp+var_4]
.text:42CF619D                 sub     edx, 1          ; switch 8 cases
.text:42CF61A0                 mov     [ebp+var_4], edx
.text:42CF61A3                 cmp     [ebp+var_4], 7
.text:42CF61A7                 ja      def_42CF61B0    ; jumptable 42CF61B0 default case, cases 5,7
.text:42CF61AD                 mov     eax, [ebp+var_4]
.text:42CF61B0                 jmp     ds:jpt_42CF61B0[eax*4] ; switch jump
.text:42CF61B7 ; ---------------------------------------------------------------------------
.text:42CF61B7
.text:42CF61B7 loc_42CF61B7:                           ; CODE XREF: sub_42CF618A+26\u2191j
.text:42CF61B7                                         ; DATA XREF: .text:jpt_42CF61B0\u2193o
.text:42CF61B7                 mov     ecx, [ebp+arg_10] ; jumptable 42CF61B0 case 6
.text:42CF61BA                 push    ecx
.text:42CF61BB                 mov     edx, [ebp+arg_C]
.text:42CF61BE                 push    edx
.text:42CF61BF                 mov     eax, [ebp+arg_8]
.text:42CF61C2                 push    eax
.text:42CF61C3                 mov     ecx, [ebp+arg_4]
.text:42CF61C6                 push    ecx
.text:42CF61C7                 mov     edx, [ebp+arg_0]
.text:42CF61CA                 mov     eax, [edx+88h]
.text:42CF61D0                 push    eax
.text:42CF61D1                 call    dword_42D01BC8
.text:42CF61D7                 add     esp, 14h
.text:42CF61DA                 jmp     loc_42CF62A0
.text:42CF61DF ; ---------------------------------------------------------------------------
.text:42CF61DF
.text:42CF61DF loc_42CF61DF:                           ; CODE XREF: sub_42CF618A+26\u2191j
.text:42CF61DF                                         ; DATA XREF: .text:jpt_42CF61B0\u2193o
.text:42CF61DF                 mov     ecx, [ebp+arg_10] ; jumptable 42CF61B0 case 1
.text:42CF61E2                 push    ecx
.text:42CF61E3                 mov     edx, [ebp+arg_C]
.text:42CF61E6                 push    edx
.text:42CF61E7                 mov     eax, [ebp+arg_8]
.text:42CF61EA                 push    eax
.text:42CF61EB                 mov     ecx, [ebp+arg_4]
.text:42CF61EE                 push    ecx
.text:42CF61EF                 mov     edx, [ebp+arg_0]
.text:42CF61F2                 mov     eax, [edx+88h]
.text:42CF61F8                 push    eax
.text:42CF61F9                 call    dword_42D01E28
.text:42CF61FF                 add     esp, 14h
.text:42CF6202                 jmp     loc_42CF62A0
.text:42CF6207 ; ---------------------------------------------------------------------------
.text:42CF6207
.text:42CF6207 loc_42CF6207:                           ; CODE XREF: sub_42CF618A+26\u2191j
.text:42CF6207                                         ; DATA XREF: .text:jpt_42CF61B0\u2193o
.text:42CF6207                 mov     ecx, [ebp+arg_10] ; jumptable 42CF61B0 case 4
.text:42CF620A                 push    ecx
.text:42CF620B                 mov     edx, [ebp+arg_C]
.text:42CF620E                 push    edx
.text:42CF620F                 mov     eax, [ebp+arg_8]
.text:42CF6212                 push    eax
.text:42CF6213                 mov     ecx, [ebp+arg_4]
.text:42CF6216                 push    ecx
.text:42CF6217                 mov     edx, [ebp+arg_0]
.text:42CF621A                 mov     eax, [edx+88h]
.text:42CF6220                 push    eax
.text:42CF6221                 call    dword_42D01F68
.text:42CF6227                 add     esp, 14h
.text:42CF622A                 jmp     short loc_42CF62A0
.text:42CF622C ; ---------------------------------------------------------------------------
.text:42CF622C
.text:42CF622C loc_42CF622C:                           ; CODE XREF: sub_42CF618A+26\u2191j
.text:42CF622C                                         ; DATA XREF: .text:jpt_42CF61B0\u2193o
.text:42CF622C                 mov     ecx, [ebp+arg_10] ; jumptable 42CF61B0 case 3
.text:42CF622F                 push    ecx
.text:42CF6230                 mov     edx, [ebp+arg_C]
.text:42CF6233                 push    edx
.text:42CF6234                 mov     eax, [ebp+arg_8]
.text:42CF6237                 push    eax
.text:42CF6238                 mov     ecx, [ebp+arg_4]
.text:42CF623B                 push    ecx
.text:42CF623C                 mov     edx, [ebp+arg_0]
.text:42CF623F                 mov     eax, [edx+88h]
.text:42CF6245                 push    eax
.text:42CF6246                 call    dword_42D01C88
.text:42CF624C                 add     esp, 14h
.text:42CF624F                 jmp     short loc_42CF62A0
.text:42CF6251 ; ---------------------------------------------------------------------------
.text:42CF6251
.text:42CF6251 loc_42CF6251:                           ; CODE XREF: sub_42CF618A+26\u2191j
.text:42CF6251                                         ; DATA XREF: .text:jpt_42CF61B0\u2193o
.text:42CF6251                 mov     ecx, [ebp+arg_10] ; jumptable 42CF61B0 case 2
.text:42CF6254                 push    ecx
.text:42CF6255                 mov     edx, [ebp+arg_C]
.text:42CF6258                 push    edx
.text:42CF6259                 mov     eax, [ebp+arg_8]
.text:42CF625C                 push    eax
.text:42CF625D                 mov     ecx, [ebp+arg_4]
.text:42CF6260                 push    ecx
.text:42CF6261                 mov     edx, [ebp+arg_0]
.text:42CF6264                 mov     eax, [edx+88h]
.text:42CF626A                 push    eax
.text:42CF626B                 call    dword_42D01C28
.text:42CF6271                 add     esp, 14h
.text:42CF6274                 jmp     short loc_42CF62A0
.text:42CF6276 ; ---------------------------------------------------------------------------
.text:42CF6276
.text:42CF6276 loc_42CF6276:                           ; CODE XREF: sub_42CF618A+26\u2191j
.text:42CF6276                                         ; DATA XREF: .text:jpt_42CF61B0\u2193o
.text:42CF6276                 mov     ecx, [ebp+arg_10] ; jumptable 42CF61B0 case 8
.text:42CF6279                 push    ecx
.text:42CF627A                 mov     edx, [ebp+arg_C]
.text:42CF627D                 push    edx
.text:42CF627E                 mov     eax, [ebp+arg_8]
.text:42CF6281                 push    eax
.text:42CF6282                 mov     ecx, [ebp+arg_4]
.text:42CF6285                 push    ecx
.text:42CF6286                 mov     edx, [ebp+arg_0]
.text:42CF6289                 mov     eax, [edx+88h]
.text:42CF628F                 push    eax
.text:42CF6290                 call    dword_42D020E8
.text:42CF6296                 add     esp, 14h
.text:42CF6299                 jmp     short loc_42CF62A0
.text:42CF629B ; ---------------------------------------------------------------------------
.text:42CF629B
.text:42CF629B def_42CF61B0:                           ; CODE XREF: sub_42CF618A+1D\u2191j
.text:42CF629B                                         ; sub_42CF618A+26\u2191j
.text:42CF629B                                         ; DATA XREF: ...
.text:42CF629B                 mov     eax, 2          ; jumptable 42CF61B0 default case, cases 5,7
.text:42CF62A0
.text:42CF62A0 loc_42CF62A0:                           ; CODE XREF: sub_42CF618A+50\u2191j
.text:42CF62A0                                         ; sub_42CF618A+78\u2191j ...
.text:42CF62A0                 mov     esp, ebp
.text:42CF62A2                 pop     ebp
.text:42CF62A3                 retn
.text:42CF62A3 sub_42CF618A    endp
.text:42CF62A3
.text:42CF62A3 ; ---------------------------------------------------------------------------
.text:42CF62A4 jpt_42CF61B0    dd offset loc_42CF61DF  ; DATA XREF: sub_42CF618A+26\u2191r
.text:42CF62A4                 dd offset loc_42CF6251  ; jump table for switch statement
.text:42CF62A4                 dd offset loc_42CF622C
.text:42CF62A4                 dd offset loc_42CF6207
.text:42CF62A4                 dd offset def_42CF61B0
.text:42CF62A4                 dd offset loc_42CF61B7
.text:42CF62A4                 dd offset def_42CF61B0
.text:42CF62A4                 dd offset loc_42CF6276
.text:42CF62C4
.text:42CF62C4 ; =============== S U B R O U T I N E =======================================
.text:42CF62C4
.text:42CF62C4 ; Attributes: bp-based frame
.text:42CF62C4
.text:42CF62C4 sub_42CF62C4    proc near               ; CODE XREF: ConnectionWriteStatus+41\u2191p
.text:42CF62C4
.text:42CF62C4 var_4           = dword ptr -4
.text:42CF62C4 arg_0           = dword ptr  8
.text:42CF62C4 arg_4           = dword ptr  0Ch
.text:42CF62C4 arg_8           = dword ptr  10h
.text:42CF62C4 arg_C           = dword ptr  14h
.text:42CF62C4
.text:42CF62C4                 push    ebp
.text:42CF62C5                 mov     ebp, esp
.text:42CF62C7                 push    ecx
.text:42CF62C8                 mov     eax, [ebp+arg_0]
.text:42CF62CB                 mov     ecx, [eax+84h]
.text:42CF62D1                 mov     [ebp+var_4], ecx
.text:42CF62D4                 mov     edx, [ebp+var_4]
.text:42CF62D7                 sub     edx, 1          ; switch 8 cases
.text:42CF62DA                 mov     [ebp+var_4], edx
.text:42CF62DD                 cmp     [ebp+var_4], 7
.text:42CF62E1                 ja      def_42CF62EA    ; jumptable 42CF62EA default case, cases 5,7
.text:42CF62E7                 mov     eax, [ebp+var_4]
.text:42CF62EA                 jmp     ds:jpt_42CF62EA[eax*4] ; switch jump
.text:42CF62F1 ; ---------------------------------------------------------------------------
.text:42CF62F1
.text:42CF62F1 loc_42CF62F1:                           ; CODE XREF: sub_42CF62C4+26\u2191j
.text:42CF62F1                                         ; DATA XREF: .text:jpt_42CF62EA\u2193o
.text:42CF62F1                 mov     ecx, [ebp+arg_C] ; jumptable 42CF62EA case 6
.text:42CF62F4                 push    ecx
.text:42CF62F5                 mov     edx, [ebp+arg_8]
.text:42CF62F8                 push    edx
.text:42CF62F9                 mov     eax, [ebp+arg_4]
.text:42CF62FC                 push    eax
.text:42CF62FD                 mov     ecx, [ebp+arg_0]
.text:42CF6300                 mov     edx, [ecx+88h]
.text:42CF6306                 push    edx
.text:42CF6307                 call    dword_42D01BCC
.text:42CF630D                 add     esp, 10h
.text:42CF6310                 jmp     loc_42CF63C2
.text:42CF6315 ; ---------------------------------------------------------------------------
.text:42CF6315
.text:42CF6315 loc_42CF6315:                           ; CODE XREF: sub_42CF62C4+26\u2191j
.text:42CF6315                                         ; DATA XREF: .text:jpt_42CF62EA\u2193o
.text:42CF6315                 mov     eax, [ebp+arg_C] ; jumptable 42CF62EA case 1
.text:42CF6318                 push    eax
.text:42CF6319                 mov     ecx, [ebp+arg_8]
.text:42CF631C                 push    ecx
.text:42CF631D                 mov     edx, [ebp+arg_4]
.text:42CF6320                 push    edx
.text:42CF6321                 mov     eax, [ebp+arg_0]
.text:42CF6324                 mov     ecx, [eax+88h]
.text:42CF632A                 push    ecx
.text:42CF632B                 call    dword_42D01E2C
.text:42CF6331                 add     esp, 10h
.text:42CF6334                 jmp     loc_42CF63C2
.text:42CF6339 ; ---------------------------------------------------------------------------
.text:42CF6339
.text:42CF6339 loc_42CF6339:                           ; CODE XREF: sub_42CF62C4+26\u2191j
.text:42CF6339                                         ; DATA XREF: .text:jpt_42CF62EA\u2193o
.text:42CF6339                 mov     edx, [ebp+arg_C] ; jumptable 42CF62EA case 4
.text:42CF633C                 push    edx
.text:42CF633D                 mov     eax, [ebp+arg_8]
.text:42CF6340                 push    eax
.text:42CF6341                 mov     ecx, [ebp+arg_4]
.text:42CF6344                 push    ecx
.text:42CF6345                 mov     edx, [ebp+arg_0]
.text:42CF6348                 mov     eax, [edx+88h]
.text:42CF634E                 push    eax
.text:42CF634F                 call    dword_42D01F6C
.text:42CF6355                 add     esp, 10h
.text:42CF6358                 jmp     short loc_42CF63C2
.text:42CF635A ; ---------------------------------------------------------------------------
.text:42CF635A
.text:42CF635A loc_42CF635A:                           ; CODE XREF: sub_42CF62C4+26\u2191j
.text:42CF635A                                         ; DATA XREF: .text:jpt_42CF62EA\u2193o
.text:42CF635A                 mov     ecx, [ebp+arg_C] ; jumptable 42CF62EA case 3
.text:42CF635D                 push    ecx
.text:42CF635E                 mov     edx, [ebp+arg_8]
.text:42CF6361                 push    edx
.text:42CF6362                 mov     eax, [ebp+arg_4]
.text:42CF6365                 push    eax
.text:42CF6366                 mov     ecx, [ebp+arg_0]
.text:42CF6369                 mov     edx, [ecx+88h]
.text:42CF636F                 push    edx
.text:42CF6370                 call    dword_42D01C8C
.text:42CF6376                 add     esp, 10h
.text:42CF6379                 jmp     short loc_42CF63C2
.text:42CF637B ; ---------------------------------------------------------------------------
.text:42CF637B
.text:42CF637B loc_42CF637B:                           ; CODE XREF: sub_42CF62C4+26\u2191j
.text:42CF637B                                         ; DATA XREF: .text:jpt_42CF62EA\u2193o
.text:42CF637B                 mov     eax, [ebp+arg_C] ; jumptable 42CF62EA case 2
.text:42CF637E                 push    eax
.text:42CF637F                 mov     ecx, [ebp+arg_8]
.text:42CF6382                 push    ecx
.text:42CF6383                 mov     edx, [ebp+arg_4]
.text:42CF6386                 push    edx
.text:42CF6387                 mov     eax, [ebp+arg_0]
.text:42CF638A                 mov     ecx, [eax+88h]
.text:42CF6390                 push    ecx
.text:42CF6391                 call    dword_42D01C2C
.text:42CF6397                 add     esp, 10h
.text:42CF639A                 jmp     short loc_42CF63C2
.text:42CF639C ; ---------------------------------------------------------------------------
.text:42CF639C
.text:42CF639C loc_42CF639C:                           ; CODE XREF: sub_42CF62C4+26\u2191j
.text:42CF639C                                         ; DATA XREF: .text:jpt_42CF62EA\u2193o
.text:42CF639C                 mov     edx, [ebp+arg_C] ; jumptable 42CF62EA case 8
.text:42CF639F                 push    edx
.text:42CF63A0                 mov     eax, [ebp+arg_8]
.text:42CF63A3                 push    eax
.text:42CF63A4                 mov     ecx, [ebp+arg_4]
.text:42CF63A7                 push    ecx
.text:42CF63A8                 mov     edx, [ebp+arg_0]
.text:42CF63AB                 mov     eax, [edx+88h]
.text:42CF63B1                 push    eax
.text:42CF63B2                 call    dword_42D020EC
.text:42CF63B8                 add     esp, 10h
.text:42CF63BB                 jmp     short loc_42CF63C2
.text:42CF63BD ; ---------------------------------------------------------------------------
.text:42CF63BD
.text:42CF63BD def_42CF62EA:                           ; CODE XREF: sub_42CF62C4+1D\u2191j
.text:42CF63BD                                         ; sub_42CF62C4+26\u2191j
.text:42CF63BD                                         ; DATA XREF: ...
.text:42CF63BD                 mov     eax, 2          ; jumptable 42CF62EA default case, cases 5,7
.text:42CF63C2
.text:42CF63C2 loc_42CF63C2:                           ; CODE XREF: sub_42CF62C4+4C\u2191j
.text:42CF63C2                                         ; sub_42CF62C4+70\u2191j ...
.text:42CF63C2                 mov     esp, ebp
.text:42CF63C4                 pop     ebp
.text:42CF63C5                 retn
.text:42CF63C5 sub_42CF62C4    endp
.text:42CF63C5
.text:42CF63C5 ; ---------------------------------------------------------------------------
.text:42CF63C6 jpt_42CF62EA    dd offset loc_42CF6315  ; DATA XREF: sub_42CF62C4+26\u2191r
.text:42CF63C6                 dd offset loc_42CF637B  ; jump table for switch statement
.text:42CF63C6                 dd offset loc_42CF635A
.text:42CF63C6                 dd offset loc_42CF6339
.text:42CF63C6                 dd offset def_42CF62EA
.text:42CF63C6                 dd offset loc_42CF62F1
.text:42CF63C6                 dd offset def_42CF62EA
.text:42CF63C6                 dd offset loc_42CF639C
.text:42CF63E6
.text:42CF63E6 ; =============== S U B R O U T I N E =======================================
.text:42CF63E6
.text:42CF63E6 ; Attributes: bp-based frame
.text:42CF63E6
.text:42CF63E6 sub_42CF63E6    proc near               ; CODE XREF: ConnectionRead+3AE\u2191p
.text:42CF63E6                                         ; ConnectionRead+51E\u2191p ...
.text:42CF63E6
.text:42CF63E6 var_4           = dword ptr -4
.text:42CF63E6 arg_0           = dword ptr  8
.text:42CF63E6 arg_4           = dword ptr  0Ch
.text:42CF63E6 arg_8           = dword ptr  10h
.text:42CF63E6 arg_C           = dword ptr  14h
.text:42CF63E6 arg_10          = dword ptr  18h
.text:42CF63E6 arg_14          = dword ptr  1Ch
.text:42CF63E6
.text:42CF63E6                 push    ebp
.text:42CF63E7                 mov     ebp, esp
.text:42CF63E9                 push    ecx
.text:42CF63EA                 mov     eax, [ebp+arg_0]
.text:42CF63ED                 mov     ecx, [eax+84h]
.text:42CF63F3                 mov     [ebp+var_4], ecx
.text:42CF63F6                 mov     edx, [ebp+var_4]
.text:42CF63F9                 sub     edx, 1          ; switch 8 cases
.text:42CF63FC                 mov     [ebp+var_4], edx
.text:42CF63FF                 cmp     [ebp+var_4], 7
.text:42CF6403                 ja      def_42CF640C    ; jumptable 42CF640C default case, cases 5,7
.text:42CF6409                 mov     eax, [ebp+var_4]
.text:42CF640C                 jmp     ds:jpt_42CF640C[eax*4] ; switch jump
.text:42CF6413 ; ---------------------------------------------------------------------------
.text:42CF6413
.text:42CF6413 loc_42CF6413:                           ; CODE XREF: sub_42CF63E6+26\u2191j
.text:42CF6413                                         ; DATA XREF: .text:jpt_42CF640C\u2193o
.text:42CF6413                 mov     ecx, [ebp+arg_14] ; jumptable 42CF640C case 6
.text:42CF6416                 push    ecx
.text:42CF6417                 mov     edx, [ebp+arg_10]
.text:42CF641A                 push    edx
.text:42CF641B                 mov     eax, [ebp+arg_C]
.text:42CF641E                 push    eax
.text:42CF641F                 mov     ecx, [ebp+arg_C]
.text:42CF6422                 push    ecx
.text:42CF6423                 mov     edx, [ebp+arg_4]
.text:42CF6426                 push    edx
.text:42CF6427                 mov     eax, [ebp+arg_0]
.text:42CF642A                 mov     ecx, [eax+88h]
.text:42CF6430                 push    ecx
.text:42CF6431                 call    dword_42D01BA8
.text:42CF6437                 add     esp, 18h
.text:42CF643A                 jmp     loc_42CF650B
.text:42CF643F ; ---------------------------------------------------------------------------
.text:42CF643F
.text:42CF643F loc_42CF643F:                           ; CODE XREF: sub_42CF63E6+26\u2191j
.text:42CF643F                                         ; DATA XREF: .text:jpt_42CF640C\u2193o
.text:42CF643F                 mov     edx, [ebp+arg_14] ; jumptable 42CF640C case 1
.text:42CF6442                 push    edx
.text:42CF6443                 mov     eax, [ebp+arg_10]
.text:42CF6446                 push    eax
.text:42CF6447                 mov     ecx, [ebp+arg_C]
.text:42CF644A                 push    ecx
.text:42CF644B                 mov     edx, [ebp+arg_C]
.text:42CF644E                 push    edx
.text:42CF644F                 mov     eax, [ebp+arg_4]
.text:42CF6452                 push    eax
.text:42CF6453                 mov     ecx, [ebp+arg_0]
.text:42CF6456                 mov     edx, [ecx+88h]
.text:42CF645C                 push    edx
.text:42CF645D                 call    dword_42D01E08
.text:42CF6463                 add     esp, 18h
.text:42CF6466                 jmp     loc_42CF650B
.text:42CF646B ; ---------------------------------------------------------------------------
.text:42CF646B
.text:42CF646B loc_42CF646B:                           ; CODE XREF: sub_42CF63E6+26\u2191j
.text:42CF646B                                         ; DATA XREF: .text:jpt_42CF640C\u2193o
.text:42CF646B                 mov     eax, [ebp+arg_14] ; jumptable 42CF640C case 4
.text:42CF646E                 push    eax
.text:42CF646F                 mov     ecx, [ebp+arg_10]
.text:42CF6472                 push    ecx
.text:42CF6473                 mov     edx, [ebp+arg_C]
.text:42CF6476                 push    edx
.text:42CF6477                 mov     eax, [ebp+arg_8]
.text:42CF647A                 push    eax
.text:42CF647B                 mov     ecx, [ebp+arg_4]
.text:42CF647E                 push    ecx
.text:42CF647F                 mov     edx, [ebp+arg_0]
.text:42CF6482                 mov     eax, [edx+88h]
.text:42CF6488                 push    eax
.text:42CF6489                 call    dword_42D01F48
.text:42CF648F                 add     esp, 18h
.text:42CF6492                 jmp     short loc_42CF650B
.text:42CF6494 ; ---------------------------------------------------------------------------
.text:42CF6494
.text:42CF6494 loc_42CF6494:                           ; CODE XREF: sub_42CF63E6+26\u2191j
.text:42CF6494                                         ; DATA XREF: .text:jpt_42CF640C\u2193o
.text:42CF6494                 mov     ecx, [ebp+arg_14] ; jumptable 42CF640C case 3
.text:42CF6497                 push    ecx
.text:42CF6498                 mov     edx, [ebp+arg_10]
.text:42CF649B                 push    edx
.text:42CF649C                 mov     eax, [ebp+arg_C]
.text:42CF649F                 push    eax
.text:42CF64A0                 push    0
.text:42CF64A2                 mov     ecx, [ebp+arg_4]
.text:42CF64A5                 push    ecx
.text:42CF64A6                 mov     edx, [ebp+arg_0]
.text:42CF64A9                 mov     eax, [edx+88h]
.text:42CF64AF                 push    eax
.text:42CF64B0                 call    dword_42D01C68
.text:42CF64B6                 add     esp, 18h
.text:42CF64B9                 jmp     short loc_42CF650B
.text:42CF64BB ; ---------------------------------------------------------------------------
.text:42CF64BB
.text:42CF64BB loc_42CF64BB:                           ; CODE XREF: sub_42CF63E6+26\u2191j
.text:42CF64BB                                         ; DATA XREF: .text:jpt_42CF640C\u2193o
.text:42CF64BB                 mov     ecx, [ebp+arg_14] ; jumptable 42CF640C case 2
.text:42CF64BE                 push    ecx
.text:42CF64BF                 mov     edx, [ebp+arg_10]
.text:42CF64C2                 push    edx
.text:42CF64C3                 mov     eax, [ebp+arg_C]
.text:42CF64C6                 push    eax
.text:42CF64C7                 push    0
.text:42CF64C9                 mov     ecx, [ebp+arg_4]
.text:42CF64CC                 push    ecx
.text:42CF64CD                 mov     edx, [ebp+arg_0]
.text:42CF64D0                 mov     eax, [edx+88h]
.text:42CF64D6                 push    eax
.text:42CF64D7                 call    dword_42D01C08
.text:42CF64DD                 add     esp, 18h
.text:42CF64E0                 jmp     short loc_42CF650B
.text:42CF64E2 ; ---------------------------------------------------------------------------
.text:42CF64E2
.text:42CF64E2 loc_42CF64E2:                           ; CODE XREF: sub_42CF63E6+26\u2191j
.text:42CF64E2                                         ; DATA XREF: .text:jpt_42CF640C\u2193o
.text:42CF64E2                 mov     ecx, [ebp+arg_14] ; jumptable 42CF640C case 8
.text:42CF64E5                 push    ecx
.text:42CF64E6                 mov     edx, [ebp+arg_10]
.text:42CF64E9                 push    edx
.text:42CF64EA                 mov     eax, [ebp+arg_C]
.text:42CF64ED                 push    eax
.text:42CF64EE                 push    0
.text:42CF64F0                 mov     ecx, [ebp+arg_4]
.text:42CF64F3                 push    ecx
.text:42CF64F4                 mov     edx, [ebp+arg_0]
.text:42CF64F7                 mov     eax, [edx+88h]
.text:42CF64FD                 push    eax
.text:42CF64FE                 call    dword_42D020C8
.text:42CF6504                 add     esp, 18h
.text:42CF6507                 jmp     short loc_42CF650B
.text:42CF6509 ; ---------------------------------------------------------------------------
.text:42CF6509
.text:42CF6509 def_42CF640C:                           ; CODE XREF: sub_42CF63E6+1D\u2191j
.text:42CF6509                                         ; sub_42CF63E6+26\u2191j
.text:42CF6509                                         ; DATA XREF: ...
.text:42CF6509                 xor     eax, eax        ; jumptable 42CF640C default case, cases 5,7
.text:42CF650B
.text:42CF650B loc_42CF650B:                           ; CODE XREF: sub_42CF63E6+54\u2191j
.text:42CF650B                                         ; sub_42CF63E6+80\u2191j ...
.text:42CF650B                 mov     esp, ebp
.text:42CF650D                 pop     ebp
.text:42CF650E                 retn
.text:42CF650E sub_42CF63E6    endp
.text:42CF650E
.text:42CF650E ; ---------------------------------------------------------------------------
.text:42CF650F jpt_42CF640C    dd offset loc_42CF643F  ; DATA XREF: sub_42CF63E6+26\u2191r
.text:42CF650F                 dd offset loc_42CF64BB  ; jump table for switch statement
.text:42CF650F                 dd offset loc_42CF6494
.text:42CF650F                 dd offset loc_42CF646B
.text:42CF650F                 dd offset def_42CF640C
.text:42CF650F                 dd offset loc_42CF6413
.text:42CF650F                 dd offset def_42CF640C
.text:42CF650F                 dd offset loc_42CF64E2
.text:42CF652F
.text:42CF652F ; =============== S U B R O U T I N E =======================================
.text:42CF652F
.text:42CF652F ; Attributes: bp-based frame
.text:42CF652F
.text:42CF652F sub_42CF652F    proc near               ; CODE XREF: ConnectionWrite+174\u2191p
.text:42CF652F
.text:42CF652F var_4           = dword ptr -4
.text:42CF652F arg_0           = dword ptr  8
.text:42CF652F arg_4           = dword ptr  0Ch
.text:42CF652F arg_8           = dword ptr  10h
.text:42CF652F arg_C           = dword ptr  14h
.text:42CF652F
.text:42CF652F                 push    ebp
.text:42CF6530                 mov     ebp, esp
.text:42CF6532                 push    ecx
.text:42CF6533                 mov     eax, [ebp+arg_0]
.text:42CF6536                 mov     ecx, [eax+84h]
.text:42CF653C                 mov     [ebp+var_4], ecx
.text:42CF653F                 mov     edx, [ebp+var_4]
.text:42CF6542                 sub     edx, 1          ; switch 8 cases
.text:42CF6545                 mov     [ebp+var_4], edx
.text:42CF6548                 cmp     [ebp+var_4], 7
.text:42CF654C                 ja      def_42CF6555    ; jumptable 42CF6555 default case, cases 5,7
.text:42CF6552                 mov     eax, [ebp+var_4]
.text:42CF6555                 jmp     ds:jpt_42CF6555[eax*4] ; switch jump
.text:42CF655C ; ---------------------------------------------------------------------------
.text:42CF655C
.text:42CF655C loc_42CF655C:                           ; CODE XREF: sub_42CF652F+26\u2191j
.text:42CF655C                                         ; DATA XREF: .text:jpt_42CF6555\u2193o
.text:42CF655C                 mov     ecx, [ebp+arg_C] ; jumptable 42CF6555 case 6
.text:42CF655F                 push    ecx
.text:42CF6560                 mov     edx, [ebp+arg_8]
.text:42CF6563                 push    edx
.text:42CF6564                 mov     eax, [ebp+arg_4]
.text:42CF6567                 push    eax
.text:42CF6568                 mov     ecx, [ebp+arg_0]
.text:42CF656B                 mov     edx, [ecx+88h]
.text:42CF6571                 push    edx
.text:42CF6572                 call    dword_42D01BAC
.text:42CF6578                 add     esp, 10h
.text:42CF657B                 jmp     loc_42CF662A
.text:42CF6580 ; ---------------------------------------------------------------------------
.text:42CF6580
.text:42CF6580 loc_42CF6580:                           ; CODE XREF: sub_42CF652F+26\u2191j
.text:42CF6580                                         ; DATA XREF: .text:jpt_42CF6555\u2193o
.text:42CF6580                 mov     eax, [ebp+arg_C] ; jumptable 42CF6555 case 1
.text:42CF6583                 push    eax
.text:42CF6584                 mov     ecx, [ebp+arg_8]
.text:42CF6587                 push    ecx
.text:42CF6588                 mov     edx, [ebp+arg_4]
.text:42CF658B                 push    edx
.text:42CF658C                 mov     eax, [ebp+arg_0]
.text:42CF658F                 mov     ecx, [eax+88h]
.text:42CF6595                 push    ecx
.text:42CF6596                 call    dword_42D01E0C
.text:42CF659C                 add     esp, 10h
.text:42CF659F                 jmp     loc_42CF662A
.text:42CF65A4 ; ---------------------------------------------------------------------------
.text:42CF65A4
.text:42CF65A4 loc_42CF65A4:                           ; CODE XREF: sub_42CF652F+26\u2191j
.text:42CF65A4                                         ; DATA XREF: .text:jpt_42CF6555\u2193o
.text:42CF65A4                 mov     edx, [ebp+arg_C] ; jumptable 42CF6555 case 4
.text:42CF65A7                 push    edx
.text:42CF65A8                 mov     eax, [ebp+arg_8]
.text:42CF65AB                 push    eax
.text:42CF65AC                 mov     ecx, [ebp+arg_4]
.text:42CF65AF                 push    ecx
.text:42CF65B0                 mov     edx, [ebp+arg_0]
.text:42CF65B3                 mov     eax, [edx+88h]
.text:42CF65B9                 push    eax
.text:42CF65BA                 call    dword_42D01F4C
.text:42CF65C0                 add     esp, 10h
.text:42CF65C3                 jmp     short loc_42CF662A
.text:42CF65C5 ; ---------------------------------------------------------------------------
.text:42CF65C5
.text:42CF65C5 loc_42CF65C5:                           ; CODE XREF: sub_42CF652F+26\u2191j
.text:42CF65C5                                         ; DATA XREF: .text:jpt_42CF6555\u2193o
.text:42CF65C5                 mov     ecx, [ebp+arg_C] ; jumptable 42CF6555 case 3
.text:42CF65C8                 push    ecx
.text:42CF65C9                 mov     edx, [ebp+arg_8]
.text:42CF65CC                 push    edx
.text:42CF65CD                 mov     eax, [ebp+arg_4]
.text:42CF65D0                 push    eax
.text:42CF65D1                 mov     ecx, [ebp+arg_0]
.text:42CF65D4                 mov     edx, [ecx+88h]
.text:42CF65DA                 push    edx
.text:42CF65DB                 call    dword_42D01C6C
.text:42CF65E1                 add     esp, 10h
.text:42CF65E4                 jmp     short loc_42CF662A
.text:42CF65E6 ; ---------------------------------------------------------------------------
.text:42CF65E6
.text:42CF65E6 loc_42CF65E6:                           ; CODE XREF: sub_42CF652F+26\u2191j
.text:42CF65E6                                         ; DATA XREF: .text:jpt_42CF6555\u2193o
.text:42CF65E6                 mov     eax, [ebp+arg_C] ; jumptable 42CF6555 case 2
.text:42CF65E9                 push    eax
.text:42CF65EA                 mov     ecx, [ebp+arg_8]
.text:42CF65ED                 push    ecx
.text:42CF65EE                 mov     edx, [ebp+arg_4]
.text:42CF65F1                 push    edx
.text:42CF65F2                 mov     eax, [ebp+arg_0]
.text:42CF65F5                 mov     ecx, [eax+88h]
.text:42CF65FB                 push    ecx
.text:42CF65FC                 call    dword_42D01C0C
.text:42CF6602                 add     esp, 10h
.text:42CF6605                 jmp     short loc_42CF662A
.text:42CF6607 ; ---------------------------------------------------------------------------
.text:42CF6607
.text:42CF6607 loc_42CF6607:                           ; CODE XREF: sub_42CF652F+26\u2191j
.text:42CF6607                                         ; DATA XREF: .text:jpt_42CF6555\u2193o
.text:42CF6607                 mov     edx, [ebp+arg_C] ; jumptable 42CF6555 case 8
.text:42CF660A                 push    edx
.text:42CF660B                 mov     eax, [ebp+arg_8]
.text:42CF660E                 push    eax
.text:42CF660F                 mov     ecx, [ebp+arg_4]
.text:42CF6612                 push    ecx
.text:42CF6613                 mov     edx, [ebp+arg_0]
.text:42CF6616                 mov     eax, [edx+88h]
.text:42CF661C                 push    eax
.text:42CF661D                 call    dword_42D020CC
.text:42CF6623                 add     esp, 10h
.text:42CF6626                 jmp     short loc_42CF662A
.text:42CF6628 ; ---------------------------------------------------------------------------
.text:42CF6628
.text:42CF6628 def_42CF6555:                           ; CODE XREF: sub_42CF652F+1D\u2191j
.text:42CF6628                                         ; sub_42CF652F+26\u2191j
.text:42CF6628                                         ; DATA XREF: ...
.text:42CF6628                 xor     eax, eax        ; jumptable 42CF6555 default case, cases 5,7
.text:42CF662A
.text:42CF662A loc_42CF662A:                           ; CODE XREF: sub_42CF652F+4C\u2191j
.text:42CF662A                                         ; sub_42CF652F+70\u2191j ...
.text:42CF662A                 mov     esp, ebp
.text:42CF662C                 pop     ebp
.text:42CF662D                 retn
.text:42CF662D sub_42CF652F    endp
.text:42CF662D
.text:42CF662D ; ---------------------------------------------------------------------------
.text:42CF662E jpt_42CF6555    dd offset loc_42CF6580  ; DATA XREF: sub_42CF652F+26\u2191r
.text:42CF662E                 dd offset loc_42CF65E6  ; jump table for switch statement
.text:42CF662E                 dd offset loc_42CF65C5
.text:42CF662E                 dd offset loc_42CF65A4
.text:42CF662E                 dd offset def_42CF6555
.text:42CF662E                 dd offset loc_42CF655C
.text:42CF662E                 dd offset def_42CF6555
.text:42CF662E                 dd offset loc_42CF6607
.text:42CF664E
.text:42CF664E ; =============== S U B R O U T I N E =======================================
.text:42CF664E
.text:42CF664E ; Attributes: bp-based frame
.text:42CF664E
.text:42CF664E sub_42CF664E    proc near               ; CODE XREF: ConnectionPeek+2A7\u2191p
.text:42CF664E
.text:42CF664E var_4           = dword ptr -4
.text:42CF664E arg_0           = dword ptr  8
.text:42CF664E arg_4           = dword ptr  0Ch
.text:42CF664E arg_8           = dword ptr  10h
.text:42CF664E arg_C           = dword ptr  14h
.text:42CF664E arg_10          = dword ptr  18h
.text:42CF664E
.text:42CF664E                 push    ebp
.text:42CF664F                 mov     ebp, esp
.text:42CF6651                 push    ecx
.text:42CF6652                 mov     eax, [ebp+arg_0]
.text:42CF6655                 mov     ecx, [eax+84h]
.text:42CF665B                 mov     [ebp+var_4], ecx
.text:42CF665E                 mov     edx, [ebp+var_4]
.text:42CF6661                 sub     edx, 1          ; switch 8 cases
.text:42CF6664                 mov     [ebp+var_4], edx
.text:42CF6667                 cmp     [ebp+var_4], 7
.text:42CF666B                 ja      def_42CF6674    ; jumptable 42CF6674 default case, cases 5,7
.text:42CF6671                 mov     eax, [ebp+var_4]
.text:42CF6674                 jmp     ds:jpt_42CF6674[eax*4] ; switch jump
.text:42CF667B ; ---------------------------------------------------------------------------
.text:42CF667B
.text:42CF667B loc_42CF667B:                           ; CODE XREF: sub_42CF664E+26\u2191j
.text:42CF667B                                         ; DATA XREF: .text:jpt_42CF6674\u2193o
.text:42CF667B                 mov     ecx, [ebp+arg_10] ; jumptable 42CF6674 case 6
.text:42CF667E                 push    ecx
.text:42CF667F                 mov     edx, [ebp+arg_C]
.text:42CF6682                 push    edx
.text:42CF6683                 mov     eax, [ebp+arg_8]
.text:42CF6686                 push    eax
.text:42CF6687                 mov     ecx, [ebp+arg_8]
.text:42CF668A                 push    ecx
.text:42CF668B                 mov     edx, [ebp+arg_4]
.text:42CF668E                 push    edx
.text:42CF668F                 mov     eax, [ebp+arg_0]
.text:42CF6692                 mov     ecx, [eax+88h]
.text:42CF6698                 push    ecx
.text:42CF6699                 call    dword_42D01BBC
.text:42CF669F                 add     esp, 18h
.text:42CF66A2                 jmp     loc_42CF6775
.text:42CF66A7 ; ---------------------------------------------------------------------------
.text:42CF66A7
.text:42CF66A7 loc_42CF66A7:                           ; CODE XREF: sub_42CF664E+26\u2191j
.text:42CF66A7                                         ; DATA XREF: .text:jpt_42CF6674\u2193o
.text:42CF66A7                 mov     edx, [ebp+arg_10] ; jumptable 42CF6674 case 1
.text:42CF66AA                 push    edx
.text:42CF66AB                 mov     eax, [ebp+arg_C]
.text:42CF66AE                 push    eax
.text:42CF66AF                 mov     ecx, [ebp+arg_8]
.text:42CF66B2                 push    ecx
.text:42CF66B3                 mov     edx, [ebp+arg_8]
.text:42CF66B6                 push    edx
.text:42CF66B7                 mov     eax, [ebp+arg_4]
.text:42CF66BA                 push    eax
.text:42CF66BB                 mov     ecx, [ebp+arg_0]
.text:42CF66BE                 mov     edx, [ecx+88h]
.text:42CF66C4                 push    edx
.text:42CF66C5                 call    dword_42D01E1C
.text:42CF66CB                 add     esp, 18h
.text:42CF66CE                 jmp     loc_42CF6775
.text:42CF66D3 ; ---------------------------------------------------------------------------
.text:42CF66D3
.text:42CF66D3 loc_42CF66D3:                           ; CODE XREF: sub_42CF664E+26\u2191j
.text:42CF66D3                                         ; DATA XREF: .text:jpt_42CF6674\u2193o
.text:42CF66D3                 mov     eax, [ebp+arg_10] ; jumptable 42CF6674 case 4
.text:42CF66D6                 push    eax
.text:42CF66D7                 mov     ecx, [ebp+arg_C]
.text:42CF66DA                 push    ecx
.text:42CF66DB                 mov     edx, [ebp+arg_8]
.text:42CF66DE                 push    edx
.text:42CF66DF                 mov     eax, [ebp+arg_8]
.text:42CF66E2                 push    eax
.text:42CF66E3                 mov     ecx, [ebp+arg_4]
.text:42CF66E6                 push    ecx
.text:42CF66E7                 mov     edx, [ebp+arg_0]
.text:42CF66EA                 mov     eax, [edx+88h]
.text:42CF66F0                 push    eax
.text:42CF66F1                 call    dword_42D01F5C
.text:42CF66F7                 add     esp, 18h
.text:42CF66FA                 jmp     short loc_42CF6775
.text:42CF66FC ; ---------------------------------------------------------------------------
.text:42CF66FC
.text:42CF66FC loc_42CF66FC:                           ; CODE XREF: sub_42CF664E+26\u2191j
.text:42CF66FC                                         ; DATA XREF: .text:jpt_42CF6674\u2193o
.text:42CF66FC                 mov     ecx, [ebp+arg_10] ; jumptable 42CF6674 case 3
.text:42CF66FF                 push    ecx
.text:42CF6700                 mov     edx, [ebp+arg_C]
.text:42CF6703                 push    edx
.text:42CF6704                 mov     eax, [ebp+arg_8]
.text:42CF6707                 push    eax
.text:42CF6708                 mov     ecx, [ebp+arg_8]
.text:42CF670B                 push    ecx
.text:42CF670C                 mov     edx, [ebp+arg_4]
.text:42CF670F                 push    edx
.text:42CF6710                 mov     eax, [ebp+arg_0]
.text:42CF6713                 mov     ecx, [eax+88h]
.text:42CF6719                 push    ecx
.text:42CF671A                 call    dword_42D01C7C
.text:42CF6720                 add     esp, 18h
.text:42CF6723                 jmp     short loc_42CF6775
.text:42CF6725 ; ---------------------------------------------------------------------------
.text:42CF6725
.text:42CF6725 loc_42CF6725:                           ; CODE XREF: sub_42CF664E+26\u2191j
.text:42CF6725                                         ; DATA XREF: .text:jpt_42CF6674\u2193o
.text:42CF6725                 mov     edx, [ebp+arg_10] ; jumptable 42CF6674 case 2
.text:42CF6728                 push    edx
.text:42CF6729                 mov     eax, [ebp+arg_C]
.text:42CF672C                 push    eax
.text:42CF672D                 mov     ecx, [ebp+arg_8]
.text:42CF6730                 push    ecx
.text:42CF6731                 push    0
.text:42CF6733                 mov     edx, [ebp+arg_4]
.text:42CF6736                 push    edx
.text:42CF6737                 mov     eax, [ebp+arg_0]
.text:42CF673A                 mov     ecx, [eax+88h]
.text:42CF6740                 push    ecx
.text:42CF6741                 call    dword_42D01C08
.text:42CF6747                 add     esp, 18h
.text:42CF674A                 jmp     short loc_42CF6775
.text:42CF674C ; ---------------------------------------------------------------------------
.text:42CF674C
.text:42CF674C loc_42CF674C:                           ; CODE XREF: sub_42CF664E+26\u2191j
.text:42CF674C                                         ; DATA XREF: .text:jpt_42CF6674\u2193o
.text:42CF674C                 mov     edx, [ebp+arg_10] ; jumptable 42CF6674 case 8
.text:42CF674F                 push    edx
.text:42CF6750                 mov     eax, [ebp+arg_C]
.text:42CF6753                 push    eax
.text:42CF6754                 mov     ecx, [ebp+arg_8]
.text:42CF6757                 push    ecx
.text:42CF6758                 push    0
.text:42CF675A                 mov     edx, [ebp+arg_4]
.text:42CF675D                 push    edx
.text:42CF675E                 mov     eax, [ebp+arg_0]
.text:42CF6761                 mov     ecx, [eax+88h]
.text:42CF6767                 push    ecx
.text:42CF6768                 call    dword_42D020C8
.text:42CF676E                 add     esp, 18h
.text:42CF6771                 jmp     short loc_42CF6775
.text:42CF6773 ; ---------------------------------------------------------------------------
.text:42CF6773
.text:42CF6773 def_42CF6674:                           ; CODE XREF: sub_42CF664E+1D\u2191j
.text:42CF6773                                         ; sub_42CF664E+26\u2191j
.text:42CF6773                                         ; DATA XREF: ...
.text:42CF6773                 xor     eax, eax        ; jumptable 42CF6674 default case, cases 5,7
.text:42CF6775
.text:42CF6775 loc_42CF6775:                           ; CODE XREF: sub_42CF664E+54\u2191j
.text:42CF6775                                         ; sub_42CF664E+80\u2191j ...
.text:42CF6775                 mov     esp, ebp
.text:42CF6777                 pop     ebp
.text:42CF6778                 retn
.text:42CF6778 sub_42CF664E    endp
.text:42CF6778
.text:42CF6778 ; ---------------------------------------------------------------------------
.text:42CF6779 jpt_42CF6674    dd offset loc_42CF66A7  ; DATA XREF: sub_42CF664E+26\u2191r
.text:42CF6779                 dd offset loc_42CF6725  ; jump table for switch statement
.text:42CF6779                 dd offset loc_42CF66FC
.text:42CF6779                 dd offset loc_42CF66D3
.text:42CF6779                 dd offset def_42CF6674
.text:42CF6779                 dd offset loc_42CF667B
.text:42CF6779                 dd offset def_42CF6674
.text:42CF6779                 dd offset loc_42CF674C
.text:42CF6799 ; ---------------------------------------------------------------------------
.text:42CF6799                 push    ebp
.text:42CF679A                 mov     ebp, esp
.text:42CF679C                 push    ecx
.text:42CF679D                 cmp     dword ptr [ebp+0Ch], 0
.text:42CF67A1                 jnz     short loc_42CF67A7
.text:42CF67A3                 xor     eax, eax
.text:42CF67A5                 jmp     short loc_42CF67F1
.text:42CF67A7 ; ---------------------------------------------------------------------------
.text:42CF67A7
.text:42CF67A7 loc_42CF67A7:                           ; CODE XREF: .text:42CF67A1\u2191j
.text:42CF67A7                 mov     eax, [ebp+8]
.text:42CF67AA                 mov     [ebp-4], eax
.text:42CF67AD
.text:42CF67AD loc_42CF67AD:                           ; CODE XREF: .text:loc_42CF67ED\u2193j
.text:42CF67AD                 mov     ecx, [ebp-4]
.text:42CF67B0                 xor     edx, edx
.text:42CF67B2                 mov     dl, [ecx]
.text:42CF67B4                 test    edx, edx
.text:42CF67B6                 jz      short loc_42CF67EF
.text:42CF67B8                 mov     eax, [ebp-4]
.text:42CF67BB                 xor     ecx, ecx
.text:42CF67BD                 mov     cl, [eax]
.text:42CF67BF                 cmp     ecx, [ebp+0Ch]
.text:42CF67C2                 jnz     short loc_42CF67C9
.text:42CF67C4                 mov     eax, [ebp-4]
.text:42CF67C7                 jmp     short loc_42CF67F1
.text:42CF67C9 ; ---------------------------------------------------------------------------
.text:42CF67C9
.text:42CF67C9 loc_42CF67C9:                           ; CODE XREF: .text:42CF67C2\u2191j
.text:42CF67C9                 mov     edx, [ebp-4]
.text:42CF67CC                 mov     al, [edx]
.text:42CF67CE                 push    eax
.text:42CF67CF                 call    ds:IsDBCSLeadByte
.text:42CF67D5                 test    eax, eax
.text:42CF67D7                 jz      short loc_42CF67E4
.text:42CF67D9                 mov     ecx, [ebp-4]
.text:42CF67DC                 add     ecx, 2
.text:42CF67DF                 mov     [ebp-4], ecx
.text:42CF67E2                 jmp     short loc_42CF67ED
.text:42CF67E4 ; ---------------------------------------------------------------------------
.text:42CF67E4
.text:42CF67E4 loc_42CF67E4:                           ; CODE XREF: .text:42CF67D7\u2191j
.text:42CF67E4                 mov     edx, [ebp-4]
.text:42CF67E7                 add     edx, 1
.text:42CF67EA                 mov     [ebp-4], edx
.text:42CF67ED
.text:42CF67ED loc_42CF67ED:                           ; CODE XREF: .text:42CF67E2\u2191j
.text:42CF67ED                 jmp     short loc_42CF67AD
.text:42CF67EF ; ---------------------------------------------------------------------------
.text:42CF67EF
.text:42CF67EF loc_42CF67EF:                           ; CODE XREF: .text:42CF67B6\u2191j
.text:42CF67EF                 xor     eax, eax
.text:42CF67F1
.text:42CF67F1 loc_42CF67F1:                           ; CODE XREF: .text:42CF67A5\u2191j
.text:42CF67F1                                         ; .text:42CF67C7\u2191j
.text:42CF67F1                 mov     esp, ebp
.text:42CF67F3                 pop     ebp
.text:42CF67F4                 retn
.text:42CF67F5
.text:42CF67F5 ; =============== S U B R O U T I N E =======================================
.text:42CF67F5
.text:42CF67F5 ; Attributes: bp-based frame
.text:42CF67F5
.text:42CF67F5 sub_42CF67F5    proc near               ; CODE XREF: ConnectionListen+6D9\u2191p
.text:42CF67F5
.text:42CF67F5 var_28          = dword ptr -28h
.text:42CF67F5 s               = dword ptr -24h
.text:42CF67F5 name            = sockaddr ptr -20h
.text:42CF67F5 Src             = dword ptr -10h
.text:42CF67F5 optval          = byte ptr -0Ch
.text:42CF67F5 var_8           = dword ptr -8
.text:42CF67F5 cp              = dword ptr -4
.text:42CF67F5 arg_0           = dword ptr  8
.text:42CF67F5 arg_4           = dword ptr  0Ch
.text:42CF67F5 arg_8           = dword ptr  10h
.text:42CF67F5 arg_C           = dword ptr  14h
.text:42CF67F5 arg_10          = dword ptr  18h
.text:42CF67F5
.text:42CF67F5                 push    ebp
.text:42CF67F6                 mov     ebp, esp
.text:42CF67F8                 sub     esp, 28h
.text:42CF67FB                 push    offset Delimiter ; ","
.text:42CF6800                 mov     eax, [ebp+arg_C]
.text:42CF6803                 add     eax, 52Ch
.text:42CF6808                 push    eax             ; String
.text:42CF6809                 call    ds:strtok
.text:42CF680F                 add     esp, 8
.text:42CF6812                 mov     [ebp+cp], eax
.text:42CF6815                 mov     dword ptr [ebp+optval], 1
.text:42CF681C                 mov     ecx, [ebp+cp]
.text:42CF681F                 push    ecx             ; cp
.text:42CF6820                 call    ds:__imp_inet_addr
.text:42CF6826                 mov     [ebp+Src], eax
.text:42CF6829                 cmp     [ebp+Src], 0FFFFFFFFh
.text:42CF682D                 jz      short loc_42CF6843
.text:42CF682F                 push    4               ; Size
.text:42CF6831                 lea     edx, [ebp+Src]
.text:42CF6834                 push    edx             ; Src
.text:42CF6835                 lea     eax, [ebp+name.sa_data+2]
.text:42CF6838                 push    eax             ; void *
.text:42CF6839                 call    memcpy
.text:42CF683E                 add     esp, 0Ch
.text:42CF6841                 jmp     short loc_42CF686F
.text:42CF6843 ; ---------------------------------------------------------------------------
.text:42CF6843
.text:42CF6843 loc_42CF6843:                           ; CODE XREF: sub_42CF67F5+38\u2191j
.text:42CF6843                 mov     ecx, [ebp+cp]
.text:42CF6846                 push    ecx             ; name
.text:42CF6847                 call    ds:__imp_gethostbyname
.text:42CF684D                 mov     [ebp+var_28], eax
.text:42CF6850                 cmp     [ebp+var_28], 0
.text:42CF6854                 jnz     short loc_42CF686F
.text:42CF6856                 mov     [ebp+arg_4], offset aGethostbyname_0 ; "gethostbyname"
.text:42CF685D                 call    ds:WSAGetLastError
.text:42CF6863                 mov     edx, [ebp+arg_8]
.text:42CF6866                 mov     [edx], eax
.text:42CF6868                 xor     eax, eax
.text:42CF686A                 jmp     loc_42CF69B0
.text:42CF686F ; ---------------------------------------------------------------------------
.text:42CF686F
.text:42CF686F loc_42CF686F:                           ; CODE XREF: sub_42CF67F5+4C\u2191j
.text:42CF686F                                         ; sub_42CF67F5+5F\u2191j
.text:42CF686F                 mov     eax, [ebp+arg_C]
.text:42CF6872                 mov     cx, [eax+524h]
.text:42CF6879                 push    ecx             ; hostshort
.text:42CF687A                 call    ds:htons
.text:42CF6880                 mov     word ptr [ebp+name.sa_data], ax
.text:42CF6884                 mov     [ebp+name.sa_family], 2
.text:42CF688A                 mov     edx, [ebp+arg_0]
.text:42CF688D                 mov     eax, [edx+5Ch]
.text:42CF6890                 push    eax             ; protocol
.text:42CF6891                 mov     ecx, [ebp+arg_0]
.text:42CF6894                 mov     edx, [ecx+58h]
.text:42CF6897                 push    edx             ; type
.text:42CF6898                 mov     eax, [ebp+arg_0]
.text:42CF689B                 mov     ecx, [eax+4Ch]
.text:42CF689E                 push    ecx             ; af
.text:42CF689F                 call    ds:socket
.text:42CF68A5                 mov     [ebp+s], eax
.text:42CF68A8                 cmp     [ebp+s], 0FFFFFFFFh
.text:42CF68AC                 jnz     short loc_42CF68C7
.text:42CF68AE                 mov     [ebp+arg_4], offset aSocket_0 ; "Socket"
.text:42CF68B5                 call    ds:WSAGetLastError
.text:42CF68BB                 mov     edx, [ebp+arg_8]
.text:42CF68BE                 mov     [edx], eax
.text:42CF68C0                 xor     eax, eax
.text:42CF68C2                 jmp     loc_42CF69B0
.text:42CF68C7 ; ---------------------------------------------------------------------------
.text:42CF68C7
.text:42CF68C7 loc_42CF68C7:                           ; CODE XREF: sub_42CF67F5+B7\u2191j
.text:42CF68C7                 cmp     dword_42D01A1C, 0
.text:42CF68CE                 jz      short loc_42CF6915
.text:42CF68D0                 cmp     [ebp+arg_10], 0
.text:42CF68D4                 jz      short loc_42CF6915
.text:42CF68D6                 push    4               ; optlen
.text:42CF68D8                 lea     eax, [ebp+optval]
.text:42CF68DB                 push    eax             ; optval
.text:42CF68DC                 push    0FFFFFFFBh      ; optname
.text:42CF68DE                 push    0FFFFh          ; level
.text:42CF68E3                 mov     ecx, [ebp+s]
.text:42CF68E6                 push    ecx             ; s
.text:42CF68E7                 call    ds:setsockopt
.text:42CF68ED                 cmp     eax, 0FFFFFFFFh
.text:42CF68F0                 jnz     short loc_42CF6915
.text:42CF68F2                 mov     [ebp+arg_4], offset aSoExclusiveadd_0 ; "SO_EXCLUSIVEADDRUSE"
.text:42CF68F9                 call    ds:WSAGetLastError
.text:42CF68FF                 mov     edx, [ebp+arg_8]
.text:42CF6902                 mov     [edx], eax
.text:42CF6904                 mov     eax, [ebp+s]
.text:42CF6907                 push    eax             ; s
.text:42CF6908                 call    ds:closesocket
.text:42CF690E                 xor     eax, eax
.text:42CF6910                 jmp     loc_42CF69B0
.text:42CF6915 ; ---------------------------------------------------------------------------
.text:42CF6915
.text:42CF6915 loc_42CF6915:                           ; CODE XREF: sub_42CF67F5+D9\u2191j
.text:42CF6915                                         ; sub_42CF67F5+DF\u2191j ...
.text:42CF6915                 mov     ecx, [ebp+arg_0]
.text:42CF6918                 mov     edx, [ecx+50h]
.text:42CF691B                 push    edx             ; namelen
.text:42CF691C                 lea     eax, [ebp+name]
.text:42CF691F                 push    eax             ; name
.text:42CF6920                 mov     ecx, [ebp+s]
.text:42CF6923                 push    ecx             ; s
.text:42CF6924                 call    ds:bind
.text:42CF692A                 mov     [ebp+var_8], eax
.text:42CF692D                 cmp     [ebp+var_8], 0FFFFFFFFh
.text:42CF6931                 jnz     short loc_42CF6965
.text:42CF6933                 mov     [ebp+arg_4], offset aBind_0 ; "Bind"
.text:42CF693A                 call    ds:WSAGetLastError
.text:42CF6940                 mov     edx, [ebp+arg_8]
.text:42CF6943                 mov     [edx], eax
.text:42CF6945                 mov     eax, [ebp+arg_8]
.text:42CF6948                 cmp     dword ptr [eax], 271Dh
.text:42CF694E                 jnz     short loc_42CF6957
.text:42CF6950                 mov     [ebp+arg_4], offset aFailedToGetExc_0 ; "Failed to get Exclusive port use"
.text:42CF6957
.text:42CF6957 loc_42CF6957:                           ; CODE XREF: sub_42CF67F5+159\u2191j
.text:42CF6957                 mov     ecx, [ebp+s]
.text:42CF695A                 push    ecx             ; s
.text:42CF695B                 call    ds:closesocket
.text:42CF6961                 xor     eax, eax
.text:42CF6963                 jmp     short loc_42CF69B0
.text:42CF6965 ; ---------------------------------------------------------------------------
.text:42CF6965
.text:42CF6965 loc_42CF6965:                           ; CODE XREF: sub_42CF67F5+13C\u2191j
.text:42CF6965                 mov     edx, [ebp+arg_C]
.text:42CF6968                 mov     eax, [edx+2730h]
.text:42CF696E                 push    eax             ; backlog
.text:42CF696F                 mov     ecx, [ebp+s]
.text:42CF6972                 push    ecx             ; s
.text:42CF6973                 call    ds:listen
.text:42CF6979                 mov     [ebp+var_8], eax
.text:42CF697C                 cmp     [ebp+var_8], 0FFFFFFFFh
.text:42CF6980                 jnz     short loc_42CF69A2
.text:42CF6982                 mov     [ebp+arg_4], offset aListen_0 ; "Listen"
.text:42CF6989                 call    ds:WSAGetLastError
.text:42CF698F                 mov     edx, [ebp+arg_8]
.text:42CF6992                 mov     [edx], eax
.text:42CF6994                 mov     eax, [ebp+s]
.text:42CF6997                 push    eax             ; s
.text:42CF6998                 call    ds:closesocket
.text:42CF699E                 xor     eax, eax
.text:42CF69A0                 jmp     short loc_42CF69B0
.text:42CF69A2 ; ---------------------------------------------------------------------------
.text:42CF69A2
.text:42CF69A2 loc_42CF69A2:                           ; CODE XREF: sub_42CF67F5+18B\u2191j
.text:42CF69A2                 mov     ecx, [ebp+s]
.text:42CF69A5                 mov     dword_42D010D4, ecx
.text:42CF69AB                 mov     eax, 1
.text:42CF69B0
.text:42CF69B0 loc_42CF69B0:                           ; CODE XREF: sub_42CF67F5+75\u2191j
.text:42CF69B0                                         ; sub_42CF67F5+CD\u2191j ...
.text:42CF69B0                 mov     esp, ebp
.text:42CF69B2                 pop     ebp
.text:42CF69B3                 retn
.text:42CF69B3 sub_42CF67F5    endp
.text:42CF69B3
.text:42CF69B4
.text:42CF69B4 ; =============== S U B R O U T I N E =======================================
.text:42CF69B4
.text:42CF69B4 ; Attributes: bp-based frame
.text:42CF69B4
.text:42CF69B4 ; int __cdecl sub_42CF69B4(LPVOID lpParameter, int)
.text:42CF69B4 sub_42CF69B4    proc near               ; CODE XREF: ConnectionListen+1148\u2191p
.text:42CF69B4
.text:42CF69B4 var_14          = dword ptr -14h
.text:42CF69B4 var_10          = dword ptr -10h
.text:42CF69B4 var_C           = dword ptr -0Ch
.text:42CF69B4 ThreadId        = dword ptr -8
.text:42CF69B4 var_4           = dword ptr -4
.text:42CF69B4 lpParameter     = dword ptr  8
.text:42CF69B4 arg_4           = dword ptr  0Ch
.text:42CF69B4
.text:42CF69B4                 push    ebp
.text:42CF69B5                 mov     ebp, esp
.text:42CF69B7                 sub     esp, 14h
.text:42CF69BA                 cmp     cEvents, 0
.text:42CF69C1                 jle     short loc_42CF6A00
.text:42CF69C3                 push    offset dword_42D02100 ; lpThreadId
.text:42CF69C8                 push    0               ; dwCreationFlags
.text:42CF69CA                 push    0               ; lpParameter
.text:42CF69CC                 push    offset sub_42CF2424 ; lpStartAddress
.text:42CF69D1                 push    1000h           ; dwStackSize
.text:42CF69D6                 push    0               ; lpThreadAttributes
.text:42CF69D8                 call    ds:CreateThread
.text:42CF69DE                 mov     hThread, eax
.text:42CF69E3                 cmp     hThread, 0
.text:42CF69EA                 jnz     short loc_42CF69FE
.text:42CF69EC                 call    ds:GetLastError
.text:42CF69F2                 mov     ecx, [ebp+arg_4]
.text:42CF69F5                 mov     [ecx], eax
.text:42CF69F7                 xor     eax, eax
.text:42CF69F9                 jmp     loc_42CF6D51
.text:42CF69FE ; ---------------------------------------------------------------------------
.text:42CF69FE
.text:42CF69FE loc_42CF69FE:                           ; CODE XREF: sub_42CF69B4+36\u2191j
.text:42CF69FE                 jmp     short loc_42CF6A0A
.text:42CF6A00 ; ---------------------------------------------------------------------------
.text:42CF6A00
.text:42CF6A00 loc_42CF6A00:                           ; CODE XREF: sub_42CF69B4+D\u2191j
.text:42CF6A00                 mov     dword_42D010E8, 1
.text:42CF6A0A
.text:42CF6A0A loc_42CF6A0A:                           ; CODE XREF: sub_42CF69B4:loc_42CF69FE\u2191j
.text:42CF6A0A                 cmp     dword_42D010E4, 0
.text:42CF6A11                 jz      short loc_42CF6A4E
.text:42CF6A13                 push    offset dword_42D01CBC ; lpThreadId
.text:42CF6A18                 push    0               ; dwCreationFlags
.text:42CF6A1A                 push    0               ; lpParameter
.text:42CF6A1C                 push    offset sub_42CF24E5 ; lpStartAddress
.text:42CF6A21                 push    1000h           ; dwStackSize
.text:42CF6A26                 push    0               ; lpThreadAttributes
.text:42CF6A28                 call    ds:CreateThread
.text:42CF6A2E                 mov     dword_42D01BE0, eax
.text:42CF6A33                 cmp     dword_42D01BE0, 0
.text:42CF6A3A                 jnz     short loc_42CF6A4E
.text:42CF6A3C                 call    ds:GetLastError
.text:42CF6A42                 mov     edx, [ebp+arg_4]
.text:42CF6A45                 mov     [edx], eax
.text:42CF6A47                 xor     eax, eax
.text:42CF6A49                 jmp     loc_42CF6D51
.text:42CF6A4E ; ---------------------------------------------------------------------------
.text:42CF6A4E
.text:42CF6A4E loc_42CF6A4E:                           ; CODE XREF: sub_42CF69B4+5D\u2191j
.text:42CF6A4E                                         ; sub_42CF69B4+86\u2191j
.text:42CF6A4E                 push    40h ; '@'       ; Size
.text:42CF6A50                 push    0               ; Val
.text:42CF6A52                 push    offset dword_42D01B60 ; void *
.text:42CF6A57                 call    memset
.text:42CF6A5C                 add     esp, 0Ch
.text:42CF6A5F                 cmp     dword_42D01BA0, 0
.text:42CF6A66                 jz      short loc_42CF6AC1
.text:42CF6A68                 push    offset dword_42D01BDC ; lpThreadId
.text:42CF6A6D                 push    0               ; dwCreationFlags
.text:42CF6A6F                 push    0               ; lpParameter
.text:42CF6A71                 push    offset sub_42CF2585 ; lpStartAddress
.text:42CF6A76                 push    1000h           ; dwStackSize
.text:42CF6A7B                 push    0               ; lpThreadAttributes
.text:42CF6A7D                 call    ds:CreateThread
.text:42CF6A83                 mov     ecx, dword_42D01A14
.text:42CF6A89                 mov     dword_42D01B60[ecx*4], eax
.text:42CF6A90                 mov     edx, dword_42D01A14
.text:42CF6A96                 cmp     dword_42D01B60[edx*4], 0
.text:42CF6A9E                 jnz     short loc_42CF6AB2
.text:42CF6AA0                 call    ds:GetLastError
.text:42CF6AA6                 mov     ecx, [ebp+arg_4]
.text:42CF6AA9                 mov     [ecx], eax
.text:42CF6AAB                 xor     eax, eax
.text:42CF6AAD                 jmp     loc_42CF6D51
.text:42CF6AB2 ; ---------------------------------------------------------------------------
.text:42CF6AB2
.text:42CF6AB2 loc_42CF6AB2:                           ; CODE XREF: sub_42CF69B4+EA\u2191j
.text:42CF6AB2                 mov     edx, dword_42D01A14
.text:42CF6AB8                 add     edx, 1
.text:42CF6ABB                 mov     dword_42D01A14, edx
.text:42CF6AC1
.text:42CF6AC1 loc_42CF6AC1:                           ; CODE XREF: sub_42CF69B4+B2\u2191j
.text:42CF6AC1                 cmp     Block, 0
.text:42CF6AC8                 jz      loc_42CF6B79
.text:42CF6ACE                 push    offset dword_42D01E3C ; lpThreadId
.text:42CF6AD3                 push    0               ; dwCreationFlags
.text:42CF6AD5                 push    0               ; lpParameter
.text:42CF6AD7                 push    offset sub_42CF2683 ; lpStartAddress
.text:42CF6ADC                 push    1000h           ; dwStackSize
.text:42CF6AE1                 push    0               ; lpThreadAttributes
.text:42CF6AE3                 call    ds:CreateThread
.text:42CF6AE9                 mov     ecx, dword_42D01A14
.text:42CF6AEF                 mov     dword_42D01B60[ecx*4], eax
.text:42CF6AF6                 mov     edx, dword_42D01A14
.text:42CF6AFC                 cmp     dword_42D01B60[edx*4], 0
.text:42CF6B04                 jnz     short loc_42CF6B18
.text:42CF6B06                 call    ds:GetLastError
.text:42CF6B0C                 mov     ecx, [ebp+arg_4]
.text:42CF6B0F                 mov     [ecx], eax
.text:42CF6B11                 xor     eax, eax
.text:42CF6B13                 jmp     loc_42CF6D51
.text:42CF6B18 ; ---------------------------------------------------------------------------
.text:42CF6B18
.text:42CF6B18 loc_42CF6B18:                           ; CODE XREF: sub_42CF69B4+150\u2191j
.text:42CF6B18                 mov     edx, dword_42D01A14
.text:42CF6B1E                 add     edx, 1
.text:42CF6B21                 mov     dword_42D01A14, edx
.text:42CF6B27                 push    400h
.text:42CF6B2C                 push    offset unk_42D01DE0
.text:42CF6B31                 call    sub_42CF75BC
.text:42CF6B36                 add     esp, 8
.text:42CF6B39                 push    offset CriticalSection ; lpCriticalSection
.text:42CF6B3E                 call    ds:InitializeCriticalSection
.text:42CF6B44                 lea     eax, [ebp+ThreadId]
.text:42CF6B47                 push    eax             ; lpThreadId
.text:42CF6B48                 push    0               ; dwCreationFlags
.text:42CF6B4A                 push    0               ; lpParameter
.text:42CF6B4C                 push    offset sub_42CF7791 ; lpStartAddress
.text:42CF6B51                 push    1000h           ; dwStackSize
.text:42CF6B56                 push    0               ; lpThreadAttributes
.text:42CF6B58                 call    ds:CreateThread
.text:42CF6B5E                 mov     [ebp+var_4], eax
.text:42CF6B61                 cmp     [ebp+var_4], 0
.text:42CF6B65                 jnz     short loc_42CF6B79
.text:42CF6B67                 call    ds:GetLastError
.text:42CF6B6D                 mov     ecx, [ebp+arg_4]
.text:42CF6B70                 mov     [ecx], eax
.text:42CF6B72                 xor     eax, eax
.text:42CF6B74                 jmp     loc_42CF6D51
.text:42CF6B79 ; ---------------------------------------------------------------------------
.text:42CF6B79
.text:42CF6B79 loc_42CF6B79:                           ; CODE XREF: sub_42CF69B4+114\u2191j
.text:42CF6B79                                         ; sub_42CF69B4+1B1\u2191j
.text:42CF6B79                 cmp     dword_42D01F40, 0
.text:42CF6B80                 jz      short loc_42CF6BDA
.text:42CF6B82                 push    offset dword_42D01F7C ; lpThreadId
.text:42CF6B87                 push    0               ; dwCreationFlags
.text:42CF6B89                 push    0               ; lpParameter
.text:42CF6B8B                 push    offset sub_42CF27CD ; lpStartAddress
.text:42CF6B90                 push    1000h           ; dwStackSize
.text:42CF6B95                 push    0               ; lpThreadAttributes
.text:42CF6B97                 call    ds:CreateThread
.text:42CF6B9D                 mov     edx, dword_42D01A14
.text:42CF6BA3                 mov     dword_42D01B60[edx*4], eax
.text:42CF6BAA                 mov     eax, dword_42D01A14
.text:42CF6BAF                 cmp     dword_42D01B60[eax*4], 0
.text:42CF6BB7                 jnz     short loc_42CF6BCB
.text:42CF6BB9                 call    ds:GetLastError
.text:42CF6BBF                 mov     ecx, [ebp+arg_4]
.text:42CF6BC2                 mov     [ecx], eax
.text:42CF6BC4                 xor     eax, eax
.text:42CF6BC6                 jmp     loc_42CF6D51
.text:42CF6BCB ; ---------------------------------------------------------------------------
.text:42CF6BCB
.text:42CF6BCB loc_42CF6BCB:                           ; CODE XREF: sub_42CF69B4+203\u2191j
.text:42CF6BCB                 mov     edx, dword_42D01A14
.text:42CF6BD1                 add     edx, 1
.text:42CF6BD4                 mov     dword_42D01A14, edx
.text:42CF6BDA
.text:42CF6BDA loc_42CF6BDA:                           ; CODE XREF: sub_42CF69B4+1CC\u2191j
.text:42CF6BDA                 cmp     dword_42D01C60, 0
.text:42CF6BE1                 jz      short loc_42CF6C3E
.text:42CF6BE3                 push    offset dword_42D01C9C ; lpThreadId
.text:42CF6BE8                 push    0               ; dwCreationFlags
.text:42CF6BEA                 mov     eax, [ebp+lpParameter]
.text:42CF6BED                 push    eax             ; lpParameter
.text:42CF6BEE                 push    offset sub_42CF28CB ; lpStartAddress
.text:42CF6BF3                 push    1000h           ; dwStackSize
.text:42CF6BF8                 push    0               ; lpThreadAttributes
.text:42CF6BFA                 call    ds:CreateThread
.text:42CF6C00                 mov     ecx, dword_42D01A14
.text:42CF6C06                 mov     dword_42D01B60[ecx*4], eax
.text:42CF6C0D                 mov     edx, dword_42D01A14
.text:42CF6C13                 cmp     dword_42D01B60[edx*4], 0
.text:42CF6C1B                 jnz     short loc_42CF6C2F
.text:42CF6C1D                 call    ds:GetLastError
.text:42CF6C23                 mov     ecx, [ebp+arg_4]
.text:42CF6C26                 mov     [ecx], eax
.text:42CF6C28                 xor     eax, eax
.text:42CF6C2A                 jmp     loc_42CF6D51
.text:42CF6C2F ; ---------------------------------------------------------------------------
.text:42CF6C2F
.text:42CF6C2F loc_42CF6C2F:                           ; CODE XREF: sub_42CF69B4+267\u2191j
.text:42CF6C2F                 mov     edx, dword_42D01A14
.text:42CF6C35                 add     edx, 1
.text:42CF6C38                 mov     dword_42D01A14, edx
.text:42CF6C3E
.text:42CF6C3E loc_42CF6C3E:                           ; CODE XREF: sub_42CF69B4+22D\u2191j
.text:42CF6C3E                 cmp     dword_42D01C00, 0
.text:42CF6C45                 jz      short loc_42CF6CA2
.text:42CF6C47                 push    offset dword_42D01C3C ; lpThreadId
.text:42CF6C4C                 push    0               ; dwCreationFlags
.text:42CF6C4E                 mov     eax, [ebp+lpParameter]
.text:42CF6C51                 push    eax             ; lpParameter
.text:42CF6C52                 push    offset sub_42CF29C9 ; lpStartAddress
.text:42CF6C57                 push    1000h           ; dwStackSize
.text:42CF6C5C                 push    0               ; lpThreadAttributes
.text:42CF6C5E                 call    ds:CreateThread
.text:42CF6C64                 mov     ecx, dword_42D01A14
.text:42CF6C6A                 mov     dword_42D01B60[ecx*4], eax
.text:42CF6C71                 mov     edx, dword_42D01A14
.text:42CF6C77                 cmp     dword_42D01B60[edx*4], 0
.text:42CF6C7F                 jnz     short loc_42CF6C93
.text:42CF6C81                 call    ds:GetLastError
.text:42CF6C87                 mov     ecx, [ebp+arg_4]
.text:42CF6C8A                 mov     [ecx], eax
.text:42CF6C8C                 xor     eax, eax
.text:42CF6C8E                 jmp     loc_42CF6D51
.text:42CF6C93 ; ---------------------------------------------------------------------------
.text:42CF6C93
.text:42CF6C93 loc_42CF6C93:                           ; CODE XREF: sub_42CF69B4+2CB\u2191j
.text:42CF6C93                 mov     edx, dword_42D01A14
.text:42CF6C99                 add     edx, 1
.text:42CF6C9C                 mov     dword_42D01A14, edx
.text:42CF6CA2
.text:42CF6CA2 loc_42CF6CA2:                           ; CODE XREF: sub_42CF69B4+291\u2191j
.text:42CF6CA2                 cmp     dword_42D020C0, 0
.text:42CF6CA9                 jz      loc_42CF6D4C
.text:42CF6CAF                 push    offset ProcName ; "ViaNumNics"
.text:42CF6CB4                 mov     eax, dword_42D020C4
.text:42CF6CB9                 push    eax             ; hModule
.text:42CF6CBA                 call    ds:GetProcAddress
.text:42CF6CC0                 mov     [ebp+var_14], eax
.text:42CF6CC3                 cmp     [ebp+var_14], 0
.text:42CF6CC7                 jnz     short loc_42CF6CD8
.text:42CF6CC9                 call    ds:GetLastError
.text:42CF6CCF                 mov     ecx, [ebp+arg_4]
.text:42CF6CD2                 mov     [ecx], eax
.text:42CF6CD4                 xor     eax, eax
.text:42CF6CD6                 jmp     short loc_42CF6D51
.text:42CF6CD8 ; ---------------------------------------------------------------------------
.text:42CF6CD8
.text:42CF6CD8 loc_42CF6CD8:                           ; CODE XREF: sub_42CF69B4+313\u2191j
.text:42CF6CD8                 call    [ebp+var_14]
.text:42CF6CDB                 mov     [ebp+var_C], eax
.text:42CF6CDE                 mov     [ebp+var_10], 0
.text:42CF6CE5                 jmp     short loc_42CF6CF0
.text:42CF6CE7 ; ---------------------------------------------------------------------------
.text:42CF6CE7
.text:42CF6CE7 loc_42CF6CE7:                           ; CODE XREF: sub_42CF69B4+396\u2193j
.text:42CF6CE7                 mov     edx, [ebp+var_10]
.text:42CF6CEA                 add     edx, 1
.text:42CF6CED                 mov     [ebp+var_10], edx
.text:42CF6CF0
.text:42CF6CF0 loc_42CF6CF0:                           ; CODE XREF: sub_42CF69B4+331\u2191j
.text:42CF6CF0                 mov     eax, [ebp+var_10]
.text:42CF6CF3                 cmp     eax, [ebp+var_C]
.text:42CF6CF6                 jnb     short loc_42CF6D4C
.text:42CF6CF8                 push    offset dword_42D020FC ; lpThreadId
.text:42CF6CFD                 push    0               ; dwCreationFlags
.text:42CF6CFF                 mov     ecx, [ebp+lpParameter]
.text:42CF6D02                 push    ecx             ; lpParameter
.text:42CF6D03                 push    offset sub_42CF2AC7 ; lpStartAddress
.text:42CF6D08                 push    1000h           ; dwStackSize
.text:42CF6D0D                 push    0               ; lpThreadAttributes
.text:42CF6D0F                 call    ds:CreateThread
.text:42CF6D15                 mov     edx, [ebp+var_10]
.text:42CF6D18                 mov     dword_42D01B60[edx*4], eax
.text:42CF6D1F                 mov     eax, [ebp+var_10]
.text:42CF6D22                 cmp     dword_42D01B60[eax*4], 0
.text:42CF6D2A                 jnz     short loc_42CF6D3B
.text:42CF6D2C                 call    ds:GetLastError
.text:42CF6D32                 mov     ecx, [ebp+arg_4]
.text:42CF6D35                 mov     [ecx], eax
.text:42CF6D37                 xor     eax, eax
.text:42CF6D39                 jmp     short loc_42CF6D51
.text:42CF6D3B ; ---------------------------------------------------------------------------
.text:42CF6D3B
.text:42CF6D3B loc_42CF6D3B:                           ; CODE XREF: sub_42CF69B4+376\u2191j
.text:42CF6D3B                 mov     edx, dword_42D01A14
.text:42CF6D41                 add     edx, 1
.text:42CF6D44                 mov     dword_42D01A14, edx
.text:42CF6D4A                 jmp     short loc_42CF6CE7
.text:42CF6D4C ; ---------------------------------------------------------------------------
.text:42CF6D4C
.text:42CF6D4C loc_42CF6D4C:                           ; CODE XREF: sub_42CF69B4+2F5\u2191j
.text:42CF6D4C                                         ; sub_42CF69B4+342\u2191j
.text:42CF6D4C                 mov     eax, 1
.text:42CF6D51
.text:42CF6D51 loc_42CF6D51:                           ; CODE XREF: sub_42CF69B4+45\u2191j
.text:42CF6D51                                         ; sub_42CF69B4+95\u2191j ...
.text:42CF6D51                 mov     esp, ebp
.text:42CF6D53                 pop     ebp
.text:42CF6D54                 retn
.text:42CF6D54 sub_42CF69B4    endp
.text:42CF6D54
.text:42CF6D55
.text:42CF6D55 ; =============== S U B R O U T I N E =======================================
.text:42CF6D55
.text:42CF6D55 ; Attributes: bp-based frame
.text:42CF6D55
.text:42CF6D55 sub_42CF6D55    proc near               ; CODE XREF: sub_42CF2424+B3\u2191p
.text:42CF6D55                                         ; sub_42CF24E5+92\u2191p ...
.text:42CF6D55
.text:42CF6D55 arg_0           = dword ptr  8
.text:42CF6D55
.text:42CF6D55                 push    ebp
.text:42CF6D56                 mov     ebp, esp
.text:42CF6D58                 mov     eax, [ebp+arg_0]
.text:42CF6D5B                 mov     ecx, dword_42D010D8
.text:42CF6D61                 mov     edx, [ecx+64h]
.text:42CF6D64                 mov     [eax+64h], edx
.text:42CF6D67                 mov     eax, [ebp+arg_0]
.text:42CF6D6A                 mov     dword ptr [eax+8Ch], 1
.text:42CF6D74                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF6D76                 mov     ecx, hSemaphore
.text:42CF6D7C                 push    ecx             ; hHandle
.text:42CF6D7D                 call    ds:WaitForSingleObject
.text:42CF6D83                 mov     edx, [ebp+arg_0]
.text:42CF6D86                 mov     CompletionKey, edx
.text:42CF6D8C                 mov     eax, hHandle
.text:42CF6D91                 push    eax             ; hEvent
.text:42CF6D92                 call    ds:SetEvent
.text:42CF6D98                 pop     ebp
.text:42CF6D99                 retn
.text:42CF6D99 sub_42CF6D55    endp
.text:42CF6D99
.text:42CF6D9A ; Exported entry  16. ConnectionInitialize
.text:42CF6D9A
.text:42CF6D9A ; =============== S U B R O U T I N E =======================================
.text:42CF6D9A
.text:42CF6D9A ; Attributes: bp-based frame
.text:42CF6D9A
.text:42CF6D9A                 public ConnectionInitialize
.text:42CF6D9A ConnectionInitialize proc near          ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF6D9A
.text:42CF6D9A arg_0           = dword ptr  8
.text:42CF6D9A arg_4           = dword ptr  0Ch
.text:42CF6D9A arg_8           = dword ptr  10h
.text:42CF6D9A
.text:42CF6D9A                 push    ebp
.text:42CF6D9B                 mov     ebp, esp
.text:42CF6D9D                 call    sub_42CFC1D0
.text:42CF6DA2                 test    eax, eax
.text:42CF6DA4                 jnz     short loc_42CF6DAA
.text:42CF6DA6                 xor     eax, eax
.text:42CF6DA8                 jmp     short loc_42CF6DDB
.text:42CF6DAA ; ---------------------------------------------------------------------------
.text:42CF6DAA
.text:42CF6DAA loc_42CF6DAA:                           ; CODE XREF: ConnectionInitialize+A\u2191j
.text:42CF6DAA                 mov     eax, [ebp+arg_0]
.text:42CF6DAD                 mov     dword ptr [eax], 1000h
.text:42CF6DB3                 mov     ecx, dword_42D020A0
.text:42CF6DB9                 add     ecx, 3
.text:42CF6DBC                 mov     edx, [ebp+arg_4]
.text:42CF6DBF                 mov     [edx], ecx
.text:42CF6DC1                 mov     eax, [ebp+arg_8]
.text:42CF6DC4                 mov     dword_42D01A18, eax
.text:42CF6DC9                 cmp     dword_42D01A18, 0
.text:42CF6DD0                 jnz     short loc_42CF6DD6
.text:42CF6DD2                 xor     eax, eax
.text:42CF6DD4                 jmp     short loc_42CF6DDB
.text:42CF6DD6 ; ---------------------------------------------------------------------------
.text:42CF6DD6
.text:42CF6DD6 loc_42CF6DD6:                           ; CODE XREF: ConnectionInitialize+36\u2191j
.text:42CF6DD6                 mov     eax, 1
.text:42CF6DDB
.text:42CF6DDB loc_42CF6DDB:                           ; CODE XREF: ConnectionInitialize+E\u2191j
.text:42CF6DDB                                         ; ConnectionInitialize+3A\u2191j
.text:42CF6DDB                 pop     ebp
.text:42CF6DDC                 retn
.text:42CF6DDC ConnectionInitialize endp
.text:42CF6DDC
.text:42CF6DDD ; Exported entry  17. ConnectionPreLogin
.text:42CF6DDD
.text:42CF6DDD ; =============== S U B R O U T I N E =======================================
.text:42CF6DDD
.text:42CF6DDD ; Attributes: bp-based frame
.text:42CF6DDD
.text:42CF6DDD ; int __cdecl ConnectionPreLogin(int, void *Src, size_t Size, void *, int)
.text:42CF6DDD                 public ConnectionPreLogin
.text:42CF6DDD ConnectionPreLogin proc near            ; DATA XREF: .rdata:off_42CFE9C8\u2193o
.text:42CF6DDD
.text:42CF6DDD var_4           = dword ptr -4
.text:42CF6DDD arg_0           = dword ptr  8
.text:42CF6DDD Src             = dword ptr  0Ch
.text:42CF6DDD Size            = dword ptr  10h
.text:42CF6DDD arg_C           = dword ptr  14h
.text:42CF6DDD arg_10          = dword ptr  18h
.text:42CF6DDD
.text:42CF6DDD                 push    ebp
.text:42CF6DDE                 mov     ebp, esp
.text:42CF6DE0                 push    ecx
.text:42CF6DE1                 mov     eax, [ebp+arg_0]
.text:42CF6DE4                 mov     ecx, [eax+94h]
.text:42CF6DEA                 mov     [ebp+var_4], ecx
.text:42CF6DED                 cmp     [ebp+var_4], 1
.text:42CF6DF1                 jz      short loc_42CF6E01
.text:42CF6DF3                 cmp     [ebp+var_4], 1
.text:42CF6DF7                 jle     short loc_42CF6E3D
.text:42CF6DF9                 cmp     [ebp+var_4], 3
.text:42CF6DFD                 jle     short loc_42CF6E1F
.text:42CF6DFF                 jmp     short loc_42CF6E3D
.text:42CF6E01 ; ---------------------------------------------------------------------------
.text:42CF6E01
.text:42CF6E01 loc_42CF6E01:                           ; CODE XREF: ConnectionPreLogin+14\u2191j
.text:42CF6E01                 mov     edx, [ebp+arg_10]
.text:42CF6E04                 push    edx             ; int
.text:42CF6E05                 mov     eax, [ebp+arg_C]
.text:42CF6E08                 push    eax             ; void *
.text:42CF6E09                 mov     ecx, [ebp+Size]
.text:42CF6E0C                 push    ecx             ; int
.text:42CF6E0D                 mov     edx, [ebp+Src]
.text:42CF6E10                 push    edx             ; int
.text:42CF6E11                 mov     eax, [ebp+arg_0]
.text:42CF6E14                 push    eax             ; int
.text:42CF6E15                 call    sub_42CF6E4F
.text:42CF6E1A                 add     esp, 14h
.text:42CF6E1D                 jmp     short loc_42CF6E4B
.text:42CF6E1F ; ---------------------------------------------------------------------------
.text:42CF6E1F
.text:42CF6E1F loc_42CF6E1F:                           ; CODE XREF: ConnectionPreLogin+20\u2191j
.text:42CF6E1F                 mov     ecx, [ebp+arg_10]
.text:42CF6E22                 push    ecx             ; int
.text:42CF6E23                 mov     edx, [ebp+arg_C]
.text:42CF6E26                 push    edx             ; void *
.text:42CF6E27                 mov     eax, [ebp+Size]
.text:42CF6E2A                 push    eax             ; Size
.text:42CF6E2B                 mov     ecx, [ebp+Src]
.text:42CF6E2E                 push    ecx             ; Src
.text:42CF6E2F                 mov     edx, [ebp+arg_0]
.text:42CF6E32                 push    edx             ; int
.text:42CF6E33                 call    sub_42CF7275
.text:42CF6E38                 add     esp, 14h
.text:42CF6E3B                 jmp     short loc_42CF6E4B
.text:42CF6E3D ; ---------------------------------------------------------------------------
.text:42CF6E3D
.text:42CF6E3D loc_42CF6E3D:                           ; CODE XREF: ConnectionPreLogin+1A\u2191j
.text:42CF6E3D                                         ; ConnectionPreLogin+22\u2191j
.text:42CF6E3D                 mov     eax, [ebp+arg_10]
.text:42CF6E40                 mov     dword ptr [eax], 0
.text:42CF6E46                 mov     eax, 3
.text:42CF6E4B
.text:42CF6E4B loc_42CF6E4B:                           ; CODE XREF: ConnectionPreLogin+40\u2191j
.text:42CF6E4B                                         ; ConnectionPreLogin+5E\u2191j
.text:42CF6E4B                 mov     esp, ebp
.text:42CF6E4D                 pop     ebp
.text:42CF6E4E                 retn
.text:42CF6E4E ConnectionPreLogin endp
.text:42CF6E4E
.text:42CF6E4F
.text:42CF6E4F ; =============== S U B R O U T I N E =======================================
.text:42CF6E4F
.text:42CF6E4F ; Attributes: bp-based frame
.text:42CF6E4F
.text:42CF6E4F ; int __cdecl sub_42CF6E4F(int, int, int, void *, int)
.text:42CF6E4F sub_42CF6E4F    proc near               ; CODE XREF: ConnectionPreLogin+38\u2191p
.text:42CF6E4F
.text:42CF6E4F var_234         = dword ptr -234h
.text:42CF6E4F var_230         = dword ptr -230h
.text:42CF6E4F var_22C         = dword ptr -22Ch
.text:42CF6E4F var_228         = dword ptr -228h
.text:42CF6E4F var_224         = dword ptr -224h
.text:42CF6E4F var_220         = dword ptr -220h
.text:42CF6E4F var_21C         = dword ptr -21Ch
.text:42CF6E4F var_218         = dword ptr -218h
.text:42CF6E4F Destination     = byte ptr -214h
.text:42CF6E4F var_14          = dword ptr -14h
.text:42CF6E4F Src             = byte ptr -10h
.text:42CF6E4F var_C           = word ptr -0Ch
.text:42CF6E4F var_A           = byte ptr -0Ah
.text:42CF6E4F var_9           = byte ptr -9
.text:42CF6E4F var_8           = dword ptr -8
.text:42CF6E4F var_4           = dword ptr -4
.text:42CF6E4F arg_0           = dword ptr  8
.text:42CF6E4F arg_4           = dword ptr  0Ch
.text:42CF6E4F arg_C           = dword ptr  14h
.text:42CF6E4F arg_10          = dword ptr  18h
.text:42CF6E4F
.text:42CF6E4F                 push    ebp
.text:42CF6E50                 mov     ebp, esp
.text:42CF6E52                 sub     esp, 234h
.text:42CF6E58                 mov     [ebp+var_8], 0
.text:42CF6E5F                 mov     [ebp+var_4], 0
.text:42CF6E66                 mov     [ebp+var_14], 0
.text:42CF6E6D                 mov     [ebp+var_21C], 0
.text:42CF6E77                 mov     [ebp+var_218], 15h
.text:42CF6E81                 push    0               ; Size
.text:42CF6E83                 mov     eax, [ebp+arg_10]
.text:42CF6E86                 mov     ecx, [eax]
.text:42CF6E88                 push    ecx             ; Val
.text:42CF6E89                 mov     edx, [ebp+arg_C]
.text:42CF6E8C                 push    edx             ; void *
.text:42CF6E8D                 call    memset
.text:42CF6E92                 add     esp, 0Ch
.text:42CF6E95                 mov     eax, [ebp+arg_4]
.text:42CF6E98                 xor     ecx, ecx
.text:42CF6E9A                 mov     cl, [eax]
.text:42CF6E9C                 test    ecx, ecx
.text:42CF6E9E                 jz      short loc_42CF6EB3
.text:42CF6EA0                 mov     edx, [ebp+arg_10]
.text:42CF6EA3                 mov     dword ptr [edx], 0
.text:42CF6EA9                 mov     eax, 3
.text:42CF6EAE                 jmp     loc_42CF7271
.text:42CF6EB3 ; ---------------------------------------------------------------------------
.text:42CF6EB3
.text:42CF6EB3 loc_42CF6EB3:                           ; CODE XREF: sub_42CF6E4F+4F\u2191j
.text:42CF6EB3                 mov     eax, [ebp+arg_0]
.text:42CF6EB6                 mov     ecx, dword_42D01DFC
.text:42CF6EBC                 mov     [eax+68h], ecx
.text:42CF6EBF                 lea     edx, [ebp+Src]
.text:42CF6EC2                 mov     [ebp+var_220], edx
.text:42CF6EC8                 push    80000C2h        ; hostlong
.text:42CF6ECD                 call    ds:htonl
.text:42CF6ED3                 mov     ecx, [ebp+var_220]
.text:42CF6ED9                 mov     [ecx], eax
.text:42CF6EDB                 mov     [ebp+var_C], 0
.text:42CF6EE1
.text:42CF6EE1 loc_42CF6EE1:                           ; CODE XREF: sub_42CF6E4F+21E\u2193j
.text:42CF6EE1                 cmp     [ebp+var_14], 0FFh
.text:42CF6EE8                 jz      loc_42CF7072
.text:42CF6EEE                 mov     edx, [ebp+arg_4]
.text:42CF6EF1                 add     edx, [ebp+var_4]
.text:42CF6EF4                 xor     eax, eax
.text:42CF6EF6                 mov     al, [edx]
.text:42CF6EF8                 mov     [ebp+var_14], eax
.text:42CF6EFB                 mov     ecx, [ebp+arg_4]
.text:42CF6EFE                 add     ecx, [ebp+var_4]
.text:42CF6F01                 xor     edx, edx
.text:42CF6F03                 mov     dl, [ecx+1]
.text:42CF6F06                 shl     edx, 8
.text:42CF6F09                 mov     eax, [ebp+arg_4]
.text:42CF6F0C                 add     eax, [ebp+var_4]
.text:42CF6F0F                 xor     ecx, ecx
.text:42CF6F11                 mov     cl, [eax+2]
.text:42CF6F14                 add     edx, ecx
.text:42CF6F16                 mov     [ebp+var_218], edx
.text:42CF6F1C                 mov     edx, [ebp+var_14]
.text:42CF6F1F                 mov     [ebp+var_230], edx
.text:42CF6F25                 cmp     [ebp+var_230], 1
.text:42CF6F2C                 jz      loc_42CF6FC4
.text:42CF6F32                 cmp     [ebp+var_230], 2
.text:42CF6F39                 jz      short loc_42CF6F49
.text:42CF6F3B                 cmp     [ebp+var_230], 3
.text:42CF6F42                 jz      short loc_42CF6FA2
.text:42CF6F44                 jmp     loc_42CF7064
.text:42CF6F49 ; ---------------------------------------------------------------------------
.text:42CF6F49
.text:42CF6F49 loc_42CF6F49:                           ; CODE XREF: sub_42CF6E4F+EA\u2191j
.text:42CF6F49                 mov     eax, [ebp+arg_4]
.text:42CF6F4C                 add     eax, [ebp+var_218]
.text:42CF6F52                 push    eax             ; Source
.text:42CF6F53                 lea     ecx, [ebp+Destination]
.text:42CF6F59                 push    ecx             ; Destination
.text:42CF6F5A                 call    strcpy
.text:42CF6F5F                 add     esp, 8
.text:42CF6F62                 push    offset byte_42D01104 ; Str2
.text:42CF6F67                 lea     edx, [ebp+Destination]
.text:42CF6F6D                 push    edx             ; Str1
.text:42CF6F6E                 call    strcmp
.text:42CF6F73                 add     esp, 8
.text:42CF6F76                 test    eax, eax
.text:42CF6F78                 jz      short loc_42CF6F99
.text:42CF6F7A                 push    offset MultiByteStr ; String2
.text:42CF6F7F                 lea     eax, [ebp+Destination]
.text:42CF6F85                 push    eax             ; String1
.text:42CF6F86                 call    ds:_stricmp
.text:42CF6F8C                 add     esp, 8
.text:42CF6F8F                 test    eax, eax
.text:42CF6F91                 jz      short loc_42CF6F99
.text:42CF6F93                 mov     [ebp+var_9], 1
.text:42CF6F97                 jmp     short loc_42CF6F9D
.text:42CF6F99 ; ---------------------------------------------------------------------------
.text:42CF6F99
.text:42CF6F99 loc_42CF6F99:                           ; CODE XREF: sub_42CF6E4F+129\u2191j
.text:42CF6F99                                         ; sub_42CF6E4F+142\u2191j
.text:42CF6F99                 mov     [ebp+var_9], 0
.text:42CF6F9D
.text:42CF6F9D loc_42CF6F9D:                           ; CODE XREF: sub_42CF6E4F+148\u2191j
.text:42CF6F9D                 jmp     loc_42CF7064
.text:42CF6FA2 ; ---------------------------------------------------------------------------
.text:42CF6FA2
.text:42CF6FA2 loc_42CF6FA2:                           ; CODE XREF: sub_42CF6E4F+F3\u2191j
.text:42CF6FA2                 mov     ecx, [ebp+arg_4]
.text:42CF6FA5                 add     ecx, [ebp+var_218]
.text:42CF6FAB                 mov     [ebp+var_224], ecx
.text:42CF6FB1                 mov     edx, [ebp+arg_0]
.text:42CF6FB4                 mov     eax, [ebp+var_224]
.text:42CF6FBA                 mov     ecx, [eax]
.text:42CF6FBC                 mov     [edx+4], ecx
.text:42CF6FBF                 jmp     loc_42CF7064
.text:42CF6FC4 ; ---------------------------------------------------------------------------
.text:42CF6FC4
.text:42CF6FC4 loc_42CF6FC4:                           ; CODE XREF: sub_42CF6E4F+DD\u2191j
.text:42CF6FC4                 mov     edx, [ebp+arg_4]
.text:42CF6FC7                 add     edx, [ebp+var_218]
.text:42CF6FCD                 xor     eax, eax
.text:42CF6FCF                 mov     al, [edx]
.text:42CF6FD1                 test    eax, eax
.text:42CF6FD3                 jnz     short loc_42CF6FF9
.text:42CF6FD5                 mov     ecx, [ebp+arg_0]
.text:42CF6FD8                 cmp     dword ptr [ecx+64h], 1
.text:42CF6FDC                 jnz     short loc_42CF6FE4
.text:42CF6FDE                 mov     [ebp+var_A], 3
.text:42CF6FE2                 jmp     short loc_42CF6FF7
.text:42CF6FE4 ; ---------------------------------------------------------------------------
.text:42CF6FE4
.text:42CF6FE4 loc_42CF6FE4:                           ; CODE XREF: sub_42CF6E4F+18D\u2191j
.text:42CF6FE4                 cmp     dword_42D01DFC, 0
.text:42CF6FEB                 jnz     short loc_42CF6FF3
.text:42CF6FED                 mov     [ebp+var_A], 2
.text:42CF6FF1                 jmp     short loc_42CF6FF7
.text:42CF6FF3 ; ---------------------------------------------------------------------------
.text:42CF6FF3
.text:42CF6FF3 loc_42CF6FF3:                           ; CODE XREF: sub_42CF6E4F+19C\u2191j
.text:42CF6FF3                 mov     [ebp+var_A], 0
.text:42CF6FF7
.text:42CF6FF7 loc_42CF6FF7:                           ; CODE XREF: sub_42CF6E4F+193\u2191j
.text:42CF6FF7                                         ; sub_42CF6E4F+1A2\u2191j
.text:42CF6FF7                 jmp     short loc_42CF7064
.text:42CF6FF9 ; ---------------------------------------------------------------------------
.text:42CF6FF9
.text:42CF6FF9 loc_42CF6FF9:                           ; CODE XREF: sub_42CF6E4F+184\u2191j
.text:42CF6FF9                 mov     edx, [ebp+arg_4]
.text:42CF6FFC                 add     edx, [ebp+var_218]
.text:42CF7002                 xor     eax, eax
.text:42CF7004                 mov     al, [edx]
.text:42CF7006                 cmp     eax, 2
.text:42CF7009                 jnz     short loc_42CF7031
.text:42CF700B                 mov     ecx, [ebp+arg_0]
.text:42CF700E                 cmp     dword ptr [ecx+64h], 1
.text:42CF7012                 jnz     short loc_42CF7021
.text:42CF7014                 mov     [ebp+var_A], 3
.text:42CF7018                 mov     [ebp+var_8], 1
.text:42CF701F                 jmp     short loc_42CF702F
.text:42CF7021 ; ---------------------------------------------------------------------------
.text:42CF7021
.text:42CF7021 loc_42CF7021:                           ; CODE XREF: sub_42CF6E4F+1C3\u2191j
.text:42CF7021                 mov     edx, [ebp+arg_0]
.text:42CF7024                 mov     dword ptr [edx+68h], 0
.text:42CF702B                 mov     [ebp+var_A], 2
.text:42CF702F
.text:42CF702F loc_42CF702F:                           ; CODE XREF: sub_42CF6E4F+1D0\u2191j
.text:42CF702F                 jmp     short loc_42CF7064
.text:42CF7031 ; ---------------------------------------------------------------------------
.text:42CF7031
.text:42CF7031 loc_42CF7031:                           ; CODE XREF: sub_42CF6E4F+1BA\u2191j
.text:42CF7031                 mov     eax, [ebp+arg_0]
.text:42CF7034                 cmp     dword ptr [eax+64h], 1
.text:42CF7038                 jnz     short loc_42CF7040
.text:42CF703A                 mov     [ebp+var_A], 1
.text:42CF703E                 jmp     short loc_42CF7064
.text:42CF7040 ; ---------------------------------------------------------------------------
.text:42CF7040
.text:42CF7040 loc_42CF7040:                           ; CODE XREF: sub_42CF6E4F+1E9\u2191j
.text:42CF7040                 cmp     dword_42D01DFC, 1
.text:42CF7047                 jnz     short loc_42CF7059
.text:42CF7049                 mov     ecx, [ebp+arg_0]
.text:42CF704C                 mov     dword ptr [ecx+64h], 1
.text:42CF7053                 mov     [ebp+var_A], 1
.text:42CF7057                 jmp     short loc_42CF7064
.text:42CF7059 ; ---------------------------------------------------------------------------
.text:42CF7059
.text:42CF7059 loc_42CF7059:                           ; CODE XREF: sub_42CF6E4F+1F8\u2191j
.text:42CF7059                 mov     [ebp+var_A], 2
.text:42CF705D                 mov     [ebp+var_8], 1
.text:42CF7064
.text:42CF7064 loc_42CF7064:                           ; CODE XREF: sub_42CF6E4F+F5\u2191j
.text:42CF7064                                         ; sub_42CF6E4F:loc_42CF6F9D\u2191j ...
.text:42CF7064                 mov     edx, [ebp+var_4]
.text:42CF7067                 add     edx, 5
.text:42CF706A                 mov     [ebp+var_4], edx
.text:42CF706D                 jmp     loc_42CF6EE1
.text:42CF7072 ; ---------------------------------------------------------------------------
.text:42CF7072
.text:42CF7072 loc_42CF7072:                           ; CODE XREF: sub_42CF6E4F+99\u2191j
.text:42CF7072                 mov     [ebp+var_228], 0
.text:42CF707C                 mov     [ebp+var_218], 15h
.text:42CF7086
.text:42CF7086 loc_42CF7086:                           ; CODE XREF: sub_42CF6E4F+3C2\u2193j
.text:42CF7086                 cmp     [ebp+var_228], 4
.text:42CF708D                 jz      loc_42CF7216
.text:42CF7093                 mov     [ebp+var_22C], 0
.text:42CF709D                 mov     eax, [ebp+arg_C]
.text:42CF70A0                 add     eax, [ebp+var_21C]
.text:42CF70A6                 mov     cl, byte ptr [ebp+var_228]
.text:42CF70AC                 mov     [eax], cl
.text:42CF70AE                 mov     eax, [ebp+var_218]
.text:42CF70B4                 cdq
.text:42CF70B5                 and     edx, 0FFh
.text:42CF70BB                 add     eax, edx
.text:42CF70BD                 sar     eax, 8
.text:42CF70C0                 mov     edx, [ebp+arg_C]
.text:42CF70C3                 add     edx, [ebp+var_21C]
.text:42CF70C9                 mov     [edx+1], al
.text:42CF70CC                 mov     eax, [ebp+var_218]
.text:42CF70D2                 and     eax, 800000FFh
.text:42CF70D7                 jns     short loc_42CF70E0
.text:42CF70D9                 dec     eax
.text:42CF70DA                 or      eax, 0FFFFFF00h
.text:42CF70DF                 inc     eax
.text:42CF70E0
.text:42CF70E0 loc_42CF70E0:                           ; CODE XREF: sub_42CF6E4F+288\u2191j
.text:42CF70E0                 mov     ecx, [ebp+arg_C]
.text:42CF70E3                 add     ecx, [ebp+var_21C]
.text:42CF70E9                 mov     [ecx+2], al
.text:42CF70EC                 mov     edx, [ebp+var_228]
.text:42CF70F2                 mov     [ebp+var_234], edx
.text:42CF70F8                 cmp     [ebp+var_234], 0
.text:42CF70FF                 jz      short loc_42CF7118
.text:42CF7101                 cmp     [ebp+var_234], 1
.text:42CF7108                 jz      short loc_42CF716B
.text:42CF710A                 cmp     [ebp+var_234], 2
.text:42CF7111                 jz      short loc_42CF718F
.text:42CF7113                 jmp     loc_42CF71B1
.text:42CF7118 ; ---------------------------------------------------------------------------
.text:42CF7118
.text:42CF7118 loc_42CF7118:                           ; CODE XREF: sub_42CF6E4F+2B0\u2191j
.text:42CF7118                 push    4               ; Size
.text:42CF711A                 lea     eax, [ebp+Src]
.text:42CF711D                 push    eax             ; Src
.text:42CF711E                 mov     ecx, [ebp+arg_C]
.text:42CF7121                 add     ecx, [ebp+var_218]
.text:42CF7127                 push    ecx             ; void *
.text:42CF7128                 call    memcpy
.text:42CF712D                 add     esp, 0Ch
.text:42CF7130                 mov     [ebp+var_22C], 4
.text:42CF713A                 push    2               ; Size
.text:42CF713C                 lea     edx, [ebp+var_C]
.text:42CF713F                 push    edx             ; Src
.text:42CF7140                 mov     eax, [ebp+var_218]
.text:42CF7146                 add     eax, [ebp+var_22C]
.text:42CF714C                 mov     ecx, [ebp+arg_C]
.text:42CF714F                 add     ecx, eax
.text:42CF7151                 push    ecx             ; void *
.text:42CF7152                 call    memcpy
.text:42CF7157                 add     esp, 0Ch
.text:42CF715A                 mov     edx, [ebp+var_22C]
.text:42CF7160                 add     edx, 2
.text:42CF7163                 mov     [ebp+var_22C], edx
.text:42CF7169                 jmp     short loc_42CF71B1
.text:42CF716B ; ---------------------------------------------------------------------------
.text:42CF716B
.text:42CF716B loc_42CF716B:                           ; CODE XREF: sub_42CF6E4F+2B9\u2191j
.text:42CF716B                 push    1               ; Size
.text:42CF716D                 lea     eax, [ebp+var_A]
.text:42CF7170                 push    eax             ; Src
.text:42CF7171                 mov     ecx, [ebp+arg_C]
.text:42CF7174                 add     ecx, [ebp+var_218]
.text:42CF717A                 push    ecx             ; void *
.text:42CF717B                 call    memcpy
.text:42CF7180                 add     esp, 0Ch
.text:42CF7183                 mov     [ebp+var_22C], 1
.text:42CF718D                 jmp     short loc_42CF71B1
.text:42CF718F ; ---------------------------------------------------------------------------
.text:42CF718F
.text:42CF718F loc_42CF718F:                           ; CODE XREF: sub_42CF6E4F+2C2\u2191j
.text:42CF718F                 push    1               ; Size
.text:42CF7191                 lea     edx, [ebp+var_9]
.text:42CF7194                 push    edx             ; Src
.text:42CF7195                 mov     eax, [ebp+arg_C]
.text:42CF7198                 add     eax, [ebp+var_218]
.text:42CF719E                 push    eax             ; void *
.text:42CF719F                 call    memcpy
.text:42CF71A4                 add     esp, 0Ch
.text:42CF71A7                 mov     [ebp+var_22C], 1
.text:42CF71B1
.text:42CF71B1 loc_42CF71B1:                           ; CODE XREF: sub_42CF6E4F+2C4\u2191j
.text:42CF71B1                                         ; sub_42CF6E4F+31A\u2191j ...
.text:42CF71B1                 mov     ecx, [ebp+var_218]
.text:42CF71B7                 add     ecx, [ebp+var_22C]
.text:42CF71BD                 mov     [ebp+var_218], ecx
.text:42CF71C3                 mov     edx, [ebp+var_22C]
.text:42CF71C9                 shr     edx, 8
.text:42CF71CC                 mov     eax, [ebp+arg_C]
.text:42CF71CF                 add     eax, [ebp+var_21C]
.text:42CF71D5                 mov     [eax+3], dl
.text:42CF71D8                 mov     eax, [ebp+var_22C]
.text:42CF71DE                 xor     edx, edx
.text:42CF71E0                 mov     ecx, 100h
.text:42CF71E5                 div     ecx
.text:42CF71E7                 mov     eax, [ebp+arg_C]
.text:42CF71EA                 add     eax, [ebp+var_21C]
.text:42CF71F0                 mov     [eax+4], dl
.text:42CF71F3                 mov     ecx, [ebp+var_228]
.text:42CF71F9                 add     ecx, 1
.text:42CF71FC                 mov     [ebp+var_228], ecx
.text:42CF7202                 mov     edx, [ebp+var_21C]
.text:42CF7208                 add     edx, 5
.text:42CF720B                 mov     [ebp+var_21C], edx
.text:42CF7211                 jmp     loc_42CF7086
.text:42CF7216 ; ---------------------------------------------------------------------------
.text:42CF7216
.text:42CF7216 loc_42CF7216:                           ; CODE XREF: sub_42CF6E4F+23E\u2191j
.text:42CF7216                 mov     eax, [ebp+arg_C]
.text:42CF7219                 add     eax, [ebp+var_21C]
.text:42CF721F                 mov     byte ptr [eax], 0FFh
.text:42CF7222                 mov     ecx, [ebp+arg_10]
.text:42CF7225                 mov     edx, [ebp+var_218]
.text:42CF722B                 mov     [ecx], edx
.text:42CF722D                 mov     eax, [ebp+arg_0]
.text:42CF7230                 cmp     dword ptr [eax+68h], 0
.text:42CF7234                 jz      short loc_42CF7245
.text:42CF7236                 mov     ecx, [ebp+arg_0]
.text:42CF7239                 mov     dword ptr [ecx+94h], 2
.text:42CF7243                 jmp     short loc_42CF7252
.text:42CF7245 ; ---------------------------------------------------------------------------
.text:42CF7245
.text:42CF7245 loc_42CF7245:                           ; CODE XREF: sub_42CF6E4F+3E5\u2191j
.text:42CF7245                 mov     edx, [ebp+arg_0]
.text:42CF7248                 mov     dword ptr [edx+94h], 4
.text:42CF7252
.text:42CF7252 loc_42CF7252:                           ; CODE XREF: sub_42CF6E4F+3F4\u2191j
.text:42CF7252                 cmp     [ebp+var_8], 0
.text:42CF7256                 jnz     short loc_42CF726C
.text:42CF7258                 mov     eax, [ebp+arg_0]
.text:42CF725B                 cmp     dword ptr [eax+68h], 0
.text:42CF725F                 jz      short loc_42CF7268
.text:42CF7261                 mov     eax, 1
.text:42CF7266                 jmp     short loc_42CF7271
.text:42CF7268 ; ---------------------------------------------------------------------------
.text:42CF7268
.text:42CF7268 loc_42CF7268:                           ; CODE XREF: sub_42CF6E4F+410\u2191j
.text:42CF7268                 xor     eax, eax
.text:42CF726A                 jmp     short loc_42CF7271
.text:42CF726C ; ---------------------------------------------------------------------------
.text:42CF726C
.text:42CF726C loc_42CF726C:                           ; CODE XREF: sub_42CF6E4F+407\u2191j
.text:42CF726C                 mov     eax, 3
.text:42CF7271
.text:42CF7271 loc_42CF7271:                           ; CODE XREF: sub_42CF6E4F+5F\u2191j
.text:42CF7271                                         ; sub_42CF6E4F+417\u2191j ...
.text:42CF7271                 mov     esp, ebp
.text:42CF7273                 pop     ebp
.text:42CF7274                 retn
.text:42CF7274 sub_42CF6E4F    endp
.text:42CF7274
.text:42CF7275
.text:42CF7275 ; =============== S U B R O U T I N E =======================================
.text:42CF7275
.text:42CF7275 ; Attributes: bp-based frame
.text:42CF7275
.text:42CF7275 ; int __cdecl sub_42CF7275(int, void *Src, size_t Size, void *, int)
.text:42CF7275 sub_42CF7275    proc near               ; CODE XREF: ConnectionPreLogin+56\u2191p
.text:42CF7275
.text:42CF7275 var_4           = dword ptr -4
.text:42CF7275 arg_0           = dword ptr  8
.text:42CF7275 Src             = dword ptr  0Ch
.text:42CF7275 Size            = dword ptr  10h
.text:42CF7275 arg_C           = dword ptr  14h
.text:42CF7275 arg_10          = dword ptr  18h
.text:42CF7275
.text:42CF7275                 push    ebp
.text:42CF7276                 mov     ebp, esp
.text:42CF7278                 push    ecx
.text:42CF7279                 mov     eax, [ebp+arg_0]
.text:42CF727C                 mov     dword ptr [eax+6Ch], 1
.text:42CF7283                 mov     ecx, [ebp+arg_0]
.text:42CF7286                 cmp     dword ptr [ecx+94h], 2
.text:42CF728D                 jnz     loc_42CF7395
.text:42CF7293                 push    1               ; Size
.text:42CF7295                 push    68h ; 'h'       ; Count
.text:42CF7297                 call    ds:calloc
.text:42CF729D                 add     esp, 8
.text:42CF72A0                 mov     edx, [ebp+arg_0]
.text:42CF72A3                 mov     [edx+9Ch], eax
.text:42CF72A9                 mov     eax, [ebp+arg_0]
.text:42CF72AC                 mov     dword ptr [eax+54h], 0
.text:42CF72B3                 mov     ecx, [ebp+arg_0]
.text:42CF72B6                 mov     dword ptr [ecx+58h], 0
.text:42CF72BD                 mov     edx, [ebp+arg_0]
.text:42CF72C0                 mov     eax, [edx+9Ch]
.text:42CF72C6                 mov     dword ptr [eax+1Ch], 1
.text:42CF72CD                 mov     ecx, [ebp+arg_0]
.text:42CF72D0                 mov     edx, [ecx+9Ch]
.text:42CF72D6                 add     edx, 3Ch ; '<'
.text:42CF72D9                 mov     eax, [ebp+arg_0]
.text:42CF72DC                 mov     ecx, [eax+9Ch]
.text:42CF72E2                 mov     [ecx+20h], edx
.text:42CF72E5                 mov     edx, [ebp+arg_0]
.text:42CF72E8                 mov     eax, [edx+9Ch]
.text:42CF72EE                 mov     dword ptr [eax+18h], 0
.text:42CF72F5                 mov     ecx, [ebp+arg_0]
.text:42CF72F8                 mov     edx, [ecx+9Ch]
.text:42CF72FE                 mov     dword ptr [edx+8], 90312h
.text:42CF7305                 mov     eax, [ebp+arg_0]
.text:42CF7308                 mov     ecx, [eax+9Ch]
.text:42CF730E                 mov     dword ptr [ecx+48h], 1
.text:42CF7315                 mov     edx, [ebp+arg_0]
.text:42CF7318                 mov     eax, [edx+9Ch]
.text:42CF731E                 mov     dword ptr [eax+50h], 0
.text:42CF7325                 mov     ecx, dword_42D01B44
.text:42CF732B                 push    ecx             ; Size
.text:42CF732C                 call    ds:malloc
.text:42CF7332                 add     esp, 4
.text:42CF7335                 mov     edx, [ebp+arg_0]
.text:42CF7338                 mov     ecx, [edx+9Ch]
.text:42CF733E                 mov     [ecx+4Ch], eax
.text:42CF7341                 mov     edx, dword_42D01B44
.text:42CF7347                 push    edx             ; Size
.text:42CF7348                 call    ds:malloc
.text:42CF734E                 add     esp, 4
.text:42CF7351                 mov     ecx, [ebp+arg_0]
.text:42CF7354                 mov     edx, [ecx+9Ch]
.text:42CF735A                 mov     [edx+5Ch], eax
.text:42CF735D                 mov     eax, [ebp+arg_0]
.text:42CF7360                 mov     ecx, [eax+9Ch]
.text:42CF7366                 mov     dword ptr [ecx+54h], 1811Ch
.text:42CF736D                 mov     edx, [ebp+arg_0]
.text:42CF7370                 mov     eax, [edx+9Ch]
.text:42CF7376                 mov     ecx, [eax+54h]
.text:42CF7379                 or      ecx, 20h
.text:42CF737C                 mov     edx, [ebp+arg_0]
.text:42CF737F                 mov     eax, [edx+9Ch]
.text:42CF7385                 mov     [eax+54h], ecx
.text:42CF7388                 mov     ecx, [ebp+arg_0]
.text:42CF738B                 mov     dword ptr [ecx+94h], 3
.text:42CF7395
.text:42CF7395 loc_42CF7395:                           ; CODE XREF: sub_42CF7275+18\u2191j
.text:42CF7395                 mov     edx, [ebp+arg_0]
.text:42CF7398                 mov     eax, [edx+9Ch]
.text:42CF739E                 cmp     dword ptr [eax+60h], 0
.text:42CF73A2                 jbe     loc_42CF747C
.text:42CF73A8                 mov     ecx, [ebp+arg_0]
.text:42CF73AB                 mov     edx, [ecx+9Ch]
.text:42CF73B1                 mov     eax, [ebp+arg_10]
.text:42CF73B4                 mov     ecx, [edx+60h]
.text:42CF73B7                 cmp     ecx, [eax]
.text:42CF73B9                 jbe     short loc_42CF7435
.text:42CF73BB                 mov     edx, [ebp+arg_10]
.text:42CF73BE                 mov     eax, [edx]
.text:42CF73C0                 push    eax             ; Size
.text:42CF73C1                 mov     ecx, [ebp+arg_0]
.text:42CF73C4                 mov     edx, [ecx+9Ch]
.text:42CF73CA                 mov     eax, [edx+5Ch]
.text:42CF73CD                 push    eax             ; Src
.text:42CF73CE                 mov     ecx, [ebp+arg_C]
.text:42CF73D1                 push    ecx             ; void *
.text:42CF73D2                 call    memcpy
.text:42CF73D7                 add     esp, 0Ch
.text:42CF73DA                 mov     edx, [ebp+arg_0]
.text:42CF73DD                 mov     eax, [edx+9Ch]
.text:42CF73E3                 mov     ecx, [ebp+arg_10]
.text:42CF73E6                 mov     edx, [eax+60h]
.text:42CF73E9                 sub     edx, [ecx]
.text:42CF73EB                 mov     eax, [ebp+arg_0]
.text:42CF73EE                 mov     ecx, [eax+9Ch]
.text:42CF73F4                 mov     [ecx+60h], edx
.text:42CF73F7                 mov     edx, [ebp+arg_0]
.text:42CF73FA                 mov     eax, [edx+9Ch]
.text:42CF7400                 mov     ecx, [eax+60h]
.text:42CF7403                 push    ecx             ; Size
.text:42CF7404                 mov     edx, [ebp+arg_0]
.text:42CF7407                 mov     eax, [edx+9Ch]
.text:42CF740D                 mov     ecx, [eax+5Ch]
.text:42CF7410                 mov     edx, [ebp+arg_10]
.text:42CF7413                 add     ecx, [edx]
.text:42CF7415                 push    ecx             ; Src
.text:42CF7416                 mov     eax, [ebp+arg_0]
.text:42CF7419                 mov     ecx, [eax+9Ch]
.text:42CF741F                 mov     edx, [ecx+5Ch]
.text:42CF7422                 push    edx             ; void *
.text:42CF7423                 call    memcpy
.text:42CF7428                 add     esp, 0Ch
.text:42CF742B                 mov     eax, 2
.text:42CF7430                 jmp     loc_42CF75B8
.text:42CF7435 ; ---------------------------------------------------------------------------
.text:42CF7435
.text:42CF7435 loc_42CF7435:                           ; CODE XREF: sub_42CF7275+144\u2191j
.text:42CF7435                 mov     eax, [ebp+arg_0]
.text:42CF7438                 mov     ecx, [eax+9Ch]
.text:42CF743E                 mov     edx, [ebp+arg_10]
.text:42CF7441                 mov     eax, [ecx+60h]
.text:42CF7444                 mov     [edx], eax
.text:42CF7446                 mov     ecx, [ebp+arg_10]
.text:42CF7449                 mov     edx, [ecx]
.text:42CF744B                 push    edx             ; Size
.text:42CF744C                 mov     eax, [ebp+arg_0]
.text:42CF744F                 mov     ecx, [eax+9Ch]
.text:42CF7455                 mov     edx, [ecx+5Ch]
.text:42CF7458                 push    edx             ; Src
.text:42CF7459                 mov     eax, [ebp+arg_C]
.text:42CF745C                 push    eax             ; void *
.text:42CF745D                 call    memcpy
.text:42CF7462                 add     esp, 0Ch
.text:42CF7465                 mov     ecx, [ebp+arg_0]
.text:42CF7468                 mov     edx, [ecx+9Ch]
.text:42CF746E                 mov     dword ptr [edx+60h], 0
.text:42CF7475                 xor     eax, eax
.text:42CF7477                 jmp     loc_42CF75B8
.text:42CF747C ; ---------------------------------------------------------------------------
.text:42CF747C
.text:42CF747C loc_42CF747C:                           ; CODE XREF: sub_42CF7275+12D\u2191j
.text:42CF747C                 mov     eax, [ebp+Size]
.text:42CF747F                 push    eax             ; Size
.text:42CF7480                 mov     ecx, [ebp+Src]
.text:42CF7483                 push    ecx             ; Src
.text:42CF7484                 mov     edx, [ebp+arg_0]
.text:42CF7487                 mov     eax, [edx+9Ch]
.text:42CF748D                 mov     ecx, [eax+4Ch]
.text:42CF7490                 push    ecx             ; void *
.text:42CF7491                 call    memcpy
.text:42CF7496                 add     esp, 0Ch
.text:42CF7499                 mov     edx, [ebp+arg_0]
.text:42CF749C                 mov     eax, [edx+9Ch]
.text:42CF74A2                 mov     ecx, [ebp+Size]
.text:42CF74A5                 mov     [eax+50h], ecx
.text:42CF74A8                 mov     edx, [ebp+arg_10]
.text:42CF74AB                 push    edx             ; int
.text:42CF74AC                 mov     eax, [ebp+arg_C]
.text:42CF74AF                 push    eax             ; void *
.text:42CF74B0                 push    offset unk_42D01DC8 ; int
.text:42CF74B5                 mov     ecx, [ebp+arg_0]
.text:42CF74B8                 add     ecx, 54h ; 'T'
.text:42CF74BB                 push    ecx             ; int
.text:42CF74BC                 mov     edx, [ebp+arg_0]
.text:42CF74BF                 mov     eax, [edx+9Ch]
.text:42CF74C5                 push    eax             ; int
.text:42CF74C6                 call    sub_42CF7F6F
.text:42CF74CB                 add     esp, 14h
.text:42CF74CE                 mov     [ebp+var_4], eax
.text:42CF74D1                 cmp     [ebp+var_4], 0
.text:42CF74D5                 jnz     loc_42CF7588
.text:42CF74DB                 mov     ecx, [ebp+arg_0]
.text:42CF74DE                 add     ecx, 54h ; 'T'
.text:42CF74E1                 push    ecx
.text:42CF74E2                 push    offset Size
.text:42CF74E7                 call    sub_42CF7E2C
.text:42CF74EC                 add     esp, 8
.text:42CF74EF                 mov     edx, [ebp+arg_0]
.text:42CF74F2                 mov     eax, [edx+9Ch]
.text:42CF74F8                 cmp     dword ptr [eax+4Ch], 0
.text:42CF74FC                 jz      short loc_42CF7524
.text:42CF74FE                 mov     ecx, [ebp+arg_0]
.text:42CF7501                 mov     edx, [ecx+9Ch]
.text:42CF7507                 mov     eax, [edx+4Ch]
.text:42CF750A                 push    eax             ; Block
.text:42CF750B                 call    ds:free
.text:42CF7511                 add     esp, 4
.text:42CF7514                 mov     ecx, [ebp+arg_0]
.text:42CF7517                 mov     edx, [ecx+9Ch]
.text:42CF751D                 mov     dword ptr [edx+4Ch], 0
.text:42CF7524
.text:42CF7524 loc_42CF7524:                           ; CODE XREF: sub_42CF7275+287\u2191j
.text:42CF7524                 mov     eax, [ebp+arg_0]
.text:42CF7527                 mov     ecx, [eax+9Ch]
.text:42CF752D                 cmp     dword ptr [ecx+5Ch], 0
.text:42CF7531                 jz      short loc_42CF7559
.text:42CF7533                 mov     edx, [ebp+arg_0]
.text:42CF7536                 mov     eax, [edx+9Ch]
.text:42CF753C                 mov     ecx, [eax+5Ch]
.text:42CF753F                 push    ecx             ; Block
.text:42CF7540                 call    ds:free
.text:42CF7546                 add     esp, 4
.text:42CF7549                 mov     edx, [ebp+arg_0]
.text:42CF754C                 mov     eax, [edx+9Ch]
.text:42CF7552                 mov     dword ptr [eax+5Ch], 0
.text:42CF7559
.text:42CF7559 loc_42CF7559:                           ; CODE XREF: sub_42CF7275+2BC\u2191j
.text:42CF7559                 mov     ecx, [ebp+arg_0]
.text:42CF755C                 mov     edx, [ecx+9Ch]
.text:42CF7562                 push    edx             ; Block
.text:42CF7563                 call    ds:free
.text:42CF7569                 add     esp, 4
.text:42CF756C                 mov     eax, [ebp+arg_0]
.text:42CF756F                 mov     dword ptr [eax+9Ch], 0
.text:42CF7579                 mov     ecx, [ebp+arg_0]
.text:42CF757C                 mov     dword ptr [ecx+0A0h], 1
.text:42CF7586                 jmp     short loc_42CF75B5
.text:42CF7588 ; ---------------------------------------------------------------------------
.text:42CF7588
.text:42CF7588 loc_42CF7588:                           ; CODE XREF: sub_42CF7275+260\u2191j
.text:42CF7588                 mov     edx, [ebp+arg_0]
.text:42CF758B                 mov     eax, [edx+9Ch]
.text:42CF7591                 cmp     dword ptr [eax+60h], 0
.text:42CF7595                 jbe     short loc_42CF759E
.text:42CF7597                 mov     eax, 2
.text:42CF759C                 jmp     short loc_42CF75B8
.text:42CF759E ; ---------------------------------------------------------------------------
.text:42CF759E
.text:42CF759E loc_42CF759E:                           ; CODE XREF: sub_42CF7275+320\u2191j
.text:42CF759E                 mov     ecx, [ebp+arg_0]
.text:42CF75A1                 mov     edx, [ecx+9Ch]
.text:42CF75A7                 mov     dword ptr [edx+60h], 0
.text:42CF75AE                 mov     [ebp+var_4], 0
.text:42CF75B5
.text:42CF75B5 loc_42CF75B5:                           ; CODE XREF: sub_42CF7275+311\u2191j
.text:42CF75B5                 mov     eax, [ebp+var_4]
.text:42CF75B8
.text:42CF75B8 loc_42CF75B8:                           ; CODE XREF: sub_42CF7275+1BB\u2191j
.text:42CF75B8                                         ; sub_42CF7275+202\u2191j ...
.text:42CF75B8                 mov     esp, ebp
.text:42CF75BA                 pop     ebp
.text:42CF75BB                 retn
.text:42CF75BB sub_42CF7275    endp
.text:42CF75BB
.text:42CF75BC
.text:42CF75BC ; =============== S U B R O U T I N E =======================================
.text:42CF75BC
.text:42CF75BC ; Attributes: bp-based frame
.text:42CF75BC
.text:42CF75BC sub_42CF75BC    proc near               ; CODE XREF: sub_42CF69B4+17D\u2191p
.text:42CF75BC
.text:42CF75BC arg_0           = dword ptr  8
.text:42CF75BC arg_4           = dword ptr  0Ch
.text:42CF75BC
.text:42CF75BC                 push    ebp
.text:42CF75BD                 mov     ebp, esp
.text:42CF75BF                 mov     eax, [ebp+arg_0]
.text:42CF75C2                 mov     ecx, [ebp+arg_4]
.text:42CF75C5                 mov     [eax], ecx
.text:42CF75C7                 mov     edx, [ebp+arg_0]
.text:42CF75CA                 mov     dword ptr [edx+8], 0
.text:42CF75D1                 mov     eax, [ebp+arg_0]
.text:42CF75D4                 mov     dword ptr [eax+0Ch], 0FFFFFFFFh
.text:42CF75DB                 mov     ecx, [ebp+arg_0]
.text:42CF75DE                 mov     dword ptr [ecx+10h], 0
.text:42CF75E5                 push    4               ; Size
.text:42CF75E7                 mov     edx, [ebp+arg_0]
.text:42CF75EA                 mov     eax, [edx]
.text:42CF75EC                 push    eax             ; Count
.text:42CF75ED                 call    ds:calloc
.text:42CF75F3                 add     esp, 8
.text:42CF75F6                 mov     ecx, [ebp+arg_0]
.text:42CF75F9                 mov     [ecx+4], eax
.text:42CF75FC                 push    0               ; lpName
.text:42CF75FE                 push    0               ; bInitialState
.text:42CF7600                 push    0               ; bManualReset
.text:42CF7602                 push    0               ; lpEventAttributes
.text:42CF7604                 call    ds:CreateEventA
.text:42CF760A                 mov     edx, [ebp+arg_0]
.text:42CF760D                 mov     [edx+14h], eax
.text:42CF7610                 pop     ebp
.text:42CF7611                 retn
.text:42CF7611 sub_42CF75BC    endp
.text:42CF7611
.text:42CF7612 ; ---------------------------------------------------------------------------
.text:42CF7612                 push    ebp
.text:42CF7613                 mov     ebp, esp
.text:42CF7615                 mov     eax, [ebp+8]
.text:42CF7618                 mov     ecx, [eax+4]
.text:42CF761B                 push    ecx
.text:42CF761C                 call    ds:free
.text:42CF7622                 add     esp, 4
.text:42CF7625                 mov     edx, [ebp+8]
.text:42CF7628                 mov     eax, [edx+14h]
.text:42CF762B                 push    eax
.text:42CF762C                 call    ds:CloseHandle
.text:42CF7632                 pop     ebp
.text:42CF7633                 retn
.text:42CF7634
.text:42CF7634 ; =============== S U B R O U T I N E =======================================
.text:42CF7634
.text:42CF7634 ; Attributes: bp-based frame
.text:42CF7634
.text:42CF7634 sub_42CF7634    proc near               ; CODE XREF: sub_42CF2683+12E\u2191p
.text:42CF7634
.text:42CF7634 arg_0           = dword ptr  8
.text:42CF7634 arg_4           = dword ptr  0Ch
.text:42CF7634
.text:42CF7634                 push    ebp
.text:42CF7635                 mov     ebp, esp
.text:42CF7637                 mov     eax, [ebp+arg_0]
.text:42CF763A                 mov     ecx, [eax]
.text:42CF763C                 sub     ecx, 1
.text:42CF763F                 mov     edx, [ebp+arg_0]
.text:42CF7642                 cmp     [edx+0Ch], ecx
.text:42CF7645                 jnz     short loc_42CF7651
.text:42CF7647                 mov     eax, [ebp+arg_0]
.text:42CF764A                 mov     dword ptr [eax+0Ch], 0FFFFFFFFh
.text:42CF7651
.text:42CF7651 loc_42CF7651:                           ; CODE XREF: sub_42CF7634+11\u2191j
.text:42CF7651                 mov     ecx, [ebp+arg_0]
.text:42CF7654                 mov     edx, [ecx+0Ch]
.text:42CF7657                 add     edx, 1
.text:42CF765A                 mov     eax, [ebp+arg_0]
.text:42CF765D                 mov     [eax+0Ch], edx
.text:42CF7660                 mov     ecx, [ebp+arg_0]
.text:42CF7663                 mov     edx, [ecx+0Ch]
.text:42CF7666                 mov     eax, [ebp+arg_0]
.text:42CF7669                 mov     ecx, [eax+4]
.text:42CF766C                 mov     eax, [ebp+arg_4]
.text:42CF766F                 mov     [ecx+edx*4], eax
.text:42CF7672                 mov     ecx, [ebp+arg_0]
.text:42CF7675                 mov     edx, [ecx+10h]
.text:42CF7678                 add     edx, 1
.text:42CF767B                 mov     eax, [ebp+arg_0]
.text:42CF767E                 mov     [eax+10h], edx
.text:42CF7681                 mov     ecx, [ebp+arg_0]
.text:42CF7684                 cmp     dword ptr [ecx+10h], 1
.text:42CF7688                 jnz     short loc_42CF7697
.text:42CF768A                 mov     edx, [ebp+arg_0]
.text:42CF768D                 mov     eax, [edx+14h]
.text:42CF7690                 push    eax             ; hEvent
.text:42CF7691                 call    ds:SetEvent
.text:42CF7697
.text:42CF7697 loc_42CF7697:                           ; CODE XREF: sub_42CF7634+54\u2191j
.text:42CF7697                 pop     ebp
.text:42CF7698                 retn
.text:42CF7698 sub_42CF7634    endp
.text:42CF7698
.text:42CF7699
.text:42CF7699 ; =============== S U B R O U T I N E =======================================
.text:42CF7699
.text:42CF7699 ; Attributes: bp-based frame
.text:42CF7699
.text:42CF7699 sub_42CF7699    proc near               ; CODE XREF: sub_42CF7791+5A\u2193p
.text:42CF7699
.text:42CF7699 var_4           = dword ptr -4
.text:42CF7699 arg_0           = dword ptr  8
.text:42CF7699
.text:42CF7699                 push    ebp
.text:42CF769A                 mov     ebp, esp
.text:42CF769C                 push    ecx
.text:42CF769D                 mov     eax, [ebp+arg_0]
.text:42CF76A0                 mov     ecx, [eax+8]
.text:42CF76A3                 mov     edx, [ebp+arg_0]
.text:42CF76A6                 mov     eax, [edx+4]
.text:42CF76A9                 mov     ecx, [eax+ecx*4]
.text:42CF76AC                 mov     [ebp+var_4], ecx
.text:42CF76AF                 mov     edx, [ebp+arg_0]
.text:42CF76B2                 mov     eax, [edx+8]
.text:42CF76B5                 add     eax, 1
.text:42CF76B8                 mov     ecx, [ebp+arg_0]
.text:42CF76BB                 mov     [ecx+8], eax
.text:42CF76BE                 mov     edx, [ebp+arg_0]
.text:42CF76C1                 mov     eax, [ebp+arg_0]
.text:42CF76C4                 mov     ecx, [edx+8]
.text:42CF76C7                 cmp     ecx, [eax]
.text:42CF76C9                 jnz     short loc_42CF76D5
.text:42CF76CB                 mov     edx, [ebp+arg_0]
.text:42CF76CE                 mov     dword ptr [edx+8], 0
.text:42CF76D5
.text:42CF76D5 loc_42CF76D5:                           ; CODE XREF: sub_42CF7699+30\u2191j
.text:42CF76D5                 mov     eax, [ebp+arg_0]
.text:42CF76D8                 mov     ecx, [eax+10h]
.text:42CF76DB                 sub     ecx, 1
.text:42CF76DE                 mov     edx, [ebp+arg_0]
.text:42CF76E1                 mov     [edx+10h], ecx
.text:42CF76E4                 mov     eax, [ebp+arg_0]
.text:42CF76E7                 cmp     dword ptr [eax+10h], 0
.text:42CF76EB                 jge     short loc_42CF770B
.text:42CF76ED                 xor     ecx, ecx
.text:42CF76EF                 test    ecx, ecx
.text:42CF76F1                 jnz     short loc_42CF770B
.text:42CF76F3                 push    1E40h
.text:42CF76F8                 push    offset aQSphinxNetlibs_16 ; "q:\\SPHINX\\NETLIBS\\nt\\ssock\\src\\nt"...
.text:42CF76FD                 push    offset a0       ; "0"
.text:42CF7702                 call    ds:_assert
.text:42CF7708 ; ---------------------------------------------------------------------------
.text:42CF7708                 add     esp, 0Ch
.text:42CF770B
.text:42CF770B loc_42CF770B:                           ; CODE XREF: sub_42CF7699+52\u2191j
.text:42CF770B                                         ; sub_42CF7699+58\u2191j
.text:42CF770B                 mov     eax, [ebp+arg_0]
.text:42CF770E                 cmp     dword ptr [eax+10h], 0
.text:42CF7712                 jnz     short loc_42CF7721
.text:42CF7714                 mov     ecx, [ebp+arg_0]
.text:42CF7717                 mov     edx, [ecx+14h]
.text:42CF771A                 push    edx             ; hEvent
.text:42CF771B                 call    ds:ResetEvent
.text:42CF7721
.text:42CF7721 loc_42CF7721:                           ; CODE XREF: sub_42CF7699+79\u2191j
.text:42CF7721                 mov     eax, [ebp+var_4]
.text:42CF7724                 mov     esp, ebp
.text:42CF7726                 pop     ebp
.text:42CF7727                 retn
.text:42CF7727 sub_42CF7699    endp
.text:42CF7727
.text:42CF7728 ; ---------------------------------------------------------------------------
.text:42CF7728                 push    ebp
.text:42CF7729                 mov     ebp, esp
.text:42CF772B                 push    ecx
.text:42CF772C                 mov     eax, [ebp+8]
.text:42CF772F                 mov     ecx, [eax+8]
.text:42CF7732                 mov     edx, [ebp+8]
.text:42CF7735                 mov     eax, [edx+4]
.text:42CF7738                 mov     ecx, [eax+ecx*4]
.text:42CF773B                 mov     [ebp-4], ecx
.text:42CF773E                 mov     eax, [ebp-4]
.text:42CF7741                 mov     esp, ebp
.text:42CF7743                 pop     ebp
.text:42CF7744                 retn
.text:42CF7745
.text:42CF7745 ; =============== S U B R O U T I N E =======================================
.text:42CF7745
.text:42CF7745 ; Attributes: bp-based frame
.text:42CF7745
.text:42CF7745 sub_42CF7745    proc near               ; CODE XREF: sub_42CF7791+25\u2193p
.text:42CF7745
.text:42CF7745 var_4           = dword ptr -4
.text:42CF7745 arg_0           = dword ptr  8
.text:42CF7745
.text:42CF7745                 push    ebp
.text:42CF7746                 mov     ebp, esp
.text:42CF7748                 push    ecx
.text:42CF7749                 mov     eax, [ebp+arg_0]
.text:42CF774C                 xor     ecx, ecx
.text:42CF774E                 cmp     dword ptr [eax+10h], 0
.text:42CF7752                 setz    cl
.text:42CF7755                 mov     [ebp+var_4], ecx
.text:42CF7758                 mov     eax, [ebp+var_4]
.text:42CF775B                 mov     esp, ebp
.text:42CF775D                 pop     ebp
.text:42CF775E                 retn
.text:42CF775E sub_42CF7745    endp
.text:42CF775E
.text:42CF775F
.text:42CF775F ; =============== S U B R O U T I N E =======================================
.text:42CF775F
.text:42CF775F ; Attributes: bp-based frame
.text:42CF775F
.text:42CF775F sub_42CF775F    proc near               ; CODE XREF: sub_42CF2683+F9\u2191p
.text:42CF775F
.text:42CF775F var_4           = dword ptr -4
.text:42CF775F arg_0           = dword ptr  8
.text:42CF775F
.text:42CF775F                 push    ebp
.text:42CF7760                 mov     ebp, esp
.text:42CF7762                 push    ecx
.text:42CF7763                 mov     eax, [ebp+arg_0]
.text:42CF7766                 mov     ecx, [ebp+arg_0]
.text:42CF7769                 mov     edx, [eax+10h]
.text:42CF776C                 xor     eax, eax
.text:42CF776E                 cmp     edx, [ecx]
.text:42CF7770                 setz    al
.text:42CF7773                 mov     [ebp+var_4], eax
.text:42CF7776                 mov     eax, [ebp+var_4]
.text:42CF7779                 mov     esp, ebp
.text:42CF777B                 pop     ebp
.text:42CF777C                 retn
.text:42CF777C sub_42CF775F    endp
.text:42CF777C
.text:42CF777D ; ---------------------------------------------------------------------------
.text:42CF777D                 push    ebp
.text:42CF777E                 mov     ebp, esp
.text:42CF7780                 push    ecx
.text:42CF7781                 mov     eax, [ebp+8]
.text:42CF7784                 mov     ecx, [eax+10h]
.text:42CF7787                 mov     [ebp-4], ecx
.text:42CF778A                 mov     eax, [ebp-4]
.text:42CF778D                 mov     esp, ebp
.text:42CF778F                 pop     ebp
.text:42CF7790                 retn
.text:42CF7791
.text:42CF7791 ; =============== S U B R O U T I N E =======================================
.text:42CF7791
.text:42CF7791 ; Attributes: bp-based frame
.text:42CF7791
.text:42CF7791 ; DWORD __stdcall sub_42CF7791(LPVOID lpThreadParameter)
.text:42CF7791 sub_42CF7791    proc near               ; DATA XREF: sub_42CF69B4+198\u2191o
.text:42CF7791
.text:42CF7791 var_8           = dword ptr -8
.text:42CF7791 var_4           = dword ptr -4
.text:42CF7791 lpThreadParameter= dword ptr  8
.text:42CF7791
.text:42CF7791                 push    ebp
.text:42CF7792                 mov     ebp, esp
.text:42CF7794                 sub     esp, 8
.text:42CF7797                 mov     [ebp+var_4], offset unk_42D01DE0
.text:42CF779E
.text:42CF779E loc_42CF779E:                           ; CODE XREF: sub_42CF7791+7C\u2193j
.text:42CF779E                 mov     eax, 1
.text:42CF77A3                 test    eax, eax
.text:42CF77A5                 jz      short loc_42CF780F
.text:42CF77A7                 push    offset CriticalSection ; lpCriticalSection
.text:42CF77AC                 call    ds:EnterCriticalSection
.text:42CF77B2                 mov     ecx, [ebp+var_4]
.text:42CF77B5                 push    ecx
.text:42CF77B6                 call    sub_42CF7745
.text:42CF77BB                 add     esp, 4
.text:42CF77BE                 test    eax, eax
.text:42CF77C0                 jz      short loc_42CF77E7
.text:42CF77C2                 push    offset CriticalSection ; lpCriticalSection
.text:42CF77C7                 call    ds:LeaveCriticalSection
.text:42CF77CD                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CF77CF                 mov     edx, [ebp+var_4]
.text:42CF77D2                 mov     eax, [edx+14h]
.text:42CF77D5                 push    eax             ; hHandle
.text:42CF77D6                 call    ds:WaitForSingleObject
.text:42CF77DC                 push    offset CriticalSection ; lpCriticalSection
.text:42CF77E1                 call    ds:EnterCriticalSection
.text:42CF77E7
.text:42CF77E7 loc_42CF77E7:                           ; CODE XREF: sub_42CF7791+2F\u2191j
.text:42CF77E7                 mov     ecx, [ebp+var_4]
.text:42CF77EA                 push    ecx
.text:42CF77EB                 call    sub_42CF7699
.text:42CF77F0                 add     esp, 4
.text:42CF77F3                 mov     [ebp+var_8], eax
.text:42CF77F6                 push    offset CriticalSection ; lpCriticalSection
.text:42CF77FB                 call    ds:LeaveCriticalSection
.text:42CF7801                 mov     edx, [ebp+var_8]
.text:42CF7804                 push    edx
.text:42CF7805                 call    sub_42CF6D55
.text:42CF780A                 add     esp, 4
.text:42CF780D                 jmp     short loc_42CF779E
.text:42CF780F ; ---------------------------------------------------------------------------
.text:42CF780F
.text:42CF780F loc_42CF780F:                           ; CODE XREF: sub_42CF7791+14\u2191j
.text:42CF780F                 mov     esp, ebp
.text:42CF7811                 pop     ebp
.text:42CF7812                 retn
.text:42CF7812 sub_42CF7791    endp
.text:42CF7812
.text:42CF7812 ; ---------------------------------------------------------------------------
.text:42CF7813                 align 10h
.text:42CF7820
.text:42CF7820 ; =============== S U B R O U T I N E =======================================
.text:42CF7820
.text:42CF7820 ; Attributes: bp-based frame
.text:42CF7820
.text:42CF7820 sub_42CF7820    proc near               ; CODE XREF: ConnectionListen+C73\u2191p
.text:42CF7820
.text:42CF7820 var_4           = dword ptr -4
.text:42CF7820 arg_0           = dword ptr  8
.text:42CF7820 arg_4           = dword ptr  0Ch
.text:42CF7820
.text:42CF7820                 push    ebp
.text:42CF7821                 mov     ebp, esp
.text:42CF7823                 push    ecx
.text:42CF7824                 mov     [ebp+var_4], 0
.text:42CF782B                 jmp     short loc_42CF7836
.text:42CF782D ; ---------------------------------------------------------------------------
.text:42CF782D
.text:42CF782D loc_42CF782D:                           ; CODE XREF: sub_42CF7820:loc_42CF786E\u2193j
.text:42CF782D                 mov     eax, [ebp+var_4]
.text:42CF7830                 add     eax, 1
.text:42CF7833                 mov     [ebp+var_4], eax
.text:42CF7836
.text:42CF7836 loc_42CF7836:                           ; CODE XREF: sub_42CF7820+B\u2191j
.text:42CF7836                 mov     ecx, [ebp+arg_4]
.text:42CF7839                 mov     edx, [ebp+var_4]
.text:42CF783C                 cmp     edx, [ecx+20Ch]
.text:42CF7842                 jnb     short loc_42CF7870
.text:42CF7844                 mov     eax, [ebp+var_4]
.text:42CF7847                 mov     ecx, [ebp+arg_4]
.text:42CF784A                 mov     edx, [ebp+arg_0]
.text:42CF784D                 cmp     edx, [ecx+eax*4+10Ch]
.text:42CF7854                 jnz     short loc_42CF786E
.text:42CF7856                 mov     eax, [ebp+var_4]
.text:42CF7859                 mov     ecx, [ebp+arg_4]
.text:42CF785C                 mov     dword ptr [ecx+eax*4+10Ch], 0
.text:42CF7867                 mov     eax, 1
.text:42CF786C                 jmp     short loc_42CF7872
.text:42CF786E ; ---------------------------------------------------------------------------
.text:42CF786E
.text:42CF786E loc_42CF786E:                           ; CODE XREF: sub_42CF7820+34\u2191j
.text:42CF786E                 jmp     short loc_42CF782D
.text:42CF7870 ; ---------------------------------------------------------------------------
.text:42CF7870
.text:42CF7870 loc_42CF7870:                           ; CODE XREF: sub_42CF7820+22\u2191j
.text:42CF7870                 xor     eax, eax
.text:42CF7872
.text:42CF7872 loc_42CF7872:                           ; CODE XREF: sub_42CF7820+4C\u2191j
.text:42CF7872                 mov     esp, ebp
.text:42CF7874                 pop     ebp
.text:42CF7875                 retn
.text:42CF7875 sub_42CF7820    endp
.text:42CF7875
.text:42CF7875 ; ---------------------------------------------------------------------------
.text:42CF7876                 align 10h
.text:42CF7880
.text:42CF7880 ; =============== S U B R O U T I N E =======================================
.text:42CF7880
.text:42CF7880 ; Attributes: bp-based frame
.text:42CF7880
.text:42CF7880 ; int __cdecl sub_42CF7880(char *Destination, int, int, struct in_addr in)
.text:42CF7880 sub_42CF7880    proc near               ; CODE XREF: ConnectionListen+F09\u2191p
.text:42CF7880
.text:42CF7880 Buffer          = byte ptr -400h
.text:42CF7880 Destination     = dword ptr  8
.text:42CF7880 arg_4           = dword ptr  0Ch
.text:42CF7880 in              = in_addr ptr  14h
.text:42CF7880
.text:42CF7880                 push    ebp
.text:42CF7881                 mov     ebp, esp
.text:42CF7883                 sub     esp, 400h
.text:42CF7889                 mov     eax, [ebp+arg_4]
.text:42CF788C                 push    eax
.text:42CF788D                 mov     ecx, dword ptr [ebp+in.S_un]
.text:42CF7890                 push    ecx             ; in
.text:42CF7891                 call    ds:inet_ntoa
.text:42CF7897                 push    eax
.text:42CF7898                 push    offset aSD      ; ", %s:%d"
.text:42CF789D                 lea     edx, [ebp+Buffer]
.text:42CF78A3                 push    edx             ; Buffer
.text:42CF78A4                 call    ds:sprintf
.text:42CF78AA                 add     esp, 10h
.text:42CF78AD                 lea     eax, [ebp+Buffer]
.text:42CF78B3                 push    eax             ; Source
.text:42CF78B4                 mov     ecx, [ebp+Destination]
.text:42CF78B7                 push    ecx             ; Destination
.text:42CF78B8                 call    strcat
.text:42CF78BD                 add     esp, 8
.text:42CF78C0                 mov     esp, ebp
.text:42CF78C2                 pop     ebp
.text:42CF78C3                 retn
.text:42CF78C3 sub_42CF7880    endp
.text:42CF78C3
.text:42CF78C3 ; ---------------------------------------------------------------------------
.text:42CF78C4                 align 10h
.text:42CF78D0
.text:42CF78D0 ; =============== S U B R O U T I N E =======================================
.text:42CF78D0
.text:42CF78D0 ; Attributes: bp-based frame
.text:42CF78D0
.text:42CF78D0 ; int __cdecl sub_42CF78D0(char Buf1)
.text:42CF78D0 sub_42CF78D0    proc near               ; CODE XREF: ConnectionListen+647\u2191p
.text:42CF78D0
.text:42CF78D0 Buf1            = byte ptr  8
.text:42CF78D0
.text:42CF78D0                 push    ebp
.text:42CF78D1                 mov     ebp, esp
.text:42CF78D3                 push    10h             ; Size
.text:42CF78D5                 push    offset unk_42CFF008 ; Buf2
.text:42CF78DA                 lea     eax, [ebp+Buf1]
.text:42CF78DD                 push    eax             ; Buf1
.text:42CF78DE                 call    memcmp
.text:42CF78E3                 add     esp, 0Ch
.text:42CF78E6                 test    eax, eax
.text:42CF78E8                 jnz     short loc_42CF78F1
.text:42CF78EA                 mov     eax, 1
.text:42CF78EF                 jmp     short loc_42CF78F3
.text:42CF78F1 ; ---------------------------------------------------------------------------
.text:42CF78F1
.text:42CF78F1 loc_42CF78F1:                           ; CODE XREF: sub_42CF78D0+18\u2191j
.text:42CF78F1                 xor     eax, eax
.text:42CF78F3
.text:42CF78F3 loc_42CF78F3:                           ; CODE XREF: sub_42CF78D0+1F\u2191j
.text:42CF78F3                 pop     ebp
.text:42CF78F4                 retn
.text:42CF78F4 sub_42CF78D0    endp
.text:42CF78F4
.text:42CF78F4 ; ---------------------------------------------------------------------------
.text:42CF78F5                 align 10h
.text:42CF7900
.text:42CF7900 ; =============== S U B R O U T I N E =======================================
.text:42CF7900
.text:42CF7900 ; Attributes: bp-based frame
.text:42CF7900
.text:42CF7900 ; int __cdecl sub_42CF7900(char Buf1)
.text:42CF7900 sub_42CF7900    proc near               ; CODE XREF: ConnectionListen+677\u2191p
.text:42CF7900
.text:42CF7900 Buf1            = byte ptr  8
.text:42CF7900
.text:42CF7900                 push    ebp
.text:42CF7901                 mov     ebp, esp
.text:42CF7903                 push    10h             ; Size
.text:42CF7905                 push    offset unk_42CFF018 ; Buf2
.text:42CF790A                 lea     eax, [ebp+Buf1]
.text:42CF790D                 push    eax             ; Buf1
.text:42CF790E                 call    memcmp
.text:42CF7913                 add     esp, 0Ch
.text:42CF7916                 test    eax, eax
.text:42CF7918                 jnz     short loc_42CF7921
.text:42CF791A                 mov     eax, 1
.text:42CF791F                 jmp     short loc_42CF7923
.text:42CF7921 ; ---------------------------------------------------------------------------
.text:42CF7921
.text:42CF7921 loc_42CF7921:                           ; CODE XREF: sub_42CF7900+18\u2191j
.text:42CF7921                 xor     eax, eax
.text:42CF7923
.text:42CF7923 loc_42CF7923:                           ; CODE XREF: sub_42CF7900+1F\u2191j
.text:42CF7923                 pop     ebp
.text:42CF7924                 retn
.text:42CF7924 sub_42CF7900    endp
.text:42CF7924
.text:42CF7924 ; ---------------------------------------------------------------------------
.text:42CF7925                 align 10h
.text:42CF7930
.text:42CF7930 ; =============== S U B R O U T I N E =======================================
.text:42CF7930
.text:42CF7930 ; Attributes: bp-based frame
.text:42CF7930
.text:42CF7930 sub_42CF7930    proc near               ; CODE XREF: ConnectionListen+3BC\u2191p
.text:42CF7930
.text:42CF7930 lpLibFileName   = dword ptr -0Ch
.text:42CF7930 Src             = dword ptr -8
.text:42CF7930 var_4           = dword ptr -4
.text:42CF7930
.text:42CF7930                 push    ebp
.text:42CF7931                 mov     ebp, esp
.text:42CF7933                 sub     esp, 0Ch
.text:42CF7936                 cmp     dword_42D01A1C, 0
.text:42CF793D                 jz      short loc_42CF7948
.text:42CF793F                 mov     [ebp+lpLibFileName], offset aSecurityDll ; "security.dll"
.text:42CF7946                 jmp     short loc_42CF794F
.text:42CF7948 ; ---------------------------------------------------------------------------
.text:42CF7948
.text:42CF7948 loc_42CF7948:                           ; CODE XREF: sub_42CF7930+D\u2191j
.text:42CF7948                 mov     [ebp+lpLibFileName], offset aSchannelDll ; "schannel.dll"
.text:42CF794F
.text:42CF794F loc_42CF794F:                           ; CODE XREF: sub_42CF7930+16\u2191j
.text:42CF794F                 mov     eax, [ebp+lpLibFileName]
.text:42CF7952                 push    eax             ; lpLibFileName
.text:42CF7953                 call    ds:LoadLibraryA
.text:42CF7959                 mov     dword_42D011A4, eax
.text:42CF795E                 cmp     dword_42D011A4, 0
.text:42CF7965                 jnz     short loc_42CF7969
.text:42CF7967                 jmp     short loc_42CF79E2
.text:42CF7969 ; ---------------------------------------------------------------------------
.text:42CF7969
.text:42CF7969 loc_42CF7969:                           ; CODE XREF: sub_42CF7930+35\u2191j
.text:42CF7969                 push    offset aInitsecurityin ; "InitSecurityInterfaceA"
.text:42CF796E                 mov     ecx, dword_42D011A4
.text:42CF7974                 push    ecx             ; hModule
.text:42CF7975                 call    ds:GetProcAddress
.text:42CF797B                 mov     [ebp+var_4], eax
.text:42CF797E                 cmp     [ebp+var_4], 0
.text:42CF7982                 jnz     short loc_42CF7986
.text:42CF7984                 jmp     short loc_42CF79E2
.text:42CF7986 ; ---------------------------------------------------------------------------
.text:42CF7986
.text:42CF7986 loc_42CF7986:                           ; CODE XREF: sub_42CF7930+52\u2191j
.text:42CF7986                 call    [ebp+var_4]
.text:42CF7989                 mov     [ebp+Src], eax
.text:42CF798C                 cmp     [ebp+Src], 0
.text:42CF7990                 jnz     short loc_42CF7994
.text:42CF7992                 jmp     short loc_42CF79E2
.text:42CF7994 ; ---------------------------------------------------------------------------
.text:42CF7994
.text:42CF7994 loc_42CF7994:                           ; CODE XREF: sub_42CF7930+60\u2191j
.text:42CF7994                 push    6Ch ; 'l'       ; Size
.text:42CF7996                 mov     edx, [ebp+Src]
.text:42CF7999                 push    edx             ; Src
.text:42CF799A                 push    offset unk_42D01108 ; void *
.text:42CF799F                 call    memcpy
.text:42CF79A4                 add     esp, 0Ch
.text:42CF79A7                 call    sub_42CF7E41
.text:42CF79AC                 test    eax, eax
.text:42CF79AE                 jnz     short loc_42CF79B2
.text:42CF79B0                 jmp     short loc_42CF79E2
.text:42CF79B2 ; ---------------------------------------------------------------------------
.text:42CF79B2
.text:42CF79B2 loc_42CF79B2:                           ; CODE XREF: sub_42CF7930+7E\u2191j
.text:42CF79B2                 cmp     dword_42D01A1C, 0
.text:42CF79B9                 jnz     short loc_42CF79D1
.text:42CF79BB                 mov     eax, dword_42D01154
.text:42CF79C0                 mov     dword_42D01960, eax
.text:42CF79C5                 mov     ecx, dword_42D01150
.text:42CF79CB                 mov     dword_42D01964, ecx
.text:42CF79D1
.text:42CF79D1 loc_42CF79D1:                           ; CODE XREF: sub_42CF7930+89\u2191j
.text:42CF79D1                 mov     dword_42D010C4, 1
.text:42CF79DB                 mov     eax, 1
.text:42CF79E0                 jmp     short loc_42CF7A23
.text:42CF79E2 ; ---------------------------------------------------------------------------
.text:42CF79E2
.text:42CF79E2 loc_42CF79E2:                           ; CODE XREF: sub_42CF7930+37\u2191j
.text:42CF79E2                                         ; sub_42CF7930+54\u2191j ...
.text:42CF79E2                 cmp     dword_42D011A4, 0
.text:42CF79E9                 jz      short loc_42CF7A02
.text:42CF79EB                 mov     edx, dword_42D011A4
.text:42CF79F1                 push    edx             ; hLibModule
.text:42CF79F2                 call    ds:FreeLibrary
.text:42CF79F8                 mov     dword_42D011A4, 0
.text:42CF7A02
.text:42CF7A02 loc_42CF7A02:                           ; CODE XREF: sub_42CF7930+B9\u2191j
.text:42CF7A02                 cmp     dword_42D01968, 0
.text:42CF7A09                 jz      short loc_42CF7A21
.text:42CF7A0B                 mov     eax, dword_42D01968
.text:42CF7A10                 push    eax             ; hLibModule
.text:42CF7A11                 call    ds:FreeLibrary
.text:42CF7A17                 mov     dword_42D01968, 0
.text:42CF7A21
.text:42CF7A21 loc_42CF7A21:                           ; CODE XREF: sub_42CF7930+D9\u2191j
.text:42CF7A21                 xor     eax, eax
.text:42CF7A23
.text:42CF7A23 loc_42CF7A23:                           ; CODE XREF: sub_42CF7930+B0\u2191j
.text:42CF7A23                 mov     esp, ebp
.text:42CF7A25                 pop     ebp
.text:42CF7A26                 retn
.text:42CF7A26 sub_42CF7930    endp
.text:42CF7A26
.text:42CF7A27
.text:42CF7A27 ; =============== S U B R O U T I N E =======================================
.text:42CF7A27
.text:42CF7A27 ; Attributes: bp-based frame
.text:42CF7A27
.text:42CF7A27 sub_42CF7A27    proc near               ; CODE XREF: ConnectionListen+3F4\u2191p
.text:42CF7A27
.text:42CF7A27 var_50          = dword ptr -50h
.text:42CF7A27 var_4C          = dword ptr -4Ch
.text:42CF7A27 var_48          = dword ptr -48h
.text:42CF7A27 var_44          = dword ptr -44h
.text:42CF7A27 var_40          = dword ptr -40h
.text:42CF7A27 var_3C          = dword ptr -3Ch
.text:42CF7A27 var_24          = dword ptr -24h
.text:42CF7A27 var_14          = dword ptr -14h
.text:42CF7A27 var_C           = dword ptr -0Ch
.text:42CF7A27 var_8           = byte ptr -8
.text:42CF7A27 arg_0           = dword ptr  8
.text:42CF7A27 arg_4           = dword ptr  0Ch
.text:42CF7A27 arg_8           = dword ptr  10h
.text:42CF7A27
.text:42CF7A27                 push    ebp
.text:42CF7A28                 mov     ebp, esp
.text:42CF7A2A                 sub     esp, 50h
.text:42CF7A2D                 mov     [ebp+var_4C], 0
.text:42CF7A34                 mov     [ebp+var_C], 0
.text:42CF7A3B                 cmp     [ebp+var_C], 0
.text:42CF7A3F                 jnz     short loc_42CF7A8B
.text:42CF7A41                 cmp     [ebp+arg_8], 0
.text:42CF7A45                 jz      short loc_42CF7A8B
.text:42CF7A47                 mov     eax, 1
.text:42CF7A4C                 test    eax, eax
.text:42CF7A4E                 jz      short loc_42CF7A6B
.text:42CF7A50                 push    offset aMy      ; "MY"
.text:42CF7A55                 push    20000h
.text:42CF7A5A                 push    0
.text:42CF7A5C                 push    1
.text:42CF7A5E                 push    0Ah
.text:42CF7A60                 call    dword_42D01184
.text:42CF7A66                 mov     [ebp+var_C], eax
.text:42CF7A69                 jmp     short loc_42CF7A7B
.text:42CF7A6B ; ---------------------------------------------------------------------------
.text:42CF7A6B
.text:42CF7A6B loc_42CF7A6B:                           ; CODE XREF: sub_42CF7A27+27\u2191j
.text:42CF7A6B                 push    offset aMy_0    ; "MY"
.text:42CF7A70                 push    0
.text:42CF7A72                 call    dword_42D01180
.text:42CF7A78                 mov     [ebp+var_C], eax
.text:42CF7A7B
.text:42CF7A7B loc_42CF7A7B:                           ; CODE XREF: sub_42CF7A27+42\u2191j
.text:42CF7A7B                 cmp     [ebp+var_C], 0
.text:42CF7A7F                 jnz     short loc_42CF7A8B
.text:42CF7A81                 mov     eax, 8009030Eh
.text:42CF7A86                 jmp     loc_42CF7BBB
.text:42CF7A8B ; ---------------------------------------------------------------------------
.text:42CF7A8B
.text:42CF7A8B loc_42CF7A8B:                           ; CODE XREF: sub_42CF7A27+18\u2191j
.text:42CF7A8B                                         ; sub_42CF7A27+1E\u2191j ...
.text:42CF7A8B                 cmp     [ebp+arg_0], 0
.text:42CF7A8F                 jz      short loc_42CF7AFF
.text:42CF7A91                 push    0
.text:42CF7A93                 mov     ecx, [ebp+arg_0]
.text:42CF7A96                 push    ecx
.text:42CF7A97                 push    70007h
.text:42CF7A9C                 push    0
.text:42CF7A9E                 push    1
.text:42CF7AA0                 mov     edx, [ebp+var_C]
.text:42CF7AA3                 push    edx
.text:42CF7AA4                 call    dword_42D0117C
.text:42CF7AAA                 mov     [ebp+var_4C], eax
.text:42CF7AAD                 cmp     [ebp+var_4C], 0
.text:42CF7AB1                 jnz     short loc_42CF7AFF
.text:42CF7AB3                 push    offset aMy_1    ; "MY"
.text:42CF7AB8                 push    0
.text:42CF7ABA                 call    dword_42D01180
.text:42CF7AC0                 mov     [ebp+var_C], eax
.text:42CF7AC3                 cmp     [ebp+var_C], 0
.text:42CF7AC7                 jnz     short loc_42CF7AD3
.text:42CF7AC9                 mov     eax, 8009030Eh
.text:42CF7ACE                 jmp     loc_42CF7BBB
.text:42CF7AD3 ; ---------------------------------------------------------------------------
.text:42CF7AD3
.text:42CF7AD3 loc_42CF7AD3:                           ; CODE XREF: sub_42CF7A27+A0\u2191j
.text:42CF7AD3                 push    0
.text:42CF7AD5                 mov     eax, [ebp+arg_0]
.text:42CF7AD8                 push    eax
.text:42CF7AD9                 push    70007h
.text:42CF7ADE                 push    0
.text:42CF7AE0                 push    1
.text:42CF7AE2                 mov     ecx, [ebp+var_C]
.text:42CF7AE5                 push    ecx
.text:42CF7AE6                 call    dword_42D0117C
.text:42CF7AEC                 mov     [ebp+var_4C], eax
.text:42CF7AEF                 cmp     [ebp+var_4C], 0
.text:42CF7AF3                 jnz     short loc_42CF7AFF
.text:42CF7AF5                 mov     eax, 8009030Eh
.text:42CF7AFA                 jmp     loc_42CF7BBB
.text:42CF7AFF ; ---------------------------------------------------------------------------
.text:42CF7AFF
.text:42CF7AFF loc_42CF7AFF:                           ; CODE XREF: sub_42CF7A27+68\u2191j
.text:42CF7AFF                                         ; sub_42CF7A27+8A\u2191j ...
.text:42CF7AFF                 push    38h ; '8'       ; Size
.text:42CF7B01                 push    0               ; Val
.text:42CF7B03                 lea     edx, [ebp+var_44]
.text:42CF7B06                 push    edx             ; void *
.text:42CF7B07                 call    memset
.text:42CF7B0C                 add     esp, 0Ch
.text:42CF7B0F                 mov     [ebp+var_44], 4
.text:42CF7B16                 cmp     [ebp+var_4C], 0
.text:42CF7B1A                 jz      short loc_42CF7B29
.text:42CF7B1C                 mov     [ebp+var_40], 1
.text:42CF7B23                 lea     eax, [ebp+var_4C]
.text:42CF7B26                 mov     [ebp+var_3C], eax
.text:42CF7B29
.text:42CF7B29 loc_42CF7B29:                           ; CODE XREF: sub_42CF7A27+F3\u2191j
.text:42CF7B29                 mov     ecx, dword_42CFFF70
.text:42CF7B2F                 mov     [ebp+var_24], ecx
.text:42CF7B32                 cmp     [ebp+arg_8], 0
.text:42CF7B36                 jnz     short loc_42CF7B49
.text:42CF7B38                 mov     edx, [ebp+var_14]
.text:42CF7B3B                 or      edx, 10h
.text:42CF7B3E                 mov     [ebp+var_14], edx
.text:42CF7B41                 mov     eax, [ebp+var_14]
.text:42CF7B44                 or      al, 8
.text:42CF7B46                 mov     [ebp+var_14], eax
.text:42CF7B49
.text:42CF7B49 loc_42CF7B49:                           ; CODE XREF: sub_42CF7A27+10F\u2191j
.text:42CF7B49                 lea     ecx, [ebp+var_8]
.text:42CF7B4C                 push    ecx
.text:42CF7B4D                 mov     edx, [ebp+arg_4]
.text:42CF7B50                 push    edx
.text:42CF7B51                 push    0
.text:42CF7B53                 push    0
.text:42CF7B55                 lea     eax, [ebp+var_44]
.text:42CF7B58                 push    eax
.text:42CF7B59                 push    0
.text:42CF7B5B                 mov     ecx, [ebp+arg_8]
.text:42CF7B5E                 neg     ecx
.text:42CF7B60                 sbb     ecx, ecx
.text:42CF7B62                 add     ecx, 2
.text:42CF7B65                 push    ecx
.text:42CF7B66                 push    offset aMicrosoftUnifi ; "Microsoft Unified Security Protocol Pro"...
.text:42CF7B6B                 push    0
.text:42CF7B6D                 call    dword_42D01114
.text:42CF7B73                 mov     [ebp+var_48], eax
.text:42CF7B76                 cmp     [ebp+var_48], 0
.text:42CF7B7A                 jz      short loc_42CF7B81
.text:42CF7B7C                 mov     eax, [ebp+var_48]
.text:42CF7B7F                 jmp     short loc_42CF7BBB
.text:42CF7B81 ; ---------------------------------------------------------------------------
.text:42CF7B81
.text:42CF7B81 loc_42CF7B81:                           ; CODE XREF: sub_42CF7A27+153\u2191j
.text:42CF7B81                 cmp     [ebp+var_4C], 0
.text:42CF7B85                 jz      short loc_42CF7B91
.text:42CF7B87                 mov     edx, [ebp+var_4C]
.text:42CF7B8A                 push    edx
.text:42CF7B8B                 call    dword_42D01178
.text:42CF7B91
.text:42CF7B91 loc_42CF7B91:                           ; CODE XREF: sub_42CF7A27+15E\u2191j
.text:42CF7B91                 lea     eax, [ebp+var_50]
.text:42CF7B94                 push    eax
.text:42CF7B95                 push    offset aMicrosoftUnifi_0 ; "Microsoft Unified Security Protocol Pro"...
.text:42CF7B9A                 call    dword_42D0114C
.text:42CF7BA0                 mov     [ebp+var_48], eax
.text:42CF7BA3                 mov     ecx, [ebp+var_50]
.text:42CF7BA6                 mov     edx, [ecx+8]
.text:42CF7BA9                 mov     dword_42D01B44, edx
.text:42CF7BAF                 mov     eax, [ebp+var_50]
.text:42CF7BB2                 push    eax
.text:42CF7BB3                 call    dword_42D01148
.text:42CF7BB9                 xor     eax, eax
.text:42CF7BBB
.text:42CF7BBB loc_42CF7BBB:                           ; CODE XREF: sub_42CF7A27+5F\u2191j
.text:42CF7BBB                                         ; sub_42CF7A27+A7\u2191j ...
.text:42CF7BBB                 mov     esp, ebp
.text:42CF7BBD                 pop     ebp
.text:42CF7BBE                 retn
.text:42CF7BBE sub_42CF7A27    endp
.text:42CF7BBE
.text:42CF7BBF
.text:42CF7BBF ; =============== S U B R O U T I N E =======================================
.text:42CF7BBF
.text:42CF7BBF ; Attributes: bp-based frame
.text:42CF7BBF
.text:42CF7BBF ; int __cdecl sub_42CF7BBF(void *, void *, int, int, char)
.text:42CF7BBF sub_42CF7BBF    proc near               ; CODE XREF: ConnectionRead+443\u2191p
.text:42CF7BBF                                         ; ConnectionReadAsyncWait+283\u2191p
.text:42CF7BBF
.text:42CF7BBF var_44          = dword ptr -44h
.text:42CF7BBF var_40          = dword ptr -40h
.text:42CF7BBF var_3C          = dword ptr -3Ch
.text:42CF7BBF var_38          = dword ptr -38h
.text:42CF7BBF var_34          = dword ptr -34h
.text:42CF7BBF Size            = dword ptr -30h
.text:42CF7BBF var_2C          = dword ptr -2Ch
.text:42CF7BBF Src             = dword ptr -28h
.text:42CF7BBF var_20          = dword ptr -20h
.text:42CF7BBF var_18          = dword ptr -18h
.text:42CF7BBF var_14          = dword ptr -14h
.text:42CF7BBF var_10          = dword ptr -10h
.text:42CF7BBF var_C           = dword ptr -0Ch
.text:42CF7BBF var_8           = dword ptr -8
.text:42CF7BBF var_4           = dword ptr -4
.text:42CF7BBF arg_0           = dword ptr  8
.text:42CF7BBF arg_4           = dword ptr  0Ch
.text:42CF7BBF arg_8           = dword ptr  10h
.text:42CF7BBF arg_C           = dword ptr  14h
.text:42CF7BBF arg_10          = byte ptr  18h
.text:42CF7BBF
.text:42CF7BBF                 push    ebp
.text:42CF7BC0                 mov     ebp, esp
.text:42CF7BC2                 sub     esp, 44h
.text:42CF7BC5                 mov     eax, [ebp+arg_8]
.text:42CF7BC8                 mov     ecx, [eax]
.text:42CF7BCA                 mov     [ebp+var_44], ecx
.text:42CF7BCD                 mov     edx, [ebp+arg_C]
.text:42CF7BD0                 mov     dword ptr [edx], 0
.text:42CF7BD6                 mov     [ebp+var_C], 0
.text:42CF7BDD                 mov     [ebp+var_8], 4
.text:42CF7BE4                 lea     eax, [ebp+var_3C]
.text:42CF7BE7                 mov     [ebp+var_4], eax
.text:42CF7BEA                 mov     ecx, [ebp+arg_0]
.text:42CF7BED                 mov     [ebp+var_34], ecx
.text:42CF7BF0                 mov     edx, [ebp+var_44]
.text:42CF7BF3                 mov     [ebp+var_3C], edx
.text:42CF7BF6                 mov     [ebp+var_38], 1
.text:42CF7BFD                 mov     [ebp+var_2C], 0
.text:42CF7C04                 mov     [ebp+var_20], 0
.text:42CF7C0B                 mov     [ebp+var_14], 0
.text:42CF7C12                 mov     eax, [ebp+arg_8]
.text:42CF7C15                 mov     dword ptr [eax], 0
.text:42CF7C1B                 cmp     dword_42D01A1C, 0
.text:42CF7C22                 jz      short loc_42CF7C3B
.text:42CF7C24                 push    0
.text:42CF7C26                 push    0
.text:42CF7C28                 lea     ecx, [ebp+var_C]
.text:42CF7C2B                 push    ecx
.text:42CF7C2C                 lea     edx, [ebp+arg_10]
.text:42CF7C2F                 push    edx
.text:42CF7C30                 call    dword_42D01170
.text:42CF7C36                 mov     [ebp+var_40], eax
.text:42CF7C39                 jmp     short loc_42CF7C50
.text:42CF7C3B ; ---------------------------------------------------------------------------
.text:42CF7C3B
.text:42CF7C3B loc_42CF7C3B:                           ; CODE XREF: sub_42CF7BBF+63\u2191j
.text:42CF7C3B                 push    0
.text:42CF7C3D                 push    0
.text:42CF7C3F                 lea     eax, [ebp+var_C]
.text:42CF7C42                 push    eax
.text:42CF7C43                 lea     ecx, [ebp+arg_10]
.text:42CF7C46                 push    ecx
.text:42CF7C47                 call    dword_42D01960
.text:42CF7C4D                 mov     [ebp+var_40], eax
.text:42CF7C50
.text:42CF7C50 loc_42CF7C50:                           ; CODE XREF: sub_42CF7BBF+7A\u2191j
.text:42CF7C50                 cmp     [ebp+var_40], 0
.text:42CF7C54                 jz      short loc_42CF7C64
.text:42CF7C56                 cmp     [ebp+var_40], 80090318h
.text:42CF7C5D                 jz      short loc_42CF7C64
.text:42CF7C5F                 jmp     loc_42CF7D6E
.text:42CF7C64 ; ---------------------------------------------------------------------------
.text:42CF7C64
.text:42CF7C64 loc_42CF7C64:                           ; CODE XREF: sub_42CF7BBF+95\u2191j
.text:42CF7C64                                         ; sub_42CF7BBF+9E\u2191j
.text:42CF7C64                 cmp     [ebp+var_40], 80090318h
.text:42CF7C6B                 jnz     short loc_42CF7C7F
.text:42CF7C6D                 mov     edx, [ebp+arg_C]
.text:42CF7C70                 mov     eax, [ebp+var_44]
.text:42CF7C73                 mov     [edx], eax
.text:42CF7C75                 mov     eax, 80090318h
.text:42CF7C7A                 jmp     loc_42CF7D71
.text:42CF7C7F ; ---------------------------------------------------------------------------
.text:42CF7C7F
.text:42CF7C7F loc_42CF7C7F:                           ; CODE XREF: sub_42CF7BBF+AC\u2191j
.text:42CF7C7F                 mov     ecx, [ebp+Size]
.text:42CF7C82                 push    ecx             ; Size
.text:42CF7C83                 mov     edx, [ebp+Src]
.text:42CF7C86                 push    edx             ; Src
.text:42CF7C87                 mov     eax, [ebp+arg_4]
.text:42CF7C8A                 push    eax             ; void *
.text:42CF7C8B                 call    memcpy
.text:42CF7C90                 add     esp, 0Ch
.text:42CF7C93                 mov     ecx, [ebp+arg_8]
.text:42CF7C96                 mov     edx, [ebp+Size]
.text:42CF7C99                 mov     [ecx], edx
.text:42CF7C9B
.text:42CF7C9B loc_42CF7C9B:                           ; CODE XREF: sub_42CF7BBF+1A6\u2193j
.text:42CF7C9B                 cmp     [ebp+var_14], 5
.text:42CF7C9F                 jnz     loc_42CF7D6A
.text:42CF7CA5                 mov     eax, [ebp+var_10]
.text:42CF7CA8                 mov     [ebp+var_34], eax
.text:42CF7CAB                 mov     ecx, [ebp+var_18]
.text:42CF7CAE                 mov     [ebp+var_3C], ecx
.text:42CF7CB1                 mov     [ebp+var_38], 1
.text:42CF7CB8                 mov     [ebp+var_2C], 0
.text:42CF7CBF                 mov     [ebp+var_20], 0
.text:42CF7CC6                 mov     [ebp+var_14], 0
.text:42CF7CCD                 cmp     dword_42D01A1C, 0
.text:42CF7CD4                 jz      short loc_42CF7CED
.text:42CF7CD6                 push    0
.text:42CF7CD8                 push    0
.text:42CF7CDA                 lea     edx, [ebp+var_C]
.text:42CF7CDD                 push    edx
.text:42CF7CDE                 lea     eax, [ebp+arg_10]
.text:42CF7CE1                 push    eax
.text:42CF7CE2                 call    dword_42D01170
.text:42CF7CE8                 mov     [ebp+var_40], eax
.text:42CF7CEB                 jmp     short loc_42CF7D02
.text:42CF7CED ; ---------------------------------------------------------------------------
.text:42CF7CED
.text:42CF7CED loc_42CF7CED:                           ; CODE XREF: sub_42CF7BBF+115\u2191j
.text:42CF7CED                 push    0
.text:42CF7CEF                 push    0
.text:42CF7CF1                 lea     ecx, [ebp+var_C]
.text:42CF7CF4                 push    ecx
.text:42CF7CF5                 lea     edx, [ebp+arg_10]
.text:42CF7CF8                 push    edx
.text:42CF7CF9                 call    dword_42D01960
.text:42CF7CFF                 mov     [ebp+var_40], eax
.text:42CF7D02
.text:42CF7D02 loc_42CF7D02:                           ; CODE XREF: sub_42CF7BBF+12C\u2191j
.text:42CF7D02                 cmp     [ebp+var_40], 0
.text:42CF7D06                 jz      short loc_42CF7D13
.text:42CF7D08                 cmp     [ebp+var_40], 80090318h
.text:42CF7D0F                 jz      short loc_42CF7D13
.text:42CF7D11                 jmp     short loc_42CF7D6E
.text:42CF7D13 ; ---------------------------------------------------------------------------
.text:42CF7D13
.text:42CF7D13 loc_42CF7D13:                           ; CODE XREF: sub_42CF7BBF+147\u2191j
.text:42CF7D13                                         ; sub_42CF7BBF+150\u2191j
.text:42CF7D13                 cmp     [ebp+var_40], 80090318h
.text:42CF7D1A                 jnz     short loc_42CF7D3F
.text:42CF7D1C                 mov     eax, [ebp+var_18]
.text:42CF7D1F                 push    eax             ; Size
.text:42CF7D20                 mov     ecx, [ebp+var_10]
.text:42CF7D23                 push    ecx             ; Src
.text:42CF7D24                 mov     edx, [ebp+arg_0]
.text:42CF7D27                 push    edx             ; void *
.text:42CF7D28                 call    memcpy
.text:42CF7D2D                 add     esp, 0Ch
.text:42CF7D30                 mov     eax, [ebp+arg_C]
.text:42CF7D33                 mov     ecx, [ebp+var_18]
.text:42CF7D36                 mov     [eax], ecx
.text:42CF7D38                 mov     eax, 80090318h
.text:42CF7D3D                 jmp     short loc_42CF7D71
.text:42CF7D3F ; ---------------------------------------------------------------------------
.text:42CF7D3F
.text:42CF7D3F loc_42CF7D3F:                           ; CODE XREF: sub_42CF7BBF+15B\u2191j
.text:42CF7D3F                 mov     edx, [ebp+Size]
.text:42CF7D42                 push    edx             ; Size
.text:42CF7D43                 mov     eax, [ebp+Src]
.text:42CF7D46                 push    eax             ; Src
.text:42CF7D47                 mov     ecx, [ebp+arg_8]
.text:42CF7D4A                 mov     edx, [ebp+arg_4]
.text:42CF7D4D                 add     edx, [ecx]
.text:42CF7D4F                 push    edx             ; void *
.text:42CF7D50                 call    memcpy
.text:42CF7D55                 add     esp, 0Ch
.text:42CF7D58                 mov     eax, [ebp+arg_8]
.text:42CF7D5B                 mov     ecx, [eax]
.text:42CF7D5D                 add     ecx, [ebp+Size]
.text:42CF7D60                 mov     edx, [ebp+arg_8]
.text:42CF7D63                 mov     [edx], ecx
.text:42CF7D65                 jmp     loc_42CF7C9B
.text:42CF7D6A ; ---------------------------------------------------------------------------
.text:42CF7D6A
.text:42CF7D6A loc_42CF7D6A:                           ; CODE XREF: sub_42CF7BBF+E0\u2191j
.text:42CF7D6A                 xor     eax, eax
.text:42CF7D6C                 jmp     short loc_42CF7D71
.text:42CF7D6E ; ---------------------------------------------------------------------------
.text:42CF7D6E
.text:42CF7D6E loc_42CF7D6E:                           ; CODE XREF: sub_42CF7BBF+A0\u2191j
.text:42CF7D6E                                         ; sub_42CF7BBF+152\u2191j
.text:42CF7D6E                 mov     eax, [ebp+var_40]
.text:42CF7D71
.text:42CF7D71 loc_42CF7D71:                           ; CODE XREF: sub_42CF7BBF+BB\u2191j
.text:42CF7D71                                         ; sub_42CF7BBF+17E\u2191j ...
.text:42CF7D71                 mov     esp, ebp
.text:42CF7D73                 pop     ebp
.text:42CF7D74                 retn
.text:42CF7D74 sub_42CF7BBF    endp
.text:42CF7D74
.text:42CF7D75
.text:42CF7D75 ; =============== S U B R O U T I N E =======================================
.text:42CF7D75
.text:42CF7D75 ; Attributes: bp-based frame
.text:42CF7D75
.text:42CF7D75 sub_42CF7D75    proc near               ; CODE XREF: ConnectionWrite+105\u2191p
.text:42CF7D75                                         ; ConnectionWriteAsync+105\u2191p
.text:42CF7D75
.text:42CF7D75 var_40          = dword ptr -40h
.text:42CF7D75 var_3C          = dword ptr -3Ch
.text:42CF7D75 var_38          = dword ptr -38h
.text:42CF7D75 var_34          = dword ptr -34h
.text:42CF7D75 var_30          = dword ptr -30h
.text:42CF7D75 var_2C          = dword ptr -2Ch
.text:42CF7D75 var_28          = dword ptr -28h
.text:42CF7D75 var_24          = dword ptr -24h
.text:42CF7D75 var_20          = dword ptr -20h
.text:42CF7D75 var_1C          = dword ptr -1Ch
.text:42CF7D75 var_14          = dword ptr -14h
.text:42CF7D75 var_C           = dword ptr -0Ch
.text:42CF7D75 var_8           = dword ptr -8
.text:42CF7D75 var_4           = dword ptr -4
.text:42CF7D75 arg_0           = dword ptr  8
.text:42CF7D75 arg_4           = byte ptr  0Ch
.text:42CF7D75 arg_C           = dword ptr  14h
.text:42CF7D75 arg_10          = dword ptr  18h
.text:42CF7D75 arg_20          = dword ptr  28h
.text:42CF7D75 arg_24          = dword ptr  2Ch
.text:42CF7D75
.text:42CF7D75                 push    ebp
.text:42CF7D76                 mov     ebp, esp
.text:42CF7D78                 sub     esp, 40h
.text:42CF7D7B                 mov     [ebp+var_C], 0
.text:42CF7D82                 mov     [ebp+var_8], 4
.text:42CF7D89                 lea     eax, [ebp+var_3C]
.text:42CF7D8C                 mov     [ebp+var_4], eax
.text:42CF7D8F                 mov     ecx, [ebp+arg_20]
.text:42CF7D92                 mov     [ebp+var_34], ecx
.text:42CF7D95                 mov     edx, [ebp+arg_C]
.text:42CF7D98                 mov     [ebp+var_3C], edx
.text:42CF7D9B                 mov     [ebp+var_38], 7
.text:42CF7DA2                 mov     eax, [ebp+arg_20]
.text:42CF7DA5                 add     eax, [ebp+arg_C]
.text:42CF7DA8                 mov     [ebp+var_28], eax
.text:42CF7DAB                 mov     ecx, [ebp+arg_0]
.text:42CF7DAE                 mov     [ebp+var_30], ecx
.text:42CF7DB1                 mov     [ebp+var_2C], 1
.text:42CF7DB8                 mov     edx, [ebp+arg_20]
.text:42CF7DBB                 add     edx, [ebp+arg_C]
.text:42CF7DBE                 add     edx, [ebp+arg_0]
.text:42CF7DC1                 mov     [ebp+var_1C], edx
.text:42CF7DC4                 mov     eax, [ebp+arg_10]
.text:42CF7DC7                 mov     [ebp+var_24], eax
.text:42CF7DCA                 mov     [ebp+var_20], 6
.text:42CF7DD1                 mov     [ebp+var_14], 0
.text:42CF7DD8                 cmp     dword_42D01A1C, 0
.text:42CF7DDF                 jz      short loc_42CF7DF8
.text:42CF7DE1                 push    0
.text:42CF7DE3                 lea     ecx, [ebp+var_C]
.text:42CF7DE6                 push    ecx
.text:42CF7DE7                 push    0
.text:42CF7DE9                 lea     edx, [ebp+arg_4]
.text:42CF7DEC                 push    edx
.text:42CF7DED                 call    dword_42D0116C
.text:42CF7DF3                 mov     [ebp+var_40], eax
.text:42CF7DF6                 jmp     short loc_42CF7E0D
.text:42CF7DF8 ; ---------------------------------------------------------------------------
.text:42CF7DF8
.text:42CF7DF8 loc_42CF7DF8:                           ; CODE XREF: sub_42CF7D75+6A\u2191j
.text:42CF7DF8                 push    0
.text:42CF7DFA                 lea     eax, [ebp+var_C]
.text:42CF7DFD                 push    eax
.text:42CF7DFE                 push    0
.text:42CF7E00                 lea     ecx, [ebp+arg_4]
.text:42CF7E03                 push    ecx
.text:42CF7E04                 call    dword_42D01964
.text:42CF7E0A                 mov     [ebp+var_40], eax
.text:42CF7E0D
.text:42CF7E0D loc_42CF7E0D:                           ; CODE XREF: sub_42CF7D75+81\u2191j
.text:42CF7E0D                 cmp     [ebp+var_40], 0
.text:42CF7E11                 jge     short loc_42CF7E1F
.text:42CF7E13                 mov     edx, [ebp+arg_24]
.text:42CF7E16                 mov     eax, [ebp+var_40]
.text:42CF7E19                 mov     [edx], eax
.text:42CF7E1B                 xor     eax, eax
.text:42CF7E1D                 jmp     short loc_42CF7E28
.text:42CF7E1F ; ---------------------------------------------------------------------------
.text:42CF7E1F
.text:42CF7E1F loc_42CF7E1F:                           ; CODE XREF: sub_42CF7D75+9C\u2191j
.text:42CF7E1F                 mov     eax, [ebp+var_3C]
.text:42CF7E22                 add     eax, [ebp+var_30]
.text:42CF7E25                 add     eax, [ebp+var_24]
.text:42CF7E28
.text:42CF7E28 loc_42CF7E28:                           ; CODE XREF: sub_42CF7D75+A8\u2191j
.text:42CF7E28                 mov     esp, ebp
.text:42CF7E2A                 pop     ebp
.text:42CF7E2B                 retn
.text:42CF7E2B sub_42CF7D75    endp
.text:42CF7E2B
.text:42CF7E2C
.text:42CF7E2C ; =============== S U B R O U T I N E =======================================
.text:42CF7E2C
.text:42CF7E2C ; Attributes: bp-based frame
.text:42CF7E2C
.text:42CF7E2C sub_42CF7E2C    proc near               ; CODE XREF: sub_42CF7275+272\u2191p
.text:42CF7E2C
.text:42CF7E2C arg_0           = dword ptr  8
.text:42CF7E2C arg_4           = dword ptr  0Ch
.text:42CF7E2C
.text:42CF7E2C                 push    ebp
.text:42CF7E2D                 mov     ebp, esp
.text:42CF7E2F                 mov     eax, [ebp+arg_0]
.text:42CF7E32                 push    eax
.text:42CF7E33                 push    4
.text:42CF7E35                 mov     ecx, [ebp+arg_4]
.text:42CF7E38                 push    ecx
.text:42CF7E39                 call    dword_42D01134
.text:42CF7E3F                 pop     ebp
.text:42CF7E40                 retn
.text:42CF7E40 sub_42CF7E2C    endp
.text:42CF7E40
.text:42CF7E41
.text:42CF7E41 ; =============== S U B R O U T I N E =======================================
.text:42CF7E41
.text:42CF7E41 ; Attributes: bp-based frame
.text:42CF7E41
.text:42CF7E41 sub_42CF7E41    proc near               ; CODE XREF: sub_42CF7930+77\u2191p
.text:42CF7E41
.text:42CF7E41 lpProcName      = dword ptr -5Ch
.text:42CF7E41 var_58          = dword ptr -58h
.text:42CF7E41 var_54          = dword ptr -54h
.text:42CF7E41 var_50          = dword ptr -50h
.text:42CF7E41 var_4C          = dword ptr -4Ch
.text:42CF7E41 var_48          = dword ptr -48h
.text:42CF7E41 var_44          = dword ptr -44h
.text:42CF7E41 var_40          = dword ptr -40h
.text:42CF7E41 var_3C          = dword ptr -3Ch
.text:42CF7E41 var_38          = dword ptr -38h
.text:42CF7E41 var_34          = dword ptr -34h
.text:42CF7E41 Src             = dword ptr -30h
.text:42CF7E41 var_4           = dword ptr -4
.text:42CF7E41
.text:42CF7E41                 push    ebp
.text:42CF7E42                 mov     ebp, esp
.text:42CF7E44                 sub     esp, 5Ch
.text:42CF7E47                 mov     [ebp+lpProcName], offset aCertfreecertif ; "CertFreeCertificateContext"
.text:42CF7E4E                 mov     [ebp+var_58], offset aCertfindcertif ; "CertFindCertificateInStore"
.text:42CF7E55                 mov     [ebp+var_54], offset aCertopensystem ; "CertOpenSystemStoreA"
.text:42CF7E5C                 mov     [ebp+var_50], offset aCertopenstore ; "CertOpenStore"
.text:42CF7E63                 mov     [ebp+var_4C], offset aCertgetissuerc ; "CertGetIssuerCertificateFromStore"
.text:42CF7E6A                 mov     [ebp+var_48], offset aCertnametostra ; "CertNameToStrA"
.text:42CF7E71                 mov     [ebp+var_44], offset aCertnametostrw ; "CertNameToStrW"
.text:42CF7E78                 mov     [ebp+var_40], offset aCertfreecertif_0 ; "CertFreeCertificateChain"
.text:42CF7E7F                 mov     [ebp+var_3C], offset aCertverifycert ; "CertVerifyCertificateChainPolicy"
.text:42CF7E86                 mov     [ebp+var_38], offset aCertgetcertifi ; "CertGetCertificateChain"
.text:42CF7E8D                 mov     [ebp+var_34], offset aCertfindchaini ; "CertFindChainInStore"
.text:42CF7E94                 push    offset aCrypt32Dll ; "crypt32.dll"
.text:42CF7E99                 call    ds:LoadLibraryA
.text:42CF7E9F                 mov     dword_42D01968, eax
.text:42CF7EA4                 cmp     dword_42D01968, 0
.text:42CF7EAB                 jnz     short loc_42CF7EB1
.text:42CF7EAD                 xor     eax, eax
.text:42CF7EAF                 jmp     short loc_42CF7F18
.text:42CF7EB1 ; ---------------------------------------------------------------------------
.text:42CF7EB1
.text:42CF7EB1 loc_42CF7EB1:                           ; CODE XREF: sub_42CF7E41+6A\u2191j
.text:42CF7EB1                 mov     [ebp+var_4], 0
.text:42CF7EB8                 jmp     short loc_42CF7EC3
.text:42CF7EBA ; ---------------------------------------------------------------------------
.text:42CF7EBA
.text:42CF7EBA loc_42CF7EBA:                           ; CODE XREF: sub_42CF7E41:loc_42CF7EFE\u2193j
.text:42CF7EBA                 mov     eax, [ebp+var_4]
.text:42CF7EBD                 add     eax, 1
.text:42CF7EC0                 mov     [ebp+var_4], eax
.text:42CF7EC3
.text:42CF7EC3 loc_42CF7EC3:                           ; CODE XREF: sub_42CF7E41+77\u2191j
.text:42CF7EC3                 cmp     [ebp+var_4], 0Bh
.text:42CF7EC7                 jge     short loc_42CF7F00
.text:42CF7EC9                 mov     ecx, [ebp+var_4]
.text:42CF7ECC                 mov     edx, [ebp+ecx*4+lpProcName]
.text:42CF7ED0                 push    edx             ; lpProcName
.text:42CF7ED1                 mov     eax, dword_42D01968
.text:42CF7ED6                 push    eax             ; hModule
.text:42CF7ED7                 call    ds:GetProcAddress
.text:42CF7EDD                 mov     ecx, [ebp+var_4]
.text:42CF7EE0                 mov     [ebp+ecx*4+Src], eax
.text:42CF7EE4                 mov     edx, [ebp+var_4]
.text:42CF7EE7                 cmp     [ebp+edx*4+Src], 0
.text:42CF7EEC                 jnz     short loc_42CF7EFE
.text:42CF7EEE                 mov     eax, dword_42D01968
.text:42CF7EF3                 push    eax             ; hLibModule
.text:42CF7EF4                 call    ds:FreeLibrary
.text:42CF7EFA                 xor     eax, eax
.text:42CF7EFC                 jmp     short loc_42CF7F18
.text:42CF7EFE ; ---------------------------------------------------------------------------
.text:42CF7EFE
.text:42CF7EFE loc_42CF7EFE:                           ; CODE XREF: sub_42CF7E41+AB\u2191j
.text:42CF7EFE                 jmp     short loc_42CF7EBA
.text:42CF7F00 ; ---------------------------------------------------------------------------
.text:42CF7F00
.text:42CF7F00 loc_42CF7F00:                           ; CODE XREF: sub_42CF7E41+86\u2191j
.text:42CF7F00                 push    2Ch ; ','       ; Size
.text:42CF7F02                 lea     ecx, [ebp+Src]
.text:42CF7F05                 push    ecx             ; Src
.text:42CF7F06                 push    offset dword_42D01178 ; void *
.text:42CF7F0B                 call    memcpy
.text:42CF7F10                 add     esp, 0Ch
.text:42CF7F13                 mov     eax, 1
.text:42CF7F18
.text:42CF7F18 loc_42CF7F18:                           ; CODE XREF: sub_42CF7E41+6E\u2191j
.text:42CF7F18                                         ; sub_42CF7E41+BB\u2191j
.text:42CF7F18                 mov     esp, ebp
.text:42CF7F1A                 pop     ebp
.text:42CF7F1B                 retn
.text:42CF7F1B sub_42CF7E41    endp
.text:42CF7F1B
.text:42CF7F1C ; ---------------------------------------------------------------------------
.text:42CF7F1C                 push    ebp
.text:42CF7F1D                 mov     ebp, esp
.text:42CF7F1F                 cmp     dword_42D01968, 0
.text:42CF7F26                 jz      short loc_42CF7F3E
.text:42CF7F28                 mov     eax, dword_42D01968
.text:42CF7F2D                 push    eax
.text:42CF7F2E                 call    ds:FreeLibrary
.text:42CF7F34                 mov     dword_42D01968, 0
.text:42CF7F3E
.text:42CF7F3E loc_42CF7F3E:                           ; CODE XREF: .text:42CF7F26\u2191j
.text:42CF7F3E                 cmp     dword_42D011A4, 0
.text:42CF7F45                 jz      short loc_42CF7F5E
.text:42CF7F47                 mov     ecx, dword_42D011A4
.text:42CF7F4D                 push    ecx
.text:42CF7F4E                 call    ds:FreeLibrary
.text:42CF7F54                 mov     dword_42D011A4, 0
.text:42CF7F5E
.text:42CF7F5E loc_42CF7F5E:                           ; CODE XREF: .text:42CF7F45\u2191j
.text:42CF7F5E                 pop     ebp
.text:42CF7F5F                 retn
.text:42CF7F60
.text:42CF7F60 ; =============== S U B R O U T I N E =======================================
.text:42CF7F60
.text:42CF7F60 ; Attributes: bp-based frame
.text:42CF7F60
.text:42CF7F60 sub_42CF7F60    proc near               ; CODE XREF: ConnectionClose+44A\u2191p
.text:42CF7F60
.text:42CF7F60 arg_0           = dword ptr  8
.text:42CF7F60
.text:42CF7F60                 push    ebp
.text:42CF7F61                 mov     ebp, esp
.text:42CF7F63                 mov     eax, [ebp+arg_0]
.text:42CF7F66                 push    eax
.text:42CF7F67                 call    dword_42D0112C
.text:42CF7F6D                 pop     ebp
.text:42CF7F6E                 retn
.text:42CF7F6E sub_42CF7F60    endp
.text:42CF7F6E
.text:42CF7F6F
.text:42CF7F6F ; =============== S U B R O U T I N E =======================================
.text:42CF7F6F
.text:42CF7F6F ; Attributes: bp-based frame
.text:42CF7F6F
.text:42CF7F6F ; int __cdecl sub_42CF7F6F(int, int, int, void *, int)
.text:42CF7F6F sub_42CF7F6F    proc near               ; CODE XREF: sub_42CF7275+251\u2191p
.text:42CF7F6F
.text:42CF7F6F Destination     = byte ptr -20h
.text:42CF7F6F var_4           = dword ptr -4
.text:42CF7F6F arg_0           = dword ptr  8
.text:42CF7F6F arg_4           = dword ptr  0Ch
.text:42CF7F6F arg_8           = dword ptr  10h
.text:42CF7F6F arg_C           = dword ptr  14h
.text:42CF7F6F arg_10          = dword ptr  18h
.text:42CF7F6F
.text:42CF7F6F                 push    ebp
.text:42CF7F70                 mov     ebp, esp
.text:42CF7F72                 sub     esp, 20h
.text:42CF7F75                 mov     eax, [ebp+arg_0]
.text:42CF7F78                 mov     ecx, [eax+4Ch]
.text:42CF7F7B                 mov     [ebp+var_4], ecx
.text:42CF7F7E
.text:42CF7F7E loc_42CF7F7E:                           ; CODE XREF: sub_42CF7F6F:loc_42CF8257\u2193j
.text:42CF7F7E                 mov     edx, [ebp+arg_0]
.text:42CF7F81                 cmp     dword ptr [edx+8], 90312h
.text:42CF7F88                 jz      short loc_42CF7FA6
.text:42CF7F8A                 mov     eax, [ebp+arg_0]
.text:42CF7F8D                 cmp     dword ptr [eax+8], 80090318h
.text:42CF7F94                 jz      short loc_42CF7FA6
.text:42CF7F96                 mov     ecx, [ebp+arg_0]
.text:42CF7F99                 cmp     dword ptr [ecx+8], 90320h
.text:42CF7FA0                 jnz     loc_42CF825C
.text:42CF7FA6
.text:42CF7FA6 loc_42CF7FA6:                           ; CODE XREF: sub_42CF7F6F+19\u2191j
.text:42CF7FA6                                         ; sub_42CF7F6F+25\u2191j
.text:42CF7FA6                 mov     edx, [ebp+arg_0]
.text:42CF7FA9                 mov     eax, [ebp+var_4]
.text:42CF7FAC                 mov     [edx+2Ch], eax
.text:42CF7FAF                 mov     ecx, [ebp+arg_0]
.text:42CF7FB2                 mov     edx, [ebp+arg_0]
.text:42CF7FB5                 mov     eax, [edx+50h]
.text:42CF7FB8                 mov     [ecx+24h], eax
.text:42CF7FBB                 mov     ecx, [ebp+arg_0]
.text:42CF7FBE                 mov     dword ptr [ecx+28h], 2
.text:42CF7FC5                 mov     edx, [ebp+arg_0]
.text:42CF7FC8                 mov     dword ptr [edx+38h], 0
.text:42CF7FCF                 mov     eax, [ebp+arg_0]
.text:42CF7FD2                 mov     dword ptr [eax+30h], 0
.text:42CF7FD9                 mov     ecx, [ebp+arg_0]
.text:42CF7FDC                 mov     dword ptr [ecx+34h], 0
.text:42CF7FE3                 mov     edx, [ebp+arg_0]
.text:42CF7FE6                 mov     dword ptr [edx+10h], 2
.text:42CF7FED                 mov     eax, [ebp+arg_0]
.text:42CF7FF0                 add     eax, 24h ; '$'
.text:42CF7FF3                 mov     ecx, [ebp+arg_0]
.text:42CF7FF6                 mov     [ecx+14h], eax
.text:42CF7FF9                 mov     edx, [ebp+arg_0]
.text:42CF7FFC                 mov     dword ptr [edx+0Ch], 0
.text:42CF8003                 mov     eax, [ebp+arg_0]
.text:42CF8006                 mov     dword ptr [eax+44h], 0
.text:42CF800D                 mov     ecx, [ebp+arg_0]
.text:42CF8010                 mov     dword ptr [ecx+40h], 2
.text:42CF8017                 mov     edx, [ebp+arg_0]
.text:42CF801A                 mov     dword ptr [edx+3Ch], 0
.text:42CF8021                 mov     eax, [ebp+arg_0]
.text:42CF8024                 push    eax
.text:42CF8025                 mov     ecx, [ebp+arg_0]
.text:42CF8028                 add     ecx, 58h ; 'X'
.text:42CF802B                 push    ecx
.text:42CF802C                 mov     edx, [ebp+arg_0]
.text:42CF802F                 add     edx, 18h
.text:42CF8032                 push    edx
.text:42CF8033                 mov     eax, [ebp+arg_0]
.text:42CF8036                 mov     ecx, [eax+48h]
.text:42CF8039                 neg     ecx
.text:42CF803B                 sbb     ecx, ecx
.text:42CF803D                 and     ecx, [ebp+arg_4]
.text:42CF8040                 push    ecx
.text:42CF8041                 push    10h
.text:42CF8043                 mov     edx, [ebp+arg_0]
.text:42CF8046                 mov     eax, [edx+54h]
.text:42CF8049                 push    eax
.text:42CF804A                 mov     ecx, [ebp+arg_0]
.text:42CF804D                 add     ecx, 0Ch
.text:42CF8050                 push    ecx
.text:42CF8051                 mov     edx, [ebp+arg_0]
.text:42CF8054                 mov     eax, [edx+48h]
.text:42CF8057                 neg     eax
.text:42CF8059                 sbb     eax, eax
.text:42CF805B                 not     eax
.text:42CF805D                 and     eax, [ebp+arg_4]
.text:42CF8060                 push    eax
.text:42CF8061                 mov     ecx, [ebp+arg_8]
.text:42CF8064                 push    ecx
.text:42CF8065                 call    dword_42D01124
.text:42CF806B                 mov     edx, [ebp+arg_0]
.text:42CF806E                 mov     [edx+8], eax
.text:42CF8071                 lea     eax, [ebp+Destination]
.text:42CF8074                 push    eax             ; Destination
.text:42CF8075                 mov     ecx, [ebp+arg_0]
.text:42CF8078                 mov     edx, [ecx+8]
.text:42CF807B                 push    edx             ; int
.text:42CF807C                 call    sub_42CF8270
.text:42CF8081                 add     esp, 8
.text:42CF8084                 mov     eax, [ebp+arg_0]
.text:42CF8087                 mov     dword ptr [eax+48h], 0
.text:42CF808E                 mov     ecx, [ebp+arg_0]
.text:42CF8091                 cmp     dword ptr [ecx+8], 0
.text:42CF8095                 jz      short loc_42CF80C4
.text:42CF8097                 mov     edx, [ebp+arg_0]
.text:42CF809A                 cmp     dword ptr [edx+8], 90312h
.text:42CF80A1                 jz      short loc_42CF80C4
.text:42CF80A3                 mov     eax, [ebp+arg_0]
.text:42CF80A6                 cmp     dword ptr [eax+8], 0
.text:42CF80AA                 jge     loc_42CF8187
.text:42CF80B0                 mov     ecx, [ebp+arg_0]
.text:42CF80B3                 mov     edx, [ecx+58h]
.text:42CF80B6                 and     edx, 4000h
.text:42CF80BC                 test    edx, edx
.text:42CF80BE                 jz      loc_42CF8187
.text:42CF80C4
.text:42CF80C4 loc_42CF80C4:                           ; CODE XREF: sub_42CF7F6F+126\u2191j
.text:42CF80C4                                         ; sub_42CF7F6F+132\u2191j
.text:42CF80C4                 mov     eax, [ebp+arg_0]
.text:42CF80C7                 cmp     dword ptr [eax+3Ch], 0
.text:42CF80CB                 jz      loc_42CF8187
.text:42CF80D1                 mov     ecx, [ebp+arg_0]
.text:42CF80D4                 cmp     dword ptr [ecx+44h], 0
.text:42CF80D8                 jz      loc_42CF8187
.text:42CF80DE                 mov     edx, [ebp+arg_0]
.text:42CF80E1                 mov     eax, [ebp+arg_10]
.text:42CF80E4                 mov     ecx, [edx+3Ch]
.text:42CF80E7                 cmp     ecx, [eax]
.text:42CF80E9                 jbe     short loc_42CF8139
.text:42CF80EB                 mov     edx, [ebp+arg_0]
.text:42CF80EE                 mov     eax, [ebp+arg_10]
.text:42CF80F1                 mov     ecx, [edx+3Ch]
.text:42CF80F4                 sub     ecx, [eax]
.text:42CF80F6                 mov     edx, [ebp+arg_0]
.text:42CF80F9                 mov     [edx+60h], ecx
.text:42CF80FC                 mov     eax, [ebp+arg_10]
.text:42CF80FF                 mov     ecx, [eax]
.text:42CF8101                 push    ecx             ; Size
.text:42CF8102                 mov     edx, [ebp+arg_0]
.text:42CF8105                 mov     eax, [edx+44h]
.text:42CF8108                 push    eax             ; Src
.text:42CF8109                 mov     ecx, [ebp+arg_C]
.text:42CF810C                 push    ecx             ; void *
.text:42CF810D                 call    memcpy
.text:42CF8112                 add     esp, 0Ch
.text:42CF8115                 mov     edx, [ebp+arg_0]
.text:42CF8118                 mov     eax, [edx+60h]
.text:42CF811B                 push    eax             ; Size
.text:42CF811C                 mov     ecx, [ebp+arg_0]
.text:42CF811F                 mov     edx, [ecx+44h]
.text:42CF8122                 mov     eax, [ebp+arg_10]
.text:42CF8125                 add     edx, [eax]
.text:42CF8127                 push    edx             ; Src
.text:42CF8128                 mov     ecx, [ebp+arg_0]
.text:42CF812B                 mov     edx, [ecx+5Ch]
.text:42CF812E                 push    edx             ; void *
.text:42CF812F                 call    memcpy
.text:42CF8134                 add     esp, 0Ch
.text:42CF8137                 jmp     short loc_42CF815D
.text:42CF8139 ; ---------------------------------------------------------------------------
.text:42CF8139
.text:42CF8139 loc_42CF8139:                           ; CODE XREF: sub_42CF7F6F+17A\u2191j
.text:42CF8139                 mov     eax, [ebp+arg_10]
.text:42CF813C                 mov     ecx, [ebp+arg_0]
.text:42CF813F                 mov     edx, [ecx+3Ch]
.text:42CF8142                 mov     [eax], edx
.text:42CF8144                 mov     eax, [ebp+arg_10]
.text:42CF8147                 mov     ecx, [eax]
.text:42CF8149                 push    ecx             ; Size
.text:42CF814A                 mov     edx, [ebp+arg_0]
.text:42CF814D                 mov     eax, [edx+44h]
.text:42CF8150                 push    eax             ; Src
.text:42CF8151                 mov     ecx, [ebp+arg_C]
.text:42CF8154                 push    ecx             ; void *
.text:42CF8155                 call    memcpy
.text:42CF815A                 add     esp, 0Ch
.text:42CF815D
.text:42CF815D loc_42CF815D:                           ; CODE XREF: sub_42CF7F6F+1C8\u2191j
.text:42CF815D                 mov     edx, [ebp+arg_0]
.text:42CF8160                 mov     eax, [edx+44h]
.text:42CF8163                 push    eax
.text:42CF8164                 call    dword_42D01148
.text:42CF816A                 mov     ecx, [ebp+arg_0]
.text:42CF816D                 mov     dword ptr [ecx+44h], 0
.text:42CF8174                 mov     edx, [ebp+arg_0]
.text:42CF8177                 cmp     dword ptr [edx+8], 0
.text:42CF817B                 jz      short loc_42CF8187
.text:42CF817D                 mov     eax, 1
.text:42CF8182                 jmp     loc_42CF8261
.text:42CF8187 ; ---------------------------------------------------------------------------
.text:42CF8187
.text:42CF8187 loc_42CF8187:                           ; CODE XREF: sub_42CF7F6F+13B\u2191j
.text:42CF8187                                         ; sub_42CF7F6F+14F\u2191j ...
.text:42CF8187                 mov     eax, [ebp+arg_0]
.text:42CF818A                 cmp     dword ptr [eax+8], 0
.text:42CF818E                 jnz     short loc_42CF81DD
.text:42CF8190                 mov     ecx, [ebp+arg_0]
.text:42CF8193                 cmp     dword ptr [ecx+34h], 5
.text:42CF8197                 jnz     short loc_42CF81CC
.text:42CF8199                 mov     edx, [ebp+arg_0]
.text:42CF819C                 mov     eax, [edx+30h]
.text:42CF819F                 push    eax             ; Size
.text:42CF81A0                 mov     ecx, [ebp+arg_0]
.text:42CF81A3                 mov     edx, [ebp+arg_0]
.text:42CF81A6                 mov     eax, [ecx+50h]
.text:42CF81A9                 sub     eax, [edx+30h]
.text:42CF81AC                 mov     ecx, [ebp+var_4]
.text:42CF81AF                 add     ecx, eax
.text:42CF81B1                 push    ecx             ; Src
.text:42CF81B2                 mov     edx, [ebp+var_4]
.text:42CF81B5                 push    edx             ; void *
.text:42CF81B6                 call    memcpy
.text:42CF81BB                 add     esp, 0Ch
.text:42CF81BE                 mov     eax, [ebp+arg_0]
.text:42CF81C1                 mov     ecx, [ebp+arg_0]
.text:42CF81C4                 mov     edx, [ecx+30h]
.text:42CF81C7                 mov     [eax+50h], edx
.text:42CF81CA                 jmp     short loc_42CF81D6
.text:42CF81CC ; ---------------------------------------------------------------------------
.text:42CF81CC
.text:42CF81CC loc_42CF81CC:                           ; CODE XREF: sub_42CF7F6F+228\u2191j
.text:42CF81CC                 mov     eax, [ebp+arg_0]
.text:42CF81CF                 mov     dword ptr [eax+50h], 0
.text:42CF81D6
.text:42CF81D6 loc_42CF81D6:                           ; CODE XREF: sub_42CF7F6F+25B\u2191j
.text:42CF81D6                 xor     eax, eax
.text:42CF81D8                 jmp     loc_42CF8261
.text:42CF81DD ; ---------------------------------------------------------------------------
.text:42CF81DD
.text:42CF81DD loc_42CF81DD:                           ; CODE XREF: sub_42CF7F6F+21F\u2191j
.text:42CF81DD                 mov     ecx, [ebp+arg_0]
.text:42CF81E0                 cmp     dword ptr [ecx+8], 0
.text:42CF81E4                 jge     short loc_42CF81F9
.text:42CF81E6                 mov     edx, [ebp+arg_0]
.text:42CF81E9                 cmp     dword ptr [edx+8], 80090318h
.text:42CF81F0                 jz      short loc_42CF81F9
.text:42CF81F2                 mov     eax, 3
.text:42CF81F7                 jmp     short loc_42CF8261
.text:42CF81F9 ; ---------------------------------------------------------------------------
.text:42CF81F9
.text:42CF81F9 loc_42CF81F9:                           ; CODE XREF: sub_42CF7F6F+275\u2191j
.text:42CF81F9                                         ; sub_42CF7F6F+281\u2191j
.text:42CF81F9                 mov     eax, [ebp+arg_0]
.text:42CF81FC                 cmp     dword ptr [eax+8], 80090318h
.text:42CF8203                 jz      short loc_42CF8257
.text:42CF8205                 mov     ecx, [ebp+arg_0]
.text:42CF8208                 cmp     dword ptr [ecx+8], 90320h
.text:42CF820F                 jz      short loc_42CF8257
.text:42CF8211                 mov     edx, [ebp+arg_0]
.text:42CF8214                 cmp     dword ptr [edx+34h], 5
.text:42CF8218                 jnz     short loc_42CF824D
.text:42CF821A                 mov     eax, [ebp+arg_0]
.text:42CF821D                 mov     ecx, [eax+30h]
.text:42CF8220                 push    ecx             ; Size
.text:42CF8221                 mov     edx, [ebp+arg_0]
.text:42CF8224                 mov     eax, [ebp+arg_0]
.text:42CF8227                 mov     ecx, [edx+50h]
.text:42CF822A                 sub     ecx, [eax+30h]
.text:42CF822D                 mov     edx, [ebp+var_4]
.text:42CF8230                 add     edx, ecx
.text:42CF8232                 push    edx             ; Src
.text:42CF8233                 mov     eax, [ebp+var_4]
.text:42CF8236                 push    eax             ; void *
.text:42CF8237                 call    memcpy
.text:42CF823C                 add     esp, 0Ch
.text:42CF823F                 mov     ecx, [ebp+arg_0]
.text:42CF8242                 mov     edx, [ebp+arg_0]
.text:42CF8245                 mov     eax, [edx+30h]
.text:42CF8248                 mov     [ecx+50h], eax
.text:42CF824B                 jmp     short loc_42CF8257
.text:42CF824D ; ---------------------------------------------------------------------------
.text:42CF824D
.text:42CF824D loc_42CF824D:                           ; CODE XREF: sub_42CF7F6F+2A9\u2191j
.text:42CF824D                 mov     ecx, [ebp+arg_0]
.text:42CF8250                 mov     dword ptr [ecx+50h], 0
.text:42CF8257
.text:42CF8257 loc_42CF8257:                           ; CODE XREF: sub_42CF7F6F+294\u2191j
.text:42CF8257                                         ; sub_42CF7F6F+2A0\u2191j ...
.text:42CF8257                 jmp     loc_42CF7F7E
.text:42CF825C ; ---------------------------------------------------------------------------
.text:42CF825C
.text:42CF825C loc_42CF825C:                           ; CODE XREF: sub_42CF7F6F+31\u2191j
.text:42CF825C                 mov     eax, 3
.text:42CF8261
.text:42CF8261 loc_42CF8261:                           ; CODE XREF: sub_42CF7F6F+213\u2191j
.text:42CF8261                                         ; sub_42CF7F6F+269\u2191j ...
.text:42CF8261                 mov     esp, ebp
.text:42CF8263                 pop     ebp
.text:42CF8264                 retn
.text:42CF8264 sub_42CF7F6F    endp
.text:42CF8264
.text:42CF8264 ; ---------------------------------------------------------------------------
.text:42CF8265                 align 10h
.text:42CF8270
.text:42CF8270 ; =============== S U B R O U T I N E =======================================
.text:42CF8270
.text:42CF8270 ; Attributes: bp-based frame
.text:42CF8270
.text:42CF8270 ; int __cdecl sub_42CF8270(int, char *Destination)
.text:42CF8270 sub_42CF8270    proc near               ; CODE XREF: sub_42CF7F6F+10D\u2191p
.text:42CF8270
.text:42CF8270 arg_0           = dword ptr  8
.text:42CF8270 Destination     = dword ptr  0Ch
.text:42CF8270
.text:42CF8270                 push    ebp
.text:42CF8271                 mov     ebp, esp
.text:42CF8273                 cmp     [ebp+arg_0], 0
.text:42CF8277                 jnz     short loc_42CF828C
.text:42CF8279                 push    offset aSecEOk  ; "SEC_E_OK"
.text:42CF827E                 mov     eax, [ebp+Destination]
.text:42CF8281                 push    eax             ; Destination
.text:42CF8282                 call    strcpy
.text:42CF8287                 add     esp, 8
.text:42CF828A                 jmp     short loc_42CF82F1
.text:42CF828C ; ---------------------------------------------------------------------------
.text:42CF828C
.text:42CF828C loc_42CF828C:                           ; CODE XREF: sub_42CF8270+7\u2191j
.text:42CF828C                 cmp     [ebp+arg_0], 90312h
.text:42CF8293                 jnz     short loc_42CF82A8
.text:42CF8295                 push    offset aSecIContinueNe ; "SEC_I_CONTINUE_NEEDED"
.text:42CF829A                 mov     ecx, [ebp+Destination]
.text:42CF829D                 push    ecx             ; Destination
.text:42CF829E                 call    strcpy
.text:42CF82A3                 add     esp, 8
.text:42CF82A6                 jmp     short loc_42CF82F1
.text:42CF82A8 ; ---------------------------------------------------------------------------
.text:42CF82A8
.text:42CF82A8 loc_42CF82A8:                           ; CODE XREF: sub_42CF8270+23\u2191j
.text:42CF82A8                 cmp     [ebp+arg_0], 80090318h
.text:42CF82AF                 jnz     short loc_42CF82C4
.text:42CF82B1                 push    offset aSecIIncomplete ; "SEC_I_INCOMPLETE_MESSAGE"
.text:42CF82B6                 mov     edx, [ebp+Destination]
.text:42CF82B9                 push    edx             ; Destination
.text:42CF82BA                 call    strcpy
.text:42CF82BF                 add     esp, 8
.text:42CF82C2                 jmp     short loc_42CF82F1
.text:42CF82C4 ; ---------------------------------------------------------------------------
.text:42CF82C4
.text:42CF82C4 loc_42CF82C4:                           ; CODE XREF: sub_42CF8270+3F\u2191j
.text:42CF82C4                 cmp     [ebp+arg_0], 90320h
.text:42CF82CB                 jnz     short loc_42CF82E0
.text:42CF82CD                 push    offset aSecIIncomplete_0 ; "SEC_I_INCOMPLETE_CREDENTIALS"
.text:42CF82D2                 mov     eax, [ebp+Destination]
.text:42CF82D5                 push    eax             ; Destination
.text:42CF82D6                 call    strcpy
.text:42CF82DB                 add     esp, 8
.text:42CF82DE                 jmp     short loc_42CF82F1
.text:42CF82E0 ; ---------------------------------------------------------------------------
.text:42CF82E0
.text:42CF82E0 loc_42CF82E0:                           ; CODE XREF: sub_42CF8270+5B\u2191j
.text:42CF82E0                 push    offset aUnknown ; "UNKNOWN"
.text:42CF82E5                 mov     ecx, [ebp+Destination]
.text:42CF82E8                 push    ecx             ; Destination
.text:42CF82E9                 call    strcpy
.text:42CF82EE                 add     esp, 8
.text:42CF82F1
.text:42CF82F1 loc_42CF82F1:                           ; CODE XREF: sub_42CF8270+1A\u2191j
.text:42CF82F1                                         ; sub_42CF8270+36\u2191j ...
.text:42CF82F1                 pop     ebp
.text:42CF82F2                 retn
.text:42CF82F2 sub_42CF8270    endp
.text:42CF82F2
.text:42CF82F2 ; ---------------------------------------------------------------------------
.text:42CF82F3                 align 10h
.text:42CF8300
.text:42CF8300 ; =============== S U B R O U T I N E =======================================
.text:42CF8300
.text:42CF8300 ; Attributes: bp-based frame
.text:42CF8300
.text:42CF8300 ; int __cdecl sub_42CF8300(char *String1, PHKEY)
.text:42CF8300 sub_42CF8300    proc near               ; CODE XREF: ConnectionListen+118\u2191p
.text:42CF8300
.text:42CF8300 var_3800        = dword ptr -3800h
.text:42CF8300 var_37FC        = dword ptr -37FCh
.text:42CF8300 String          = dword ptr -37F8h
.text:42CF8300 Str1            = dword ptr -37F4h
.text:42CF8300 var_37F0        = byte ptr -37F0h
.text:42CF8300 var_37EC        = byte ptr -37ECh
.text:42CF8300 var_37E8        = byte ptr -37E8h
.text:42CF8300 Destination     = byte ptr -33E8h
.text:42CF8300 Str             = byte ptr -3258h
.text:42CF8300 var_3140        = byte ptr -3140h
.text:42CF8300 lpData          = dword ptr -3028h
.text:42CF8300 var_3024        = byte ptr -3024h
.text:42CF8300 var_3020        = byte ptr -3020h
.text:42CF8300 var_2FD4        = byte ptr -2FD4h
.text:42CF8300 var_2EBC        = byte ptr -2EBCh
.text:42CF8300 var_2DA4        = byte ptr -2DA4h
.text:42CF8300 var_2D24        = byte ptr -2D24h
.text:42CF8300 var_2D20        = byte ptr -2D20h
.text:42CF8300 cbData          = dword ptr -2C08h
.text:42CF8300 phkResult       = dword ptr -2C04h
.text:42CF8300 Type            = dword ptr -2C00h
.text:42CF8300 var_2BFC        = byte ptr -2BFCh
.text:42CF8300 var_2AE4        = byte ptr -2AE4h
.text:42CF8300 var_29CC        = byte ptr -29CCh
.text:42CF8300 var_294C        = byte ptr -294Ch
.text:42CF8300 SubKey          = byte ptr -274Ch
.text:42CF8300 var_2634        = dword ptr -2634h
.text:42CF8300 var_2630        = byte ptr -2630h
.text:42CF8300 Data            = byte ptr -2430h
.text:42CF8300 var_242C        = byte ptr -242Ch
.text:42CF8300 var_2428        = byte ptr -2428h
.text:42CF8300 var_488         = byte ptr -488h
.text:42CF8300 var_408         = byte ptr -408h
.text:42CF8300 var_404         = byte ptr -404h
.text:42CF8300 var_400         = byte ptr -400h
.text:42CF8300 String1         = dword ptr  8
.text:42CF8300 arg_4           = dword ptr  0Ch
.text:42CF8300
.text:42CF8300                 push    ebp
.text:42CF8301                 mov     ebp, esp
.text:42CF8303                 mov     eax, 3800h
.text:42CF8308                 call    __alloca_probe
.text:42CF830D                 push    edi
.text:42CF830E                 mov     eax, dword_42D002B8
.text:42CF8313                 mov     dword ptr [ebp+var_3024], eax
.text:42CF8319                 mov     ecx, 13h
.text:42CF831E                 xor     eax, eax
.text:42CF8320                 lea     edi, [ebp+var_3020]
.text:42CF8326                 rep stosd
.text:42CF8328                 push    2758h           ; Size
.text:42CF832D                 push    0               ; Val
.text:42CF832F                 mov     ecx, [ebp+arg_4]
.text:42CF8332                 push    ecx             ; void *
.text:42CF8333                 call    memset
.text:42CF8338                 add     esp, 0Ch
.text:42CF833B                 push    offset aMssqlserver_3 ; "MSSQLServer"
.text:42CF8340                 mov     edx, [ebp+String1]
.text:42CF8343                 push    edx             ; String1
.text:42CF8344                 call    ds:_stricmp
.text:42CF834A                 add     esp, 8
.text:42CF834D                 test    eax, eax
.text:42CF834F                 jnz     short loc_42CF8367
.text:42CF8351                 push    offset aSoftwareMicros ; "SOFTWARE\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CF8356                 lea     eax, [ebp+Destination]
.text:42CF835C                 push    eax             ; Destination
.text:42CF835D                 call    strcpy
.text:42CF8362                 add     esp, 8
.text:42CF8365                 jmp     short loc_42CF83A2
.text:42CF8367 ; ---------------------------------------------------------------------------
.text:42CF8367
.text:42CF8367 loc_42CF8367:                           ; CODE XREF: sub_42CF8300+4F\u2191j
.text:42CF8367                 push    offset aSoftwareMicros_0 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CF836C                 lea     ecx, [ebp+Destination]
.text:42CF8372                 push    ecx             ; Destination
.text:42CF8373                 call    strcpy
.text:42CF8378                 add     esp, 8
.text:42CF837B                 mov     edx, [ebp+String1]
.text:42CF837E                 push    edx             ; Source
.text:42CF837F                 lea     eax, [ebp+Destination]
.text:42CF8385                 push    eax             ; Destination
.text:42CF8386                 call    strcat
.text:42CF838B                 add     esp, 8
.text:42CF838E                 push    offset aMssqlserverSup ; "\\MSSQLServer\\SuperSocketNetLib\\"
.text:42CF8393                 lea     ecx, [ebp+Destination]
.text:42CF8399                 push    ecx             ; Destination
.text:42CF839A                 call    strcat
.text:42CF839F                 add     esp, 8
.text:42CF83A2
.text:42CF83A2 loc_42CF83A2:                           ; CODE XREF: sub_42CF8300+65\u2191j
.text:42CF83A2                 mov     edx, [ebp+arg_4]
.text:42CF83A5                 mov     dword ptr [edx+2734h], 0
.text:42CF83AF                 mov     eax, [ebp+arg_4]
.text:42CF83B2                 mov     dword ptr [eax+2738h], 0
.text:42CF83BC                 mov     ecx, [ebp+arg_4]
.text:42CF83BF                 mov     dword ptr [ecx+273Ch], 0
.text:42CF83C9                 mov     edx, [ebp+arg_4]
.text:42CF83CC                 mov     dword ptr [edx+2740h], 0
.text:42CF83D6                 mov     eax, [ebp+arg_4]
.text:42CF83D9                 mov     dword ptr [eax+2744h], 0
.text:42CF83E3                 mov     ecx, [ebp+arg_4]
.text:42CF83E6                 mov     dword ptr [ecx+2748h], 0
.text:42CF83F0                 mov     edx, [ebp+arg_4]
.text:42CF83F3                 mov     dword ptr [edx+274Ch], 0
.text:42CF83FD                 mov     eax, [ebp+arg_4]
.text:42CF8400                 mov     dword ptr [eax+2750h], 0
.text:42CF840A                 mov     ecx, [ebp+arg_4]
.text:42CF840D                 mov     dword ptr [ecx], 0
.text:42CF8413                 mov     edx, [ebp+arg_4]
.text:42CF8416                 mov     dword ptr [edx+2754h], 0
.text:42CF8420                 mov     dword_42D01B40, 0
.text:42CF842A                 mov     eax, [ebp+arg_4]
.text:42CF842D                 mov     dword ptr [eax+2730h], 5
.text:42CF8437                 lea     ecx, [ebp+phkResult]
.text:42CF843D                 push    ecx             ; phkResult
.text:42CF843E                 push    1               ; samDesired
.text:42CF8440                 push    0               ; ulOptions
.text:42CF8442                 lea     edx, [ebp+Destination]
.text:42CF8448                 push    edx             ; lpSubKey
.text:42CF8449                 push    80000002h       ; hKey
.text:42CF844E                 call    ds:RegOpenKeyExA
.text:42CF8454                 test    eax, eax
.text:42CF8456                 jnz     loc_42CF856A
.text:42CF845C                 mov     [ebp+cbData], 4
.text:42CF8466                 lea     eax, [ebp+cbData]
.text:42CF846C                 push    eax             ; lpcbData
.text:42CF846D                 lea     ecx, [ebp+Data]
.text:42CF8473                 push    ecx             ; lpData
.text:42CF8474                 lea     edx, [ebp+Type]
.text:42CF847A                 push    edx             ; lpType
.text:42CF847B                 push    0               ; lpReserved
.text:42CF847D                 push    offset ValueName ; "Encrypt"
.text:42CF8482                 mov     eax, [ebp+phkResult]
.text:42CF8488                 push    eax             ; hKey
.text:42CF8489                 call    ds:RegQueryValueExA
.text:42CF848F                 test    eax, eax
.text:42CF8491                 jnz     short loc_42CF84AF
.text:42CF8493                 cmp     [ebp+cbData], 0
.text:42CF849A                 jz      short loc_42CF84AF
.text:42CF849C                 cmp     dword ptr [ebp+Data], 0
.text:42CF84A3                 jbe     short loc_42CF84AF
.text:42CF84A5                 mov     dword_42D01B40, 1
.text:42CF84AF
.text:42CF84AF loc_42CF84AF:                           ; CODE XREF: sub_42CF8300+191\u2191j
.text:42CF84AF                                         ; sub_42CF8300+19A\u2191j ...
.text:42CF84AF                 mov     [ebp+cbData], 50h ; 'P'
.text:42CF84B9                 lea     ecx, [ebp+cbData]
.text:42CF84BF                 push    ecx             ; lpcbData
.text:42CF84C0                 lea     edx, [ebp+var_3024]
.text:42CF84C6                 push    edx             ; lpData
.text:42CF84C7                 lea     eax, [ebp+Type]
.text:42CF84CD                 push    eax             ; lpType
.text:42CF84CE                 push    0               ; lpReserved
.text:42CF84D0                 push    offset aProtocollist ; "ProtocolList"
.text:42CF84D5                 mov     ecx, [ebp+phkResult]
.text:42CF84DB                 push    ecx             ; hKey
.text:42CF84DC                 call    ds:RegQueryValueExA
.text:42CF84E2                 test    eax, eax
.text:42CF84E4                 jnz     short loc_42CF850A
.text:42CF84E6                 push    offset byte_42D011A8 ; Str2
.text:42CF84EB                 lea     edx, [ebp+var_3024]
.text:42CF84F1                 push    edx             ; Str1
.text:42CF84F2                 call    strcmp
.text:42CF84F7                 add     esp, 8
.text:42CF84FA                 test    eax, eax
.text:42CF84FC                 jz      short loc_42CF850A
.text:42CF84FE                 lea     eax, [ebp+var_3024]
.text:42CF8504                 mov     [ebp+var_2634], eax
.text:42CF850A
.text:42CF850A loc_42CF850A:                           ; CODE XREF: sub_42CF8300+1E4\u2191j
.text:42CF850A                                         ; sub_42CF8300+1FC\u2191j
.text:42CF850A                 mov     [ebp+cbData], 4
.text:42CF8514                 lea     ecx, [ebp+cbData]
.text:42CF851A                 push    ecx             ; lpcbData
.text:42CF851B                 lea     edx, [ebp+var_2D24]
.text:42CF8521                 push    edx             ; lpData
.text:42CF8522                 push    0               ; lpType
.text:42CF8524                 push    0               ; lpReserved
.text:42CF8526                 push    offset aWinsocklistenb ; "WinsockListenBacklog"
.text:42CF852B                 mov     eax, [ebp+phkResult]
.text:42CF8531                 push    eax             ; hKey
.text:42CF8532                 call    ds:RegQueryValueExA
.text:42CF8538                 test    eax, eax
.text:42CF853A                 jnz     short loc_42CF855D
.text:42CF853C                 cmp     [ebp+cbData], 0
.text:42CF8543                 jz      short loc_42CF855D
.text:42CF8545                 cmp     dword ptr [ebp+var_2D24], 0
.text:42CF854C                 jbe     short loc_42CF855D
.text:42CF854E                 mov     ecx, [ebp+arg_4]
.text:42CF8551                 mov     edx, dword ptr [ebp+var_2D24]
.text:42CF8557                 mov     [ecx+2730h], edx
.text:42CF855D
.text:42CF855D loc_42CF855D:                           ; CODE XREF: sub_42CF8300+23A\u2191j
.text:42CF855D                                         ; sub_42CF8300+243\u2191j ...
.text:42CF855D                 mov     eax, [ebp+phkResult]
.text:42CF8563                 push    eax             ; hKey
.text:42CF8564                 call    ds:RegCloseKey
.text:42CF856A
.text:42CF856A loc_42CF856A:                           ; CODE XREF: sub_42CF8300+156\u2191j
.text:42CF856A                 lea     ecx, [ebp+Destination]
.text:42CF8570                 push    ecx             ; Source
.text:42CF8571                 lea     edx, [ebp+Str]
.text:42CF8577                 push    edx             ; Destination
.text:42CF8578                 call    strcpy
.text:42CF857D                 add     esp, 8
.text:42CF8580                 push    offset aCluster ; "Cluster\\"
.text:42CF8585                 push    offset SubStr   ; "MSSQLServer\\SuperSocketNetLib"
.text:42CF858A                 lea     eax, [ebp+Str]
.text:42CF8590                 push    eax             ; Str
.text:42CF8591                 call    ds:strstr
.text:42CF8597                 add     esp, 8
.text:42CF859A                 push    eax             ; Destination
.text:42CF859B                 call    strcpy
.text:42CF85A0                 add     esp, 8
.text:42CF85A3                 lea     ecx, [ebp+phkResult]
.text:42CF85A9                 push    ecx             ; phkResult
.text:42CF85AA                 push    1               ; samDesired
.text:42CF85AC                 push    0               ; ulOptions
.text:42CF85AE                 lea     edx, [ebp+Str]
.text:42CF85B4                 push    edx             ; lpSubKey
.text:42CF85B5                 push    80000002h       ; hKey
.text:42CF85BA                 call    ds:RegOpenKeyExA
.text:42CF85C0                 test    eax, eax
.text:42CF85C2                 jnz     loc_42CF8734
.text:42CF85C8                 mov     eax, [ebp+arg_4]
.text:42CF85CB                 mov     dword ptr [eax+2750h], 1
.text:42CF85D5                 mov     [ebp+cbData], 0
.text:42CF85DF                 lea     ecx, [ebp+cbData]
.text:42CF85E5                 push    ecx             ; lpcbData
.text:42CF85E6                 push    0               ; lpData
.text:42CF85E8                 push    0               ; lpType
.text:42CF85EA                 push    0               ; lpReserved
.text:42CF85EC                 push    offset aClusteripaddr ; "ClusterIPAddr"
.text:42CF85F1                 mov     edx, [ebp+phkResult]
.text:42CF85F7                 push    edx             ; hKey
.text:42CF85F8                 call    ds:RegQueryValueExA
.text:42CF85FE                 mov     eax, [ebp+cbData]
.text:42CF8604                 push    eax             ; Size
.text:42CF8605                 call    ds:malloc
.text:42CF860B                 add     esp, 4
.text:42CF860E                 mov     [ebp+lpData], eax
.text:42CF8614                 lea     ecx, [ebp+cbData]
.text:42CF861A                 push    ecx             ; lpcbData
.text:42CF861B                 mov     edx, [ebp+lpData]
.text:42CF8621                 push    edx             ; lpData
.text:42CF8622                 push    0               ; lpType
.text:42CF8624                 push    0               ; lpReserved
.text:42CF8626                 push    offset aClusteripaddr_0 ; "ClusterIPAddr"
.text:42CF862B                 mov     eax, [ebp+phkResult]
.text:42CF8631                 push    eax             ; hKey
.text:42CF8632                 call    ds:RegQueryValueExA
.text:42CF8638                 test    eax, eax
.text:42CF863A                 jnz     loc_42CF86F0
.text:42CF8640                 mov     ecx, [ebp+lpData]
.text:42CF8646                 mov     [ebp+Str1], ecx
.text:42CF864C                 mov     edx, [ebp+arg_4]
.text:42CF864F                 mov     dword ptr [edx+252Ch], 0
.text:42CF8659
.text:42CF8659 loc_42CF8659:                           ; CODE XREF: sub_42CF8300+3EB\u2193j
.text:42CF8659                 push    offset byte_42D011AC ; Str2
.text:42CF865E                 mov     eax, [ebp+Str1]
.text:42CF8664                 push    eax             ; Str1
.text:42CF8665                 call    strcmp
.text:42CF866A                 add     esp, 8
.text:42CF866D                 test    eax, eax
.text:42CF866F                 jz      short loc_42CF86F0
.text:42CF8671                 mov     ecx, [ebp+Str1]
.text:42CF8677                 push    ecx             ; cp
.text:42CF8678                 call    inet_addr
.text:42CF867D                 mov     edx, [ebp+arg_4]
.text:42CF8680                 mov     ecx, [edx+252Ch]
.text:42CF8686                 mov     edx, [ebp+arg_4]
.text:42CF8689                 mov     [edx+ecx*4+152Ch], eax
.text:42CF8690                 mov     eax, [ebp+arg_4]
.text:42CF8693                 mov     ecx, [eax+252Ch]
.text:42CF8699                 mov     edx, [ebp+arg_4]
.text:42CF869C                 mov     eax, [edx+ecx*4+152Ch]
.text:42CF86A3                 mov     ecx, [ebp+arg_4]
.text:42CF86A6                 mov     edx, [ecx+252Ch]
.text:42CF86AC                 add     edx, 1
.text:42CF86AF                 mov     ecx, [ebp+arg_4]
.text:42CF86B2                 mov     [ecx+252Ch], edx
.text:42CF86B8                 cmp     eax, 0FFFFFFFFh
.text:42CF86BB                 jnz     short loc_42CF86CC
.text:42CF86BD                 mov     edx, [ebp+arg_4]
.text:42CF86C0                 mov     dword ptr [edx+252Ch], 0
.text:42CF86CA                 jmp     short loc_42CF86F0
.text:42CF86CC ; ---------------------------------------------------------------------------
.text:42CF86CC
.text:42CF86CC loc_42CF86CC:                           ; CODE XREF: sub_42CF8300+3BB\u2191j
.text:42CF86CC                 mov     eax, [ebp+Str1]
.text:42CF86D2                 push    eax             ; Str
.text:42CF86D3                 call    strlen
.text:42CF86D8                 add     esp, 4
.text:42CF86DB                 mov     ecx, [ebp+Str1]
.text:42CF86E1                 lea     edx, [ecx+eax+1]
.text:42CF86E5                 mov     [ebp+Str1], edx
.text:42CF86EB                 jmp     loc_42CF8659
.text:42CF86F0 ; ---------------------------------------------------------------------------
.text:42CF86F0
.text:42CF86F0 loc_42CF86F0:                           ; CODE XREF: sub_42CF8300+33A\u2191j
.text:42CF86F0                                         ; sub_42CF8300+36F\u2191j ...
.text:42CF86F0                 mov     eax, [ebp+lpData]
.text:42CF86F6                 push    eax             ; Block
.text:42CF86F7                 call    ds:free
.text:42CF86FD                 add     esp, 4
.text:42CF8700                 lea     ecx, [ebp+cbData]
.text:42CF8706                 push    ecx             ; lpcbData
.text:42CF8707                 mov     edx, [ebp+arg_4]
.text:42CF870A                 add     edx, 2530h
.text:42CF8710                 push    edx             ; lpData
.text:42CF8711                 push    0               ; lpType
.text:42CF8713                 push    0               ; lpReserved
.text:42CF8715                 push    offset aClustername ; "ClusterName"
.text:42CF871A                 mov     eax, [ebp+phkResult]
.text:42CF8720                 push    eax             ; hKey
.text:42CF8721                 call    ds:RegQueryValueExA
.text:42CF8727                 mov     ecx, [ebp+phkResult]
.text:42CF872D                 push    ecx             ; hKey
.text:42CF872E                 call    ds:RegCloseKey
.text:42CF8734
.text:42CF8734 loc_42CF8734:                           ; CODE XREF: sub_42CF8300+2C2\u2191j
.text:42CF8734                 lea     edx, [ebp+var_3024]
.text:42CF873A                 mov     [ebp+var_2634], edx
.text:42CF8740
.text:42CF8740 loc_42CF8740:                           ; CODE XREF: sub_42CF8300+1019\u2193j
.text:42CF8740                 cmp     [ebp+var_2634], 0
.text:42CF8747                 jz      loc_42CF931E
.text:42CF874D                 push    offset byte_42D011B0 ; Str2
.text:42CF8752                 mov     eax, [ebp+var_2634]
.text:42CF8758                 push    eax             ; Str1
.text:42CF8759                 call    strcmp
.text:42CF875E                 add     esp, 8
.text:42CF8761                 test    eax, eax
.text:42CF8763                 jz      loc_42CF931E
.text:42CF8769                 mov     ecx, [ebp+var_2634]
.text:42CF876F                 movsx   edx, byte ptr [ecx]
.text:42CF8772                 mov     [ebp+var_3800], edx
.text:42CF8778                 mov     eax, [ebp+var_3800]
.text:42CF877E                 sub     eax, 56h ; 'V'  ; switch 34 cases
.text:42CF8781                 mov     [ebp+var_3800], eax
.text:42CF8787                 cmp     [ebp+var_3800], 21h
.text:42CF878E                 ja      def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF8794                 mov     edx, [ebp+var_3800]
.text:42CF879A                 xor     ecx, ecx
.text:42CF879C                 mov     cl, ds:byte_42CF9366[edx]
.text:42CF87A2                 jmp     ds:jpt_42CF87A2[ecx*4] ; switch jump
.text:42CF87A9 ; ---------------------------------------------------------------------------
.text:42CF87A9
.text:42CF87A9 loc_42CF87A9:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF87A9                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF87A9                 mov     eax, [ebp+arg_4] ; jumptable 42CF87A2 case 116
.text:42CF87AC                 mov     dword ptr [eax+2734h], 1
.text:42CF87B6                 lea     ecx, [ebp+Destination]
.text:42CF87BC                 push    ecx             ; Source
.text:42CF87BD                 lea     edx, [ebp+SubKey]
.text:42CF87C3                 push    edx             ; Destination
.text:42CF87C4                 call    strcpy
.text:42CF87C9                 add     esp, 8
.text:42CF87CC                 push    offset aTcp_0   ; "Tcp"
.text:42CF87D1                 lea     eax, [ebp+SubKey]
.text:42CF87D7                 push    eax             ; Destination
.text:42CF87D8                 call    strcat
.text:42CF87DD                 add     esp, 8
.text:42CF87E0                 mov     ecx, [ebp+arg_4]
.text:42CF87E3                 mov     dword ptr [ecx+108h], 0
.text:42CF87ED                 mov     edx, [ebp+arg_4]
.text:42CF87F0                 mov     dword ptr [edx+314h], 0
.text:42CF87FA                 mov     eax, [ebp+arg_4]
.text:42CF87FD                 push    eax             ; phkResult
.text:42CF87FE                 push    3               ; samDesired
.text:42CF8800                 push    0               ; ulOptions
.text:42CF8802                 lea     ecx, [ebp+SubKey]
.text:42CF8808                 push    ecx             ; lpSubKey
.text:42CF8809                 push    80000002h       ; hKey
.text:42CF880E                 call    ds:RegOpenKeyExA
.text:42CF8814                 test    eax, eax
.text:42CF8816                 jnz     loc_42CF8A4E
.text:42CF881C                 mov     [ebp+cbData], 4
.text:42CF8826                 lea     edx, [ebp+cbData]
.text:42CF882C                 push    edx             ; lpcbData
.text:42CF882D                 lea     eax, [ebp+var_242C]
.text:42CF8833                 push    eax             ; lpData
.text:42CF8834                 lea     ecx, [ebp+Type]
.text:42CF883A                 push    ecx             ; lpType
.text:42CF883B                 push    0               ; lpReserved
.text:42CF883D                 push    offset aTcphideflag ; "TcpHideFlag"
.text:42CF8842                 mov     edx, [ebp+arg_4]
.text:42CF8845                 mov     eax, [edx]
.text:42CF8847                 push    eax             ; hKey
.text:42CF8848                 call    ds:RegQueryValueExA
.text:42CF884E                 test    eax, eax
.text:42CF8850                 jnz     short loc_42CF8888
.text:42CF8852                 cmp     [ebp+cbData], 0
.text:42CF8859                 jz      short loc_42CF8888
.text:42CF885B                 cmp     dword ptr [ebp+var_242C], 0
.text:42CF8862                 jbe     short loc_42CF8888
.text:42CF8864                 mov     ecx, [ebp+arg_4]
.text:42CF8867                 mov     dword ptr [ecx+108h], 1
.text:42CF8871                 mov     edx, [ebp+arg_4]
.text:42CF8874                 mov     dword ptr [edx+104h], 1
.text:42CF887E                 mov     eax, [ebp+arg_4]
.text:42CF8881                 mov     dword ptr [eax+4], 981h
.text:42CF8888
.text:42CF8888 loc_42CF8888:                           ; CODE XREF: sub_42CF8300+550\u2191j
.text:42CF8888                                         ; sub_42CF8300+559\u2191j ...
.text:42CF8888                 mov     [ebp+cbData], 1FA0h
.text:42CF8892                 mov     ecx, [ebp+arg_4]
.text:42CF8895                 cmp     dword ptr [ecx+108h], 0
.text:42CF889C                 jnz     loc_42CF89B7
.text:42CF88A2                 lea     edx, [ebp+cbData]
.text:42CF88A8                 push    edx             ; lpcbData
.text:42CF88A9                 lea     eax, [ebp+var_2428]
.text:42CF88AF                 push    eax             ; lpData
.text:42CF88B0                 lea     ecx, [ebp+Type]
.text:42CF88B6                 push    ecx             ; lpType
.text:42CF88B7                 push    0               ; lpReserved
.text:42CF88B9                 push    offset aTcpport ; "TcpPort"
.text:42CF88BE                 mov     edx, [ebp+arg_4]
.text:42CF88C1                 mov     eax, [edx]
.text:42CF88C3                 push    eax             ; hKey
.text:42CF88C4                 call    ds:RegQueryValueExA
.text:42CF88CA                 test    eax, eax
.text:42CF88CC                 jnz     loc_42CF89B7
.text:42CF88D2                 cmp     [ebp+cbData], 1
.text:42CF88D9                 jbe     loc_42CF89B5
.text:42CF88DF                 lea     ecx, [ebp+var_2428]
.text:42CF88E5                 mov     [ebp+String], ecx
.text:42CF88EB                 mov     edx, [ebp+arg_4]
.text:42CF88EE                 mov     dword ptr [edx+104h], 0
.text:42CF88F8
.text:42CF88F8 loc_42CF88F8:                           ; CODE XREF: sub_42CF8300+670\u2193j
.text:42CF88F8                 push    2Ch ; ','       ; Val
.text:42CF88FA                 mov     eax, [ebp+String]
.text:42CF8900                 push    eax             ; Str
.text:42CF8901                 call    ds:strchr
.text:42CF8907                 add     esp, 8
.text:42CF890A                 test    eax, eax
.text:42CF890C                 jz      short loc_42CF8972
.text:42CF890E                 push    offset asc_42D003F4 ; ","
.text:42CF8913                 mov     ecx, [ebp+String]
.text:42CF8919                 push    ecx             ; String
.text:42CF891A                 call    ds:strtok
.text:42CF8920                 add     esp, 8
.text:42CF8923                 push    eax             ; char *
.text:42CF8924                 call    sub_42CF9C63
.text:42CF8929                 add     esp, 4
.text:42CF892C                 mov     edx, [ebp+arg_4]
.text:42CF892F                 mov     ecx, [edx+104h]
.text:42CF8935                 mov     edx, [ebp+arg_4]
.text:42CF8938                 mov     [edx+ecx*4+4], eax
.text:42CF893C                 mov     eax, [ebp+String]
.text:42CF8942                 push    eax             ; Str
.text:42CF8943                 call    strlen
.text:42CF8948                 add     esp, 4
.text:42CF894B                 mov     ecx, [ebp+String]
.text:42CF8951                 lea     edx, [ecx+eax+1]
.text:42CF8955                 mov     [ebp+String], edx
.text:42CF895B                 mov     eax, [ebp+arg_4]
.text:42CF895E                 mov     ecx, [eax+104h]
.text:42CF8964                 add     ecx, 1
.text:42CF8967                 mov     edx, [ebp+arg_4]
.text:42CF896A                 mov     [edx+104h], ecx
.text:42CF8970                 jmp     short loc_42CF88F8
.text:42CF8972 ; ---------------------------------------------------------------------------
.text:42CF8972
.text:42CF8972 loc_42CF8972:                           ; CODE XREF: sub_42CF8300+60C\u2191j
.text:42CF8972                 push    offset asc_42D003F8 ; ","
.text:42CF8977                 mov     eax, [ebp+String]
.text:42CF897D                 push    eax             ; String
.text:42CF897E                 call    ds:strtok
.text:42CF8984                 add     esp, 8
.text:42CF8987                 push    eax             ; char *
.text:42CF8988                 call    sub_42CF9C63
.text:42CF898D                 add     esp, 4
.text:42CF8990                 mov     ecx, [ebp+arg_4]
.text:42CF8993                 mov     edx, [ecx+104h]
.text:42CF8999                 mov     ecx, [ebp+arg_4]
.text:42CF899C                 mov     [ecx+edx*4+4], eax
.text:42CF89A0                 mov     edx, [ebp+arg_4]
.text:42CF89A3                 mov     eax, [edx+104h]
.text:42CF89A9                 add     eax, 1
.text:42CF89AC                 mov     ecx, [ebp+arg_4]
.text:42CF89AF                 mov     [ecx+104h], eax
.text:42CF89B5
.text:42CF89B5 loc_42CF89B5:                           ; CODE XREF: sub_42CF8300+5D9\u2191j
.text:42CF89B5                 jmp     short loc_42CF89DA
.text:42CF89B7 ; ---------------------------------------------------------------------------
.text:42CF89B7
.text:42CF89B7 loc_42CF89B7:                           ; CODE XREF: sub_42CF8300+59C\u2191j
.text:42CF89B7                                         ; sub_42CF8300+5CC\u2191j
.text:42CF89B7                 mov     edx, [ebp+arg_4]
.text:42CF89BA                 cmp     dword ptr [edx+108h], 0
.text:42CF89C1                 jnz     short loc_42CF89DA
.text:42CF89C3                 mov     eax, [ebp+arg_4]
.text:42CF89C6                 mov     dword ptr [eax+104h], 1
.text:42CF89D0                 mov     ecx, [ebp+arg_4]
.text:42CF89D3                 mov     dword ptr [ecx+4], 599h
.text:42CF89DA
.text:42CF89DA loc_42CF89DA:                           ; CODE XREF: sub_42CF8300:loc_42CF89B5\u2191j
.text:42CF89DA                                         ; sub_42CF8300+6C1\u2191j
.text:42CF89DA                 mov     edx, [ebp+arg_4]
.text:42CF89DD                 mov     dword ptr [edx+20Ch], 0
.text:42CF89E7                 mov     eax, [ebp+arg_4]
.text:42CF89EA                 push    eax             ; int
.text:42CF89EB                 mov     ecx, [ebp+arg_4]
.text:42CF89EE                 mov     edx, [ecx]
.text:42CF89F0                 push    edx             ; hKey
.text:42CF89F1                 call    sub_42CF9895
.text:42CF89F6                 add     esp, 8
.text:42CF89F9                 mov     [ebp+cbData], 4
.text:42CF8A03                 lea     eax, [ebp+cbData]
.text:42CF8A09                 push    eax             ; lpcbData
.text:42CF8A0A                 lea     ecx, [ebp+var_408]
.text:42CF8A10                 push    ecx             ; lpData
.text:42CF8A11                 lea     edx, [ebp+Type]
.text:42CF8A17                 push    edx             ; lpType
.text:42CF8A18                 push    0               ; lpReserved
.text:42CF8A1A                 push    offset aTcpabortiveclo ; "TcpAbortiveClose"
.text:42CF8A1F                 mov     eax, [ebp+arg_4]
.text:42CF8A22                 mov     ecx, [eax]
.text:42CF8A24                 push    ecx             ; hKey
.text:42CF8A25                 call    ds:RegQueryValueExA
.text:42CF8A2B                 test    eax, eax
.text:42CF8A2D                 jnz     short loc_42CF8A4E
.text:42CF8A2F                 cmp     [ebp+cbData], 0
.text:42CF8A36                 jz      short loc_42CF8A4E
.text:42CF8A38                 cmp     dword ptr [ebp+var_408], 1
.text:42CF8A3F                 jnz     short loc_42CF8A4E
.text:42CF8A41                 mov     edx, [ebp+arg_4]
.text:42CF8A44                 mov     dword ptr [edx+314h], 1
.text:42CF8A4E
.text:42CF8A4E loc_42CF8A4E:                           ; CODE XREF: sub_42CF8300+516\u2191j
.text:42CF8A4E                                         ; sub_42CF8300+72D\u2191j ...
.text:42CF8A4E                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF8A53 ; ---------------------------------------------------------------------------
.text:42CF8A53
.text:42CF8A53 loc_42CF8A53:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF8A53                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF8A53                 mov     eax, [ebp+arg_4] ; jumptable 42CF87A2 case 115
.text:42CF8A56                 mov     dword ptr [eax+2738h], 1
.text:42CF8A60                 lea     ecx, [ebp+Destination]
.text:42CF8A66                 push    ecx             ; Source
.text:42CF8A67                 lea     edx, [ebp+var_2D20]
.text:42CF8A6D                 push    edx             ; Destination
.text:42CF8A6E                 call    strcpy
.text:42CF8A73                 add     esp, 8
.text:42CF8A76                 push    offset aSpx_0   ; "Spx"
.text:42CF8A7B                 lea     eax, [ebp+var_2D20]
.text:42CF8A81                 push    eax             ; Destination
.text:42CF8A82                 call    strcat
.text:42CF8A87                 add     esp, 8
.text:42CF8A8A                 mov     ecx, [ebp+arg_4]
.text:42CF8A8D                 mov     dword ptr [ecx+318h], 843Eh
.text:42CF8A97                 mov     edx, [ebp+arg_4]
.text:42CF8A9A                 mov     dword ptr [edx+31Ch], 0F503h
.text:42CF8AA4                 mov     eax, [ebp+arg_4]
.text:42CF8AA7                 mov     dword ptr [eax+320h], 0
.text:42CF8AB1                 push    offset name     ; Source
.text:42CF8AB6                 mov     ecx, [ebp+arg_4]
.text:42CF8AB9                 add     ecx, 324h
.text:42CF8ABF                 push    ecx             ; Destination
.text:42CF8AC0                 call    strcpy
.text:42CF8AC5                 add     esp, 8
.text:42CF8AC8                 mov     edx, [ebp+String1]
.text:42CF8ACB                 push    edx             ; Str
.text:42CF8ACC                 call    strlen
.text:42CF8AD1                 add     esp, 4
.text:42CF8AD4                 test    eax, eax
.text:42CF8AD6                 jz      short loc_42CF8B1A
.text:42CF8AD8                 push    offset aMssqlserver_4 ; "MSSQLServer"
.text:42CF8ADD                 mov     eax, [ebp+String1]
.text:42CF8AE0                 push    eax             ; String1
.text:42CF8AE1                 call    ds:_stricmp
.text:42CF8AE7                 add     esp, 8
.text:42CF8AEA                 test    eax, eax
.text:42CF8AEC                 jz      short loc_42CF8B1A
.text:42CF8AEE                 push    offset asc_42D00420 ; "$"
.text:42CF8AF3                 mov     ecx, [ebp+arg_4]
.text:42CF8AF6                 add     ecx, 324h
.text:42CF8AFC                 push    ecx             ; Destination
.text:42CF8AFD                 call    strcat
.text:42CF8B02                 add     esp, 8
.text:42CF8B05                 mov     edx, [ebp+String1]
.text:42CF8B08                 push    edx             ; Source
.text:42CF8B09                 mov     eax, [ebp+arg_4]
.text:42CF8B0C                 add     eax, 324h
.text:42CF8B11                 push    eax             ; Destination
.text:42CF8B12                 call    strcat
.text:42CF8B17                 add     esp, 8
.text:42CF8B1A
.text:42CF8B1A loc_42CF8B1A:                           ; CODE XREF: sub_42CF8300+7D6\u2191j
.text:42CF8B1A                                         ; sub_42CF8300+7EC\u2191j
.text:42CF8B1A                 lea     ecx, [ebp+phkResult]
.text:42CF8B20                 push    ecx             ; phkResult
.text:42CF8B21                 push    1               ; samDesired
.text:42CF8B23                 push    0               ; ulOptions
.text:42CF8B25                 lea     edx, [ebp+var_2D20]
.text:42CF8B2B                 push    edx             ; lpSubKey
.text:42CF8B2C                 push    80000002h       ; hKey
.text:42CF8B31                 call    ds:RegOpenKeyExA
.text:42CF8B37                 test    eax, eax
.text:42CF8B39                 jnz     loc_42CF8C84
.text:42CF8B3F                 mov     [ebp+cbData], 4
.text:42CF8B49                 lea     eax, [ebp+cbData]
.text:42CF8B4F                 push    eax             ; lpcbData
.text:42CF8B50                 lea     ecx, [ebp+var_404]
.text:42CF8B56                 push    ecx             ; lpData
.text:42CF8B57                 lea     edx, [ebp+Type]
.text:42CF8B5D                 push    edx             ; lpType
.text:42CF8B5E                 push    0               ; lpReserved
.text:42CF8B60                 push    offset aSpxhideflag ; "SpxHideFlag"
.text:42CF8B65                 mov     eax, [ebp+phkResult]
.text:42CF8B6B                 push    eax             ; hKey
.text:42CF8B6C                 call    ds:RegQueryValueExA
.text:42CF8B72                 test    eax, eax
.text:42CF8B74                 jnz     short loc_42CF8BAF
.text:42CF8B76                 cmp     [ebp+cbData], 0
.text:42CF8B7D                 jz      short loc_42CF8BAF
.text:42CF8B7F                 cmp     dword ptr [ebp+var_404], 0
.text:42CF8B86                 jbe     short loc_42CF8BAF
.text:42CF8B88                 mov     ecx, [ebp+arg_4]
.text:42CF8B8B                 mov     dword ptr [ecx+320h], 1
.text:42CF8B95                 mov     edx, [ebp+arg_4]
.text:42CF8B98                 mov     dword ptr [edx+318h], 8536h
.text:42CF8BA2                 mov     eax, [ebp+arg_4]
.text:42CF8BA5                 mov     dword ptr [eax+31Ch], 9604h
.text:42CF8BAF
.text:42CF8BAF loc_42CF8BAF:                           ; CODE XREF: sub_42CF8300+874\u2191j
.text:42CF8BAF                                         ; sub_42CF8300+87D\u2191j ...
.text:42CF8BAF                 mov     [ebp+cbData], 4
.text:42CF8BB9                 lea     ecx, [ebp+cbData]
.text:42CF8BBF                 push    ecx             ; lpcbData
.text:42CF8BC0                 lea     edx, [ebp+var_37F0]
.text:42CF8BC6                 push    edx             ; lpData
.text:42CF8BC7                 lea     eax, [ebp+Type]
.text:42CF8BCD                 push    eax             ; lpType
.text:42CF8BCE                 push    0               ; lpReserved
.text:42CF8BD0                 push    offset aSpxport ; "SpxPort"
.text:42CF8BD5                 mov     ecx, [ebp+phkResult]
.text:42CF8BDB                 push    ecx             ; hKey
.text:42CF8BDC                 call    ds:RegQueryValueExA
.text:42CF8BE2                 test    eax, eax
.text:42CF8BE4                 jnz     short loc_42CF8C07
.text:42CF8BE6                 cmp     [ebp+cbData], 0
.text:42CF8BED                 jz      short loc_42CF8C07
.text:42CF8BEF                 cmp     dword ptr [ebp+var_37F0], 0
.text:42CF8BF6                 jbe     short loc_42CF8C07
.text:42CF8BF8                 mov     edx, [ebp+arg_4]
.text:42CF8BFB                 mov     eax, dword ptr [ebp+var_37F0]
.text:42CF8C01                 mov     [edx+318h], eax
.text:42CF8C07
.text:42CF8C07 loc_42CF8C07:                           ; CODE XREF: sub_42CF8300+8E4\u2191j
.text:42CF8C07                                         ; sub_42CF8300+8ED\u2191j ...
.text:42CF8C07                 mov     [ebp+cbData], 80h ; '€'
.text:42CF8C11                 lea     ecx, [ebp+cbData]
.text:42CF8C17                 push    ecx             ; lpcbData
.text:42CF8C18                 lea     edx, [ebp+var_488]
.text:42CF8C1E                 push    edx             ; lpData
.text:42CF8C1F                 lea     eax, [ebp+Type]
.text:42CF8C25                 push    eax             ; lpType
.text:42CF8C26                 push    0               ; lpReserved
.text:42CF8C28                 push    offset aSpxservicename ; "SpxServiceName"
.text:42CF8C2D                 mov     ecx, [ebp+phkResult]
.text:42CF8C33                 push    ecx             ; hKey
.text:42CF8C34                 call    ds:RegQueryValueExA
.text:42CF8C3A                 test    eax, eax
.text:42CF8C3C                 jnz     short loc_42CF8C77
.text:42CF8C3E                 cmp     [ebp+cbData], 0
.text:42CF8C45                 jz      short loc_42CF8C77
.text:42CF8C47                 cmp     [ebp+cbData], 100h
.text:42CF8C51                 ja      short loc_42CF8C77
.text:42CF8C53                 movsx   edx, [ebp+var_488]
.text:42CF8C5A                 test    edx, edx
.text:42CF8C5C                 jz      short loc_42CF8C77
.text:42CF8C5E                 lea     eax, [ebp+var_488]
.text:42CF8C64                 push    eax             ; Source
.text:42CF8C65                 mov     ecx, [ebp+arg_4]
.text:42CF8C68                 add     ecx, 324h
.text:42CF8C6E                 push    ecx             ; Destination
.text:42CF8C6F                 call    strcpy
.text:42CF8C74                 add     esp, 8
.text:42CF8C77
.text:42CF8C77 loc_42CF8C77:                           ; CODE XREF: sub_42CF8300+93C\u2191j
.text:42CF8C77                                         ; sub_42CF8300+945\u2191j ...
.text:42CF8C77                 mov     edx, [ebp+phkResult]
.text:42CF8C7D                 push    edx             ; hKey
.text:42CF8C7E                 call    ds:RegCloseKey
.text:42CF8C84
.text:42CF8C84 loc_42CF8C84:                           ; CODE XREF: sub_42CF8300+839\u2191j
.text:42CF8C84                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF8C89 ; ---------------------------------------------------------------------------
.text:42CF8C89
.text:42CF8C89 loc_42CF8C89:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF8C89                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF8C89                 mov     eax, [ebp+arg_4] ; jumptable 42CF87A2 case 97
.text:42CF8C8C                 mov     dword ptr [eax+273Ch], 1
.text:42CF8C96                 lea     ecx, [ebp+Destination]
.text:42CF8C9C                 push    ecx             ; Source
.text:42CF8C9D                 lea     edx, [ebp+var_3140]
.text:42CF8CA3                 push    edx             ; Destination
.text:42CF8CA4                 call    strcpy
.text:42CF8CA9                 add     esp, 8
.text:42CF8CAC                 push    offset aAdsp_4  ; "Adsp"
.text:42CF8CB1                 lea     eax, [ebp+var_3140]
.text:42CF8CB7                 push    eax             ; Destination
.text:42CF8CB8                 call    strcat
.text:42CF8CBD                 add     esp, 8
.text:42CF8CC0                 push    offset name     ; Source
.text:42CF8CC5                 mov     ecx, [ebp+arg_4]
.text:42CF8CC8                 add     ecx, 424h
.text:42CF8CCE                 push    ecx             ; Destination
.text:42CF8CCF                 call    strcpy
.text:42CF8CD4                 add     esp, 8
.text:42CF8CD7                 lea     edx, [ebp+phkResult]
.text:42CF8CDD                 push    edx             ; phkResult
.text:42CF8CDE                 push    1               ; samDesired
.text:42CF8CE0                 push    0               ; ulOptions
.text:42CF8CE2                 lea     eax, [ebp+var_3140]
.text:42CF8CE8                 push    eax             ; lpSubKey
.text:42CF8CE9                 push    80000002h       ; hKey
.text:42CF8CEE                 call    ds:RegOpenKeyExA
.text:42CF8CF4                 test    eax, eax
.text:42CF8CF6                 jnz     short loc_42CF8D69
.text:42CF8CF8                 mov     [ebp+cbData], 80h ; '€'
.text:42CF8D02                 lea     ecx, [ebp+cbData]
.text:42CF8D08                 push    ecx             ; lpcbData
.text:42CF8D09                 lea     edx, [ebp+var_29CC]
.text:42CF8D0F                 push    edx             ; lpData
.text:42CF8D10                 lea     eax, [ebp+Type]
.text:42CF8D16                 push    eax             ; lpType
.text:42CF8D17                 push    0               ; lpReserved
.text:42CF8D19                 push    offset aAdspobjectname ; "AdspObjectName"
.text:42CF8D1E                 mov     ecx, [ebp+phkResult]
.text:42CF8D24                 push    ecx             ; hKey
.text:42CF8D25                 call    ds:RegQueryValueExA
.text:42CF8D2B                 test    eax, eax
.text:42CF8D2D                 jnz     short loc_42CF8D5C
.text:42CF8D2F                 cmp     [ebp+cbData], 0
.text:42CF8D36                 jz      short loc_42CF8D5C
.text:42CF8D38                 cmp     [ebp+cbData], 100h
.text:42CF8D42                 ja      short loc_42CF8D5C
.text:42CF8D44                 lea     edx, [ebp+var_29CC]
.text:42CF8D4A                 push    edx             ; Source
.text:42CF8D4B                 mov     eax, [ebp+arg_4]
.text:42CF8D4E                 add     eax, 424h
.text:42CF8D53                 push    eax             ; Destination
.text:42CF8D54                 call    strcpy
.text:42CF8D59                 add     esp, 8
.text:42CF8D5C
.text:42CF8D5C loc_42CF8D5C:                           ; CODE XREF: sub_42CF8300+A2D\u2191j
.text:42CF8D5C                                         ; sub_42CF8300+A36\u2191j ...
.text:42CF8D5C                 mov     ecx, [ebp+phkResult]
.text:42CF8D62                 push    ecx             ; hKey
.text:42CF8D63                 call    ds:RegCloseKey
.text:42CF8D69
.text:42CF8D69 loc_42CF8D69:                           ; CODE XREF: sub_42CF8300+9F6\u2191j
.text:42CF8D69                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF8D6E ; ---------------------------------------------------------------------------
.text:42CF8D6E
.text:42CF8D6E loc_42CF8D6E:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF8D6E                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF8D6E                 mov     edx, [ebp+arg_4] ; jumptable 42CF87A2 cases 86,118
.text:42CF8D71                 mov     dword ptr [edx+2754h], 1
.text:42CF8D7B                 lea     eax, [ebp+Destination]
.text:42CF8D81                 push    eax             ; Source
.text:42CF8D82                 lea     ecx, [ebp+var_2FD4]
.text:42CF8D88                 push    ecx             ; Destination
.text:42CF8D89                 call    strcpy
.text:42CF8D8E                 add     esp, 8
.text:42CF8D91                 push    offset aVia_2   ; "Via"
.text:42CF8D96                 lea     edx, [ebp+var_2FD4]
.text:42CF8D9C                 push    edx             ; Destination
.text:42CF8D9D                 call    strcat
.text:42CF8DA2                 add     esp, 8
.text:42CF8DA5                 push    offset byte_42D011B4 ; Source
.text:42CF8DAA                 mov     eax, [ebp+arg_4]
.text:42CF8DAD                 add     eax, 112Ch
.text:42CF8DB2                 push    eax             ; Destination
.text:42CF8DB3                 call    strcpy
.text:42CF8DB8                 add     esp, 8
.text:42CF8DBB                 push    offset aNic0    ; "Nic0"
.text:42CF8DC0                 mov     ecx, [ebp+arg_4]
.text:42CF8DC3                 add     ecx, 132Ch
.text:42CF8DC9                 push    ecx             ; Destination
.text:42CF8DCA                 call    strcpy
.text:42CF8DCF                 add     esp, 8
.text:42CF8DD2                 lea     edx, [ebp+phkResult]
.text:42CF8DD8                 push    edx             ; phkResult
.text:42CF8DD9                 push    1               ; samDesired
.text:42CF8DDB                 push    0               ; ulOptions
.text:42CF8DDD                 lea     eax, [ebp+var_2FD4]
.text:42CF8DE3                 push    eax             ; lpSubKey
.text:42CF8DE4                 push    80000002h       ; hKey
.text:42CF8DE9                 call    ds:RegOpenKeyExA
.text:42CF8DEF                 test    eax, eax
.text:42CF8DF1                 jnz     loc_42CF8ECC
.text:42CF8DF7                 mov     [ebp+cbData], 200h
.text:42CF8E01                 lea     ecx, [ebp+cbData]
.text:42CF8E07                 push    ecx             ; lpcbData
.text:42CF8E08                 lea     edx, [ebp+var_2630]
.text:42CF8E0E                 push    edx             ; lpData
.text:42CF8E0F                 lea     eax, [ebp+Type]
.text:42CF8E15                 push    eax             ; lpType
.text:42CF8E16                 push    0               ; lpReserved
.text:42CF8E18                 push    offset aVendor  ; "Vendor"
.text:42CF8E1D                 mov     ecx, [ebp+phkResult]
.text:42CF8E23                 push    ecx             ; hKey
.text:42CF8E24                 call    ds:RegQueryValueExA
.text:42CF8E2A                 test    eax, eax
.text:42CF8E2C                 jnz     short loc_42CF8E5B
.text:42CF8E2E                 cmp     [ebp+cbData], 0
.text:42CF8E35                 jz      short loc_42CF8E5B
.text:42CF8E37                 cmp     [ebp+cbData], 100h
.text:42CF8E41                 ja      short loc_42CF8E5B
.text:42CF8E43                 lea     edx, [ebp+var_2630]
.text:42CF8E49                 push    edx             ; Source
.text:42CF8E4A                 mov     eax, [ebp+arg_4]
.text:42CF8E4D                 add     eax, 112Ch
.text:42CF8E52                 push    eax             ; Destination
.text:42CF8E53                 call    strcpy
.text:42CF8E58                 add     esp, 8
.text:42CF8E5B
.text:42CF8E5B loc_42CF8E5B:                           ; CODE XREF: sub_42CF8300+B2C\u2191j
.text:42CF8E5B                                         ; sub_42CF8300+B35\u2191j ...
.text:42CF8E5B                 mov     [ebp+cbData], 200h
.text:42CF8E65                 lea     ecx, [ebp+cbData]
.text:42CF8E6B                 push    ecx             ; lpcbData
.text:42CF8E6C                 lea     edx, [ebp+var_294C]
.text:42CF8E72                 push    edx             ; lpData
.text:42CF8E73                 lea     eax, [ebp+Type]
.text:42CF8E79                 push    eax             ; lpType
.text:42CF8E7A                 push    0               ; lpReserved
.text:42CF8E7C                 push    offset aListeninfo ; "ListenInfo"
.text:42CF8E81                 mov     ecx, [ebp+phkResult]
.text:42CF8E87                 push    ecx             ; hKey
.text:42CF8E88                 call    ds:RegQueryValueExA
.text:42CF8E8E                 test    eax, eax
.text:42CF8E90                 jnz     short loc_42CF8EBF
.text:42CF8E92                 cmp     [ebp+cbData], 0
.text:42CF8E99                 jz      short loc_42CF8EBF
.text:42CF8E9B                 cmp     [ebp+cbData], 100h
.text:42CF8EA5                 ja      short loc_42CF8EBF
.text:42CF8EA7                 lea     edx, [ebp+var_294C]
.text:42CF8EAD                 push    edx             ; Source
.text:42CF8EAE                 mov     eax, [ebp+arg_4]
.text:42CF8EB1                 add     eax, 132Ch
.text:42CF8EB6                 push    eax             ; Destination
.text:42CF8EB7                 call    strcpy
.text:42CF8EBC                 add     esp, 8
.text:42CF8EBF
.text:42CF8EBF loc_42CF8EBF:                           ; CODE XREF: sub_42CF8300+B90\u2191j
.text:42CF8EBF                                         ; sub_42CF8300+B99\u2191j ...
.text:42CF8EBF                 mov     ecx, [ebp+phkResult]
.text:42CF8EC5                 push    ecx             ; hKey
.text:42CF8EC6                 call    ds:RegCloseKey
.text:42CF8ECC
.text:42CF8ECC loc_42CF8ECC:                           ; CODE XREF: sub_42CF8300+AF1\u2191j
.text:42CF8ECC                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF8ED1 ; ---------------------------------------------------------------------------
.text:42CF8ED1
.text:42CF8ED1 loc_42CF8ED1:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF8ED1                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF8ED1                 mov     edx, [ebp+arg_4] ; jumptable 42CF87A2 case 119
.text:42CF8ED4                 mov     dword ptr [edx+2740h], 1
.text:42CF8EDE                 lea     eax, [ebp+Destination]
.text:42CF8EE4                 push    eax             ; Source
.text:42CF8EE5                 lea     ecx, [ebp+var_2BFC]
.text:42CF8EEB                 push    ecx             ; Destination
.text:42CF8EEC                 call    strcpy
.text:42CF8EF1                 add     esp, 8
.text:42CF8EF4                 push    offset aWsproxy_2 ; "WSProxy"
.text:42CF8EF9                 lea     edx, [ebp+var_2BFC]
.text:42CF8EFF                 push    edx             ; Destination
.text:42CF8F00                 call    strcat
.text:42CF8F05                 add     esp, 8
.text:42CF8F08                 mov     eax, [ebp+arg_4]
.text:42CF8F0B                 mov     dword ptr [eax+524h], 599h
.text:42CF8F15                 mov     ecx, [ebp+arg_4]
.text:42CF8F18                 mov     dword ptr [ecx+528h], 0
.text:42CF8F22                 lea     edx, [ebp+phkResult]
.text:42CF8F28                 push    edx             ; phkResult
.text:42CF8F29                 push    1               ; samDesired
.text:42CF8F2B                 push    0               ; ulOptions
.text:42CF8F2D                 lea     eax, [ebp+var_2BFC]
.text:42CF8F33                 push    eax             ; lpSubKey
.text:42CF8F34                 push    80000002h       ; hKey
.text:42CF8F39                 call    ds:RegOpenKeyExA
.text:42CF8F3F                 test    eax, eax
.text:42CF8F41                 jnz     loc_42CF9080
.text:42CF8F47                 mov     [ebp+cbData], 80h ; '€'
.text:42CF8F51                 lea     ecx, [ebp+cbData]
.text:42CF8F57                 push    ecx             ; lpcbData
.text:42CF8F58                 lea     edx, [ebp+var_2DA4]
.text:42CF8F5E                 push    edx             ; lpData
.text:42CF8F5F                 lea     eax, [ebp+Type]
.text:42CF8F65                 push    eax             ; lpType
.text:42CF8F66                 push    0               ; lpReserved
.text:42CF8F68                 push    offset aWsproxyaddress ; "WSProxyAddress"
.text:42CF8F6D                 mov     ecx, [ebp+phkResult]
.text:42CF8F73                 push    ecx             ; hKey
.text:42CF8F74                 call    ds:RegQueryValueExA
.text:42CF8F7A                 test    eax, eax
.text:42CF8F7C                 jnz     short loc_42CF8FEF
.text:42CF8F7E                 cmp     [ebp+cbData], 0
.text:42CF8F85                 jz      short loc_42CF8FEF
.text:42CF8F87                 cmp     [ebp+cbData], 80h ; '€'
.text:42CF8F91                 ja      short loc_42CF8FEF
.text:42CF8F93                 lea     edx, [ebp+var_2DA4]
.text:42CF8F99                 push    edx             ; cp
.text:42CF8F9A                 call    inet_addr
.text:42CF8F9F                 mov     ecx, [ebp+arg_4]
.text:42CF8FA2                 mov     [ecx+528h], eax
.text:42CF8FA8                 mov     edx, [ebp+arg_4]
.text:42CF8FAB                 cmp     dword ptr [edx+528h], 0FFFFFFFFh
.text:42CF8FB2                 jnz     short loc_42CF8FEF
.text:42CF8FB4                 lea     eax, [ebp+var_2DA4]
.text:42CF8FBA                 push    eax             ; name
.text:42CF8FBB                 call    gethostbyname
.text:42CF8FC0                 mov     [ebp+var_37FC], eax
.text:42CF8FC6                 cmp     [ebp+var_37FC], 0
.text:42CF8FCD                 jz      short loc_42CF8FEF
.text:42CF8FCF                 push    4               ; Size
.text:42CF8FD1                 mov     ecx, [ebp+var_37FC]
.text:42CF8FD7                 mov     edx, [ecx+0Ch]
.text:42CF8FDA                 mov     eax, [edx]
.text:42CF8FDC                 push    eax             ; Src
.text:42CF8FDD                 mov     ecx, [ebp+arg_4]
.text:42CF8FE0                 add     ecx, 528h
.text:42CF8FE6                 push    ecx             ; void *
.text:42CF8FE7                 call    memcpy
.text:42CF8FEC                 add     esp, 0Ch
.text:42CF8FEF
.text:42CF8FEF loc_42CF8FEF:                           ; CODE XREF: sub_42CF8300+C7C\u2191j
.text:42CF8FEF                                         ; sub_42CF8300+C85\u2191j ...
.text:42CF8FEF                 mov     [ebp+cbData], 4
.text:42CF8FF9                 lea     edx, [ebp+cbData]
.text:42CF8FFF                 push    edx             ; lpcbData
.text:42CF9000                 lea     eax, [ebp+var_37EC]
.text:42CF9006                 push    eax             ; lpData
.text:42CF9007                 lea     ecx, [ebp+Type]
.text:42CF900D                 push    ecx             ; lpType
.text:42CF900E                 push    0               ; lpReserved
.text:42CF9010                 push    offset aWsproxyport ; "WSProxyPort"
.text:42CF9015                 mov     edx, [ebp+phkResult]
.text:42CF901B                 push    edx             ; hKey
.text:42CF901C                 call    ds:RegQueryValueExA
.text:42CF9022                 test    eax, eax
.text:42CF9024                 jnz     short loc_42CF904A
.text:42CF9026                 cmp     [ebp+cbData], 0
.text:42CF902D                 jz      short loc_42CF904A
.text:42CF902F                 mov     eax, [ebp+arg_4]
.text:42CF9032                 cmp     dword ptr [eax+524h], 0
.text:42CF9039                 jbe     short loc_42CF904A
.text:42CF903B                 mov     ecx, [ebp+arg_4]
.text:42CF903E                 mov     edx, dword ptr [ebp+var_37EC]
.text:42CF9044                 mov     [ecx+524h], edx
.text:42CF904A
.text:42CF904A loc_42CF904A:                           ; CODE XREF: sub_42CF8300+D24\u2191j
.text:42CF904A                                         ; sub_42CF8300+D2D\u2191j ...
.text:42CF904A                 mov     eax, [ebp+phkResult]
.text:42CF9050                 push    eax             ; hKey
.text:42CF9051                 call    ds:RegCloseKey
.text:42CF9057                 mov     ecx, [ebp+arg_4]
.text:42CF905A                 mov     edx, [ecx+524h]
.text:42CF9060                 push    edx
.text:42CF9061                 lea     eax, [ebp+var_2DA4]
.text:42CF9067                 push    eax
.text:42CF9068                 push    offset aSD_0    ; "%s,%d"
.text:42CF906D                 mov     ecx, [ebp+arg_4]
.text:42CF9070                 add     ecx, 52Ch
.text:42CF9076                 push    ecx             ; Buffer
.text:42CF9077                 call    ds:sprintf
.text:42CF907D                 add     esp, 10h
.text:42CF9080
.text:42CF9080 loc_42CF9080:                           ; CODE XREF: sub_42CF8300+C41\u2191j
.text:42CF9080                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF9085 ; ---------------------------------------------------------------------------
.text:42CF9085
.text:42CF9085 loc_42CF9085:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF9085                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF9085                 mov     edx, [ebp+arg_4] ; jumptable 42CF87A2 case 110
.text:42CF9088                 mov     dword ptr [edx+2744h], 1
.text:42CF9092                 lea     eax, [ebp+Destination]
.text:42CF9098                 push    eax             ; Source
.text:42CF9099                 lea     ecx, [ebp+var_2AE4]
.text:42CF909F                 push    ecx             ; Destination
.text:42CF90A0                 call    strcpy
.text:42CF90A5                 add     esp, 8
.text:42CF90A8                 push    offset aNp      ; "Np"
.text:42CF90AD                 lea     edx, [ebp+var_2AE4]
.text:42CF90B3                 push    edx             ; Destination
.text:42CF90B4                 call    strcat
.text:42CF90B9                 add     esp, 8
.text:42CF90BC                 lea     eax, [ebp+phkResult]
.text:42CF90C2                 push    eax             ; phkResult
.text:42CF90C3                 push    1               ; samDesired
.text:42CF90C5                 push    0               ; ulOptions
.text:42CF90C7                 lea     ecx, [ebp+var_2AE4]
.text:42CF90CD                 push    ecx             ; lpSubKey
.text:42CF90CE                 push    80000002h       ; hKey
.text:42CF90D3                 call    ds:RegOpenKeyExA
.text:42CF90D9                 test    eax, eax
.text:42CF90DB                 jnz     short loc_42CF9143
.text:42CF90DD                 mov     [ebp+cbData], 400h
.text:42CF90E7                 lea     edx, [ebp+cbData]
.text:42CF90ED                 push    edx             ; lpcbData
.text:42CF90EE                 lea     eax, [ebp+var_37E8]
.text:42CF90F4                 push    eax             ; lpData
.text:42CF90F5                 lea     ecx, [ebp+Type]
.text:42CF90FB                 push    ecx             ; lpType
.text:42CF90FC                 push    0               ; lpReserved
.text:42CF90FE                 push    offset aPipename ; "PipeName"
.text:42CF9103                 mov     edx, [ebp+phkResult]
.text:42CF9109                 push    edx             ; hKey
.text:42CF910A                 call    ds:RegQueryValueExA
.text:42CF9110                 test    eax, eax
.text:42CF9112                 jnz     short loc_42CF9136
.text:42CF9114                 cmp     [ebp+cbData], 2
.text:42CF911B                 jbe     short loc_42CF9136
.text:42CF911D                 lea     eax, [ebp+var_37E8]
.text:42CF9123                 push    eax             ; Source
.text:42CF9124                 mov     ecx, [ebp+arg_4]
.text:42CF9127                 add     ecx, 92Ch
.text:42CF912D                 push    ecx             ; Destination
.text:42CF912E                 call    strcpy
.text:42CF9133                 add     esp, 8
.text:42CF9136
.text:42CF9136 loc_42CF9136:                           ; CODE XREF: sub_42CF8300+E12\u2191j
.text:42CF9136                                         ; sub_42CF8300+E1B\u2191j
.text:42CF9136                 mov     edx, [ebp+phkResult]
.text:42CF913C                 push    edx             ; hKey
.text:42CF913D                 call    ds:RegCloseKey
.text:42CF9143
.text:42CF9143 loc_42CF9143:                           ; CODE XREF: sub_42CF8300+DDB\u2191j
.text:42CF9143                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF9148 ; ---------------------------------------------------------------------------
.text:42CF9148
.text:42CF9148 loc_42CF9148:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF9148                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF9148                 mov     eax, [ebp+arg_4] ; jumptable 42CF87A2 case 114
.text:42CF914B                 mov     dword ptr [eax+2748h], 1
.text:42CF9155                 jmp     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF915A ; ---------------------------------------------------------------------------
.text:42CF915A
.text:42CF915A loc_42CF915A:                           ; CODE XREF: sub_42CF8300+4A2\u2191j
.text:42CF915A                                         ; DATA XREF: .text:jpt_42CF87A2\u2193o
.text:42CF915A                 mov     ecx, [ebp+arg_4] ; jumptable 42CF87A2 case 98
.text:42CF915D                 mov     dword ptr [ecx+274Ch], 1
.text:42CF9167                 lea     edx, [ebp+Destination]
.text:42CF916D                 push    edx             ; Source
.text:42CF916E                 lea     eax, [ebp+var_2EBC]
.text:42CF9174                 push    eax             ; Destination
.text:42CF9175                 call    strcpy
.text:42CF917A                 add     esp, 8
.text:42CF917D                 push    offset aBv      ; "Bv"
.text:42CF9182                 lea     ecx, [ebp+var_2EBC]
.text:42CF9188                 push    ecx             ; Destination
.text:42CF9189                 call    strcat
.text:42CF918E                 add     esp, 8
.text:42CF9191                 lea     edx, [ebp+phkResult]
.text:42CF9197                 push    edx             ; phkResult
.text:42CF9198                 push    1               ; samDesired
.text:42CF919A                 push    0               ; ulOptions
.text:42CF919C                 lea     eax, [ebp+var_2EBC]
.text:42CF91A2                 push    eax             ; lpSubKey
.text:42CF91A3                 push    80000002h       ; hKey
.text:42CF91A8                 call    ds:RegOpenKeyExA
.text:42CF91AE                 test    eax, eax
.text:42CF91B0                 jnz     def_42CF87A2    ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF91B6                 mov     [ebp+cbData], 400h
.text:42CF91C0                 lea     ecx, [ebp+cbData]
.text:42CF91C6                 push    ecx             ; lpcbData
.text:42CF91C7                 lea     edx, [ebp+var_400]
.text:42CF91CD                 push    edx             ; lpData
.text:42CF91CE                 lea     eax, [ebp+Type]
.text:42CF91D4                 push    eax             ; lpType
.text:42CF91D5                 push    0               ; lpReserved
.text:42CF91D7                 push    offset aItemname ; "ItemName"
.text:42CF91DC                 mov     ecx, [ebp+phkResult]
.text:42CF91E2                 push    ecx             ; hKey
.text:42CF91E3                 call    ds:RegQueryValueExA
.text:42CF91E9                 test    eax, eax
.text:42CF91EB                 jnz     short loc_42CF920E
.text:42CF91ED                 cmp     [ebp+cbData], 2
.text:42CF91F4                 jbe     short loc_42CF920E
.text:42CF91F6                 lea     edx, [ebp+var_400]
.text:42CF91FC                 push    edx             ; Source
.text:42CF91FD                 mov     eax, [ebp+arg_4]
.text:42CF9200                 add     eax, 0D2Ch
.text:42CF9205                 push    eax             ; Destination
.text:42CF9206                 call    strcpy
.text:42CF920B                 add     esp, 8
.text:42CF920E
.text:42CF920E loc_42CF920E:                           ; CODE XREF: sub_42CF8300+EEB\u2191j
.text:42CF920E                                         ; sub_42CF8300+EF4\u2191j
.text:42CF920E                 mov     [ebp+cbData], 400h
.text:42CF9218                 lea     ecx, [ebp+cbData]
.text:42CF921E                 push    ecx             ; lpcbData
.text:42CF921F                 lea     edx, [ebp+var_400]
.text:42CF9225                 push    edx             ; lpData
.text:42CF9226                 lea     eax, [ebp+Type]
.text:42CF922C                 push    eax             ; lpType
.text:42CF922D                 push    0               ; lpReserved
.text:42CF922F                 push    offset aGroupname ; "GroupName"
.text:42CF9234                 mov     ecx, [ebp+phkResult]
.text:42CF923A                 push    ecx             ; hKey
.text:42CF923B                 call    ds:RegQueryValueExA
.text:42CF9241                 test    eax, eax
.text:42CF9243                 jnz     short loc_42CF927E
.text:42CF9245                 cmp     [ebp+cbData], 2
.text:42CF924C                 jbe     short loc_42CF927E
.text:42CF924E                 push    offset asc_42D004D8 ; "@"
.text:42CF9253                 mov     edx, [ebp+arg_4]
.text:42CF9256                 add     edx, 0D2Ch
.text:42CF925C                 push    edx             ; Destination
.text:42CF925D                 call    strcat
.text:42CF9262                 add     esp, 8
.text:42CF9265                 lea     eax, [ebp+var_400]
.text:42CF926B                 push    eax             ; Source
.text:42CF926C                 mov     ecx, [ebp+arg_4]
.text:42CF926F                 add     ecx, 0D2Ch
.text:42CF9275                 push    ecx             ; Destination
.text:42CF9276                 call    strcat
.text:42CF927B                 add     esp, 8
.text:42CF927E
.text:42CF927E loc_42CF927E:                           ; CODE XREF: sub_42CF8300+F43\u2191j
.text:42CF927E                                         ; sub_42CF8300+F4C\u2191j
.text:42CF927E                 mov     [ebp+cbData], 400h
.text:42CF9288                 lea     edx, [ebp+cbData]
.text:42CF928E                 push    edx             ; lpcbData
.text:42CF928F                 lea     eax, [ebp+var_400]
.text:42CF9295                 push    eax             ; lpData
.text:42CF9296                 lea     ecx, [ebp+Type]
.text:42CF929C                 push    ecx             ; lpType
.text:42CF929D                 push    0               ; lpReserved
.text:42CF929F                 push    offset aOrgname ; "OrgName"
.text:42CF92A4                 mov     edx, [ebp+phkResult]
.text:42CF92AA                 push    edx             ; hKey
.text:42CF92AB                 call    ds:RegQueryValueExA
.text:42CF92B1                 test    eax, eax
.text:42CF92B3                 jnz     short loc_42CF92ED
.text:42CF92B5                 cmp     [ebp+cbData], 2
.text:42CF92BC                 jbe     short loc_42CF92ED
.text:42CF92BE                 push    offset asc_42D004E4 ; "@"
.text:42CF92C3                 mov     eax, [ebp+arg_4]
.text:42CF92C6                 add     eax, 0D2Ch
.text:42CF92CB                 push    eax             ; Destination
.text:42CF92CC                 call    strcat
.text:42CF92D1                 add     esp, 8
.text:42CF92D4                 lea     ecx, [ebp+var_400]
.text:42CF92DA                 push    ecx             ; Source
.text:42CF92DB                 mov     edx, [ebp+arg_4]
.text:42CF92DE                 add     edx, 0D2Ch
.text:42CF92E4                 push    edx             ; Destination
.text:42CF92E5                 call    strcat
.text:42CF92EA                 add     esp, 8
.text:42CF92ED
.text:42CF92ED loc_42CF92ED:                           ; CODE XREF: sub_42CF8300+FB3\u2191j
.text:42CF92ED                                         ; sub_42CF8300+FBC\u2191j
.text:42CF92ED                 mov     eax, [ebp+phkResult]
.text:42CF92F3                 push    eax             ; hKey
.text:42CF92F4                 call    ds:RegCloseKey
.text:42CF92FA
.text:42CF92FA def_42CF87A2:                           ; CODE XREF: sub_42CF8300+48E\u2191j
.text:42CF92FA                                         ; sub_42CF8300+4A2\u2191j ...
.text:42CF92FA                 mov     ecx, [ebp+var_2634] ; jumptable 42CF87A2 default case, cases 87-96,99-109,111-113,117
.text:42CF9300                 push    ecx             ; Str
.text:42CF9301                 call    strlen
.text:42CF9306                 add     esp, 4
.text:42CF9309                 mov     edx, [ebp+var_2634]
.text:42CF930F                 lea     eax, [edx+eax+1]
.text:42CF9313                 mov     [ebp+var_2634], eax
.text:42CF9319                 jmp     loc_42CF8740
.text:42CF931E ; ---------------------------------------------------------------------------
.text:42CF931E
.text:42CF931E loc_42CF931E:                           ; CODE XREF: sub_42CF8300+447\u2191j
.text:42CF931E                                         ; sub_42CF8300+463\u2191j
.text:42CF931E                 mov     ecx, [ebp+String1]
.text:42CF9321                 push    ecx             ; String2
.text:42CF9322                 mov     edx, [ebp+arg_4]
.text:42CF9325                 add     edx, 310h
.text:42CF932B                 push    edx             ; int
.text:42CF932C                 mov     eax, [ebp+arg_4]
.text:42CF932F                 add     eax, 210h
.text:42CF9334                 push    eax             ; int
.text:42CF9335                 call    sub_42CF9388
.text:42CF933A                 add     esp, 0Ch
.text:42CF933D                 pop     edi
.text:42CF933E                 mov     esp, ebp
.text:42CF9340                 pop     ebp
.text:42CF9341                 retn
.text:42CF9341 sub_42CF8300    endp
.text:42CF9341
.text:42CF9341 ; ---------------------------------------------------------------------------
.text:42CF9342 jpt_42CF87A2    dd offset loc_42CF8D6E  ; DATA XREF: sub_42CF8300+4A2\u2191r
.text:42CF9342                 dd offset loc_42CF8C89  ; jump table for switch statement
.text:42CF9342                 dd offset loc_42CF915A
.text:42CF9342                 dd offset loc_42CF9085
.text:42CF9342                 dd offset loc_42CF9148
.text:42CF9342                 dd offset loc_42CF8A53
.text:42CF9342                 dd offset loc_42CF87A9
.text:42CF9342                 dd offset loc_42CF8ED1
.text:42CF9342                 dd offset def_42CF87A2
.text:42CF9366 byte_42CF9366   db      0,     8,     8,     8
.text:42CF9366                                         ; DATA XREF: sub_42CF8300+49C\u2191r
.text:42CF9366                 db      8,     8,     8,     8 ; indirect table for switch statement
.text:42CF9366                 db      8,     8,     8,     1
.text:42CF9366                 db      2,     8,     8,     8
.text:42CF9366                 db      8,     8,     8,     8
.text:42CF9366                 db      8,     8,     8,     8
.text:42CF9366                 db      3,     8,     8,     8
.text:42CF9366                 db      4,     5,     6,     8
.text:42CF9366                 db      0,     7
.text:42CF9388
.text:42CF9388 ; =============== S U B R O U T I N E =======================================
.text:42CF9388
.text:42CF9388 ; Attributes: bp-based frame
.text:42CF9388
.text:42CF9388 ; int __cdecl sub_42CF9388(int, int, char *String2)
.text:42CF9388 sub_42CF9388    proc near               ; CODE XREF: sub_42CF8300+1035\u2191p
.text:42CF9388
.text:42CF9388 var_5B0         = dword ptr -5B0h
.text:42CF9388 var_5AC         = byte ptr -5ACh
.text:42CF9388 var_5AB         = byte ptr -5ABh
.text:42CF9388 hKey            = dword ptr -4ACh
.text:42CF9388 var_4A8         = dword ptr -4A8h
.text:42CF9388 var_4A4         = dword ptr -4A4h
.text:42CF9388 var_4A0         = dword ptr -4A0h
.text:42CF9388 var_49C         = dword ptr -49Ch
.text:42CF9388 Data            = byte ptr -498h
.text:42CF9388 var_497         = byte ptr -497h
.text:42CF9388 Str             = dword ptr -418h
.text:42CF9388 Destination     = byte ptr -414h
.text:42CF9388 lpData          = dword ptr -14h
.text:42CF9388 phkResult       = dword ptr -10h
.text:42CF9388 Str1            = dword ptr -0Ch
.text:42CF9388 var_8           = dword ptr -8
.text:42CF9388 cbData          = dword ptr -4
.text:42CF9388 arg_0           = dword ptr  8
.text:42CF9388 arg_4           = dword ptr  0Ch
.text:42CF9388 String2         = dword ptr  10h
.text:42CF9388
.text:42CF9388                 push    ebp
.text:42CF9389                 mov     ebp, esp
.text:42CF938B                 sub     esp, 5B0h
.text:42CF9391                 push    edi
.text:42CF9392                 mov     [ebp+cbData], 0
.text:42CF9399                 mov     [ebp+lpData], 0
.text:42CF93A0                 mov     [ebp+Str1], offset unk_42D011B8
.text:42CF93A7                 mov     [ebp+var_8], 0
.text:42CF93AE                 lea     eax, [ebp+phkResult]
.text:42CF93B1                 push    eax             ; phkResult
.text:42CF93B2                 push    0F003Fh         ; samDesired
.text:42CF93B7                 push    0               ; ulOptions
.text:42CF93B9                 push    offset SubKey   ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CF93BE                 push    80000002h       ; hKey
.text:42CF93C3                 call    ds:RegOpenKeyExA
.text:42CF93C9                 test    eax, eax
.text:42CF93CB                 jnz     short loc_42CF9420
.text:42CF93CD                 lea     ecx, [ebp+cbData]
.text:42CF93D0                 push    ecx             ; lpcbData
.text:42CF93D1                 push    0               ; lpData
.text:42CF93D3                 push    0               ; lpType
.text:42CF93D5                 push    0               ; lpReserved
.text:42CF93D7                 push    offset aInstalledinsta ; "InstalledInstances"
.text:42CF93DC                 mov     edx, [ebp+phkResult]
.text:42CF93DF                 push    edx             ; hKey
.text:42CF93E0                 call    ds:RegQueryValueExA
.text:42CF93E6                 test    eax, eax
.text:42CF93E8                 jnz     short loc_42CF9420
.text:42CF93EA                 push    1               ; Size
.text:42CF93EC                 mov     eax, [ebp+cbData]
.text:42CF93EF                 add     eax, 2
.text:42CF93F2                 push    eax             ; Count
.text:42CF93F3                 call    ds:calloc
.text:42CF93F9                 add     esp, 8
.text:42CF93FC                 mov     [ebp+lpData], eax
.text:42CF93FF                 lea     ecx, [ebp+cbData]
.text:42CF9402                 push    ecx             ; lpcbData
.text:42CF9403                 mov     edx, [ebp+lpData]
.text:42CF9406                 push    edx             ; lpData
.text:42CF9407                 push    0               ; lpType
.text:42CF9409                 push    0               ; lpReserved
.text:42CF940B                 push    offset aInstalledinsta_0 ; "InstalledInstances"
.text:42CF9410                 mov     eax, [ebp+phkResult]
.text:42CF9413                 push    eax             ; hKey
.text:42CF9414                 call    ds:RegQueryValueExA
.text:42CF941A                 mov     ecx, [ebp+lpData]
.text:42CF941D                 mov     [ebp+Str1], ecx
.text:42CF9420
.text:42CF9420 loc_42CF9420:                           ; CODE XREF: sub_42CF9388+43\u2191j
.text:42CF9420                                         ; sub_42CF9388+60\u2191j
.text:42CF9420                 cmp     [ebp+phkResult], 0
.text:42CF9424                 jz      short loc_42CF9430
.text:42CF9426                 mov     edx, [ebp+phkResult]
.text:42CF9429                 push    edx             ; hKey
.text:42CF942A                 call    ds:RegCloseKey
.text:42CF9430
.text:42CF9430 loc_42CF9430:                           ; CODE XREF: sub_42CF9388+9C\u2191j
.text:42CF9430                                         ; sub_42CF9388+EC\u2193j ...
.text:42CF9430                 push    offset byte_42D011BC ; Str2
.text:42CF9435                 mov     eax, [ebp+Str1]
.text:42CF9438                 push    eax             ; Str1
.text:42CF9439                 call    strcmp
.text:42CF943E                 add     esp, 8
.text:42CF9441                 test    eax, eax
.text:42CF9443                 jz      loc_42CF9600
.text:42CF9449                 mov     ecx, [ebp+String2]
.text:42CF944C                 push    ecx             ; String2
.text:42CF944D                 mov     edx, [ebp+Str1]
.text:42CF9450                 push    edx             ; String1
.text:42CF9451                 call    ds:_stricmp
.text:42CF9457                 add     esp, 8
.text:42CF945A                 test    eax, eax
.text:42CF945C                 jnz     short loc_42CF9476
.text:42CF945E                 mov     eax, [ebp+Str1]
.text:42CF9461                 push    eax             ; Str
.text:42CF9462                 call    strlen
.text:42CF9467                 add     esp, 4
.text:42CF946A                 mov     ecx, [ebp+Str1]
.text:42CF946D                 lea     edx, [ecx+eax+1]
.text:42CF9471                 mov     [ebp+Str1], edx
.text:42CF9474                 jmp     short loc_42CF9430
.text:42CF9476 ; ---------------------------------------------------------------------------
.text:42CF9476
.text:42CF9476 loc_42CF9476:                           ; CODE XREF: sub_42CF9388+D4\u2191j
.text:42CF9476                 push    offset aMssqlserver_5 ; "MSSQLServer"
.text:42CF947B                 mov     eax, [ebp+Str1]
.text:42CF947E                 push    eax             ; String1
.text:42CF947F                 call    ds:_stricmp
.text:42CF9485                 add     esp, 8
.text:42CF9488                 test    eax, eax
.text:42CF948A                 jnz     short loc_42CF94B6
.text:42CF948C                 push    offset aSoftwareMicros_2 ; "SOFTWARE\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CF9491                 lea     ecx, [ebp+Destination]
.text:42CF9497                 push    ecx             ; Destination
.text:42CF9498                 call    strcpy
.text:42CF949D                 add     esp, 8
.text:42CF94A0                 push    offset aTcp_1   ; "Tcp"
.text:42CF94A5                 lea     edx, [ebp+Destination]
.text:42CF94AB                 push    edx             ; Destination
.text:42CF94AC                 call    strcat
.text:42CF94B1                 add     esp, 8
.text:42CF94B4                 jmp     short loc_42CF94D4
.text:42CF94B6 ; ---------------------------------------------------------------------------
.text:42CF94B6
.text:42CF94B6 loc_42CF94B6:                           ; CODE XREF: sub_42CF9388+102\u2191j
.text:42CF94B6                 mov     eax, [ebp+Str1]
.text:42CF94B9                 push    eax
.text:42CF94BA                 push    offset aSoftwareMicros_3 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CF94BF                 push    offset aSSMssqlserverS ; "%s%s\\MSSQLServer\\SuperSocketNetLib\\T"...
.text:42CF94C4                 lea     ecx, [ebp+Destination]
.text:42CF94CA                 push    ecx             ; Buffer
.text:42CF94CB                 call    ds:sprintf
.text:42CF94D1                 add     esp, 10h
.text:42CF94D4
.text:42CF94D4 loc_42CF94D4:                           ; CODE XREF: sub_42CF9388+12C\u2191j
.text:42CF94D4                 mov     cbData, 400h
.text:42CF94DE                 lea     edx, [ebp+phkResult]
.text:42CF94E1                 push    edx             ; phkResult
.text:42CF94E2                 push    0F003Fh         ; samDesired
.text:42CF94E7                 push    0               ; ulOptions
.text:42CF94E9                 lea     eax, [ebp+Destination]
.text:42CF94EF                 push    eax             ; lpSubKey
.text:42CF94F0                 push    80000002h       ; hKey
.text:42CF94F5                 call    ds:RegOpenKeyExA
.text:42CF94FB                 test    eax, eax
.text:42CF94FD                 jnz     loc_42CF95D5
.text:42CF9503                 push    offset cbData   ; lpcbData
.text:42CF9508                 push    offset Data     ; lpData
.text:42CF950D                 push    0               ; lpType
.text:42CF950F                 push    0               ; lpReserved
.text:42CF9511                 push    offset aTcpport_0 ; "TcpPort"
.text:42CF9516                 mov     ecx, [ebp+phkResult]
.text:42CF9519                 push    ecx             ; hKey
.text:42CF951A                 call    ds:RegQueryValueExA
.text:42CF9520                 test    eax, eax
.text:42CF9522                 jnz     loc_42CF95D5
.text:42CF9528                 mov     [ebp+Str], offset Data
.text:42CF9532
.text:42CF9532 loc_42CF9532:                           ; CODE XREF: sub_42CF9388+215\u2193j
.text:42CF9532                 push    2Ch ; ','       ; Val
.text:42CF9534                 mov     edx, [ebp+Str]
.text:42CF953A                 push    edx             ; Str
.text:42CF953B                 call    ds:strchr
.text:42CF9541                 add     esp, 8
.text:42CF9544                 test    eax, eax
.text:42CF9546                 jz      short loc_42CF959F
.text:42CF9548                 push    offset asc_42D005E8 ; ","
.text:42CF954D                 mov     eax, [ebp+Str]
.text:42CF9553                 push    eax             ; String
.text:42CF9554                 call    ds:strtok
.text:42CF955A                 add     esp, 8
.text:42CF955D                 push    eax             ; char *
.text:42CF955E                 call    sub_42CF9C63
.text:42CF9563                 add     esp, 4
.text:42CF9566                 mov     ecx, [ebp+arg_4]
.text:42CF9569                 mov     edx, [ecx]
.text:42CF956B                 mov     ecx, [ebp+arg_0]
.text:42CF956E                 mov     [ecx+edx*4], eax
.text:42CF9571                 mov     edx, [ebp+arg_4]
.text:42CF9574                 mov     eax, [edx]
.text:42CF9576                 add     eax, 1
.text:42CF9579                 mov     ecx, [ebp+arg_4]
.text:42CF957C                 mov     [ecx], eax
.text:42CF957E                 mov     edx, [ebp+Str]
.text:42CF9584                 push    edx             ; Str
.text:42CF9585                 call    strlen
.text:42CF958A                 add     esp, 4
.text:42CF958D                 mov     ecx, [ebp+Str]
.text:42CF9593                 lea     edx, [ecx+eax+1]
.text:42CF9597                 mov     [ebp+Str], edx
.text:42CF959D                 jmp     short loc_42CF9532
.text:42CF959F ; ---------------------------------------------------------------------------
.text:42CF959F
.text:42CF959F loc_42CF959F:                           ; CODE XREF: sub_42CF9388+1BE\u2191j
.text:42CF959F                 push    offset asc_42D005EC ; ","
.text:42CF95A4                 mov     eax, [ebp+Str]
.text:42CF95AA                 push    eax             ; String
.text:42CF95AB                 call    ds:strtok
.text:42CF95B1                 add     esp, 8
.text:42CF95B4                 push    eax             ; char *
.text:42CF95B5                 call    sub_42CF9C63
.text:42CF95BA                 add     esp, 4
.text:42CF95BD                 mov     ecx, [ebp+arg_4]
.text:42CF95C0                 mov     edx, [ecx]
.text:42CF95C2                 mov     ecx, [ebp+arg_0]
.text:42CF95C5                 mov     [ecx+edx*4], eax
.text:42CF95C8                 mov     edx, [ebp+arg_4]
.text:42CF95CB                 mov     eax, [edx]
.text:42CF95CD                 add     eax, 1
.text:42CF95D0                 mov     ecx, [ebp+arg_4]
.text:42CF95D3                 mov     [ecx], eax
.text:42CF95D5
.text:42CF95D5 loc_42CF95D5:                           ; CODE XREF: sub_42CF9388+175\u2191j
.text:42CF95D5                                         ; sub_42CF9388+19A\u2191j
.text:42CF95D5                 cmp     [ebp+phkResult], 0
.text:42CF95D9                 jz      short loc_42CF95E5
.text:42CF95DB                 mov     edx, [ebp+phkResult]
.text:42CF95DE                 push    edx             ; hKey
.text:42CF95DF                 call    ds:RegCloseKey
.text:42CF95E5
.text:42CF95E5 loc_42CF95E5:                           ; CODE XREF: sub_42CF9388+251\u2191j
.text:42CF95E5                 mov     eax, [ebp+Str1]
.text:42CF95E8                 push    eax             ; Str
.text:42CF95E9                 call    strlen
.text:42CF95EE                 add     esp, 4
.text:42CF95F1                 mov     ecx, [ebp+Str1]
.text:42CF95F4                 lea     edx, [ecx+eax+1]
.text:42CF95F8                 mov     [ebp+Str1], edx
.text:42CF95FB                 jmp     loc_42CF9430
.text:42CF9600 ; ---------------------------------------------------------------------------
.text:42CF9600
.text:42CF9600 loc_42CF9600:                           ; CODE XREF: sub_42CF9388+BB\u2191j
.text:42CF9600                 cmp     [ebp+lpData], 0
.text:42CF9604                 jz      short loc_42CF9613
.text:42CF9606                 mov     eax, [ebp+lpData]
.text:42CF9609                 push    eax             ; Block
.text:42CF960A                 call    ds:free
.text:42CF9610                 add     esp, 4
.text:42CF9613
.text:42CF9613 loc_42CF9613:                           ; CODE XREF: sub_42CF9388+27C\u2191j
.text:42CF9613                 mov     cl, byte_42D011C0
.text:42CF9619                 mov     [ebp+Data], cl
.text:42CF961F                 mov     ecx, 1Fh
.text:42CF9624                 xor     eax, eax
.text:42CF9626                 lea     edi, [ebp+var_497]
.text:42CF962C                 rep stosd
.text:42CF962E                 stosw
.text:42CF9630                 stosb
.text:42CF9631                 mov     [ebp+var_49C], 80h ; '€'
.text:42CF963B                 mov     [ebp+phkResult], 0
.text:42CF9642                 lea     edx, [ebp+phkResult]
.text:42CF9645                 push    edx             ; phkResult
.text:42CF9646                 push    0F003Fh         ; samDesired
.text:42CF964B                 push    0               ; ulOptions
.text:42CF964D                 push    offset aSoftwareMicros_4 ; "SOFTWARE\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CF9652                 push    80000002h       ; hKey
.text:42CF9657                 call    ds:RegOpenKeyExA
.text:42CF965D                 test    eax, eax
.text:42CF965F                 jnz     loc_42CF9880
.text:42CF9665                 lea     eax, [ebp+var_49C]
.text:42CF966B                 push    eax             ; lpcbData
.text:42CF966C                 lea     ecx, [ebp+Data]
.text:42CF9672                 push    ecx             ; lpData
.text:42CF9673                 push    0               ; lpType
.text:42CF9675                 push    0               ; lpReserved
.text:42CF9677                 push    offset aCurrentversion ; "CurrentVersion"
.text:42CF967C                 mov     edx, [ebp+phkResult]
.text:42CF967F                 push    edx             ; hKey
.text:42CF9680                 call    ds:RegQueryValueExA
.text:42CF9686                 test    eax, eax
.text:42CF9688                 jnz     loc_42CF9880
.text:42CF968E                 push    offset asc_42D0063C ; "."
.text:42CF9693                 lea     eax, [ebp+Data]
.text:42CF9699                 push    eax             ; String
.text:42CF969A                 call    ds:strtok
.text:42CF96A0                 add     esp, 8
.text:42CF96A3                 push    eax             ; String
.text:42CF96A4                 call    ds:atoi
.text:42CF96AA                 add     esp, 4
.text:42CF96AD                 mov     [ebp+var_4A0], eax
.text:42CF96B3                 push    offset asc_42D00640 ; "."
.text:42CF96B8                 push    0               ; String
.text:42CF96BA                 call    ds:strtok
.text:42CF96C0                 add     esp, 8
.text:42CF96C3                 push    eax             ; String
.text:42CF96C4                 call    ds:atoi
.text:42CF96CA                 add     esp, 4
.text:42CF96CD                 mov     [ebp+var_4A4], eax
.text:42CF96D3                 cmp     [ebp+var_4A0], 7
.text:42CF96DA                 jl      short loc_42CF96F6
.text:42CF96DC                 cmp     [ebp+var_4A0], 7
.text:42CF96E3                 jnz     loc_42CF9880
.text:42CF96E9                 cmp     [ebp+var_4A4], 5
.text:42CF96F0                 jge     loc_42CF9880
.text:42CF96F6
.text:42CF96F6 loc_42CF96F6:                           ; CODE XREF: sub_42CF9388+352\u2191j
.text:42CF96F6                 mov     [ebp+hKey], 0
.text:42CF9700                 mov     cl, byte_42D011C4
.text:42CF9706                 mov     [ebp+var_5AC], cl
.text:42CF970C                 mov     ecx, 3Fh ; '?'
.text:42CF9711                 xor     eax, eax
.text:42CF9713                 lea     edi, [ebp+var_5AB]
.text:42CF9719                 rep stosd
.text:42CF971B                 stosw
.text:42CF971D                 stosb
.text:42CF971E                 mov     [ebp+var_4A8], 100h
.text:42CF9728                 lea     edx, [ebp+hKey]
.text:42CF972E                 push    edx             ; phkResult
.text:42CF972F                 push    0F003Fh         ; samDesired
.text:42CF9734                 push    0               ; ulOptions
.text:42CF9736                 push    offset aSoftwareMicros_5 ; "Software\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CF973B                 push    80000002h       ; hKey
.text:42CF9740                 call    ds:RegOpenKeyExA
.text:42CF9746                 test    eax, eax
.text:42CF9748                 jnz     loc_42CF986A
.text:42CF974E                 lea     eax, [ebp+var_4A8]
.text:42CF9754                 push    eax             ; lpcbData
.text:42CF9755                 lea     ecx, [ebp+var_5AC]
.text:42CF975B                 push    ecx             ; lpData
.text:42CF975C                 push    0               ; lpType
.text:42CF975E                 push    0               ; lpReserved
.text:42CF9760                 push    offset aListenon ; "ListenOn"
.text:42CF9765                 mov     edx, [ebp+hKey]
.text:42CF976B                 push    edx             ; hKey
.text:42CF976C                 call    ds:RegQueryValueExA
.text:42CF9772                 test    eax, eax
.text:42CF9774                 jnz     loc_42CF986A
.text:42CF977A                 lea     eax, [ebp+var_5AC]
.text:42CF9780                 mov     [ebp+var_5B0], eax
.text:42CF9786
.text:42CF9786 loc_42CF9786:                           ; CODE XREF: sub_42CF9388+4DD\u2193j
.text:42CF9786                 push    offset byte_42D011C8 ; Str2
.text:42CF978B                 mov     ecx, [ebp+var_5B0]
.text:42CF9791                 push    ecx             ; Str1
.text:42CF9792                 call    strcmp
.text:42CF9797                 add     esp, 8
.text:42CF979A                 test    eax, eax
.text:42CF979C                 jz      loc_42CF986A
.text:42CF97A2                 push    offset aSsmsso70 ; "SSMSSO70"
.text:42CF97A7                 mov     edx, [ebp+var_5B0]
.text:42CF97AD                 push    edx             ; Str
.text:42CF97AE                 call    ds:strstr
.text:42CF97B4                 add     esp, 8
.text:42CF97B7                 test    eax, eax
.text:42CF97B9                 jnz     short loc_42CF9806
.text:42CF97BB                 push    offset aSsmsso60 ; "SSMSSO60"
.text:42CF97C0                 mov     eax, [ebp+var_5B0]
.text:42CF97C6                 push    eax             ; Str
.text:42CF97C7                 call    ds:strstr
.text:42CF97CD                 add     esp, 8
.text:42CF97D0                 test    eax, eax
.text:42CF97D2                 jnz     short loc_42CF9806
.text:42CF97D4                 push    offset aSsmsso70_0 ; "ssmsso70"
.text:42CF97D9                 mov     ecx, [ebp+var_5B0]
.text:42CF97DF                 push    ecx             ; Str
.text:42CF97E0                 call    ds:strstr
.text:42CF97E6                 add     esp, 8
.text:42CF97E9                 test    eax, eax
.text:42CF97EB                 jnz     short loc_42CF9806
.text:42CF97ED                 push    offset aSsmsso60_0 ; "ssmsso60"
.text:42CF97F2                 mov     edx, [ebp+var_5B0]
.text:42CF97F8                 push    edx             ; Str
.text:42CF97F9                 call    ds:strstr
.text:42CF97FF                 add     esp, 8
.text:42CF9802                 test    eax, eax
.text:42CF9804                 jz      short loc_42CF9846
.text:42CF9806
.text:42CF9806 loc_42CF9806:                           ; CODE XREF: sub_42CF9388+431\u2191j
.text:42CF9806                                         ; sub_42CF9388+44A\u2191j ...
.text:42CF9806                 push    offset Control  ; ","
.text:42CF980B                 mov     eax, [ebp+var_5B0]
.text:42CF9811                 push    eax             ; Str
.text:42CF9812                 call    ds:strcspn
.text:42CF9818                 add     esp, 8
.text:42CF981B                 mov     ecx, [ebp+var_5B0]
.text:42CF9821                 lea     edx, [ecx+eax+1]
.text:42CF9825                 push    edx             ; char *
.text:42CF9826                 call    sub_42CF9C63
.text:42CF982B                 add     esp, 4
.text:42CF982E                 mov     ecx, [ebp+arg_4]
.text:42CF9831                 mov     edx, [ecx]
.text:42CF9833                 mov     ecx, [ebp+arg_0]
.text:42CF9836                 mov     [ecx+edx*4], eax
.text:42CF9839                 mov     edx, [ebp+arg_4]
.text:42CF983C                 mov     eax, [edx]
.text:42CF983E                 add     eax, 1
.text:42CF9841                 mov     ecx, [ebp+arg_4]
.text:42CF9844                 mov     [ecx], eax
.text:42CF9846
.text:42CF9846 loc_42CF9846:                           ; CODE XREF: sub_42CF9388+47C\u2191j
.text:42CF9846                 mov     edx, [ebp+var_5B0]
.text:42CF984C                 push    edx             ; Str
.text:42CF984D                 call    strlen
.text:42CF9852                 add     esp, 4
.text:42CF9855                 mov     ecx, [ebp+var_5B0]
.text:42CF985B                 lea     edx, [ecx+eax+1]
.text:42CF985F                 mov     [ebp+var_5B0], edx
.text:42CF9865                 jmp     loc_42CF9786
.text:42CF986A ; ---------------------------------------------------------------------------
.text:42CF986A
.text:42CF986A loc_42CF986A:                           ; CODE XREF: sub_42CF9388+3C0\u2191j
.text:42CF986A                                         ; sub_42CF9388+3EC\u2191j ...
.text:42CF986A                 cmp     [ebp+hKey], 0
.text:42CF9871                 jz      short loc_42CF9880
.text:42CF9873                 mov     eax, [ebp+hKey]
.text:42CF9879                 push    eax             ; hKey
.text:42CF987A                 call    ds:RegCloseKey
.text:42CF9880
.text:42CF9880 loc_42CF9880:                           ; CODE XREF: sub_42CF9388+2D7\u2191j
.text:42CF9880                                         ; sub_42CF9388+300\u2191j ...
.text:42CF9880                 cmp     [ebp+phkResult], 0
.text:42CF9884                 jz      short loc_42CF9890
.text:42CF9886                 mov     ecx, [ebp+phkResult]
.text:42CF9889                 push    ecx             ; hKey
.text:42CF988A                 call    ds:RegCloseKey
.text:42CF9890
.text:42CF9890 loc_42CF9890:                           ; CODE XREF: sub_42CF9388+4FC\u2191j
.text:42CF9890                 pop     edi
.text:42CF9891                 mov     esp, ebp
.text:42CF9893                 pop     ebp
.text:42CF9894                 retn
.text:42CF9894 sub_42CF9388    endp
.text:42CF9894
.text:42CF9895
.text:42CF9895 ; =============== S U B R O U T I N E =======================================
.text:42CF9895
.text:42CF9895 ; Attributes: bp-based frame
.text:42CF9895
.text:42CF9895 ; int __cdecl sub_42CF9895(HKEY hKey, int)
.text:42CF9895 sub_42CF9895    proc near               ; CODE XREF: sub_42CF8300+6F1\u2191p
.text:42CF9895
.text:42CF9895 var_8           = dword ptr -8
.text:42CF9895 Str             = dword ptr -4
.text:42CF9895 hKey            = dword ptr  8
.text:42CF9895 arg_4           = dword ptr  0Ch
.text:42CF9895
.text:42CF9895                 push    ebp
.text:42CF9896                 mov     ebp, esp
.text:42CF9898                 sub     esp, 8
.text:42CF989B                 mov     cbData, 400h
.text:42CF98A5                 push    offset cbData   ; lpcbData
.text:42CF98AA                 push    offset Data     ; lpData
.text:42CF98AF                 push    0               ; lpType
.text:42CF98B1                 push    0               ; lpReserved
.text:42CF98B3                 push    offset aTcpdynamicport ; "TcpDynamicPorts"
.text:42CF98B8                 mov     eax, [ebp+hKey]
.text:42CF98BB                 push    eax             ; hKey
.text:42CF98BC                 call    ds:RegQueryValueExA
.text:42CF98C2                 test    eax, eax
.text:42CF98C4                 jnz     loc_42CF99D3
.text:42CF98CA                 cmp     cbData, 1
.text:42CF98D1                 jbe     loc_42CF99D3
.text:42CF98D7                 mov     [ebp+Str], offset Data
.text:42CF98DE                 mov     ecx, [ebp+arg_4]
.text:42CF98E1                 mov     dword ptr [ecx+20Ch], 0
.text:42CF98EB
.text:42CF98EB loc_42CF98EB:                           ; CODE XREF: sub_42CF9895+DC\u2193j
.text:42CF98EB                 push    2Ch ; ','       ; Val
.text:42CF98ED                 mov     edx, [ebp+Str]
.text:42CF98F0                 push    edx             ; Str
.text:42CF98F1                 call    ds:strchr
.text:42CF98F7                 add     esp, 8
.text:42CF98FA                 test    eax, eax
.text:42CF98FC                 jz      short loc_42CF9976
.text:42CF98FE                 push    offset asc_42D006C0 ; ","
.text:42CF9903                 mov     eax, [ebp+Str]
.text:42CF9906                 push    eax             ; String
.text:42CF9907                 call    ds:strtok
.text:42CF990D                 add     esp, 8
.text:42CF9910                 push    eax             ; char *
.text:42CF9911                 call    sub_42CF9C63
.text:42CF9916                 add     esp, 4
.text:42CF9919                 mov     [ebp+var_8], eax
.text:42CF991C                 mov     ecx, [ebp+arg_4]
.text:42CF991F                 push    ecx
.text:42CF9920                 mov     edx, [ebp+var_8]
.text:42CF9923                 push    edx
.text:42CF9924                 call    sub_42CF9E90
.text:42CF9929                 add     esp, 8
.text:42CF992C                 test    eax, eax
.text:42CF992E                 jz      short loc_42CF995B
.text:42CF9930                 mov     eax, [ebp+arg_4]
.text:42CF9933                 mov     ecx, [eax+20Ch]
.text:42CF9939                 mov     edx, [ebp+arg_4]
.text:42CF993C                 mov     eax, [ebp+var_8]
.text:42CF993F                 mov     [edx+ecx*4+10Ch], eax
.text:42CF9946                 mov     ecx, [ebp+arg_4]
.text:42CF9949                 mov     edx, [ecx+20Ch]
.text:42CF994F                 add     edx, 1
.text:42CF9952                 mov     eax, [ebp+arg_4]
.text:42CF9955                 mov     [eax+20Ch], edx
.text:42CF995B
.text:42CF995B loc_42CF995B:                           ; CODE XREF: sub_42CF9895+99\u2191j
.text:42CF995B                 mov     ecx, [ebp+Str]
.text:42CF995E                 push    ecx             ; Str
.text:42CF995F                 call    strlen
.text:42CF9964                 add     esp, 4
.text:42CF9967                 mov     edx, [ebp+Str]
.text:42CF996A                 lea     eax, [edx+eax+1]
.text:42CF996E                 mov     [ebp+Str], eax
.text:42CF9971                 jmp     loc_42CF98EB
.text:42CF9976 ; ---------------------------------------------------------------------------
.text:42CF9976
.text:42CF9976 loc_42CF9976:                           ; CODE XREF: sub_42CF9895+67\u2191j
.text:42CF9976                 push    offset asc_42D006C4 ; ","
.text:42CF997B                 mov     ecx, [ebp+Str]
.text:42CF997E                 push    ecx             ; String
.text:42CF997F                 call    ds:strtok
.text:42CF9985                 add     esp, 8
.text:42CF9988                 push    eax             ; char *
.text:42CF9989                 call    sub_42CF9C63
.text:42CF998E                 add     esp, 4
.text:42CF9991                 mov     [ebp+var_8], eax
.text:42CF9994                 mov     edx, [ebp+arg_4]
.text:42CF9997                 push    edx
.text:42CF9998                 mov     eax, [ebp+var_8]
.text:42CF999B                 push    eax
.text:42CF999C                 call    sub_42CF9E90
.text:42CF99A1                 add     esp, 8
.text:42CF99A4                 test    eax, eax
.text:42CF99A6                 jz      short loc_42CF99D3
.text:42CF99A8                 mov     ecx, [ebp+arg_4]
.text:42CF99AB                 mov     edx, [ecx+20Ch]
.text:42CF99B1                 mov     eax, [ebp+arg_4]
.text:42CF99B4                 mov     ecx, [ebp+var_8]
.text:42CF99B7                 mov     [eax+edx*4+10Ch], ecx
.text:42CF99BE                 mov     edx, [ebp+arg_4]
.text:42CF99C1                 mov     eax, [edx+20Ch]
.text:42CF99C7                 add     eax, 1
.text:42CF99CA                 mov     ecx, [ebp+arg_4]
.text:42CF99CD                 mov     [ecx+20Ch], eax
.text:42CF99D3
.text:42CF99D3 loc_42CF99D3:                           ; CODE XREF: sub_42CF9895+2F\u2191j
.text:42CF99D3                                         ; sub_42CF9895+3C\u2191j ...
.text:42CF99D3                 mov     esp, ebp
.text:42CF99D5                 pop     ebp
.text:42CF99D6                 retn
.text:42CF99D6 sub_42CF9895    endp
.text:42CF99D6
.text:42CF99D7
.text:42CF99D7 ; =============== S U B R O U T I N E =======================================
.text:42CF99D7
.text:42CF99D7 ; Attributes: bp-based frame
.text:42CF99D7
.text:42CF99D7 sub_42CF99D7    proc near               ; CODE XREF: ConnectionListen+DA1\u2191p
.text:42CF99D7
.text:42CF99D7 var_4           = dword ptr -4
.text:42CF99D7 arg_0           = dword ptr  8
.text:42CF99D7 arg_4           = dword ptr  0Ch
.text:42CF99D7
.text:42CF99D7                 push    ebp
.text:42CF99D8                 mov     ebp, esp
.text:42CF99DA                 push    ecx
.text:42CF99DB                 cmp     [ebp+arg_0], 599h
.text:42CF99E2                 jz      short loc_42CF99ED
.text:42CF99E4                 cmp     [ebp+arg_0], 59Ah
.text:42CF99EB                 jnz     short loc_42CF99F4
.text:42CF99ED
.text:42CF99ED loc_42CF99ED:                           ; CODE XREF: sub_42CF99D7+B\u2191j
.text:42CF99ED                 mov     eax, 1
.text:42CF99F2                 jmp     short loc_42CF9A31
.text:42CF99F4 ; ---------------------------------------------------------------------------
.text:42CF99F4
.text:42CF99F4 loc_42CF99F4:                           ; CODE XREF: sub_42CF99D7+14\u2191j
.text:42CF99F4                 mov     [ebp+var_4], 0
.text:42CF99FB                 jmp     short loc_42CF9A06
.text:42CF99FD ; ---------------------------------------------------------------------------
.text:42CF99FD
.text:42CF99FD loc_42CF99FD:                           ; CODE XREF: sub_42CF99D7:loc_42CF9A2D\u2193j
.text:42CF99FD                 mov     eax, [ebp+var_4]
.text:42CF9A00                 add     eax, 1
.text:42CF9A03                 mov     [ebp+var_4], eax
.text:42CF9A06
.text:42CF9A06 loc_42CF9A06:                           ; CODE XREF: sub_42CF99D7+24\u2191j
.text:42CF9A06                 mov     ecx, [ebp+arg_4]
.text:42CF9A09                 mov     edx, [ebp+var_4]
.text:42CF9A0C                 cmp     edx, [ecx+310h]
.text:42CF9A12                 jnb     short loc_42CF9A2F
.text:42CF9A14                 mov     eax, [ebp+var_4]
.text:42CF9A17                 mov     ecx, [ebp+arg_4]
.text:42CF9A1A                 mov     edx, [ebp+arg_0]
.text:42CF9A1D                 cmp     edx, [ecx+eax*4+210h]
.text:42CF9A24                 jnz     short loc_42CF9A2D
.text:42CF9A26                 mov     eax, 1
.text:42CF9A2B                 jmp     short loc_42CF9A31
.text:42CF9A2D ; ---------------------------------------------------------------------------
.text:42CF9A2D
.text:42CF9A2D loc_42CF9A2D:                           ; CODE XREF: sub_42CF99D7+4D\u2191j
.text:42CF9A2D                 jmp     short loc_42CF99FD
.text:42CF9A2F ; ---------------------------------------------------------------------------
.text:42CF9A2F
.text:42CF9A2F loc_42CF9A2F:                           ; CODE XREF: sub_42CF99D7+3B\u2191j
.text:42CF9A2F                 xor     eax, eax
.text:42CF9A31
.text:42CF9A31 loc_42CF9A31:                           ; CODE XREF: sub_42CF99D7+1B\u2191j
.text:42CF9A31                                         ; sub_42CF99D7+54\u2191j
.text:42CF9A31                 mov     esp, ebp
.text:42CF9A33                 pop     ebp
.text:42CF9A34                 retn
.text:42CF9A34 sub_42CF99D7    endp
.text:42CF9A34
.text:42CF9A35
.text:42CF9A35 ; =============== S U B R O U T I N E =======================================
.text:42CF9A35
.text:42CF9A35 ; Attributes: bp-based frame
.text:42CF9A35
.text:42CF9A35 sub_42CF9A35    proc near               ; CODE XREF: ConnectionListen+F4C\u2191p
.text:42CF9A35
.text:42CF9A35 Buffer          = byte ptr -2030h
.text:42CF9A35 var_1FB1        = byte ptr -1FB1h
.text:42CF9A35 Destination     = byte ptr -1FB0h
.text:42CF9A35 var_1FAF        = byte ptr -1FAFh
.text:42CF9A35 var_10          = dword ptr -10h
.text:42CF9A35 Value           = dword ptr -0Ch
.text:42CF9A35 var_8           = dword ptr -8
.text:42CF9A35 var_4           = dword ptr -4
.text:42CF9A35 arg_0           = dword ptr  8
.text:42CF9A35
.text:42CF9A35                 push    ebp
.text:42CF9A36                 mov     ebp, esp
.text:42CF9A38                 mov     eax, 2030h
.text:42CF9A3D                 call    __alloca_probe
.text:42CF9A42                 push    edi
.text:42CF9A43                 mov     al, byte_42D011CC
.text:42CF9A48                 mov     [ebp+Destination], al
.text:42CF9A4E                 mov     ecx, 7E7h
.text:42CF9A53                 xor     eax, eax
.text:42CF9A55                 lea     edi, [ebp+var_1FAF]
.text:42CF9A5B                 rep stosd
.text:42CF9A5D                 stosw
.text:42CF9A5F                 stosb
.text:42CF9A60                 mov     [ebp+var_10], 1
.text:42CF9A67                 mov     ecx, [ebp+arg_0]
.text:42CF9A6A                 cmp     dword ptr [ecx], 0
.text:42CF9A6D                 jz      loc_42CF9C5B
.text:42CF9A73                 mov     [ebp+var_8], 0
.text:42CF9A7A                 jmp     short loc_42CF9A85
.text:42CF9A7C ; ---------------------------------------------------------------------------
.text:42CF9A7C
.text:42CF9A7C loc_42CF9A7C:                           ; CODE XREF: sub_42CF9A35+71\u2193j
.text:42CF9A7C                                         ; sub_42CF9A35:loc_42CF9AF9\u2193j
.text:42CF9A7C                 mov     edx, [ebp+var_8]
.text:42CF9A7F                 add     edx, 1
.text:42CF9A82                 mov     [ebp+var_8], edx
.text:42CF9A85
.text:42CF9A85 loc_42CF9A85:                           ; CODE XREF: sub_42CF9A35+45\u2191j
.text:42CF9A85                 mov     eax, [ebp+arg_0]
.text:42CF9A88                 mov     ecx, [ebp+var_8]
.text:42CF9A8B                 cmp     ecx, [eax+104h]
.text:42CF9A91                 jnb     short loc_42CF9AFB
.text:42CF9A93                 mov     edx, [ebp+var_8]
.text:42CF9A96                 mov     eax, [ebp+arg_0]
.text:42CF9A99                 mov     ecx, [eax+edx*4+4]
.text:42CF9A9D                 mov     [ebp+Value], ecx
.text:42CF9AA0                 cmp     [ebp+Value], 0
.text:42CF9AA4                 jnz     short loc_42CF9AA8
.text:42CF9AA6                 jmp     short loc_42CF9A7C
.text:42CF9AA8 ; ---------------------------------------------------------------------------
.text:42CF9AA8
.text:42CF9AA8 loc_42CF9AA8:                           ; CODE XREF: sub_42CF9A35+6F\u2191j
.text:42CF9AA8                 push    0Ah             ; Radix
.text:42CF9AAA                 lea     edx, [ebp+Buffer]
.text:42CF9AB0                 push    edx             ; Buffer
.text:42CF9AB1                 mov     eax, [ebp+Value]
.text:42CF9AB4                 push    eax             ; Value
.text:42CF9AB5                 call    ds:_itoa
.text:42CF9ABB                 add     esp, 0Ch
.text:42CF9ABE                 lea     ecx, [ebp+Buffer]
.text:42CF9AC4                 push    ecx             ; Source
.text:42CF9AC5                 lea     edx, [ebp+Destination]
.text:42CF9ACB                 push    edx             ; Destination
.text:42CF9ACC                 call    strcat
.text:42CF9AD1                 add     esp, 8
.text:42CF9AD4                 mov     eax, [ebp+arg_0]
.text:42CF9AD7                 mov     ecx, [eax+104h]
.text:42CF9ADD                 sub     ecx, 1
.text:42CF9AE0                 cmp     [ebp+var_8], ecx
.text:42CF9AE3                 jz      short loc_42CF9AF9
.text:42CF9AE5                 push    offset asc_42D006C8 ; ","
.text:42CF9AEA                 lea     edx, [ebp+Destination]
.text:42CF9AF0                 push    edx             ; Destination
.text:42CF9AF1                 call    strcat
.text:42CF9AF6                 add     esp, 8
.text:42CF9AF9
.text:42CF9AF9 loc_42CF9AF9:                           ; CODE XREF: sub_42CF9A35+AE\u2191j
.text:42CF9AF9                 jmp     short loc_42CF9A7C
.text:42CF9AFB ; ---------------------------------------------------------------------------
.text:42CF9AFB
.text:42CF9AFB loc_42CF9AFB:                           ; CODE XREF: sub_42CF9A35+5C\u2191j
.text:42CF9AFB                 lea     eax, [ebp+Destination]
.text:42CF9B01                 push    eax             ; Str
.text:42CF9B02                 call    strlen
.text:42CF9B07                 add     esp, 4
.text:42CF9B0A                 add     eax, 1
.text:42CF9B0D                 push    eax             ; cbData
.text:42CF9B0E                 lea     ecx, [ebp+Destination]
.text:42CF9B14                 push    ecx             ; lpData
.text:42CF9B15                 push    1               ; dwType
.text:42CF9B17                 push    0               ; Reserved
.text:42CF9B19                 push    offset aTcpport_1 ; "TcpPort"
.text:42CF9B1E                 mov     edx, [ebp+arg_0]
.text:42CF9B21                 mov     eax, [edx]
.text:42CF9B23                 push    eax             ; hKey
.text:42CF9B24                 call    ds:RegSetValueExA
.text:42CF9B2A                 mov     [ebp+var_4], eax
.text:42CF9B2D                 cmp     [ebp+var_4], 0
.text:42CF9B31                 jz      short loc_42CF9B3A
.text:42CF9B33                 mov     [ebp+var_10], 0
.text:42CF9B3A
.text:42CF9B3A loc_42CF9B3A:                           ; CODE XREF: sub_42CF9A35+FC\u2191j
.text:42CF9B3A                 mov     ecx, [ebp+arg_0]
.text:42CF9B3D                 cmp     dword ptr [ecx+20Ch], 0
.text:42CF9B44                 jbe     loc_42CF9BF3
.text:42CF9B4A                 push    offset byte_42D011D0 ; Source
.text:42CF9B4F                 lea     edx, [ebp+Destination]
.text:42CF9B55                 push    edx             ; Destination
.text:42CF9B56                 call    strcpy
.text:42CF9B5B                 add     esp, 8
.text:42CF9B5E                 mov     [ebp+var_8], 0
.text:42CF9B65                 jmp     short loc_42CF9B70
.text:42CF9B67 ; ---------------------------------------------------------------------------
.text:42CF9B67
.text:42CF9B67 loc_42CF9B67:                           ; CODE XREF: sub_42CF9A35:loc_42CF9BD8\u2193j
.text:42CF9B67                 mov     eax, [ebp+var_8]
.text:42CF9B6A                 add     eax, 1
.text:42CF9B6D                 mov     [ebp+var_8], eax
.text:42CF9B70
.text:42CF9B70 loc_42CF9B70:                           ; CODE XREF: sub_42CF9A35+130\u2191j
.text:42CF9B70                 mov     ecx, [ebp+arg_0]
.text:42CF9B73                 mov     edx, [ebp+var_8]
.text:42CF9B76                 cmp     edx, [ecx+20Ch]
.text:42CF9B7C                 jnb     short loc_42CF9BDA
.text:42CF9B7E                 mov     eax, [ebp+var_8]
.text:42CF9B81                 mov     ecx, [ebp+arg_0]
.text:42CF9B84                 cmp     dword ptr [ecx+eax*4+10Ch], 0
.text:42CF9B8C                 jz      short loc_42CF9BD8
.text:42CF9B8E                 push    0Ah             ; Radix
.text:42CF9B90                 lea     edx, [ebp+Buffer]
.text:42CF9B96                 push    edx             ; Buffer
.text:42CF9B97                 mov     eax, [ebp+var_8]
.text:42CF9B9A                 mov     ecx, [ebp+arg_0]
.text:42CF9B9D                 mov     edx, [ecx+eax*4+10Ch]
.text:42CF9BA4                 push    edx             ; Value
.text:42CF9BA5                 call    ds:_itoa
.text:42CF9BAB                 add     esp, 0Ch
.text:42CF9BAE                 lea     eax, [ebp+Buffer]
.text:42CF9BB4                 push    eax             ; Source
.text:42CF9BB5                 lea     ecx, [ebp+Destination]
.text:42CF9BBB                 push    ecx             ; Destination
.text:42CF9BBC                 call    strcat
.text:42CF9BC1                 add     esp, 8
.text:42CF9BC4                 push    offset asc_42D006D4 ; ","
.text:42CF9BC9                 lea     edx, [ebp+Destination]
.text:42CF9BCF                 push    edx             ; Destination
.text:42CF9BD0                 call    strcat
.text:42CF9BD5                 add     esp, 8
.text:42CF9BD8
.text:42CF9BD8 loc_42CF9BD8:                           ; CODE XREF: sub_42CF9A35+157\u2191j
.text:42CF9BD8                 jmp     short loc_42CF9B67
.text:42CF9BDA ; ---------------------------------------------------------------------------
.text:42CF9BDA
.text:42CF9BDA loc_42CF9BDA:                           ; CODE XREF: sub_42CF9A35+147\u2191j
.text:42CF9BDA                 lea     eax, [ebp+Destination]
.text:42CF9BE0                 push    eax             ; Str
.text:42CF9BE1                 call    strlen
.text:42CF9BE6                 add     esp, 4
.text:42CF9BE9                 mov     [ebp+eax+var_1FB1], 0
.text:42CF9BF1                 jmp     short loc_42CF9C07
.text:42CF9BF3 ; ---------------------------------------------------------------------------
.text:42CF9BF3
.text:42CF9BF3 loc_42CF9BF3:                           ; CODE XREF: sub_42CF9A35+10F\u2191j
.text:42CF9BF3                 push    offset byte_42D011D4 ; Source
.text:42CF9BF8                 lea     ecx, [ebp+Destination]
.text:42CF9BFE                 push    ecx             ; Destination
.text:42CF9BFF                 call    strcpy
.text:42CF9C04                 add     esp, 8
.text:42CF9C07
.text:42CF9C07 loc_42CF9C07:                           ; CODE XREF: sub_42CF9A35+1BC\u2191j
.text:42CF9C07                 lea     edx, [ebp+Destination]
.text:42CF9C0D                 push    edx             ; Str
.text:42CF9C0E                 call    strlen
.text:42CF9C13                 add     esp, 4
.text:42CF9C16                 add     eax, 1
.text:42CF9C19                 push    eax             ; cbData
.text:42CF9C1A                 lea     eax, [ebp+Destination]
.text:42CF9C20                 push    eax             ; lpData
.text:42CF9C21                 push    1               ; dwType
.text:42CF9C23                 push    0               ; Reserved
.text:42CF9C25                 push    offset aTcpdynamicport_0 ; "TcpDynamicPorts"
.text:42CF9C2A                 mov     ecx, [ebp+arg_0]
.text:42CF9C2D                 mov     edx, [ecx]
.text:42CF9C2F                 push    edx             ; hKey
.text:42CF9C30                 call    ds:RegSetValueExA
.text:42CF9C36                 mov     [ebp+var_4], eax
.text:42CF9C39                 cmp     [ebp+var_4], 0
.text:42CF9C3D                 jz      short loc_42CF9C46
.text:42CF9C3F                 mov     [ebp+var_10], 0
.text:42CF9C46
.text:42CF9C46 loc_42CF9C46:                           ; CODE XREF: sub_42CF9A35+208\u2191j
.text:42CF9C46                 mov     eax, [ebp+arg_0]
.text:42CF9C49                 mov     ecx, [eax]
.text:42CF9C4B                 push    ecx             ; hKey
.text:42CF9C4C                 call    ds:RegCloseKey
.text:42CF9C52                 mov     edx, [ebp+arg_0]
.text:42CF9C55                 mov     dword ptr [edx], 0
.text:42CF9C5B
.text:42CF9C5B loc_42CF9C5B:                           ; CODE XREF: sub_42CF9A35+38\u2191j
.text:42CF9C5B                 mov     eax, [ebp+var_10]
.text:42CF9C5E                 pop     edi
.text:42CF9C5F                 mov     esp, ebp
.text:42CF9C61                 pop     ebp
.text:42CF9C62                 retn
.text:42CF9C62 sub_42CF9A35    endp
.text:42CF9C62
.text:42CF9C63
.text:42CF9C63 ; =============== S U B R O U T I N E =======================================
.text:42CF9C63
.text:42CF9C63 ; Attributes: bp-based frame
.text:42CF9C63
.text:42CF9C63 ; int __cdecl sub_42CF9C63(char *)
.text:42CF9C63 sub_42CF9C63    proc near               ; CODE XREF: sub_42CF8300+624\u2191p
.text:42CF9C63                                         ; sub_42CF8300+688\u2191p ...
.text:42CF9C63
.text:42CF9C63 var_18          = dword ptr -18h
.text:42CF9C63 var_14          = dword ptr -14h
.text:42CF9C63 var_10          = dword ptr -10h
.text:42CF9C63 String          = dword ptr -0Ch
.text:42CF9C63 var_8           = dword ptr -8
.text:42CF9C63 var_4           = dword ptr -4
.text:42CF9C63 arg_0           = dword ptr  8
.text:42CF9C63
.text:42CF9C63                 push    ebp
.text:42CF9C64                 mov     ebp, esp
.text:42CF9C66                 sub     esp, 18h
.text:42CF9C69                 mov     [ebp+var_4], 0
.text:42CF9C70                 cmp     [ebp+arg_0], 0
.text:42CF9C74                 jz      loc_42CF9D80
.text:42CF9C7A                 mov     eax, [ebp+arg_0]
.text:42CF9C7D                 movsx   ecx, byte ptr [eax]
.text:42CF9C80                 cmp     ecx, 30h ; '0'
.text:42CF9C83                 jnz     loc_42CF9D70
.text:42CF9C89                 mov     edx, [ebp+arg_0]
.text:42CF9C8C                 movsx   eax, byte ptr [edx+1]
.text:42CF9C90                 push    eax             ; C
.text:42CF9C91                 call    ds:toupper
.text:42CF9C97                 add     esp, 4
.text:42CF9C9A                 cmp     eax, 58h ; 'X'
.text:42CF9C9D                 jnz     loc_42CF9D70
.text:42CF9CA3                 mov     ecx, [ebp+arg_0]
.text:42CF9CA6                 add     ecx, 2
.text:42CF9CA9                 mov     [ebp+String], ecx
.text:42CF9CAC                 mov     edx, [ebp+String]
.text:42CF9CAF                 push    edx             ; String
.text:42CF9CB0                 call    ds:_strupr
.text:42CF9CB6                 add     esp, 4
.text:42CF9CB9                 mov     eax, [ebp+String]
.text:42CF9CBC                 push    eax             ; Str
.text:42CF9CBD                 call    strlen
.text:42CF9CC2                 add     esp, 4
.text:42CF9CC5                 sub     eax, 1
.text:42CF9CC8                 mov     [ebp+var_8], eax
.text:42CF9CCB                 mov     [ebp+var_10], 0
.text:42CF9CD2                 jmp     short loc_42CF9CDD
.text:42CF9CD4 ; ---------------------------------------------------------------------------
.text:42CF9CD4
.text:42CF9CD4 loc_42CF9CD4:                           ; CODE XREF: sub_42CF9C63+D2\u2193j
.text:42CF9CD4                 mov     ecx, [ebp+var_10]
.text:42CF9CD7                 add     ecx, 1
.text:42CF9CDA                 mov     [ebp+var_10], ecx
.text:42CF9CDD
.text:42CF9CDD loc_42CF9CDD:                           ; CODE XREF: sub_42CF9C63+6F\u2191j
.text:42CF9CDD                 mov     edx, [ebp+var_10]
.text:42CF9CE0                 cmp     edx, [ebp+var_8]
.text:42CF9CE3                 jge     short loc_42CF9D37
.text:42CF9CE5                 mov     eax, [ebp+String]
.text:42CF9CE8                 add     eax, [ebp+var_10]
.text:42CF9CEB                 movsx   ecx, byte ptr [eax]
.text:42CF9CEE                 cmp     ecx, 39h ; '9'
.text:42CF9CF1                 jg      short loc_42CF9D04
.text:42CF9CF3                 mov     edx, [ebp+String]
.text:42CF9CF6                 add     edx, [ebp+var_10]
.text:42CF9CF9                 movsx   eax, byte ptr [edx]
.text:42CF9CFC                 sub     eax, 30h ; '0'
.text:42CF9CFF                 mov     [ebp+var_14], eax
.text:42CF9D02                 jmp     short loc_42CF9D13
.text:42CF9D04 ; ---------------------------------------------------------------------------
.text:42CF9D04
.text:42CF9D04 loc_42CF9D04:                           ; CODE XREF: sub_42CF9C63+8E\u2191j
.text:42CF9D04                 mov     ecx, [ebp+String]
.text:42CF9D07                 add     ecx, [ebp+var_10]
.text:42CF9D0A                 movsx   edx, byte ptr [ecx]
.text:42CF9D0D                 sub     edx, 37h ; '7'
.text:42CF9D10                 mov     [ebp+var_14], edx
.text:42CF9D13
.text:42CF9D13 loc_42CF9D13:                           ; CODE XREF: sub_42CF9C63+9F\u2191j
.text:42CF9D13                 mov     eax, [ebp+var_8]
.text:42CF9D16                 sub     eax, [ebp+var_10]
.text:42CF9D19                 lea     ecx, ds:0FFFFFFFCh[eax*4]
.text:42CF9D20                 mov     edx, 10h
.text:42CF9D25                 shl     edx, cl
.text:42CF9D27                 mov     eax, [ebp+var_14]
.text:42CF9D2A                 imul    eax, edx
.text:42CF9D2D                 mov     ecx, [ebp+var_4]
.text:42CF9D30                 add     ecx, eax
.text:42CF9D32                 mov     [ebp+var_4], ecx
.text:42CF9D35                 jmp     short loc_42CF9CD4
.text:42CF9D37 ; ---------------------------------------------------------------------------
.text:42CF9D37
.text:42CF9D37 loc_42CF9D37:                           ; CODE XREF: sub_42CF9C63+80\u2191j
.text:42CF9D37                 mov     edx, [ebp+String]
.text:42CF9D3A                 add     edx, [ebp+var_10]
.text:42CF9D3D                 movsx   eax, byte ptr [edx]
.text:42CF9D40                 cmp     eax, 39h ; '9'
.text:42CF9D43                 jg      short loc_42CF9D56
.text:42CF9D45                 mov     ecx, [ebp+String]
.text:42CF9D48                 add     ecx, [ebp+var_10]
.text:42CF9D4B                 movsx   edx, byte ptr [ecx]
.text:42CF9D4E                 sub     edx, 30h ; '0'
.text:42CF9D51                 mov     [ebp+var_18], edx
.text:42CF9D54                 jmp     short loc_42CF9D65
.text:42CF9D56 ; ---------------------------------------------------------------------------
.text:42CF9D56
.text:42CF9D56 loc_42CF9D56:                           ; CODE XREF: sub_42CF9C63+E0\u2191j
.text:42CF9D56                 mov     eax, [ebp+String]
.text:42CF9D59                 add     eax, [ebp+var_10]
.text:42CF9D5C                 movsx   ecx, byte ptr [eax]
.text:42CF9D5F                 sub     ecx, 37h ; '7'
.text:42CF9D62                 mov     [ebp+var_18], ecx
.text:42CF9D65
.text:42CF9D65 loc_42CF9D65:                           ; CODE XREF: sub_42CF9C63+F1\u2191j
.text:42CF9D65                 mov     edx, [ebp+var_4]
.text:42CF9D68                 add     edx, [ebp+var_18]
.text:42CF9D6B                 mov     [ebp+var_4], edx
.text:42CF9D6E                 jmp     short loc_42CF9D80
.text:42CF9D70 ; ---------------------------------------------------------------------------
.text:42CF9D70
.text:42CF9D70 loc_42CF9D70:                           ; CODE XREF: sub_42CF9C63+20\u2191j
.text:42CF9D70                                         ; sub_42CF9C63+3A\u2191j
.text:42CF9D70                 mov     eax, [ebp+arg_0]
.text:42CF9D73                 push    eax             ; String
.text:42CF9D74                 call    ds:atoi
.text:42CF9D7A                 add     esp, 4
.text:42CF9D7D                 mov     [ebp+var_4], eax
.text:42CF9D80
.text:42CF9D80 loc_42CF9D80:                           ; CODE XREF: sub_42CF9C63+11\u2191j
.text:42CF9D80                                         ; sub_42CF9C63+10B\u2191j
.text:42CF9D80                 mov     eax, [ebp+var_4]
.text:42CF9D83                 mov     esp, ebp
.text:42CF9D85                 pop     ebp
.text:42CF9D86                 retn
.text:42CF9D86 sub_42CF9C63    endp
.text:42CF9D86
.text:42CF9D87
.text:42CF9D87 ; =============== S U B R O U T I N E =======================================
.text:42CF9D87
.text:42CF9D87 ; Attributes: bp-based frame
.text:42CF9D87
.text:42CF9D87 ; int __cdecl sub_42CF9D87(char *Str1, LPBYTE lpData)
.text:42CF9D87 sub_42CF9D87    proc near               ; CODE XREF: sub_42CFB392+30B\u2193p
.text:42CF9D87
.text:42CF9D87 Destination     = byte ptr -408h
.text:42CF9D87 cbData          = dword ptr -8
.text:42CF9D87 phkResult       = dword ptr -4
.text:42CF9D87 Str1            = dword ptr  8
.text:42CF9D87 lpData          = dword ptr  0Ch
.text:42CF9D87
.text:42CF9D87                 push    ebp
.text:42CF9D88                 mov     ebp, esp
.text:42CF9D8A                 sub     esp, 408h
.text:42CF9D90                 mov     [ebp+cbData], 200h
.text:42CF9D97                 cmp     [ebp+Str1], 0
.text:42CF9D9B                 jz      short loc_42CF9DC8
.text:42CF9D9D                 push    offset byte_42D011D8 ; Str2
.text:42CF9DA2                 mov     eax, [ebp+Str1]
.text:42CF9DA5                 push    eax             ; Str1
.text:42CF9DA6                 call    strcmp
.text:42CF9DAB                 add     esp, 8
.text:42CF9DAE                 test    eax, eax
.text:42CF9DB0                 jz      short loc_42CF9DC8
.text:42CF9DB2                 push    offset aMssqlserver_6 ; "MSSQLServer"
.text:42CF9DB7                 mov     ecx, [ebp+Str1]
.text:42CF9DBA                 push    ecx             ; String1
.text:42CF9DBB                 call    ds:_stricmp
.text:42CF9DC1                 add     esp, 8
.text:42CF9DC4                 test    eax, eax
.text:42CF9DC6                 jnz     short loc_42CF9E01
.text:42CF9DC8
.text:42CF9DC8 loc_42CF9DC8:                           ; CODE XREF: sub_42CF9D87+14\u2191j
.text:42CF9DC8                                         ; sub_42CF9D87+29\u2191j
.text:42CF9DC8                 push    offset aSoftwareMicros_6 ; "SOFTWARE\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CF9DCD                 lea     edx, [ebp+Destination]
.text:42CF9DD3                 push    edx             ; Destination
.text:42CF9DD4                 call    strcpy
.text:42CF9DD9                 add     esp, 8
.text:42CF9DDC                 push    offset aCluster_0 ; "Cluster\\"
.text:42CF9DE1                 push    offset aMssqlserverSup_1 ; "MSSQLServer\\SuperSocketNetLib"
.text:42CF9DE6                 lea     eax, [ebp+Destination]
.text:42CF9DEC                 push    eax             ; Str
.text:42CF9DED                 call    ds:strstr
.text:42CF9DF3                 add     esp, 8
.text:42CF9DF6                 push    eax             ; Destination
.text:42CF9DF7                 call    strcpy
.text:42CF9DFC                 add     esp, 8
.text:42CF9DFF                 jmp     short loc_42CF9E3C
.text:42CF9E01 ; ---------------------------------------------------------------------------
.text:42CF9E01
.text:42CF9E01 loc_42CF9E01:                           ; CODE XREF: sub_42CF9D87+3F\u2191j
.text:42CF9E01                 push    offset aSoftwareMicros_7 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CF9E06                 lea     ecx, [ebp+Destination]
.text:42CF9E0C                 push    ecx             ; Destination
.text:42CF9E0D                 call    strcpy
.text:42CF9E12                 add     esp, 8
.text:42CF9E15                 mov     edx, [ebp+Str1]
.text:42CF9E18                 push    edx             ; Source
.text:42CF9E19                 lea     eax, [ebp+Destination]
.text:42CF9E1F                 push    eax             ; Destination
.text:42CF9E20                 call    strcat
.text:42CF9E25                 add     esp, 8
.text:42CF9E28                 push    offset aCluster_1 ; "\\Cluster\\"
.text:42CF9E2D                 lea     ecx, [ebp+Destination]
.text:42CF9E33                 push    ecx             ; Destination
.text:42CF9E34                 call    strcat
.text:42CF9E39                 add     esp, 8
.text:42CF9E3C
.text:42CF9E3C loc_42CF9E3C:                           ; CODE XREF: sub_42CF9D87+78\u2191j
.text:42CF9E3C                 lea     edx, [ebp+phkResult]
.text:42CF9E3F                 push    edx             ; phkResult
.text:42CF9E40                 push    1               ; samDesired
.text:42CF9E42                 push    0               ; ulOptions
.text:42CF9E44                 lea     eax, [ebp+Destination]
.text:42CF9E4A                 push    eax             ; lpSubKey
.text:42CF9E4B                 push    80000002h       ; hKey
.text:42CF9E50                 call    ds:RegOpenKeyExA
.text:42CF9E56                 test    eax, eax
.text:42CF9E58                 jnz     short loc_42CF9E86
.text:42CF9E5A                 lea     ecx, [ebp+cbData]
.text:42CF9E5D                 push    ecx             ; lpcbData
.text:42CF9E5E                 mov     edx, [ebp+lpData]
.text:42CF9E61                 push    edx             ; lpData
.text:42CF9E62                 push    0               ; lpType
.text:42CF9E64                 push    0               ; lpReserved
.text:42CF9E66                 push    offset aClustername_0 ; "ClusterName"
.text:42CF9E6B                 mov     eax, [ebp+phkResult]
.text:42CF9E6E                 push    eax             ; hKey
.text:42CF9E6F                 call    ds:RegQueryValueExA
.text:42CF9E75                 mov     ecx, [ebp+phkResult]
.text:42CF9E78                 push    ecx             ; hKey
.text:42CF9E79                 call    ds:RegCloseKey
.text:42CF9E7F                 mov     eax, 1
.text:42CF9E84                 jmp     short loc_42CF9E88
.text:42CF9E86 ; ---------------------------------------------------------------------------
.text:42CF9E86
.text:42CF9E86 loc_42CF9E86:                           ; CODE XREF: sub_42CF9D87+D1\u2191j
.text:42CF9E86                 xor     eax, eax
.text:42CF9E88
.text:42CF9E88 loc_42CF9E88:                           ; CODE XREF: sub_42CF9D87+FD\u2191j
.text:42CF9E88                 mov     esp, ebp
.text:42CF9E8A                 pop     ebp
.text:42CF9E8B                 retn
.text:42CF9E8B sub_42CF9D87    endp
.text:42CF9E8B
.text:42CF9E8B ; ---------------------------------------------------------------------------
.text:42CF9E8C                 align 10h
.text:42CF9E90
.text:42CF9E90 ; =============== S U B R O U T I N E =======================================
.text:42CF9E90
.text:42CF9E90 ; Attributes: bp-based frame
.text:42CF9E90
.text:42CF9E90 sub_42CF9E90    proc near               ; CODE XREF: sub_42CF9895+8F\u2191p
.text:42CF9E90                                         ; sub_42CF9895+107\u2191p
.text:42CF9E90
.text:42CF9E90 var_4           = dword ptr -4
.text:42CF9E90 arg_0           = dword ptr  8
.text:42CF9E90 arg_4           = dword ptr  0Ch
.text:42CF9E90
.text:42CF9E90                 push    ebp
.text:42CF9E91                 mov     ebp, esp
.text:42CF9E93                 push    ecx
.text:42CF9E94                 mov     [ebp+var_4], 0
.text:42CF9E9B                 jmp     short loc_42CF9EA6
.text:42CF9E9D ; ---------------------------------------------------------------------------
.text:42CF9E9D
.text:42CF9E9D loc_42CF9E9D:                           ; CODE XREF: sub_42CF9E90:loc_42CF9ECA\u2193j
.text:42CF9E9D                 mov     eax, [ebp+var_4]
.text:42CF9EA0                 add     eax, 1
.text:42CF9EA3                 mov     [ebp+var_4], eax
.text:42CF9EA6
.text:42CF9EA6 loc_42CF9EA6:                           ; CODE XREF: sub_42CF9E90+B\u2191j
.text:42CF9EA6                 mov     ecx, [ebp+arg_4]
.text:42CF9EA9                 mov     edx, [ebp+var_4]
.text:42CF9EAC                 cmp     edx, [ecx+104h]
.text:42CF9EB2                 jnb     short loc_42CF9ECC
.text:42CF9EB4                 mov     eax, [ebp+var_4]
.text:42CF9EB7                 mov     ecx, [ebp+arg_4]
.text:42CF9EBA                 mov     edx, [ebp+arg_0]
.text:42CF9EBD                 cmp     edx, [ecx+eax*4+4]
.text:42CF9EC1                 jnz     short loc_42CF9ECA
.text:42CF9EC3                 mov     eax, 1
.text:42CF9EC8                 jmp     short loc_42CF9ECE
.text:42CF9ECA ; ---------------------------------------------------------------------------
.text:42CF9ECA
.text:42CF9ECA loc_42CF9ECA:                           ; CODE XREF: sub_42CF9E90+31\u2191j
.text:42CF9ECA                 jmp     short loc_42CF9E9D
.text:42CF9ECC ; ---------------------------------------------------------------------------
.text:42CF9ECC
.text:42CF9ECC loc_42CF9ECC:                           ; CODE XREF: sub_42CF9E90+22\u2191j
.text:42CF9ECC                 xor     eax, eax
.text:42CF9ECE
.text:42CF9ECE loc_42CF9ECE:                           ; CODE XREF: sub_42CF9E90+38\u2191j
.text:42CF9ECE                 mov     esp, ebp
.text:42CF9ED0                 pop     ebp
.text:42CF9ED1                 retn
.text:42CF9ED1 sub_42CF9E90    endp
.text:42CF9ED1
.text:42CF9ED1 ; ---------------------------------------------------------------------------
.text:42CF9ED2                 align 10h
.text:42CF9EE0
.text:42CF9EE0 ; =============== S U B R O U T I N E =======================================
.text:42CF9EE0
.text:42CF9EE0 ; Attributes: bp-based frame
.text:42CF9EE0
.text:42CF9EE0 ; DWORD __stdcall StartAddress(LPVOID lpThreadParameter)
.text:42CF9EE0 StartAddress    proc near               ; DATA XREF: sub_42CF508D+5E\u2191o
.text:42CF9EE0
.text:42CF9EE0 var_40C         = dword ptr -40Ch
.text:42CF9EE0 var_408         = dword ptr -408h
.text:42CF9EE0 buf             = byte ptr -404h
.text:42CF9EE0 var_4           = dword ptr -4
.text:42CF9EE0 lpThreadParameter= dword ptr  8
.text:42CF9EE0
.text:42CF9EE0                 push    ebp
.text:42CF9EE1                 mov     ebp, esp
.text:42CF9EE3                 sub     esp, 40Ch
.text:42CF9EE9                 mov     String1, 0
.text:42CF9EF3                 mov     Val, 0
.text:42CF9EFD                 mov     eax, [ebp+lpThreadParameter]
.text:42CF9F00                 push    eax             ; Str
.text:42CF9F01                 call    sub_42CFA2CE
.text:42CF9F06                 add     esp, 4
.text:42CF9F09                 mov     dword ptr word_42D0154C, eax
.text:42CF9F0E                 call    sub_42CFA406
.text:42CF9F13                 cmp     dword_42D011DC, 0
.text:42CF9F1A                 jnz     short loc_42CF9F21
.text:42CF9F1C                 jmp     loc_42CFA225
.text:42CF9F21 ; ---------------------------------------------------------------------------
.text:42CF9F21
.text:42CF9F21 loc_42CF9F21:                           ; CODE XREF: StartAddress+3A\u2191j
.text:42CF9F21                 cmp     dword ptr word_42D0154C, 0
.text:42CF9F28                 jnz     loc_42CF9FE8
.text:42CF9F2E                 mov     ecx, [ebp+lpThreadParameter]
.text:42CF9F31                 push    ecx
.text:42CF9F32                 call    sub_42CFA84B
.text:42CF9F37                 add     esp, 4
.text:42CF9F3A                 call    sub_42CFA257
.text:42CF9F3F                 push    offset Time2    ; Time
.text:42CF9F44                 call    ds:time
.text:42CF9F4A                 add     esp, 4
.text:42CF9F4D
.text:42CF9F4D loc_42CF9F4D:                           ; CODE XREF: StartAddress:loc_42CF9FCF\u2193j
.text:42CF9F4D                                         ; StartAddress:loc_42CF9FE3\u2193j ...
.text:42CF9F4D                 mov     edx, 1
.text:42CF9F52                 test    edx, edx
.text:42CF9F54                 jz      loc_42CF9FE8
.text:42CF9F5A                 lea     eax, [ebp+buf]
.text:42CF9F60                 push    eax             ; buf
.text:42CF9F61                 call    sub_42CFA4FE
.text:42CF9F66                 add     esp, 4
.text:42CF9F69                 mov     [ebp+var_4], eax
.text:42CF9F6C                 mov     ecx, [ebp+var_4]
.text:42CF9F6F                 mov     [ebp+var_408], ecx
.text:42CF9F75                 cmp     [ebp+var_408], 6
.text:42CF9F7C                 jz      short loc_42CF9F95
.text:42CF9F7E                 cmp     [ebp+var_408], 0Ah
.text:42CF9F85                 jz      short loc_42CF9FD9
.text:42CF9F87                 cmp     [ebp+var_408], 274Ch
.text:42CF9F91                 jz      short loc_42CF9FD4
.text:42CF9F93                 jmp     short loc_42CF9FE3
.text:42CF9F95 ; ---------------------------------------------------------------------------
.text:42CF9F95
.text:42CF9F95 loc_42CF9F95:                           ; CODE XREF: StartAddress+9C\u2191j
.text:42CF9F95                 mov     dword ptr word_42D0154C, 1
.text:42CF9F9F                 mov     edx, dword_42D011DC
.text:42CF9FA5                 push    edx             ; s
.text:42CF9FA6                 call    ds:closesocket
.text:42CF9FAC                 call    sub_42CFA406
.text:42CF9FB1                 cmp     dword_42D011DC, 0
.text:42CF9FB8                 jnz     short loc_42CF9FBF
.text:42CF9FBA                 jmp     loc_42CFA225
.text:42CF9FBF ; ---------------------------------------------------------------------------
.text:42CF9FBF
.text:42CF9FBF loc_42CF9FBF:                           ; CODE XREF: StartAddress+D8\u2191j
.text:42CF9FBF                 cmp     dword ptr word_42D0154C, 0
.text:42CF9FC6                 jz      short loc_42CF9FCF
.text:42CF9FC8                 call    sub_42CFAB38
.text:42CF9FCD                 jmp     short loc_42CF9FE8
.text:42CF9FCF ; ---------------------------------------------------------------------------
.text:42CF9FCF
.text:42CF9FCF loc_42CF9FCF:                           ; CODE XREF: StartAddress+E6\u2191j
.text:42CF9FCF                 jmp     loc_42CF9F4D
.text:42CF9FD4 ; ---------------------------------------------------------------------------
.text:42CF9FD4
.text:42CF9FD4 loc_42CF9FD4:                           ; CODE XREF: StartAddress+B1\u2191j
.text:42CF9FD4                 jmp     loc_42CFA0E0
.text:42CF9FD9 ; ---------------------------------------------------------------------------
.text:42CF9FD9
.text:42CF9FD9 loc_42CF9FD9:                           ; CODE XREF: StartAddress+A5\u2191j
.text:42CF9FD9                 mov     dword_42D01550, 1
.text:42CF9FE3
.text:42CF9FE3 loc_42CF9FE3:                           ; CODE XREF: StartAddress+B3\u2191j
.text:42CF9FE3                 jmp     loc_42CF9F4D
.text:42CF9FE8 ; ---------------------------------------------------------------------------
.text:42CF9FE8
.text:42CF9FE8 loc_42CF9FE8:                           ; CODE XREF: StartAddress+48\u2191j
.text:42CF9FE8                                         ; StartAddress+74\u2191j ...
.text:42CF9FE8                 push    offset Time     ; Time
.text:42CF9FED                 call    ds:time
.text:42CF9FF3                 add     esp, 4
.text:42CF9FF6
.text:42CF9FF6 loc_42CF9FF6:                           ; CODE XREF: StartAddress+1AC\u2193j
.text:42CF9FF6                                         ; StartAddress+1C0\u2193j ...
.text:42CF9FF6                 mov     eax, 1
.text:42CF9FFB                 test    eax, eax
.text:42CF9FFD                 jz      loc_42CFA225
.text:42CFA003                 push    400h            ; Size
.text:42CFA008                 push    0               ; Val
.text:42CFA00A                 lea     ecx, [ebp+buf]
.text:42CFA010                 push    ecx             ; void *
.text:42CFA011                 call    memset
.text:42CFA016                 add     esp, 0Ch
.text:42CFA019                 lea     edx, [ebp+buf]
.text:42CFA01F                 push    edx             ; buf
.text:42CFA020                 call    sub_42CFA4FE    ; function that has rcvfrom() returns here
.text:42CFA025                 add     esp, 4          ; remove variable from stack
.text:42CFA028                 mov     [ebp+var_4], eax ; var_4 = eax = *buf
.text:42CFA02B
.text:42CFA02B loc_42CFA02B:                           ; CODE XREF: StartAddress+2D9\u2193j
.text:42CFA02B                 mov     eax, [ebp+var_4] ; eax = *buf
.text:42CFA02E                 mov     [ebp+var_40C], eax ; var_40C = *buf
.text:42CFA034                 cmp     [ebp+var_40C], 9 ; does the buffer start at offset 9 on the stack
.text:42CFA03B                 jg      short loc_42CFA06B ; no starts at an offset > 9
.text:42CFA03D                 cmp     [ebp+var_40C], 9 ; starts at offset == 9?
.text:42CFA044                 jz      short loc_42CFA0BB ; yes so jump here
.text:42CFA046                 mov     ecx, [ebp+var_40C] ; ecx = var_40C
.text:42CFA04C                 sub     ecx, 2          ; switch 7 cases
.text:42CFA04F                 mov     [ebp+var_40C], ecx ; var_40C = var_40C - 2
.text:42CFA055                 cmp     [ebp+var_40C], 6 ; var_40C == 6?
.text:42CFA05C                 ja      short def_42CFA064 ; jumptable 42CFA064 default case, cases 5-7
.text:42CFA05E                 mov     edx, [ebp+var_40C] ; default case
.text:42CFA064                 jmp     ds:jpt_42CFA064[edx*4] ; switch jump
.text:42CFA06B ; ---------------------------------------------------------------------------
.text:42CFA06B
.text:42CFA06B loc_42CFA06B:                           ; CODE XREF: StartAddress+15B\u2191j
.text:42CFA06B                 cmp     [ebp+var_40C], 0Ah
.text:42CFA072                 jz      short loc_42CFA0CF
.text:42CFA074                 cmp     [ebp+var_40C], 274Ch
.text:42CFA07E                 jz      short loc_42CFA0D9
.text:42CFA080                 jmp     short def_42CFA064 ; jumptable 42CFA064 default case, cases 5-7
.text:42CFA082 ; ---------------------------------------------------------------------------
.text:42CFA082
.text:42CFA082 loc_42CFA082:                           ; CODE XREF: StartAddress+184\u2191j
.text:42CFA082                                         ; DATA XREF: .text:jpt_42CFA064\u2193o
.text:42CFA082                 push    0               ; jumptable 42CFA064 cases 2,3
.text:42CFA084                 call    sub_42CFAC6F    ; Default case calls this function
.text:42CFA089                 add     esp, 4
.text:42CFA08C                 jmp     loc_42CF9FF6
.text:42CFA091 ; ---------------------------------------------------------------------------
.text:42CFA091
.text:42CFA091 loc_42CFA091:                           ; CODE XREF: StartAddress+184\u2191j
.text:42CFA091                                         ; DATA XREF: .text:jpt_42CFA064\u2193o
.text:42CFA091                 lea     eax, [ebp+buf+1] ; jumptable 42CFA064 case 4
.text:42CFA097                 push    eax             ; Str1
.text:42CFA098                 call    sub_42CFAC6F    ; this case
.text:42CFA09D                 add     esp, 4
.text:42CFA0A0                 jmp     loc_42CF9FF6
.text:42CFA0A5 ; ---------------------------------------------------------------------------
.text:42CFA0A5
.text:42CFA0A5 loc_42CFA0A5:                           ; CODE XREF: StartAddress+184\u2191j
.text:42CFA0A5                                         ; DATA XREF: .text:jpt_42CFA064\u2193o
.text:42CFA0A5                 push    0               ; jumptable 42CFA064 case 8
.text:42CFA0A7                 lea     ecx, [ebp+buf+1]
.text:42CFA0AD                 push    ecx             ; String
.text:42CFA0AE                 call    sub_42CFA64E
.text:42CFA0B3                 add     esp, 8
.text:42CFA0B6                 jmp     loc_42CF9FF6
.text:42CFA0BB ; ---------------------------------------------------------------------------
.text:42CFA0BB
.text:42CFA0BB loc_42CFA0BB:                           ; CODE XREF: StartAddress+164\u2191j
.text:42CFA0BB                 lea     edx, [ebp+buf+1]
.text:42CFA0C1                 push    edx             ; String2
.text:42CFA0C2                 call    sub_42CFA732
.text:42CFA0C7                 add     esp, 4
.text:42CFA0CA                 jmp     loc_42CF9FF6
.text:42CFA0CF ; ---------------------------------------------------------------------------
.text:42CFA0CF
.text:42CFA0CF loc_42CFA0CF:                           ; CODE XREF: StartAddress+192\u2191j
.text:42CFA0CF                 call    sub_42CFA257
.text:42CFA0D4                 jmp     loc_42CF9FF6
.text:42CFA0D9 ; ---------------------------------------------------------------------------
.text:42CFA0D9
.text:42CFA0D9 loc_42CFA0D9:                           ; CODE XREF: StartAddress+19E\u2191j
.text:42CFA0D9                 jmp     short loc_42CFA0E0
.text:42CFA0DB ; ---------------------------------------------------------------------------
.text:42CFA0DB
.text:42CFA0DB def_42CFA064:                           ; CODE XREF: StartAddress+17C\u2191j
.text:42CFA0DB                                         ; StartAddress+184\u2191j ...
.text:42CFA0DB                 jmp     loc_42CF9FF6    ; jumptable 42CFA064 default case, cases 5-7
.text:42CFA0E0 ; ---------------------------------------------------------------------------
.text:42CFA0E0
.text:42CFA0E0 loc_42CFA0E0:                           ; CODE XREF: StartAddress:loc_42CF9FD4\u2191j
.text:42CFA0E0                                         ; StartAddress:loc_42CFA0D9\u2191j
.text:42CFA0E0                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CFA0E2                 mov     eax, hMutex
.text:42CFA0E7                 push    eax             ; hHandle
.text:42CFA0E8                 call    ds:WaitForSingleObject
.text:42CFA0EE                 cmp     dword_42D01B4C, 0
.text:42CFA0F5                 jz      loc_42CFA180
.text:42CFA0FB                 cmp     dword ptr word_42D0154C, 0
.text:42CFA102                 jnz     short loc_42CFA112
.text:42CFA104                 mov     ecx, [ebp+lpThreadParameter]
.text:42CFA107                 push    ecx             ; Str
.text:42CFA108                 call    sub_42CFA8D7
.text:42CFA10D                 add     esp, 4
.text:42CFA110                 jmp     short loc_42CFA14D
.text:42CFA112 ; ---------------------------------------------------------------------------
.text:42CFA112
.text:42CFA112 loc_42CFA112:                           ; CODE XREF: StartAddress+222\u2191j
.text:42CFA112                 cmp     String1, 0
.text:42CFA119                 jnz     short loc_42CFA12A
.text:42CFA11B                 push    offset Str1     ; Str1
.text:42CFA120                 call    sub_42CFA94D
.text:42CFA125                 add     esp, 4
.text:42CFA128                 jmp     short loc_42CFA14D
.text:42CFA12A ; ---------------------------------------------------------------------------
.text:42CFA12A
.text:42CFA12A loc_42CFA12A:                           ; CODE XREF: StartAddress+239\u2191j
.text:42CFA12A                 mov     edx, String1
.text:42CFA130                 push    edx             ; Str1
.text:42CFA131                 call    sub_42CFA94D
.text:42CFA136                 add     esp, 4
.text:42CFA139                 mov     eax, String1
.text:42CFA13E                 mov     ecx, [eax+100h]
.text:42CFA144                 push    ecx             ; hostshort
.text:42CFA145                 call    sub_42CFA92D
.text:42CFA14A                 add     esp, 4
.text:42CFA14D
.text:42CFA14D loc_42CFA14D:                           ; CODE XREF: StartAddress+230\u2191j
.text:42CFA14D                                         ; StartAddress+248\u2191j
.text:42CFA14D                 mov     edx, dword_42D011DC
.text:42CFA153                 push    edx             ; s
.text:42CFA154                 call    ds:closesocket
.text:42CFA15A                 mov     eax, hEvent
.text:42CFA15F                 push    eax             ; hEvent
.text:42CFA160                 call    ds:SetEvent
.text:42CFA166                 mov     ecx, hMutex
.text:42CFA16C                 push    ecx             ; hMutex
.text:42CFA16D                 call    ds:ReleaseMutex
.text:42CFA173                 push    0               ; dwExitCode
.text:42CFA175                 call    ds:ExitThread
.text:42CFA17B ; ---------------------------------------------------------------------------
.text:42CFA17B                 jmp     loc_42CFA220
.text:42CFA180 ; ---------------------------------------------------------------------------
.text:42CFA180
.text:42CFA180 loc_42CFA180:                           ; CODE XREF: StartAddress+215\u2191j
.text:42CFA180                 mov     edx, hMutex
.text:42CFA186                 push    edx             ; hMutex
.text:42CFA187                 call    ds:ReleaseMutex
.text:42CFA18D                 cmp     dword ptr word_42D0154C, 0
.text:42CFA194                 jz      short loc_42CFA1BE
.text:42CFA196                 mov     eax, dword ptr [ebp+buf]
.text:42CFA19C                 and     eax, 0FFh
.text:42CFA1A1                 test    eax, eax
.text:42CFA1A3                 jnz     short loc_42CFA1AA
.text:42CFA1A5                 jmp     loc_42CF9FF6
.text:42CFA1AA ; ---------------------------------------------------------------------------
.text:42CFA1AA
.text:42CFA1AA loc_42CFA1AA:                           ; CODE XREF: StartAddress+2C3\u2191j
.text:42CFA1AA                 mov     ecx, dword ptr [ebp+buf]
.text:42CFA1B0                 and     ecx, 0FFh
.text:42CFA1B6                 mov     [ebp+var_4], ecx
.text:42CFA1B9                 jmp     loc_42CFA02B
.text:42CFA1BE ; ---------------------------------------------------------------------------
.text:42CFA1BE
.text:42CFA1BE loc_42CFA1BE:                           ; CODE XREF: StartAddress+2B4\u2191j
.text:42CFA1BE                 cmp     dword_42D01550, 0
.text:42CFA1C5                 jnz     short loc_42CFA20D
.text:42CFA1C7                 mov     dword ptr word_42D0154C, 1
.text:42CFA1D1                 mov     edx, dword_42D011DC
.text:42CFA1D7                 push    edx             ; s
.text:42CFA1D8                 call    ds:closesocket
.text:42CFA1DE                 call    sub_42CFA406
.text:42CFA1E3                 cmp     dword_42D011DC, 0
.text:42CFA1EA                 jnz     short loc_42CFA1EE
.text:42CFA1EC                 jmp     short loc_42CFA225
.text:42CFA1EE ; ---------------------------------------------------------------------------
.text:42CFA1EE
.text:42CFA1EE loc_42CFA1EE:                           ; CODE XREF: StartAddress+30A\u2191j
.text:42CFA1EE                 cmp     dword ptr word_42D0154C, 0
.text:42CFA1F5                 jz      short loc_42CFA208
.text:42CFA1F7                 mov     eax, [ebp+lpThreadParameter]
.text:42CFA1FA                 push    eax             ; Str
.text:42CFA1FB                 call    sub_42CFA3AD
.text:42CFA200                 add     esp, 4
.text:42CFA203                 jmp     loc_42CF9FE8
.text:42CFA208 ; ---------------------------------------------------------------------------
.text:42CFA208
.text:42CFA208 loc_42CFA208:                           ; CODE XREF: StartAddress+315\u2191j
.text:42CFA208                 jmp     loc_42CF9F4D
.text:42CFA20D ; ---------------------------------------------------------------------------
.text:42CFA20D
.text:42CFA20D loc_42CFA20D:                           ; CODE XREF: StartAddress+2E5\u2191j
.text:42CFA20D                 call    sub_42CFA283
.text:42CFA212                 test    eax, eax
.text:42CFA214                 jz      short loc_42CFA21B
.text:42CFA216                 call    sub_42CFA257
.text:42CFA21B
.text:42CFA21B loc_42CFA21B:                           ; CODE XREF: StartAddress+334\u2191j
.text:42CFA21B                 jmp     loc_42CF9F4D
.text:42CFA220 ; ---------------------------------------------------------------------------
.text:42CFA220
.text:42CFA220 loc_42CFA220:                           ; CODE XREF: StartAddress+29B\u2191j
.text:42CFA220                 jmp     loc_42CF9FF6
.text:42CFA225 ; ---------------------------------------------------------------------------
.text:42CFA225
.text:42CFA225 loc_42CFA225:                           ; CODE XREF: StartAddress+3C\u2191j
.text:42CFA225                                         ; StartAddress+DA\u2191j ...
.text:42CFA225                 mov     dword_42D01DD0, 0
.text:42CFA22F                 push    0               ; dwExitCode
.text:42CFA231                 call    ds:ExitThread
.text:42CFA231 StartAddress    endp
.text:42CFA231
.text:42CFA237 ; ---------------------------------------------------------------------------
.text:42CFA237                 mov     esp, ebp
.text:42CFA239                 pop     ebp
.text:42CFA23A                 retn
.text:42CFA23A ; ---------------------------------------------------------------------------
.text:42CFA23B jpt_42CFA064    dd offset loc_42CFA082  ; DATA XREF: StartAddress+184\u2191r
.text:42CFA23B                 dd offset loc_42CFA082  ; jump table for switch statement
.text:42CFA23B                 dd offset loc_42CFA091
.text:42CFA23B                 dd offset def_42CFA064
.text:42CFA23B                 dd offset def_42CFA064
.text:42CFA23B                 dd offset def_42CFA064
.text:42CFA23B                 dd offset loc_42CFA0A5
.text:42CFA257
.text:42CFA257 ; =============== S U B R O U T I N E =======================================
.text:42CFA257
.text:42CFA257 ; Attributes: bp-based frame
.text:42CFA257
.text:42CFA257 sub_42CFA257    proc near               ; CODE XREF: StartAddress+5A\u2191p
.text:42CFA257                                         ; StartAddress:loc_42CFA0CF\u2191p ...
.text:42CFA257
.text:42CFA257 buf             = byte ptr -4
.text:42CFA257
.text:42CFA257                 push    ebp
.text:42CFA258                 mov     ebp, esp
.text:42CFA25A                 push    ecx
.text:42CFA25B                 mov     [ebp+buf], 0Ah
.text:42CFA25F                 mov     eax, dword ptr word_42D0154C
.text:42CFA264                 push    eax             ; int
.text:42CFA265                 push    0               ; hostshort
.text:42CFA267                 push    1               ; len
.text:42CFA269                 lea     ecx, [ebp+buf]
.text:42CFA26C                 push    ecx             ; buf
.text:42CFA26D                 call    sub_42CFA5C6
.text:42CFA272                 add     esp, 10h
.text:42CFA275                 mov     dword_42D01550, 0
.text:42CFA27F                 mov     esp, ebp
.text:42CFA281                 pop     ebp
.text:42CFA282                 retn                    ; returns to loc_42CFA0CF
.text:42CFA282 sub_42CFA257    endp
.text:42CFA282
.text:42CFA283
.text:42CFA283 ; =============== S U B R O U T I N E =======================================
.text:42CFA283
.text:42CFA283 ; Attributes: bp-based frame
.text:42CFA283
.text:42CFA283 sub_42CFA283    proc near               ; CODE XREF: StartAddress:loc_42CFA20D\u2191p
.text:42CFA283                 push    ebp
.text:42CFA284                 mov     ebp, esp
.text:42CFA286                 push    offset Time1    ; Time
.text:42CFA28B                 call    ds:time
.text:42CFA291                 add     esp, 4
.text:42CFA294                 mov     eax, Time2
.text:42CFA299                 push    eax             ; Time2
.text:42CFA29A                 mov     ecx, Time1
.text:42CFA2A0                 push    ecx             ; Time1
.text:42CFA2A1                 call    ds:difftime
.text:42CFA2A7                 add     esp, 8
.text:42CFA2AA                 fcomp   ds:dbl_42CFE1E0
.text:42CFA2B0                 fnstsw  ax
.text:42CFA2B2                 test    ah, 41h
.text:42CFA2B5                 jnz     short loc_42CFA2CA
.text:42CFA2B7                 mov     edx, Time1
.text:42CFA2BD                 mov     Time2, edx
.text:42CFA2C3                 mov     eax, 1
.text:42CFA2C8                 jmp     short loc_42CFA2CC
.text:42CFA2CA ; ---------------------------------------------------------------------------
.text:42CFA2CA
.text:42CFA2CA loc_42CFA2CA:                           ; CODE XREF: sub_42CFA283+32\u2191j
.text:42CFA2CA                 xor     eax, eax
.text:42CFA2CC
.text:42CFA2CC loc_42CFA2CC:                           ; CODE XREF: sub_42CFA283+45\u2191j
.text:42CFA2CC                 pop     ebp
.text:42CFA2CD                 retn
.text:42CFA2CD sub_42CFA283    endp
.text:42CFA2CD
.text:42CFA2CE
.text:42CFA2CE ; =============== S U B R O U T I N E =======================================
.text:42CFA2CE
.text:42CFA2CE ; Attributes: bp-based frame
.text:42CFA2CE
.text:42CFA2CE ; int __cdecl sub_42CFA2CE(char *Str)
.text:42CFA2CE sub_42CFA2CE    proc near               ; CODE XREF: StartAddress+21\u2191p
.text:42CFA2CE
.text:42CFA2CE cbData          = dword ptr -108h
.text:42CFA2CE Data            = byte ptr -104h
.text:42CFA2CE var_103         = byte ptr -103h
.text:42CFA2CE phkResult       = dword ptr -4
.text:42CFA2CE Str             = dword ptr  8
.text:42CFA2CE
.text:42CFA2CE                 push    ebp
.text:42CFA2CF                 mov     ebp, esp
.text:42CFA2D1                 sub     esp, 108h
.text:42CFA2D7                 push    edi
.text:42CFA2D8                 mov     al, byte_42D011E4
.text:42CFA2DD                 mov     [ebp+Data], al
.text:42CFA2E3                 mov     ecx, 3Fh ; '?'
.text:42CFA2E8                 xor     eax, eax
.text:42CFA2EA                 lea     edi, [ebp+var_103]
.text:42CFA2F0                 rep stosd
.text:42CFA2F2                 stosw
.text:42CFA2F4                 stosb
.text:42CFA2F5                 mov     [ebp+cbData], 100h
.text:42CFA2FF                 push    0               ; lpdwDisposition
.text:42CFA301                 lea     ecx, [ebp+phkResult]
.text:42CFA304                 push    ecx             ; phkResult
.text:42CFA305                 push    0               ; lpSecurityAttributes
.text:42CFA307                 push    0F003Fh         ; samDesired
.text:42CFA30C                 push    0               ; dwOptions
.text:42CFA30E                 push    0               ; lpClass
.text:42CFA310                 push    0               ; Reserved
.text:42CFA312                 push    offset aSoftwareMicros_8 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFA317                 push    80000002h       ; hKey
.text:42CFA31C                 call    ds:RegCreateKeyExA
.text:42CFA322                 test    eax, eax
.text:42CFA324                 jz      short loc_42CFA32A
.text:42CFA326                 xor     eax, eax
.text:42CFA328                 jmp     short loc_42CFA3A8
.text:42CFA32A ; ---------------------------------------------------------------------------
.text:42CFA32A
.text:42CFA32A loc_42CFA32A:                           ; CODE XREF: sub_42CFA2CE+56\u2191j
.text:42CFA32A                 lea     edx, [ebp+cbData]
.text:42CFA330                 push    edx             ; lpcbData
.text:42CFA331                 lea     eax, [ebp+Data]
.text:42CFA337                 push    eax             ; lpData
.text:42CFA338                 push    0               ; lpType
.text:42CFA33A                 push    0               ; lpReserved
.text:42CFA33C                 push    offset aSsrpactiveserv ; "SsrpActiveServer"
.text:42CFA341                 mov     ecx, [ebp+phkResult]
.text:42CFA344                 push    ecx             ; hKey
.text:42CFA345                 call    ds:RegQueryValueExA
.text:42CFA34B                 test    eax, eax
.text:42CFA34D                 jnz     short loc_42CFA375
.text:42CFA34F                 push    offset byte_42D011E8 ; Str2
.text:42CFA354                 lea     edx, [ebp+Data]
.text:42CFA35A                 push    edx             ; Str1
.text:42CFA35B                 call    strcmp
.text:42CFA360                 add     esp, 8
.text:42CFA363                 test    eax, eax
.text:42CFA365                 jz      short loc_42CFA375
.text:42CFA367                 mov     eax, [ebp+phkResult]
.text:42CFA36A                 push    eax             ; hKey
.text:42CFA36B                 call    ds:RegCloseKey
.text:42CFA371                 xor     eax, eax
.text:42CFA373                 jmp     short loc_42CFA3A8
.text:42CFA375 ; ---------------------------------------------------------------------------
.text:42CFA375
.text:42CFA375 loc_42CFA375:                           ; CODE XREF: sub_42CFA2CE+7F\u2191j
.text:42CFA375                                         ; sub_42CFA2CE+97\u2191j
.text:42CFA375                 mov     ecx, [ebp+Str]
.text:42CFA378                 push    ecx             ; Str
.text:42CFA379                 call    strlen
.text:42CFA37E                 add     esp, 4
.text:42CFA381                 push    eax             ; cbData
.text:42CFA382                 mov     edx, [ebp+Str]
.text:42CFA385                 push    edx             ; lpData
.text:42CFA386                 push    1               ; dwType
.text:42CFA388                 push    0               ; Reserved
.text:42CFA38A                 push    offset aSsrpactiveserv_0 ; "SsrpActiveServer"
.text:42CFA38F                 mov     eax, [ebp+phkResult]
.text:42CFA392                 push    eax             ; hKey
.text:42CFA393                 call    ds:RegSetValueExA
.text:42CFA399                 mov     ecx, [ebp+phkResult]
.text:42CFA39C                 push    ecx             ; hKey
.text:42CFA39D                 call    ds:RegCloseKey
.text:42CFA3A3                 mov     eax, 1
.text:42CFA3A8
.text:42CFA3A8 loc_42CFA3A8:                           ; CODE XREF: sub_42CFA2CE+5A\u2191j
.text:42CFA3A8                                         ; sub_42CFA2CE+A5\u2191j
.text:42CFA3A8                 pop     edi
.text:42CFA3A9                 mov     esp, ebp
.text:42CFA3AB                 pop     ebp
.text:42CFA3AC                 retn
.text:42CFA3AC sub_42CFA2CE    endp
.text:42CFA3AC
.text:42CFA3AD
.text:42CFA3AD ; =============== S U B R O U T I N E =======================================
.text:42CFA3AD
.text:42CFA3AD ; Attributes: bp-based frame
.text:42CFA3AD
.text:42CFA3AD ; int __cdecl sub_42CFA3AD(char *Str)
.text:42CFA3AD sub_42CFA3AD    proc near               ; CODE XREF: StartAddress+31B\u2191p
.text:42CFA3AD
.text:42CFA3AD phkResult       = dword ptr -4
.text:42CFA3AD Str             = dword ptr  8
.text:42CFA3AD
.text:42CFA3AD                 push    ebp
.text:42CFA3AE                 mov     ebp, esp
.text:42CFA3B0                 push    ecx
.text:42CFA3B1                 push    0               ; lpdwDisposition
.text:42CFA3B3                 lea     eax, [ebp+phkResult]
.text:42CFA3B6                 push    eax             ; phkResult
.text:42CFA3B7                 push    0               ; lpSecurityAttributes
.text:42CFA3B9                 push    0F003Fh         ; samDesired
.text:42CFA3BE                 push    0               ; dwOptions
.text:42CFA3C0                 push    0               ; lpClass
.text:42CFA3C2                 push    0               ; Reserved
.text:42CFA3C4                 push    offset aSoftwareMicros_9 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFA3C9                 push    80000002h       ; hKey
.text:42CFA3CE                 call    ds:RegCreateKeyExA
.text:42CFA3D4                 mov     ecx, [ebp+Str]
.text:42CFA3D7                 push    ecx             ; Str
.text:42CFA3D8                 call    strlen
.text:42CFA3DD                 add     esp, 4
.text:42CFA3E0                 push    eax             ; cbData
.text:42CFA3E1                 mov     edx, [ebp+Str]
.text:42CFA3E4                 push    edx             ; lpData
.text:42CFA3E5                 push    1               ; dwType
.text:42CFA3E7                 push    0               ; Reserved
.text:42CFA3E9                 push    offset aSsrpactiveserv_1 ; "SsrpActiveServer"
.text:42CFA3EE                 mov     eax, [ebp+phkResult]
.text:42CFA3F1                 push    eax             ; hKey
.text:42CFA3F2                 call    ds:RegSetValueExA
.text:42CFA3F8                 mov     ecx, [ebp+phkResult]
.text:42CFA3FB                 push    ecx             ; hKey
.text:42CFA3FC                 call    ds:RegCloseKey
.text:42CFA402                 mov     esp, ebp
.text:42CFA404                 pop     ebp
.text:42CFA405                 retn
.text:42CFA405 sub_42CFA3AD    endp
.text:42CFA405
.text:42CFA406
.text:42CFA406 ; =============== S U B R O U T I N E =======================================
.text:42CFA406
.text:42CFA406 ; Attributes: bp-based frame
.text:42CFA406
.text:42CFA406 sub_42CFA406    proc near               ; CODE XREF: StartAddress+2E\u2191p
.text:42CFA406                                         ; StartAddress+CC\u2191p ...
.text:42CFA406
.text:42CFA406 var_1C          = dword ptr -1Ch
.text:42CFA406 optval          = byte ptr -18h
.text:42CFA406 name            = sockaddr ptr -14h
.text:42CFA406 var_4           = dword ptr -4
.text:42CFA406
.text:42CFA406                 push    ebp
.text:42CFA407                 mov     ebp, esp
.text:42CFA409                 sub     esp, 1Ch
.text:42CFA40C                 mov     [ebp+var_4], 1
.text:42CFA413                 push    0               ; protocol
.text:42CFA415                 push    2               ; type
.text:42CFA417                 push    2               ; af
.text:42CFA419                 call    ds:socket
.text:42CFA41F                 mov     dword_42D011DC, eax
.text:42CFA424                 cmp     dword_42D011DC, 0FFFFFFFFh
.text:42CFA42B                 jnz     short loc_42CFA43C
.text:42CFA42D                 mov     dword_42D011DC, 0
.text:42CFA437                 jmp     loc_42CFA4FA
.text:42CFA43C ; ---------------------------------------------------------------------------
.text:42CFA43C
.text:42CFA43C loc_42CFA43C:                           ; CODE XREF: sub_42CFA406+25\u2191j
.text:42CFA43C                 mov     [ebp+name.sa_family], 2
.text:42CFA442                 push    0               ; hostlong
.text:42CFA444                 call    ds:htonl
.text:42CFA44A                 mov     dword ptr [ebp+name.sa_data+2], eax
.text:42CFA44D
.text:42CFA44D loc_42CFA44D:                           ; CODE XREF: sub_42CFA406+AC\u2193j
.text:42CFA44D                 cmp     dword ptr word_42D0154C, 0
.text:42CFA454                 jz      short loc_42CFA46B
.text:42CFA456                 push    59Ah            ; hostshort
.text:42CFA45B                 call    ds:htons
.text:42CFA461                 and     eax, 0FFFFh
.text:42CFA466                 mov     [ebp+var_1C], eax
.text:42CFA469                 jmp     short loc_42CFA47B
.text:42CFA46B ; ---------------------------------------------------------------------------
.text:42CFA46B
.text:42CFA46B loc_42CFA46B:                           ; CODE XREF: sub_42CFA406+4E\u2191j
.text:42CFA46B                 push    0               ; hostshort
.text:42CFA46D                 call    ds:htons
.text:42CFA473                 and     eax, 0FFFFh
.text:42CFA478                 mov     [ebp+var_1C], eax
.text:42CFA47B
.text:42CFA47B loc_42CFA47B:                           ; CODE XREF: sub_42CFA406+63\u2191j
.text:42CFA47B                 mov     ax, word ptr [ebp+var_1C]
.text:42CFA47F                 mov     word ptr [ebp+name.sa_data], ax
.text:42CFA483                 push    10h             ; namelen
.text:42CFA485                 lea     ecx, [ebp+name]
.text:42CFA488                 push    ecx             ; name
.text:42CFA489                 mov     edx, dword_42D011DC
.text:42CFA48F                 push    edx             ; s
.text:42CFA490                 call    ds:bind
.text:42CFA496                 cmp     eax, 0FFFFFFFFh
.text:42CFA499                 jnz     short loc_42CFA4B6
.text:42CFA49B                 call    ds:WSAGetLastError
.text:42CFA4A1                 cmp     eax, 2740h
.text:42CFA4A6                 jnz     short loc_42CFA4B4
.text:42CFA4A8                 mov     dword ptr word_42D0154C, 0
.text:42CFA4B2                 jmp     short loc_42CFA44D
.text:42CFA4B4 ; ---------------------------------------------------------------------------
.text:42CFA4B4
.text:42CFA4B4 loc_42CFA4B4:                           ; CODE XREF: sub_42CFA406+A0\u2191j
.text:42CFA4B4                 jmp     short loc_42CFA4E3
.text:42CFA4B6 ; ---------------------------------------------------------------------------
.text:42CFA4B6
.text:42CFA4B6 loc_42CFA4B6:                           ; CODE XREF: sub_42CFA406+93\u2191j
.text:42CFA4B6                 mov     dword ptr [ebp+optval], 0BB8h
.text:42CFA4BD                 push    4               ; optlen
.text:42CFA4BF                 lea     eax, [ebp+optval]
.text:42CFA4C2                 push    eax             ; optval
.text:42CFA4C3                 push    1006h           ; optname
.text:42CFA4C8                 push    0FFFFh          ; level
.text:42CFA4CD                 mov     ecx, dword_42D011DC
.text:42CFA4D3                 push    ecx             ; s
.text:42CFA4D4                 call    ds:setsockopt
.text:42CFA4DA                 cmp     eax, 0FFFFFFFFh
.text:42CFA4DD                 jnz     short loc_42CFA4E1
.text:42CFA4DF                 jmp     short loc_42CFA4E3
.text:42CFA4E1 ; ---------------------------------------------------------------------------
.text:42CFA4E1
.text:42CFA4E1 loc_42CFA4E1:                           ; CODE XREF: sub_42CFA406+D7\u2191j
.text:42CFA4E1                 jmp     short loc_42CFA4FA
.text:42CFA4E3 ; ---------------------------------------------------------------------------
.text:42CFA4E3
.text:42CFA4E3 loc_42CFA4E3:                           ; CODE XREF: sub_42CFA406:loc_42CFA4B4\u2191j
.text:42CFA4E3                                         ; sub_42CFA406+D9\u2191j
.text:42CFA4E3                 mov     edx, dword_42D011DC
.text:42CFA4E9                 push    edx             ; s
.text:42CFA4EA                 call    ds:closesocket
.text:42CFA4F0                 mov     dword_42D011DC, 0
.text:42CFA4FA
.text:42CFA4FA loc_42CFA4FA:                           ; CODE XREF: sub_42CFA406+31\u2191j
.text:42CFA4FA                                         ; sub_42CFA406:loc_42CFA4E1\u2191j
.text:42CFA4FA                 mov     esp, ebp
.text:42CFA4FC                 pop     ebp
.text:42CFA4FD                 retn
.text:42CFA4FD sub_42CFA406    endp
.text:42CFA4FD
.text:42CFA4FE
.text:42CFA4FE ; =============== S U B R O U T I N E =======================================
.text:42CFA4FE
.text:42CFA4FE ; Attributes: bp-based frame
.text:42CFA4FE
.text:42CFA4FE ; int __cdecl sub_42CFA4FE(char *buf)
.text:42CFA4FE sub_42CFA4FE    proc near               ; CODE XREF: StartAddress+81\u2191p
.text:42CFA4FE                                         ; StartAddress+140\u2191p
.text:42CFA4FE
.text:42CFA4FE var_8           = dword ptr -8
.text:42CFA4FE fromlen         = dword ptr -4
.text:42CFA4FE buf             = dword ptr  8
.text:42CFA4FE
.text:42CFA4FE                 push    ebp
.text:42CFA4FF                 mov     ebp, esp
.text:42CFA501                 sub     esp, 8
.text:42CFA504                 mov     [ebp+fromlen], 10h
.text:42CFA50B                 lea     eax, [ebp+fromlen]
.text:42CFA50E                 push    eax             ; fromlen
.text:42CFA50F                 push    offset from     ; from
.text:42CFA514                 push    0               ; flags
.text:42CFA516                 push    400h            ; len
.text:42CFA51B                 mov     ecx, [ebp+buf]
.text:42CFA51E                 push    ecx             ; buf
.text:42CFA51F                 mov     edx, dword_42D011DC
.text:42CFA525                 push    edx             ; s
.text:42CFA526                 call    ds:recvfrom
.text:42CFA52C                 mov     [ebp+var_8], eax ; var8 = address of fromlen
.text:42CFA52F                 cmp     [ebp+var_8], 0FFFFFFFFh ; is the variable fromlen at the beginning of the stack?
.text:42CFA533                 jnz     short loc_42CFA56C ; No it is not so jump here
.text:42CFA535                 call    ds:WSAGetLastError ; Yes it is at the beginning which means something went wrong so get the last error code
.text:42CFA53B                 mov     [ebp+var_8], eax ; var_8 = last error code
.text:42CFA53E                 cmp     [ebp+var_8], 274Ch ; check if it is a WSAETIMEDOUT error.(Connection timed out)
.text:42CFA545                 jnz     short loc_42CFA565 ; No so jump here
.text:42CFA547                 cmp     dword ptr word_42D0154C, 0 ; word_42D0154C = 0?
.text:42CFA54E                 jz      short loc_42CFA55E ; Yes so jump here
.text:42CFA550                 push    offset Time     ; Time
.text:42CFA555                 call    ds:time         ; Number of seconds since January 1, 1970
.text:42CFA55B                 add     esp, 4          ; Remove Time from the stack
.text:42CFA55E
.text:42CFA55E loc_42CFA55E:                           ; CODE XREF: sub_42CFA4FE+50\u2191j
.text:42CFA55E                 mov     eax, 274Ch      ; Set connection timed out error code
.text:42CFA563                 jmp     short exit_function ; exit function
.text:42CFA565 ; ---------------------------------------------------------------------------
.text:42CFA565
.text:42CFA565 loc_42CFA565:                           ; CODE XREF: sub_42CFA4FE+47\u2191j
.text:42CFA565                 mov     eax, 274Dh      ; Set connection refused error code (WSAECONNREFUSED)
.text:42CFA56A                 jmp     short exit_function ; exit function
.text:42CFA56C ; ---------------------------------------------------------------------------
.text:42CFA56C
.text:42CFA56C loc_42CFA56C:                           ; CODE XREF: sub_42CFA4FE+35\u2191j
.text:42CFA56C                 cmp     dword ptr word_42D0154C, 0 ; word_42D0154C = 0?
.text:42CFA573                 jz      short loc_42CFA5B9 ; Yes so jump here
.text:42CFA575                 push    offset dword_42D01514 ; Time
.text:42CFA57A                 call    ds:time         ; Call time() function
.text:42CFA580                 add     esp, 4          ; Remove Time from the stack
.text:42CFA583                 mov     eax, Time       ; eax = number of seconds from January 1, 1970
.text:42CFA588                 push    eax             ; Time2
.text:42CFA589                 mov     ecx, dword_42D01514 ; ecx = number of seconds from January 1, 1970
.text:42CFA58F                 push    ecx             ; Time1
.text:42CFA590                 call    ds:difftime     ; Call the difference in time function
.text:42CFA596                 add     esp, 8          ; Remove Time1 and Time2 from stack
.text:42CFA599                 fcomp   ds:dbl_42CFE1E8 ; (Time1 - Time2) <= 3 ?
.text:42CFA59F                 fnstsw  ax              ; 16 bit status word of fcomp
.text:42CFA5A1                 test    ah, 41h         ; Check C3 and C0 bits
.text:42CFA5A4                 jnz     short loc_42CFA5B9
.text:42CFA5A6                 mov     edx, dword_42D01514 ; edx = 0
.text:42CFA5AC                 mov     Time, edx       ; Reset variable used to store Time to 0
.text:42CFA5B2                 mov     eax, 274Ch      ; Set connection timed out error code
.text:42CFA5B7                 jmp     short exit_function ; exit function
.text:42CFA5B9 ; ---------------------------------------------------------------------------
.text:42CFA5B9
.text:42CFA5B9 loc_42CFA5B9:                           ; CODE XREF: sub_42CFA4FE+75\u2191j
.text:42CFA5B9                                         ; sub_42CFA4FE+A6\u2191j
.text:42CFA5B9                 mov     eax, [ebp+buf]  ; eax = address of @param char* buf
.text:42CFA5BC                 xor     ecx, ecx        ; ecx = 0
.text:42CFA5BE                 mov     cl, [eax]       ; cl = char* buf
.text:42CFA5C0                 mov     eax, ecx        ; eax = *buf
.text:42CFA5C2
.text:42CFA5C2 exit_function:                          ; CODE XREF: sub_42CFA4FE+65\u2191j
.text:42CFA5C2                                         ; sub_42CFA4FE+6C\u2191j ...
.text:42CFA5C2                 mov     esp, ebp        ; Reset stack pointer to base pointer (i.e set stack pointer to before this function)
.text:42CFA5C4                 pop     ebp             ; Remove base pointer from stack
.text:42CFA5C5                 retn                    ; Retun to 0x42CFA020
.text:42CFA5C5 sub_42CFA4FE    endp
.text:42CFA5C5
.text:42CFA5C6
.text:42CFA5C6 ; =============== S U B R O U T I N E =======================================
.text:42CFA5C6
.text:42CFA5C6 ; Attributes: bp-based frame
.text:42CFA5C6
.text:42CFA5C6 ; int __cdecl sub_42CFA5C6(char *buf, int len, u_short hostshort, int)
.text:42CFA5C6 sub_42CFA5C6    proc near               ; CODE XREF: sub_42CFA257+16\u2191p
.text:42CFA5C6                                         ; sub_42CFA84B+80\u2193p ...
.text:42CFA5C6
.text:42CFA5C6 var_1C          = dword ptr -1Ch
.text:42CFA5C6 var_18          = word ptr -18h
.text:42CFA5C6 var_16          = word ptr -16h
.text:42CFA5C6 var_14          = dword ptr -14h
.text:42CFA5C6 to              = dword ptr -8
.text:42CFA5C6 var_4           = dword ptr -4
.text:42CFA5C6 buf             = dword ptr  8
.text:42CFA5C6 len             = dword ptr  0Ch
.text:42CFA5C6 hostshort       = word ptr  10h
.text:42CFA5C6 arg_C           = dword ptr  14h
.text:42CFA5C6
.text:42CFA5C6                 push    ebp             ; Save frame pointer to the stack
.text:42CFA5C7                 mov     ebp, esp        ; Current SP becomes new FP
.text:42CFA5C9                 sub     esp, 1Ch        ; Allocate space for local variables on the stack
.text:42CFA5CC                 cmp     [ebp+arg_C], 0  ; @param arg_C = 0?
.text:42CFA5D0                 jnz     short loc_42CFA624 ; no so jump here
.text:42CFA5D2                 push    7F000001h       ; hostlong
.text:42CFA5D7                 call    ds:htonl        ; convert hostlong from host byte order to network byte order
.text:42CFA5DD                 mov     [ebp+var_14], eax ; var_14 = htonl(7F000001h)
.text:42CFA5E0                 mov     [ebp+var_18], 2 ; var_18 = 2
.text:42CFA5E6                 cmp     dword ptr [ebp+hostshort], 0 ; @param hostshort = 0?
.text:42CFA5EA                 jnz     short loc_42CFA601 ; no so jump here
.text:42CFA5EC                 push    59Ah            ; hostshort
.text:42CFA5F1                 call    ds:htons        ; convert hostshort from host byte order to network byte order
.text:42CFA5F7                 and     eax, 0FFFFh     ; eax = 9A05 & 0FFFF
.text:42CFA5FC                 mov     [ebp+var_1C], eax ; var_1C = htons(hostshort)
.text:42CFA5FF                 jmp     short loc_42CFA614
.text:42CFA601 ; ---------------------------------------------------------------------------
.text:42CFA601
.text:42CFA601 loc_42CFA601:                           ; CODE XREF: sub_42CFA5C6+24\u2191j
.text:42CFA601                 mov     ax, [ebp+hostshort] ; ax = @param hostshort
.text:42CFA605                 push    eax             ; hostshort
.text:42CFA606                 call    ds:htons        ; convert hostshort from host byte order to network byte order
.text:42CFA60C                 and     eax, 0FFFFh     ; eax = htons(hostshort)
.text:42CFA611                 mov     [ebp+var_1C], eax ; var_1C = htons(hostshort
.text:42CFA614
.text:42CFA614 loc_42CFA614:                           ; CODE XREF: sub_42CFA5C6+39\u2191j
.text:42CFA614                 mov     cx, word ptr [ebp+var_1C] ; cx = var_1C
.text:42CFA618                 mov     [ebp+var_16], cx ; var_16 = htons(hostshort)
.text:42CFA61C                 lea     edx, [ebp+var_18] ; edx = var_18
.text:42CFA61F                 mov     [ebp+to], edx   ; to = var_18
.text:42CFA622                 jmp     short loc_42CFA62B
.text:42CFA624 ; ---------------------------------------------------------------------------
.text:42CFA624
.text:42CFA624 loc_42CFA624:                           ; CODE XREF: sub_42CFA5C6+A\u2191j
.text:42CFA624                 mov     [ebp+to], offset from ; to = sockadrr<0>
.text:42CFA62B
.text:42CFA62B loc_42CFA62B:                           ; CODE XREF: sub_42CFA5C6+5C\u2191j
.text:42CFA62B                 push    10h             ; tolen
.text:42CFA62D                 mov     eax, [ebp+to]   ; eax = to
.text:42CFA630                 push    eax             ; to
.text:42CFA631                 push    0               ; flags
.text:42CFA633                 mov     ecx, [ebp+len]  ; ecx = len
.text:42CFA636                 push    ecx             ; len
.text:42CFA637                 mov     edx, [ebp+buf]  ; edx = *buf
.text:42CFA63A                 push    edx             ; buf
.text:42CFA63B                 mov     eax, dword_42D011DC ; socket s
.text:42CFA640                 push    eax             ; s
.text:42CFA641                 call    ds:sendto       ; call sendto func
.text:42CFA647                 mov     [ebp+var_4], eax ; var_4 = return values (on success it is number of characters sent and on error it is -1)
.text:42CFA64A                 mov     esp, ebp        ; restore sp to before this func
.text:42CFA64C                 pop     ebp             ; remove bp of this function
.text:42CFA64D                 retn                    ; return to sub_42CFA257
.text:42CFA64D sub_42CFA5C6    endp
.text:42CFA64D
.text:42CFA64E
.text:42CFA64E ; =============== S U B R O U T I N E =======================================
.text:42CFA64E
.text:42CFA64E ; Attributes: bp-based frame
.text:42CFA64E
.text:42CFA64E ; int __cdecl sub_42CFA64E(char *String, char *)
.text:42CFA64E sub_42CFA64E    proc near               ; CODE XREF: StartAddress+1CE\u2191p
.text:42CFA64E                                         ; sub_42CFAB38+B5\u2193p
.text:42CFA64E
.text:42CFA64E var_8           = dword ptr -8
.text:42CFA64E Destination     = dword ptr -4
.text:42CFA64E String          = dword ptr  8
.text:42CFA64E arg_4           = dword ptr  0Ch
.text:42CFA64E
.text:42CFA64E                 push    ebp             ; Save frame pointer to the stack
.text:42CFA64F                 mov     ebp, esp        ; current SP becomes new FP
.text:42CFA651                 sub     esp, 8          ; allocate space for local variables
.text:42CFA654                 mov     eax, [ebp+String] ; eax = @param char *String
.text:42CFA657                 mov     [ebp+var_8], eax ; var_8 = @param char* String
.text:42CFA65A                 push    108h            ; Size
.text:42CFA65F                 call    ds:malloc       ; malloc(108h)
.text:42CFA665                 add     esp, 4          ; remove var_8 from stack
.text:42CFA668                 mov     [ebp+Destination], eax ; Destination points to newly allocated memory
.text:42CFA66B                 cmp     [ebp+Destination], 0 ; null?
.text:42CFA66F                 jnz     short loc_42CFA676 ; writeable address for the virus code
.text:42CFA671                 jmp     exit_function2  ; malloc failed
.text:42CFA676 ; ---------------------------------------------------------------------------
.text:42CFA676
.text:42CFA676 loc_42CFA676:                           ; CODE XREF: sub_42CFA64E+21\u2191j
.text:42CFA676                 cmp     String1, 0      ; @param char* String == null?
.text:42CFA67D                 jnz     short loc_42CFA68A ; @param *String != null so jump here
.text:42CFA67F                 mov     ecx, [ebp+Destination] ; ecx = Destination
.text:42CFA682                 mov     String1, ecx    ; String = Destination
.text:42CFA688                 jmp     short loc_42CFA699
.text:42CFA68A ; ---------------------------------------------------------------------------
.text:42CFA68A
.text:42CFA68A loc_42CFA68A:                           ; CODE XREF: sub_42CFA64E+2F\u2191j
.text:42CFA68A                 mov     edx, dword_42D01540
.text:42CFA690                 mov     eax, [ebp+Destination]
.text:42CFA693                 mov     [edx+104h], eax
.text:42CFA699
.text:42CFA699 loc_42CFA699:                           ; CODE XREF: sub_42CFA64E+3A\u2191j
.text:42CFA699                 mov     ecx, [ebp+Destination]
.text:42CFA69C                 mov     dword_42D01540, ecx ; dword_42D01540 = Destination
.text:42CFA6A2                 cmp     [ebp+arg_4], 0  ; @param char* = null?
.text:42CFA6A6                 jnz     short loc_42CFA6EC
.text:42CFA6A8                 push    offset asc_42D00838 ; ":"
.text:42CFA6AD                 mov     edx, [ebp+String]
.text:42CFA6B0                 push    edx             ; String
.text:42CFA6B1                 call    ds:strtok
.text:42CFA6B7                 add     esp, 8
.text:42CFA6BA                 push    eax             ; Source
.text:42CFA6BB                 mov     eax, [ebp+Destination]
.text:42CFA6BE                 push    eax             ; Destination
.text:42CFA6BF                 call    strcpy
.text:42CFA6C4                 add     esp, 8
.text:42CFA6C7                 push    offset byte_42D011EC ; Delimiter
.text:42CFA6CC                 push    0               ; String
.text:42CFA6CE                 call    ds:strtok
.text:42CFA6D4                 add     esp, 8
.text:42CFA6D7                 push    eax             ; String
.text:42CFA6D8                 call    ds:atoi
.text:42CFA6DE                 add     esp, 4
.text:42CFA6E1                 mov     ecx, [ebp+Destination]
.text:42CFA6E4                 mov     [ecx+100h], eax
.text:42CFA6EA                 jmp     short loc_42CFA712
.text:42CFA6EC ; ---------------------------------------------------------------------------
.text:42CFA6EC
.text:42CFA6EC loc_42CFA6EC:                           ; CODE XREF: sub_42CFA64E+58\u2191j
.text:42CFA6EC                 mov     edx, [ebp+String]
.text:42CFA6EF                 push    edx             ; Source
.text:42CFA6F0                 mov     eax, [ebp+Destination]
.text:42CFA6F3                 push    eax             ; Destination
.text:42CFA6F4                 call    strcpy
.text:42CFA6F9                 add     esp, 8
.text:42CFA6FC                 mov     ecx, [ebp+arg_4]
.text:42CFA6FF                 push    ecx             ; String
.text:42CFA700                 call    ds:atoi
.text:42CFA706                 add     esp, 4
.text:42CFA709                 mov     edx, [ebp+Destination]
.text:42CFA70C                 mov     [edx+100h], eax
.text:42CFA712
.text:42CFA712 loc_42CFA712:                           ; CODE XREF: sub_42CFA64E+9C\u2191j
.text:42CFA712                 mov     eax, [ebp+Destination]
.text:42CFA715                 mov     dword ptr [eax+104h], 0
.text:42CFA71F                 mov     ecx, Val
.text:42CFA725                 add     ecx, 1
.text:42CFA728                 mov     Val, ecx
.text:42CFA72E
.text:42CFA72E exit_function2:                         ; CODE XREF: sub_42CFA64E+23\u2191j
.text:42CFA72E                 mov     esp, ebp        ; reset sp
.text:42CFA730                 pop     ebp             ; remove bp of the current func
.text:42CFA731                 retn
.text:42CFA731 sub_42CFA64E    endp
.text:42CFA731
.text:42CFA732
.text:42CFA732 ; =============== S U B R O U T I N E =======================================
.text:42CFA732
.text:42CFA732 ; Attributes: bp-based frame
.text:42CFA732
.text:42CFA732 ; int __cdecl sub_42CFA732(char *String2)
.text:42CFA732 sub_42CFA732    proc near               ; CODE XREF: StartAddress+1E2\u2191p
.text:42CFA732
.text:42CFA732 var_C           = dword ptr -0Ch
.text:42CFA732 var_8           = dword ptr -8
.text:42CFA732 Block           = dword ptr -4
.text:42CFA732 String2         = dword ptr  8
.text:42CFA732
.text:42CFA732                 push    ebp
.text:42CFA733                 mov     ebp, esp
.text:42CFA735                 sub     esp, 0Ch
.text:42CFA738                 mov     eax, [ebp+String2]
.text:42CFA73B                 push    eax             ; String2
.text:42CFA73C                 call    sub_42CFA7D3
.text:42CFA741                 add     esp, 4
.text:42CFA744                 mov     [ebp+var_8], eax
.text:42CFA747                 cmp     [ebp+var_8], 0
.text:42CFA74B                 jnz     short loc_42CFA758
.text:42CFA74D                 mov     ecx, String1
.text:42CFA753                 mov     [ebp+var_C], ecx
.text:42CFA756                 jmp     short loc_42CFA764
.text:42CFA758 ; ---------------------------------------------------------------------------
.text:42CFA758
.text:42CFA758 loc_42CFA758:                           ; CODE XREF: sub_42CFA732+19\u2191j
.text:42CFA758                 mov     edx, [ebp+var_8]
.text:42CFA75B                 mov     eax, [edx+104h]
.text:42CFA761                 mov     [ebp+var_C], eax
.text:42CFA764
.text:42CFA764 loc_42CFA764:                           ; CODE XREF: sub_42CFA732+24\u2191j
.text:42CFA764                 mov     ecx, [ebp+var_C]
.text:42CFA767                 mov     [ebp+Block], ecx
.text:42CFA76A                 cmp     [ebp+Block], 0
.text:42CFA76E                 jnz     short loc_42CFA772
.text:42CFA770                 jmp     short loc_42CFA7CF
.text:42CFA772 ; ---------------------------------------------------------------------------
.text:42CFA772
.text:42CFA772 loc_42CFA772:                           ; CODE XREF: sub_42CFA732+3C\u2191j
.text:42CFA772                 mov     edx, [ebp+Block]
.text:42CFA775                 cmp     edx, String1
.text:42CFA77B                 jnz     short loc_42CFA78E
.text:42CFA77D                 mov     eax, [ebp+Block]
.text:42CFA780                 mov     ecx, [eax+104h]
.text:42CFA786                 mov     String1, ecx
.text:42CFA78C                 jmp     short loc_42CFA7A0
.text:42CFA78E ; ---------------------------------------------------------------------------
.text:42CFA78E
.text:42CFA78E loc_42CFA78E:                           ; CODE XREF: sub_42CFA732+49\u2191j
.text:42CFA78E                 mov     edx, [ebp+var_8]
.text:42CFA791                 mov     eax, [ebp+Block]
.text:42CFA794                 mov     ecx, [eax+104h]
.text:42CFA79A                 mov     [edx+104h], ecx
.text:42CFA7A0
.text:42CFA7A0 loc_42CFA7A0:                           ; CODE XREF: sub_42CFA732+5A\u2191j
.text:42CFA7A0                 mov     edx, dword_42D01540
.text:42CFA7A6                 cmp     edx, [ebp+Block]
.text:42CFA7A9                 jnz     short loc_42CFA7B3
.text:42CFA7AB                 mov     eax, [ebp+var_8]
.text:42CFA7AE                 mov     dword_42D01540, eax
.text:42CFA7B3
.text:42CFA7B3 loc_42CFA7B3:                           ; CODE XREF: sub_42CFA732+77\u2191j
.text:42CFA7B3                 mov     ecx, Val
.text:42CFA7B9                 sub     ecx, 1
.text:42CFA7BC                 mov     Val, ecx
.text:42CFA7C2                 mov     edx, [ebp+Block]
.text:42CFA7C5                 push    edx             ; Block
.text:42CFA7C6                 call    ds:free
.text:42CFA7CC                 add     esp, 4
.text:42CFA7CF
.text:42CFA7CF loc_42CFA7CF:                           ; CODE XREF: sub_42CFA732+3E\u2191j
.text:42CFA7CF                 mov     esp, ebp
.text:42CFA7D1                 pop     ebp
.text:42CFA7D2                 retn
.text:42CFA7D2 sub_42CFA732    endp
.text:42CFA7D2
.text:42CFA7D3
.text:42CFA7D3 ; =============== S U B R O U T I N E =======================================
.text:42CFA7D3
.text:42CFA7D3 ; Attributes: bp-based frame
.text:42CFA7D3
.text:42CFA7D3 ; int __cdecl sub_42CFA7D3(char *String2)
.text:42CFA7D3 sub_42CFA7D3    proc near               ; CODE XREF: sub_42CFA732+A\u2191p
.text:42CFA7D3
.text:42CFA7D3 var_4           = dword ptr -4
.text:42CFA7D3 String2         = dword ptr  8
.text:42CFA7D3
.text:42CFA7D3                 push    ebp
.text:42CFA7D4                 mov     ebp, esp
.text:42CFA7D6                 push    ecx
.text:42CFA7D7                 cmp     String1, 0
.text:42CFA7DE                 jz      short loc_42CFA7F8
.text:42CFA7E0                 mov     eax, [ebp+String2]
.text:42CFA7E3                 push    eax             ; String2
.text:42CFA7E4                 mov     ecx, String1
.text:42CFA7EA                 push    ecx             ; String1
.text:42CFA7EB                 call    ds:_stricmp
.text:42CFA7F1                 add     esp, 8
.text:42CFA7F4                 test    eax, eax
.text:42CFA7F6                 jnz     short loc_42CFA7FC
.text:42CFA7F8
.text:42CFA7F8 loc_42CFA7F8:                           ; CODE XREF: sub_42CFA7D3+B\u2191j
.text:42CFA7F8                 xor     eax, eax
.text:42CFA7FA                 jmp     short loc_42CFA847
.text:42CFA7FC ; ---------------------------------------------------------------------------
.text:42CFA7FC
.text:42CFA7FC loc_42CFA7FC:                           ; CODE XREF: sub_42CFA7D3+23\u2191j
.text:42CFA7FC                 mov     edx, String1
.text:42CFA802                 mov     [ebp+var_4], edx
.text:42CFA805
.text:42CFA805 loc_42CFA805:                           ; CODE XREF: sub_42CFA7D3+70\u2193j
.text:42CFA805                 cmp     [ebp+var_4], 0
.text:42CFA809                 jz      short loc_42CFA845
.text:42CFA80B                 mov     eax, [ebp+var_4]
.text:42CFA80E                 cmp     dword ptr [eax+104h], 0
.text:42CFA815                 jz      short loc_42CFA845
.text:42CFA817                 mov     ecx, [ebp+String2]
.text:42CFA81A                 push    ecx             ; String2
.text:42CFA81B                 mov     edx, [ebp+var_4]
.text:42CFA81E                 mov     eax, [edx+104h]
.text:42CFA824                 push    eax             ; String1
.text:42CFA825                 call    ds:_stricmp
.text:42CFA82B                 add     esp, 8
.text:42CFA82E                 test    eax, eax
.text:42CFA830                 jnz     short loc_42CFA837
.text:42CFA832                 mov     eax, [ebp+var_4]
.text:42CFA835                 jmp     short loc_42CFA847
.text:42CFA837 ; ---------------------------------------------------------------------------
.text:42CFA837
.text:42CFA837 loc_42CFA837:                           ; CODE XREF: sub_42CFA7D3+5D\u2191j
.text:42CFA837                 mov     ecx, [ebp+var_4]
.text:42CFA83A                 mov     edx, [ecx+104h]
.text:42CFA840                 mov     [ebp+var_4], edx
.text:42CFA843                 jmp     short loc_42CFA805
.text:42CFA845 ; ---------------------------------------------------------------------------
.text:42CFA845
.text:42CFA845 loc_42CFA845:                           ; CODE XREF: sub_42CFA7D3+36\u2191j
.text:42CFA845                                         ; sub_42CFA7D3+42\u2191j
.text:42CFA845                 xor     eax, eax
.text:42CFA847
.text:42CFA847 loc_42CFA847:                           ; CODE XREF: sub_42CFA7D3+27\u2191j
.text:42CFA847                                         ; sub_42CFA7D3+62\u2191j
.text:42CFA847                 mov     esp, ebp
.text:42CFA849                 pop     ebp
.text:42CFA84A                 retn
.text:42CFA84A sub_42CFA7D3    endp
.text:42CFA84A
.text:42CFA84B
.text:42CFA84B ; =============== S U B R O U T I N E =======================================
.text:42CFA84B
.text:42CFA84B ; Attributes: bp-based frame
.text:42CFA84B
.text:42CFA84B sub_42CFA84B    proc near               ; CODE XREF: StartAddress+52\u2191p
.text:42CFA84B
.text:42CFA84B namelen         = dword ptr -414h
.text:42CFA84B name            = sockaddr ptr -410h
.text:42CFA84B buf             = byte ptr -400h
.text:42CFA84B Buffer          = byte ptr -3FFh
.text:42CFA84B arg_0           = dword ptr  8
.text:42CFA84B
.text:42CFA84B                 push    ebp
.text:42CFA84C                 mov     ebp, esp
.text:42CFA84E                 sub     esp, 414h
.text:42CFA854                 mov     [ebp+namelen], 10h
.text:42CFA85E                 mov     [ebp+buf], 8
.text:42CFA865                 lea     eax, [ebp+namelen]
.text:42CFA86B                 push    eax             ; namelen
.text:42CFA86C                 lea     ecx, [ebp+name]
.text:42CFA872                 push    ecx             ; name
.text:42CFA873                 mov     edx, dword_42D011DC
.text:42CFA879                 push    edx             ; s
.text:42CFA87A                 call    ds:getsockname
.text:42CFA880                 mov     ax, word ptr [ebp+name.sa_data]
.text:42CFA887                 push    eax             ; netshort
.text:42CFA888                 call    ds:ntohs
.text:42CFA88E                 and     eax, 0FFFFh
.text:42CFA893                 push    eax
.text:42CFA894                 mov     ecx, [ebp+arg_0]
.text:42CFA897                 push    ecx
.text:42CFA898                 push    offset aSD_1    ; "%s:%d"
.text:42CFA89D                 lea     edx, [ebp+Buffer]
.text:42CFA8A3                 push    edx             ; Buffer
.text:42CFA8A4                 call    ds:sprintf
.text:42CFA8AA                 add     esp, 10h
.text:42CFA8AD                 push    0               ; int
.text:42CFA8AF                 push    0               ; hostshort
.text:42CFA8B1                 lea     eax, [ebp+Buffer]
.text:42CFA8B7                 push    eax             ; Str
.text:42CFA8B8                 call    strlen
.text:42CFA8BD                 add     esp, 4
.text:42CFA8C0                 add     eax, 2
.text:42CFA8C3                 push    eax             ; len
.text:42CFA8C4                 lea     ecx, [ebp+buf]
.text:42CFA8CA                 push    ecx             ; buf
.text:42CFA8CB                 call    sub_42CFA5C6
.text:42CFA8D0                 add     esp, 10h
.text:42CFA8D3                 mov     esp, ebp
.text:42CFA8D5                 pop     ebp
.text:42CFA8D6                 retn
.text:42CFA8D6 sub_42CFA84B    endp
.text:42CFA8D6
.text:42CFA8D7
.text:42CFA8D7 ; =============== S U B R O U T I N E =======================================
.text:42CFA8D7
.text:42CFA8D7 ; Attributes: bp-based frame
.text:42CFA8D7
.text:42CFA8D7 ; int __cdecl sub_42CFA8D7(char *Str)
.text:42CFA8D7 sub_42CFA8D7    proc near               ; CODE XREF: StartAddress+228\u2191p
.text:42CFA8D7
.text:42CFA8D7 var_404         = dword ptr -404h
.text:42CFA8D7 buf             = byte ptr -400h
.text:42CFA8D7 Destination     = byte ptr -3FFh
.text:42CFA8D7 Str             = dword ptr  8
.text:42CFA8D7
.text:42CFA8D7                 push    ebp
.text:42CFA8D8                 mov     ebp, esp
.text:42CFA8DA                 sub     esp, 404h
.text:42CFA8E0                 mov     eax, [ebp+Str]
.text:42CFA8E3                 push    eax             ; Str
.text:42CFA8E4                 call    strlen
.text:42CFA8E9                 add     esp, 4
.text:42CFA8EC                 mov     [ebp+var_404], eax
.text:42CFA8F2                 mov     [ebp+buf], 9
.text:42CFA8F9                 mov     ecx, [ebp+Str]
.text:42CFA8FC                 push    ecx             ; Source
.text:42CFA8FD                 lea     edx, [ebp+Destination]
.text:42CFA903                 push    edx             ; Destination
.text:42CFA904                 call    strcpy
.text:42CFA909                 add     esp, 8
.text:42CFA90C                 push    0               ; int
.text:42CFA90E                 push    0               ; hostshort
.text:42CFA910                 mov     eax, [ebp+var_404]
.text:42CFA916                 add     eax, 2
.text:42CFA919                 push    eax             ; len
.text:42CFA91A                 lea     ecx, [ebp+buf]
.text:42CFA920                 push    ecx             ; buf
.text:42CFA921                 call    sub_42CFA5C6
.text:42CFA926                 add     esp, 10h
.text:42CFA929                 mov     esp, ebp
.text:42CFA92B                 pop     ebp
.text:42CFA92C                 retn
.text:42CFA92C sub_42CFA8D7    endp
.text:42CFA92C
.text:42CFA92D
.text:42CFA92D ; =============== S U B R O U T I N E =======================================
.text:42CFA92D
.text:42CFA92D ; Attributes: bp-based frame
.text:42CFA92D
.text:42CFA92D ; int __cdecl sub_42CFA92D(u_short hostshort)
.text:42CFA92D sub_42CFA92D    proc near               ; CODE XREF: StartAddress+265\u2191p
.text:42CFA92D
.text:42CFA92D buf             = byte ptr -4
.text:42CFA92D hostshort       = word ptr  8
.text:42CFA92D
.text:42CFA92D                 push    ebp
.text:42CFA92E                 mov     ebp, esp
.text:42CFA930                 push    ecx
.text:42CFA931                 mov     [ebp+buf], 6
.text:42CFA935                 push    0               ; int
.text:42CFA937                 mov     eax, dword ptr [ebp+hostshort]
.text:42CFA93A                 push    eax             ; hostshort
.text:42CFA93B                 push    1               ; len
.text:42CFA93D                 lea     ecx, [ebp+buf]
.text:42CFA940                 push    ecx             ; buf
.text:42CFA941                 call    sub_42CFA5C6
.text:42CFA946                 add     esp, 10h
.text:42CFA949                 mov     esp, ebp
.text:42CFA94B                 pop     ebp
.text:42CFA94C                 retn
.text:42CFA94C sub_42CFA92D    endp
.text:42CFA94C
.text:42CFA94D
.text:42CFA94D ; =============== S U B R O U T I N E =======================================
.text:42CFA94D
.text:42CFA94D ; Attributes: bp-based frame
.text:42CFA94D
.text:42CFA94D ; int __cdecl sub_42CFA94D(char *Str1)
.text:42CFA94D sub_42CFA94D    proc near               ; CODE XREF: StartAddress+240\u2191p
.text:42CFA94D                                         ; StartAddress+251\u2191p
.text:42CFA94D
.text:42CFA94D cbData          = dword ptr -824h
.text:42CFA94D Buffer          = byte ptr -820h
.text:42CFA94D var_814         = dword ptr -814h
.text:42CFA94D Data            = byte ptr -810h
.text:42CFA94D Size            = dword ptr -10h
.text:42CFA94D var_C           = dword ptr -0Ch
.text:42CFA94D Str             = dword ptr -8
.text:42CFA94D phkResult       = dword ptr -4
.text:42CFA94D Str1            = dword ptr  8
.text:42CFA94D
.text:42CFA94D                 push    ebp
.text:42CFA94E                 mov     ebp, esp
.text:42CFA950                 sub     esp, 824h
.text:42CFA956                 lea     eax, [ebp+phkResult]
.text:42CFA959                 push    eax             ; phkResult
.text:42CFA95A                 push    0F003Fh         ; samDesired
.text:42CFA95F                 push    0               ; ulOptions
.text:42CFA961                 push    offset aSoftwareMicros_10 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFA966                 push    80000002h       ; hKey
.text:42CFA96B                 call    ds:RegOpenKeyExA
.text:42CFA971                 push    offset byte_42D011F0 ; Str2
.text:42CFA976                 mov     ecx, [ebp+Str1]
.text:42CFA979                 push    ecx             ; Str1
.text:42CFA97A                 call    strcmp
.text:42CFA97F                 add     esp, 8
.text:42CFA982                 test    eax, eax
.text:42CFA984                 jnz     short loc_42CFA992
.text:42CFA986                 mov     [ebp+cbData], 0
.text:42CFA990                 jmp     short loc_42CFA9A4
.text:42CFA992 ; ---------------------------------------------------------------------------
.text:42CFA992
.text:42CFA992 loc_42CFA992:                           ; CODE XREF: sub_42CFA94D+37\u2191j
.text:42CFA992                 mov     edx, [ebp+Str1]
.text:42CFA995                 push    edx             ; Str
.text:42CFA996                 call    strlen
.text:42CFA99B                 add     esp, 4
.text:42CFA99E                 mov     [ebp+cbData], eax
.text:42CFA9A4
.text:42CFA9A4 loc_42CFA9A4:                           ; CODE XREF: sub_42CFA94D+43\u2191j
.text:42CFA9A4                 mov     eax, [ebp+cbData]
.text:42CFA9AA                 push    eax             ; cbData
.text:42CFA9AB                 mov     ecx, [ebp+Str1]
.text:42CFA9AE                 push    ecx             ; lpData
.text:42CFA9AF                 push    1               ; dwType
.text:42CFA9B1                 push    0               ; Reserved
.text:42CFA9B3                 push    offset aSsrpactiveserv_2 ; "SsrpActiveServer"
.text:42CFA9B8                 mov     edx, [ebp+phkResult]
.text:42CFA9BB                 push    edx             ; hKey
.text:42CFA9BC                 call    ds:RegSetValueExA
.text:42CFA9C2                 push    offset byte_42D011F4 ; Str2
.text:42CFA9C7                 mov     eax, [ebp+Str1]
.text:42CFA9CA                 push    eax             ; Str1
.text:42CFA9CB                 call    strcmp
.text:42CFA9D0                 add     esp, 8
.text:42CFA9D3                 test    eax, eax
.text:42CFA9D5                 jz      loc_42CFAB2A
.text:42CFA9DB                 mov     ecx, String1
.text:42CFA9E1                 cmp     dword ptr [ecx+104h], 0
.text:42CFA9E8                 jz      loc_42CFAB2A
.text:42CFA9EE                 mov     [ebp+var_814], 1
.text:42CFA9F8                 mov     edx, String1
.text:42CFA9FE                 mov     eax, [edx+104h]
.text:42CFAA04                 mov     [ebp+Str], eax
.text:42CFAA07                 push    800h            ; Size
.text:42CFAA0C                 push    0               ; Val
.text:42CFAA0E                 lea     ecx, [ebp+Data]
.text:42CFAA14                 push    ecx             ; void *
.text:42CFAA15                 call    memset
.text:42CFAA1A                 add     esp, 0Ch
.text:42CFAA1D                 push    1               ; Size
.text:42CFAA1F                 mov     edx, Val
.text:42CFAA25                 sub     edx, 1
.text:42CFAA28                 mov     Val, edx
.text:42CFAA2E                 mov     eax, Val
.text:42CFAA33                 push    eax             ; Val
.text:42CFAA34                 lea     ecx, [ebp+Data]
.text:42CFAA3A                 push    ecx             ; void *
.text:42CFAA3B                 call    memset
.text:42CFAA40                 add     esp, 0Ch
.text:42CFAA43
.text:42CFAA43 loc_42CFAA43:                           ; CODE XREF: sub_42CFA94D+1B7\u2193j
.text:42CFAA43                 cmp     Val, 0
.text:42CFAA4A                 jle     loc_42CFAB09
.text:42CFAA50                 mov     edx, [ebp+Str]
.text:42CFAA53                 push    edx             ; Str
.text:42CFAA54                 call    strlen
.text:42CFAA59                 add     esp, 4
.text:42CFAA5C                 mov     [ebp+Size], eax
.text:42CFAA5F                 mov     eax, [ebp+Size]
.text:42CFAA62                 push    eax             ; Size
.text:42CFAA63                 mov     ecx, [ebp+Str]
.text:42CFAA66                 push    ecx             ; Src
.text:42CFAA67                 mov     edx, [ebp+var_814]
.text:42CFAA6D                 lea     eax, [ebp+edx+Data]
.text:42CFAA74                 push    eax             ; void *
.text:42CFAA75                 call    memcpy
.text:42CFAA7A                 add     esp, 0Ch
.text:42CFAA7D                 push    0Ah             ; Radix
.text:42CFAA7F                 lea     ecx, [ebp+Buffer]
.text:42CFAA85                 push    ecx             ; Buffer
.text:42CFAA86                 mov     edx, [ebp+Str]
.text:42CFAA89                 mov     eax, [edx+100h]
.text:42CFAA8F                 push    eax             ; Value
.text:42CFAA90                 call    ds:_itoa
.text:42CFAA96                 add     esp, 0Ch
.text:42CFAA99                 lea     ecx, [ebp+Buffer]
.text:42CFAA9F                 push    ecx             ; Str
.text:42CFAAA0                 call    strlen
.text:42CFAAA5                 add     esp, 4
.text:42CFAAA8                 mov     [ebp+var_C], eax
.text:42CFAAAB                 mov     edx, [ebp+var_C]
.text:42CFAAAE                 push    edx             ; Size
.text:42CFAAAF                 lea     eax, [ebp+Buffer]
.text:42CFAAB5                 push    eax             ; Src
.text:42CFAAB6                 mov     ecx, [ebp+var_814]
.text:42CFAABC                 lea     edx, [ebp+ecx+Data]
.text:42CFAAC3                 mov     eax, [ebp+Size]
.text:42CFAAC6                 lea     ecx, [edx+eax+1]
.text:42CFAACA                 push    ecx             ; void *
.text:42CFAACB                 call    memcpy
.text:42CFAAD0                 add     esp, 0Ch
.text:42CFAAD3                 mov     edx, [ebp+Size]
.text:42CFAAD6                 add     edx, [ebp+var_C]
.text:42CFAAD9                 mov     eax, [ebp+var_814]
.text:42CFAADF                 lea     ecx, [eax+edx+2]
.text:42CFAAE3                 mov     [ebp+var_814], ecx
.text:42CFAAE9                 mov     edx, [ebp+Str]
.text:42CFAAEC                 mov     eax, [edx+104h]
.text:42CFAAF2                 mov     [ebp+Str], eax
.text:42CFAAF5                 mov     ecx, Val
.text:42CFAAFB                 sub     ecx, 1
.text:42CFAAFE                 mov     Val, ecx
.text:42CFAB04                 jmp     loc_42CFAA43
.text:42CFAB09 ; ---------------------------------------------------------------------------
.text:42CFAB09
.text:42CFAB09 loc_42CFAB09:                           ; CODE XREF: sub_42CFA94D+FD\u2191j
.text:42CFAB09                 mov     edx, [ebp+var_814]
.text:42CFAB0F                 push    edx             ; cbData
.text:42CFAB10                 lea     eax, [ebp+Data]
.text:42CFAB16                 push    eax             ; lpData
.text:42CFAB17                 push    7               ; dwType
.text:42CFAB19                 push    0               ; Reserved
.text:42CFAB1B                 push    offset aSsrpservers ; "SsrpServers"
.text:42CFAB20                 mov     ecx, [ebp+phkResult]
.text:42CFAB23                 push    ecx             ; hKey
.text:42CFAB24                 call    ds:RegSetValueExA
.text:42CFAB2A
.text:42CFAB2A loc_42CFAB2A:                           ; CODE XREF: sub_42CFA94D+88\u2191j
.text:42CFAB2A                                         ; sub_42CFA94D+9B\u2191j
.text:42CFAB2A                 mov     edx, [ebp+phkResult]
.text:42CFAB2D                 push    edx             ; hKey
.text:42CFAB2E                 call    ds:RegCloseKey
.text:42CFAB34                 mov     esp, ebp
.text:42CFAB36                 pop     ebp
.text:42CFAB37                 retn
.text:42CFAB37 sub_42CFA94D    endp
.text:42CFAB37
.text:42CFAB38
.text:42CFAB38 ; =============== S U B R O U T I N E =======================================
.text:42CFAB38
.text:42CFAB38 ; Attributes: bp-based frame
.text:42CFAB38
.text:42CFAB38 sub_42CFAB38    proc near               ; CODE XREF: StartAddress+E8\u2191p
.text:42CFAB38
.text:42CFAB38 var_818         = dword ptr -818h
.text:42CFAB38 cbData          = dword ptr -814h
.text:42CFAB38 phkResult       = dword ptr -810h
.text:42CFAB38 Data            = byte ptr -80Ch
.text:42CFAB38 var_C           = dword ptr -0Ch
.text:42CFAB38 var_8           = dword ptr -8
.text:42CFAB38 Str             = dword ptr -4
.text:42CFAB38
.text:42CFAB38                 push    ebp
.text:42CFAB39                 mov     ebp, esp
.text:42CFAB3B                 sub     esp, 818h
.text:42CFAB41                 push    esi
.text:42CFAB42                 mov     [ebp+cbData], 800h
.text:42CFAB4C                 lea     eax, [ebp+phkResult]
.text:42CFAB52                 push    eax             ; phkResult
.text:42CFAB53                 push    0F003Fh         ; samDesired
.text:42CFAB58                 push    0               ; ulOptions
.text:42CFAB5A                 push    offset aSoftwareMicros_11 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFAB5F                 push    80000002h       ; hKey
.text:42CFAB64                 call    ds:RegOpenKeyExA
.text:42CFAB6A                 lea     ecx, [ebp+cbData]
.text:42CFAB70                 push    ecx             ; lpcbData
.text:42CFAB71                 lea     edx, [ebp+Data]
.text:42CFAB77                 push    edx             ; lpData
.text:42CFAB78                 push    0               ; lpType
.text:42CFAB7A                 push    0               ; lpReserved
.text:42CFAB7C                 push    offset aSsrpservers_0 ; "SsrpServers"
.text:42CFAB81                 mov     eax, [ebp+phkResult]
.text:42CFAB87                 push    eax             ; hKey
.text:42CFAB88                 call    ds:RegQueryValueExA
.text:42CFAB8E                 test    eax, eax
.text:42CFAB90                 jz      short loc_42CFAB97
.text:42CFAB92                 jmp     loc_42CFAC6A
.text:42CFAB97 ; ---------------------------------------------------------------------------
.text:42CFAB97
.text:42CFAB97 loc_42CFAB97:                           ; CODE XREF: sub_42CFAB38+58\u2191j
.text:42CFAB97                 mov     ecx, dword ptr [ebp+Data]
.text:42CFAB9D                 and     ecx, 0FFh
.text:42CFABA3                 mov     [ebp+var_8], ecx
.text:42CFABA6                 lea     edx, [ebp+Data+1]
.text:42CFABAC                 mov     [ebp+Str], edx
.text:42CFABAF                 mov     eax, [ebp+Str]
.text:42CFABB2                 push    eax             ; Str
.text:42CFABB3                 call    strlen
.text:42CFABB8                 add     esp, 4
.text:42CFABBB                 lea     ecx, [ebp+eax+Data+2]
.text:42CFABC2                 mov     [ebp+var_818], ecx
.text:42CFABC8                 mov     [ebp+var_C], 0
.text:42CFABCF                 jmp     short loc_42CFABDA
.text:42CFABD1 ; ---------------------------------------------------------------------------
.text:42CFABD1
.text:42CFABD1 loc_42CFABD1:                           ; CODE XREF: sub_42CFAB38+111\u2193j
.text:42CFABD1                 mov     edx, [ebp+var_C]
.text:42CFABD4                 add     edx, 1
.text:42CFABD7                 mov     [ebp+var_C], edx
.text:42CFABDA
.text:42CFABDA loc_42CFABDA:                           ; CODE XREF: sub_42CFAB38+97\u2191j
.text:42CFABDA                 mov     eax, [ebp+var_C]
.text:42CFABDD                 cmp     eax, [ebp+var_8]
.text:42CFABE0                 jge     short loc_42CFAC4B
.text:42CFABE2                 mov     ecx, [ebp+var_818]
.text:42CFABE8                 push    ecx             ; char *
.text:42CFABE9                 mov     edx, [ebp+Str]
.text:42CFABEC                 push    edx             ; String
.text:42CFABED                 call    sub_42CFA64E
.text:42CFABF2                 add     esp, 8
.text:42CFABF5                 mov     eax, [ebp+Str]
.text:42CFABF8                 push    eax             ; Str
.text:42CFABF9                 call    strlen
.text:42CFABFE                 add     esp, 4
.text:42CFAC01                 mov     esi, eax
.text:42CFAC03                 mov     ecx, [ebp+var_818]
.text:42CFAC09                 push    ecx             ; Str
.text:42CFAC0A                 call    strlen
.text:42CFAC0F                 add     esp, 4
.text:42CFAC12                 add     eax, [ebp+Str]
.text:42CFAC15                 lea     edx, [eax+esi+2]
.text:42CFAC19                 mov     [ebp+Str], edx
.text:42CFAC1C                 mov     eax, [ebp+Str]
.text:42CFAC1F                 push    eax             ; Str
.text:42CFAC20                 call    strlen
.text:42CFAC25                 add     esp, 4
.text:42CFAC28                 mov     esi, eax
.text:42CFAC2A                 mov     ecx, [ebp+var_818]
.text:42CFAC30                 push    ecx             ; Str
.text:42CFAC31                 call    strlen
.text:42CFAC36                 add     esp, 4
.text:42CFAC39                 add     eax, [ebp+var_818]
.text:42CFAC3F                 lea     edx, [eax+esi+2]
.text:42CFAC43                 mov     [ebp+var_818], edx
.text:42CFAC49                 jmp     short loc_42CFABD1
.text:42CFAC4B ; ---------------------------------------------------------------------------
.text:42CFAC4B
.text:42CFAC4B loc_42CFAC4B:                           ; CODE XREF: sub_42CFAB38+A8\u2191j
.text:42CFAC4B                 push    offset aSsrpservers_1 ; "SsrpServers"
.text:42CFAC50                 mov     eax, [ebp+phkResult]
.text:42CFAC56                 push    eax             ; hKey
.text:42CFAC57                 call    ds:RegDeleteValueA
.text:42CFAC5D                 mov     ecx, [ebp+phkResult]
.text:42CFAC63                 push    ecx             ; hKey
.text:42CFAC64                 call    ds:RegCloseKey
.text:42CFAC6A
.text:42CFAC6A loc_42CFAC6A:                           ; CODE XREF: sub_42CFAB38+5A\u2191j
.text:42CFAC6A                 pop     esi
.text:42CFAC6B                 mov     esp, ebp
.text:42CFAC6D                 pop     ebp
.text:42CFAC6E                 retn
.text:42CFAC6E sub_42CFAB38    endp
.text:42CFAC6E
.text:42CFAC6F
.text:42CFAC6F ; =============== S U B R O U T I N E =======================================
.text:42CFAC6F
.text:42CFAC6F ; Attributes: bp-based frame
.text:42CFAC6F
.text:42CFAC6F ; int __cdecl sub_42CFAC6F(char *Str1)
.text:42CFAC6F sub_42CFAC6F    proc near               ; CODE XREF: StartAddress+1A4\u2191p
.text:42CFAC6F                                         ; StartAddress+1B8\u2191p
.text:42CFAC6F
.text:42CFAC6F var_1FB4        = dword ptr -1FB4h
.text:42CFAC6F var_1FB0        = dword ptr -1FB0h
.text:42CFAC6F var_1FAC        = dword ptr -1FACh
.text:42CFAC6F buf             = dword ptr -1FA8h
.text:42CFAC6F var_1FA4        = byte ptr -1FA4h
.text:42CFAC6F var_4           = dword ptr -4
.text:42CFAC6F Str1            = dword ptr  8
.text:42CFAC6F
.text:42CFAC6F                 push    ebp             ; Save the old frame pointer
.text:42CFAC70                 mov     ebp, esp        ; make current sp the new fp
.text:42CFAC72                 mov     eax, 1FB4h      ; eax = 1FB4H
.text:42CFAC77                 call    __alloca_probe
.text:42CFAC7C                 lea     eax, [ebp+var_1FA4] ; eax = var_1FA4
.text:42CFAC82                 mov     [ebp+buf], eax  ; buf = var_1FA4
.text:42CFAC88                 mov     ecx, [ebp+buf]  ; ecx = buf = var_1FA4
.text:42CFAC8E                 add     ecx, 3          ; ecx + 3
.text:42CFAC91                 mov     [ebp+var_1FAC], ecx ; var_1FAC = var_1FA4 + 3
.text:42CFAC97                 mov     [ebp+var_1FB4], 0 ; var_1FB4 = 0
.text:42CFACA1                 mov     edx, [ebp+buf]  ; edx = buf
.text:42CFACA7                 mov     byte ptr [edx], 5 ; buf = 5
.text:42CFACAA                 lea     eax, [ebp+var_1FB0] ; push var_1FB0 onto the stack
.text:42CFACB0                 push    eax             ; int
.text:42CFACB1                 lea     ecx, [ebp+var_1FB4] ; push var_1FB4 onto stack
.text:42CFACB7                 push    ecx             ; int
.text:42CFACB8                 mov     edx, [ebp+var_1FAC] ; push var_1FAC onto stack
.text:42CFACBE                 push    edx             ; int
.text:42CFACBF                 mov     eax, [ebp+Str1] ; push @param Str1 onto stack
.text:42CFACC2                 push    eax             ; Str1
.text:42CFACC3                 call    sub_42CFB392    ; call this function
.text:42CFACC8                 add     esp, 10h
.text:42CFACCB                 test    eax, eax
.text:42CFACCD                 jnz     short loc_42CFACD1
.text:42CFACCF                 jmp     short loc_42CFAD07
.text:42CFACD1 ; ---------------------------------------------------------------------------
.text:42CFACD1
.text:42CFACD1 loc_42CFACD1:                           ; CODE XREF: sub_42CFAC6F+5E\u2191j
.text:42CFACD1                 mov     ecx, [ebp+buf]
.text:42CFACD7                 add     ecx, 1
.text:42CFACDA                 mov     [ebp+var_4], ecx
.text:42CFACDD                 mov     edx, [ebp+var_4]
.text:42CFACE0                 mov     ax, word ptr [ebp+var_1FB4]
.text:42CFACE7                 mov     [edx], ax
.text:42CFACEA                 push    1               ; int
.text:42CFACEC                 push    0               ; hostshort
.text:42CFACEE                 mov     ecx, [ebp+var_1FB4]
.text:42CFACF4                 add     ecx, 3
.text:42CFACF7                 push    ecx             ; len
.text:42CFACF8                 mov     edx, [ebp+buf]
.text:42CFACFE                 push    edx             ; buf
.text:42CFACFF                 call    sub_42CFA5C6
.text:42CFAD04                 add     esp, 10h
.text:42CFAD07
.text:42CFAD07 loc_42CFAD07:                           ; CODE XREF: sub_42CFAC6F+60\u2191j
.text:42CFAD07                 mov     esp, ebp
.text:42CFAD09                 pop     ebp
.text:42CFAD0A                 retn
.text:42CFAD0A sub_42CFAC6F    endp
.text:42CFAD0A
.text:42CFAD0B
.text:42CFAD0B ; =============== S U B R O U T I N E =======================================
.text:42CFAD0B
.text:42CFAD0B ; Attributes: bp-based frame
.text:42CFAD0B
.text:42CFAD0B sub_42CFAD0B    proc near               ; CODE XREF: sub_42CFB392+456\u2193p
.text:42CFAD0B
.text:42CFAD0B phkResult       = dword ptr -218h
.text:42CFAD0B Data            = byte ptr -214h
.text:42CFAD0B Str             = dword ptr -14h
.text:42CFAD0B var_10          = dword ptr -10h
.text:42CFAD0B cbData          = dword ptr -0Ch
.text:42CFAD0B Str1            = dword ptr -8
.text:42CFAD0B var_4           = dword ptr -4
.text:42CFAD0B arg_0           = dword ptr  8
.text:42CFAD0B arg_4           = dword ptr  0Ch
.text:42CFAD0B arg_8           = dword ptr  10h
.text:42CFAD0B
.text:42CFAD0B                 push    ebp
.text:42CFAD0C                 mov     ebp, esp
.text:42CFAD0E                 sub     esp, 218h
.text:42CFAD14                 mov     [ebp+cbData], 0
.text:42CFAD1B                 mov     [ebp+phkResult], 0
.text:42CFAD25                 mov     [ebp+var_10], 0
.text:42CFAD2C                 mov     [ebp+Str1], 0
.text:42CFAD33                 mov     [ebp+Str], 0
.text:42CFAD3A                 mov     [ebp+var_4], 0
.text:42CFAD41                 lea     eax, [ebp+phkResult]
.text:42CFAD47                 push    eax             ; phkResult
.text:42CFAD48                 push    0F003Fh         ; samDesired
.text:42CFAD4D                 push    0               ; ulOptions
.text:42CFAD4F                 push    offset aSoftwareMicros_12 ; "Software\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CFAD54                 push    80000002h       ; hKey
.text:42CFAD59                 call    ds:RegOpenKeyExA
.text:42CFAD5F                 test    eax, eax
.text:42CFAD61                 jz      short loc_42CFAD6A
.text:42CFAD63                 xor     eax, eax
.text:42CFAD65                 jmp     loc_42CFB38E
.text:42CFAD6A ; ---------------------------------------------------------------------------
.text:42CFAD6A
.text:42CFAD6A loc_42CFAD6A:                           ; CODE XREF: sub_42CFAD0B+56\u2191j
.text:42CFAD6A                 mov     [ebp+cbData], 200h
.text:42CFAD71                 lea     ecx, [ebp+cbData]
.text:42CFAD74                 push    ecx             ; lpcbData
.text:42CFAD75                 lea     edx, [ebp+Data]
.text:42CFAD7B                 push    edx             ; lpData
.text:42CFAD7C                 push    0               ; lpType
.text:42CFAD7E                 push    0               ; lpReserved
.text:42CFAD80                 push    offset aListenon_0 ; "ListenOn"
.text:42CFAD85                 mov     eax, [ebp+phkResult]
.text:42CFAD8B                 push    eax             ; hKey
.text:42CFAD8C                 call    ds:RegQueryValueExA
.text:42CFAD92                 test    eax, eax
.text:42CFAD94                 jz      short loc_42CFADAA
.text:42CFAD96                 mov     ecx, [ebp+phkResult]
.text:42CFAD9C                 push    ecx             ; hKey
.text:42CFAD9D                 call    ds:RegCloseKey
.text:42CFADA3                 xor     eax, eax
.text:42CFADA5                 jmp     loc_42CFB38E
.text:42CFADAA ; ---------------------------------------------------------------------------
.text:42CFADAA
.text:42CFADAA loc_42CFADAA:                           ; CODE XREF: sub_42CFAD0B+89\u2191j
.text:42CFADAA                 lea     edx, [ebp+Data]
.text:42CFADB0                 mov     [ebp+var_10], edx
.text:42CFADB3                 lea     eax, [ebp+Data]
.text:42CFADB9                 mov     [ebp+Str1], eax
.text:42CFADBC                 jmp     short loc_42CFADC4
.text:42CFADBE ; ---------------------------------------------------------------------------
.text:42CFADBE
.text:42CFADBE loc_42CFADBE:                           ; CODE XREF: sub_42CFAD0B+668\u2193j
.text:42CFADBE                                         ; sub_42CFAD0B:loc_42CFB37C\u2193j
.text:42CFADBE                 mov     ecx, [ebp+var_10]
.text:42CFADC1                 mov     [ebp+Str1], ecx
.text:42CFADC4
.text:42CFADC4 loc_42CFADC4:                           ; CODE XREF: sub_42CFAD0B+B1\u2191j
.text:42CFADC4                 push    offset byte_42D011F8 ; Str2
.text:42CFADC9                 mov     edx, [ebp+Str1]
.text:42CFADCC                 push    edx             ; Str1
.text:42CFADCD                 call    strcmp
.text:42CFADD2                 add     esp, 8
.text:42CFADD5                 test    eax, eax
.text:42CFADD7                 jz      loc_42CFB381
.text:42CFADDD                 mov     eax, [ebp+Str1]
.text:42CFADE0                 push    eax             ; Str
.text:42CFADE1                 call    strlen
.text:42CFADE6                 add     esp, 4
.text:42CFADE9                 mov     ecx, [ebp+var_10]
.text:42CFADEC                 lea     edx, [ecx+eax+1]
.text:42CFADF0                 mov     [ebp+var_10], edx
.text:42CFADF3                 mov     eax, [ebp+Str1]
.text:42CFADF6                 push    eax             ; String
.text:42CFADF7                 call    ds:_strlwr
.text:42CFADFD                 add     esp, 4
.text:42CFAE00                 push    offset aSsmsso70_1 ; "ssmsso70"
.text:42CFAE05                 mov     ecx, [ebp+Str1]
.text:42CFAE08                 push    ecx             ; Str
.text:42CFAE09                 call    ds:strstr
.text:42CFAE0F                 add     esp, 8
.text:42CFAE12                 test    eax, eax
.text:42CFAE14                 jnz     short loc_42CFAE30
.text:42CFAE16                 push    offset aSsmsso60_1 ; "ssmsso60"
.text:42CFAE1B                 mov     edx, [ebp+Str1]
.text:42CFAE1E                 push    edx             ; Str
.text:42CFAE1F                 call    ds:strstr
.text:42CFAE25                 add     esp, 8
.text:42CFAE28                 test    eax, eax
.text:42CFAE2A                 jz      loc_42CFAEC9
.text:42CFAE30
.text:42CFAE30 loc_42CFAE30:                           ; CODE XREF: sub_42CFAD0B+109\u2191j
.text:42CFAE30                 push    offset aTcp_2   ; "tcp;"
.text:42CFAE35                 mov     eax, [ebp+arg_4]
.text:42CFAE38                 mov     ecx, [ebp+arg_0]
.text:42CFAE3B                 add     ecx, [eax]
.text:42CFAE3D                 push    ecx             ; Buffer
.text:42CFAE3E                 call    ds:sprintf
.text:42CFAE44                 add     esp, 8
.text:42CFAE47                 mov     edx, [ebp+arg_4]
.text:42CFAE4A                 mov     eax, [ebp+arg_0]
.text:42CFAE4D                 add     eax, [edx]
.text:42CFAE4F                 push    eax             ; Str
.text:42CFAE50                 call    strlen
.text:42CFAE55                 add     esp, 4
.text:42CFAE58                 mov     ecx, [ebp+arg_4]
.text:42CFAE5B                 mov     edx, [ecx]
.text:42CFAE5D                 add     edx, eax
.text:42CFAE5F                 mov     eax, [ebp+arg_4]
.text:42CFAE62                 mov     [eax], edx
.text:42CFAE64                 push    offset asc_42D0092C ; ","
.text:42CFAE69                 mov     ecx, [ebp+Str1]
.text:42CFAE6C                 push    ecx             ; Str
.text:42CFAE6D                 call    ds:strcspn
.text:42CFAE73                 add     esp, 8
.text:42CFAE76                 mov     edx, [ebp+Str1]
.text:42CFAE79                 lea     eax, [edx+eax+1]
.text:42CFAE7D                 push    eax             ; char *
.text:42CFAE7E                 call    sub_42CF9C63
.text:42CFAE83                 add     esp, 4
.text:42CFAE86                 push    eax
.text:42CFAE87                 push    offset aD       ; "%d;"
.text:42CFAE8C                 mov     ecx, [ebp+arg_4]
.text:42CFAE8F                 mov     edx, [ebp+arg_0]
.text:42CFAE92                 add     edx, [ecx]
.text:42CFAE94                 push    edx             ; Buffer
.text:42CFAE95                 call    ds:sprintf
.text:42CFAE9B                 add     esp, 0Ch
.text:42CFAE9E                 mov     eax, [ebp+arg_4]
.text:42CFAEA1                 mov     ecx, [ebp+arg_0]
.text:42CFAEA4                 add     ecx, [eax]
.text:42CFAEA6                 push    ecx             ; Str
.text:42CFAEA7                 call    strlen
.text:42CFAEAC                 add     esp, 4
.text:42CFAEAF                 mov     edx, [ebp+arg_4]
.text:42CFAEB2                 mov     ecx, [edx]
.text:42CFAEB4                 add     ecx, eax
.text:42CFAEB6                 mov     edx, [ebp+arg_4]
.text:42CFAEB9                 mov     [edx], ecx
.text:42CFAEBB                 mov     eax, [ebp+var_4]
.text:42CFAEBE                 add     eax, 1
.text:42CFAEC1                 mov     [ebp+var_4], eax
.text:42CFAEC4                 jmp     loc_42CFB37C
.text:42CFAEC9 ; ---------------------------------------------------------------------------
.text:42CFAEC9
.text:42CFAEC9 loc_42CFAEC9:                           ; CODE XREF: sub_42CFAD0B+11F\u2191j
.text:42CFAEC9                 push    offset aSsnmpn70 ; "ssnmpn70"
.text:42CFAECE                 mov     ecx, [ebp+Str1]
.text:42CFAED1                 push    ecx             ; Str
.text:42CFAED2                 call    ds:strstr
.text:42CFAED8                 add     esp, 8
.text:42CFAEDB                 test    eax, eax
.text:42CFAEDD                 jnz     short loc_42CFAEF9
.text:42CFAEDF                 push    offset aSsnmpn60 ; "ssnmpn60"
.text:42CFAEE4                 mov     edx, [ebp+Str1]
.text:42CFAEE7                 push    edx             ; Str
.text:42CFAEE8                 call    ds:strstr
.text:42CFAEEE                 add     esp, 8
.text:42CFAEF1                 test    eax, eax
.text:42CFAEF3                 jz      loc_42CFAFE6
.text:42CFAEF9
.text:42CFAEF9 loc_42CFAEF9:                           ; CODE XREF: sub_42CFAD0B+1D2\u2191j
.text:42CFAEF9                 push    offset aNp_0    ; "np;"
.text:42CFAEFE                 mov     eax, [ebp+arg_4]
.text:42CFAF01                 mov     ecx, [ebp+arg_0]
.text:42CFAF04                 add     ecx, [eax]
.text:42CFAF06                 push    ecx             ; Buffer
.text:42CFAF07                 call    ds:sprintf
.text:42CFAF0D                 add     esp, 8
.text:42CFAF10                 mov     edx, [ebp+arg_4]
.text:42CFAF13                 mov     eax, [ebp+arg_0]
.text:42CFAF16                 add     eax, [edx]
.text:42CFAF18                 push    eax             ; Str
.text:42CFAF19                 call    strlen
.text:42CFAF1E                 add     esp, 4
.text:42CFAF21                 mov     ecx, [ebp+arg_4]
.text:42CFAF24                 mov     edx, [ecx]
.text:42CFAF26                 add     edx, eax
.text:42CFAF28                 mov     eax, [ebp+arg_4]
.text:42CFAF2B                 mov     [eax], edx
.text:42CFAF2D                 push    offset asc_42D00950 ; ","
.text:42CFAF32                 mov     ecx, [ebp+Str1]
.text:42CFAF35                 push    ecx             ; Str
.text:42CFAF36                 call    ds:strcspn
.text:42CFAF3C                 add     esp, 8
.text:42CFAF3F                 mov     edx, [ebp+Str1]
.text:42CFAF42                 lea     eax, [edx+eax+1]
.text:42CFAF46                 mov     [ebp+Str], eax
.text:42CFAF49                 push    offset asc_42D00954 ; "\\\\."
.text:42CFAF4E                 mov     ecx, [ebp+Str]
.text:42CFAF51                 push    ecx             ; Str
.text:42CFAF52                 call    ds:strstr
.text:42CFAF58                 add     esp, 8
.text:42CFAF5B                 test    eax, eax
.text:42CFAF5D                 jz      short loc_42CFAFA0
.text:42CFAF5F                 push    offset asc_42D00958 ; "\\\\."
.text:42CFAF64                 mov     edx, [ebp+Str]
.text:42CFAF67                 push    edx             ; String
.text:42CFAF68                 call    ds:strtok
.text:42CFAF6E                 add     esp, 8
.text:42CFAF71                 push    offset byte_42D011FC ; Delimiter
.text:42CFAF76                 push    0               ; String
.text:42CFAF78                 call    ds:strtok
.text:42CFAF7E                 add     esp, 8
.text:42CFAF81                 push    eax
.text:42CFAF82                 push    offset name
.text:42CFAF87                 push    offset aSPipeS  ; "\\\\%s\\pipe\\%s;"
.text:42CFAF8C                 mov     eax, [ebp+arg_4]
.text:42CFAF8F                 mov     ecx, [ebp+arg_0]
.text:42CFAF92                 add     ecx, [eax]
.text:42CFAF94                 push    ecx             ; Buffer
.text:42CFAF95                 call    ds:sprintf
.text:42CFAF9B                 add     esp, 10h
.text:42CFAF9E                 jmp     short loc_42CFAFBB
.text:42CFAFA0 ; ---------------------------------------------------------------------------
.text:42CFAFA0
.text:42CFAFA0 loc_42CFAFA0:                           ; CODE XREF: sub_42CFAD0B+252\u2191j
.text:42CFAFA0                 mov     edx, [ebp+Str]
.text:42CFAFA3                 push    edx
.text:42CFAFA4                 push    offset aS       ; "%s;"
.text:42CFAFA9                 mov     eax, [ebp+arg_4]
.text:42CFAFAC                 mov     ecx, [ebp+arg_0]
.text:42CFAFAF                 add     ecx, [eax]
.text:42CFAFB1                 push    ecx             ; Buffer
.text:42CFAFB2                 call    ds:sprintf
.text:42CFAFB8                 add     esp, 0Ch
.text:42CFAFBB
.text:42CFAFBB loc_42CFAFBB:                           ; CODE XREF: sub_42CFAD0B+293\u2191j
.text:42CFAFBB                 mov     edx, [ebp+arg_4]
.text:42CFAFBE                 mov     eax, [ebp+arg_0]
.text:42CFAFC1                 add     eax, [edx]
.text:42CFAFC3                 push    eax             ; Str
.text:42CFAFC4                 call    strlen
.text:42CFAFC9                 add     esp, 4
.text:42CFAFCC                 mov     ecx, [ebp+arg_4]
.text:42CFAFCF                 mov     edx, [ecx]
.text:42CFAFD1                 add     edx, eax
.text:42CFAFD3                 mov     eax, [ebp+arg_4]
.text:42CFAFD6                 mov     [eax], edx
.text:42CFAFD8                 mov     ecx, [ebp+var_4]
.text:42CFAFDB                 add     ecx, 1
.text:42CFAFDE                 mov     [ebp+var_4], ecx
.text:42CFAFE1                 jmp     loc_42CFB37C
.text:42CFAFE6 ; ---------------------------------------------------------------------------
.text:42CFAFE6
.text:42CFAFE6 loc_42CFAFE6:                           ; CODE XREF: sub_42CFAD0B+1E8\u2191j
.text:42CFAFE6                 push    offset aSsmsrp70 ; "ssmsrp70"
.text:42CFAFEB                 mov     edx, [ebp+Str1]
.text:42CFAFEE                 push    edx             ; Str
.text:42CFAFEF                 call    ds:strstr
.text:42CFAFF5                 add     esp, 8
.text:42CFAFF8                 test    eax, eax
.text:42CFAFFA                 jnz     short loc_42CFB012
.text:42CFAFFC                 push    offset aSsmsrp60 ; "ssmsrp60"
.text:42CFB001                 mov     eax, [ebp+Str1]
.text:42CFB004                 push    eax             ; Str
.text:42CFB005                 call    ds:strstr
.text:42CFB00B                 add     esp, 8
.text:42CFB00E                 test    eax, eax
.text:42CFB010                 jz      short loc_42CFB08D
.text:42CFB012
.text:42CFB012 loc_42CFB012:                           ; CODE XREF: sub_42CFAD0B+2EF\u2191j
.text:42CFB012                 push    offset aRpc_4   ; "rpc;"
.text:42CFB017                 mov     ecx, [ebp+arg_4]
.text:42CFB01A                 mov     edx, [ebp+arg_0]
.text:42CFB01D                 add     edx, [ecx]
.text:42CFB01F                 push    edx             ; Buffer
.text:42CFB020                 call    ds:sprintf
.text:42CFB026                 add     esp, 8
.text:42CFB029                 mov     eax, [ebp+arg_4]
.text:42CFB02C                 mov     ecx, [ebp+arg_0]
.text:42CFB02F                 add     ecx, [eax]
.text:42CFB031                 push    ecx             ; Str
.text:42CFB032                 call    strlen
.text:42CFB037                 add     esp, 4
.text:42CFB03A                 mov     edx, [ebp+arg_4]
.text:42CFB03D                 mov     ecx, [edx]
.text:42CFB03F                 add     ecx, eax
.text:42CFB041                 mov     edx, [ebp+arg_4]
.text:42CFB044                 mov     [edx], ecx
.text:42CFB046                 push    offset name
.text:42CFB04B                 push    offset aS_0     ; "%s;"
.text:42CFB050                 mov     eax, [ebp+arg_4]
.text:42CFB053                 mov     ecx, [ebp+arg_0]
.text:42CFB056                 add     ecx, [eax]
.text:42CFB058                 push    ecx             ; Buffer
.text:42CFB059                 call    ds:sprintf
.text:42CFB05F                 add     esp, 0Ch
.text:42CFB062                 mov     edx, [ebp+arg_4]
.text:42CFB065                 mov     eax, [ebp+arg_0]
.text:42CFB068                 add     eax, [edx]
.text:42CFB06A                 push    eax             ; Str
.text:42CFB06B                 call    strlen
.text:42CFB070                 add     esp, 4
.text:42CFB073                 mov     ecx, [ebp+arg_4]
.text:42CFB076                 mov     edx, [ecx]
.text:42CFB078                 add     edx, eax
.text:42CFB07A                 mov     eax, [ebp+arg_4]
.text:42CFB07D                 mov     [eax], edx
.text:42CFB07F                 mov     ecx, [ebp+var_4]
.text:42CFB082                 add     ecx, 1
.text:42CFB085                 mov     [ebp+var_4], ecx
.text:42CFB088                 jmp     loc_42CFB37C
.text:42CFB08D ; ---------------------------------------------------------------------------
.text:42CFB08D
.text:42CFB08D loc_42CFB08D:                           ; CODE XREF: sub_42CFAD0B+305\u2191j
.text:42CFB08D                 push    offset aSsmssp70 ; "ssmssp70"
.text:42CFB092                 mov     edx, [ebp+Str1]
.text:42CFB095                 push    edx             ; Str
.text:42CFB096                 call    ds:strstr
.text:42CFB09C                 add     esp, 8
.text:42CFB09F                 test    eax, eax
.text:42CFB0A1                 jnz     short loc_42CFB0BD
.text:42CFB0A3                 push    offset aSsmssp60 ; "ssmssp60"
.text:42CFB0A8                 mov     eax, [ebp+Str1]
.text:42CFB0AB                 push    eax             ; Str
.text:42CFB0AC                 call    ds:strstr
.text:42CFB0B2                 add     esp, 8
.text:42CFB0B5                 test    eax, eax
.text:42CFB0B7                 jz      loc_42CFB18C
.text:42CFB0BD
.text:42CFB0BD loc_42CFB0BD:                           ; CODE XREF: sub_42CFAD0B+396\u2191j
.text:42CFB0BD                 push    offset asc_42D009AC ; ","
.text:42CFB0C2                 mov     ecx, [ebp+Str1]
.text:42CFB0C5                 push    ecx             ; Str
.text:42CFB0C6                 call    ds:strcspn
.text:42CFB0CC                 add     esp, 8
.text:42CFB0CF                 mov     edx, [ebp+Str1]
.text:42CFB0D2                 lea     eax, [edx+eax+1]
.text:42CFB0D6                 mov     [ebp+Str], eax
.text:42CFB0D9                 push    offset asc_42D009B0 ; "-H"
.text:42CFB0DE                 mov     ecx, [ebp+Str]
.text:42CFB0E1                 push    ecx             ; Str
.text:42CFB0E2                 call    ds:strstr
.text:42CFB0E8                 add     esp, 8
.text:42CFB0EB                 test    eax, eax
.text:42CFB0ED                 jnz     loc_42CFB17E
.text:42CFB0F3                 push    offset aSpx_1   ; "spx;"
.text:42CFB0F8                 mov     edx, [ebp+arg_4]
.text:42CFB0FB                 mov     eax, [ebp+arg_0]
.text:42CFB0FE                 add     eax, [edx]
.text:42CFB100                 push    eax             ; Buffer
.text:42CFB101                 call    ds:sprintf
.text:42CFB107                 add     esp, 8
.text:42CFB10A                 mov     ecx, [ebp+arg_4]
.text:42CFB10D                 mov     edx, [ebp+arg_0]
.text:42CFB110                 add     edx, [ecx]
.text:42CFB112                 push    edx             ; Str
.text:42CFB113                 call    strlen
.text:42CFB118                 add     esp, 4
.text:42CFB11B                 mov     ecx, [ebp+arg_4]
.text:42CFB11E                 mov     edx, [ecx]
.text:42CFB120                 add     edx, eax
.text:42CFB122                 mov     eax, [ebp+arg_4]
.text:42CFB125                 mov     [eax], edx
.text:42CFB127                 push    offset asc_42D009BC ; ","
.text:42CFB12C                 mov     ecx, [ebp+Str]
.text:42CFB12F                 push    ecx             ; Str
.text:42CFB130                 call    ds:strcspn
.text:42CFB136                 add     esp, 8
.text:42CFB139                 mov     edx, [ebp+Str]
.text:42CFB13C                 lea     eax, [edx+eax+1]
.text:42CFB140                 push    eax             ; char *
.text:42CFB141                 call    sub_42CF9C63
.text:42CFB146                 add     esp, 4
.text:42CFB149                 push    eax
.text:42CFB14A                 push    offset aD_0     ; "%d;"
.text:42CFB14F                 mov     ecx, [ebp+arg_4]
.text:42CFB152                 mov     edx, [ebp+arg_0]
.text:42CFB155                 add     edx, [ecx]
.text:42CFB157                 push    edx             ; Buffer
.text:42CFB158                 call    ds:sprintf
.text:42CFB15E                 add     esp, 0Ch
.text:42CFB161                 mov     eax, [ebp+arg_4]
.text:42CFB164                 mov     ecx, [ebp+arg_0]
.text:42CFB167                 add     ecx, [eax]
.text:42CFB169                 push    ecx             ; Str
.text:42CFB16A                 call    strlen
.text:42CFB16F                 add     esp, 4
.text:42CFB172                 mov     edx, [ebp+arg_4]
.text:42CFB175                 mov     ecx, [edx]
.text:42CFB177                 add     ecx, eax
.text:42CFB179                 mov     edx, [ebp+arg_4]
.text:42CFB17C                 mov     [edx], ecx
.text:42CFB17E
.text:42CFB17E loc_42CFB17E:                           ; CODE XREF: sub_42CFAD0B+3E2\u2191j
.text:42CFB17E                 mov     eax, [ebp+var_4]
.text:42CFB181                 add     eax, 1
.text:42CFB184                 mov     [ebp+var_4], eax
.text:42CFB187                 jmp     loc_42CFB37C
.text:42CFB18C ; ---------------------------------------------------------------------------
.text:42CFB18C
.text:42CFB18C loc_42CFB18C:                           ; CODE XREF: sub_42CFAD0B+3AC\u2191j
.text:42CFB18C                 push    offset aSsmsad70 ; "ssmsad70"
.text:42CFB191                 mov     ecx, [ebp+Str1]
.text:42CFB194                 push    ecx             ; Str
.text:42CFB195                 call    ds:strstr
.text:42CFB19B                 add     esp, 8
.text:42CFB19E                 test    eax, eax
.text:42CFB1A0                 jnz     short loc_42CFB1BC
.text:42CFB1A2                 push    offset aSsmsad60 ; "ssmsad60"
.text:42CFB1A7                 mov     edx, [ebp+Str1]
.text:42CFB1AA                 push    edx             ; Str
.text:42CFB1AB                 call    ds:strstr
.text:42CFB1B1                 add     esp, 8
.text:42CFB1B4                 test    eax, eax
.text:42CFB1B6                 jz      loc_42CFB291
.text:42CFB1BC
.text:42CFB1BC loc_42CFB1BC:                           ; CODE XREF: sub_42CFAD0B+495\u2191j
.text:42CFB1BC                 push    offset aAdsp_5  ; "adsp;"
.text:42CFB1C1                 mov     eax, [ebp+arg_4]
.text:42CFB1C4                 mov     ecx, [ebp+arg_0]
.text:42CFB1C7                 add     ecx, [eax]
.text:42CFB1C9                 push    ecx             ; Buffer
.text:42CFB1CA                 call    ds:sprintf
.text:42CFB1D0                 add     esp, 8
.text:42CFB1D3                 mov     edx, [ebp+arg_4]
.text:42CFB1D6                 mov     eax, [ebp+arg_0]
.text:42CFB1D9                 add     eax, [edx]
.text:42CFB1DB                 push    eax             ; Str
.text:42CFB1DC                 call    strlen
.text:42CFB1E1                 add     esp, 4
.text:42CFB1E4                 mov     ecx, [ebp+arg_4]
.text:42CFB1E7                 mov     edx, [ecx]
.text:42CFB1E9                 add     edx, eax
.text:42CFB1EB                 mov     eax, [ebp+arg_4]
.text:42CFB1EE                 mov     [eax], edx
.text:42CFB1F0                 push    offset asc_42D009E4 ; ","
.text:42CFB1F5                 mov     ecx, [ebp+Str1]
.text:42CFB1F8                 push    ecx             ; Str
.text:42CFB1F9                 call    ds:strcspn
.text:42CFB1FF                 add     esp, 8
.text:42CFB202                 mov     edx, [ebp+Str1]
.text:42CFB205                 lea     eax, [edx+eax+1]
.text:42CFB209                 mov     [ebp+Str], eax
.text:42CFB20C                 push    40h ; '@'       ; Val
.text:42CFB20E                 mov     ecx, [ebp+Str]
.text:42CFB211                 push    ecx             ; Str
.text:42CFB212                 call    ds:strchr
.text:42CFB218                 add     esp, 8
.text:42CFB21B                 test    eax, eax
.text:42CFB21D                 jnz     short loc_42CFB23C
.text:42CFB21F                 mov     edx, [ebp+Str]
.text:42CFB222                 push    edx
.text:42CFB223                 push    offset aS_1     ; "%s;"
.text:42CFB228                 mov     eax, [ebp+arg_4]
.text:42CFB22B                 mov     ecx, [ebp+arg_0]
.text:42CFB22E                 add     ecx, [eax]
.text:42CFB230                 push    ecx             ; Buffer
.text:42CFB231                 call    ds:sprintf
.text:42CFB237                 add     esp, 0Ch
.text:42CFB23A                 jmp     short loc_42CFB266
.text:42CFB23C ; ---------------------------------------------------------------------------
.text:42CFB23C
.text:42CFB23C loc_42CFB23C:                           ; CODE XREF: sub_42CFAD0B+512\u2191j
.text:42CFB23C                 push    offset asc_42D009EC ; "@"
.text:42CFB241                 mov     edx, [ebp+Str]
.text:42CFB244                 push    edx             ; String
.text:42CFB245                 call    ds:strtok
.text:42CFB24B                 add     esp, 8
.text:42CFB24E                 push    eax
.text:42CFB24F                 push    offset aS_2     ; "%s;"
.text:42CFB254                 mov     eax, [ebp+arg_4]
.text:42CFB257                 mov     ecx, [ebp+arg_0]
.text:42CFB25A                 add     ecx, [eax]
.text:42CFB25C                 push    ecx             ; Buffer
.text:42CFB25D                 call    ds:sprintf
.text:42CFB263                 add     esp, 0Ch
.text:42CFB266
.text:42CFB266 loc_42CFB266:                           ; CODE XREF: sub_42CFAD0B+52F\u2191j
.text:42CFB266                 mov     edx, [ebp+arg_4]
.text:42CFB269                 mov     eax, [ebp+arg_0]
.text:42CFB26C                 add     eax, [edx]
.text:42CFB26E                 push    eax             ; Str
.text:42CFB26F                 call    strlen
.text:42CFB274                 add     esp, 4
.text:42CFB277                 mov     ecx, [ebp+arg_4]
.text:42CFB27A                 mov     edx, [ecx]
.text:42CFB27C                 add     edx, eax
.text:42CFB27E                 mov     eax, [ebp+arg_4]
.text:42CFB281                 mov     [eax], edx
.text:42CFB283                 mov     ecx, [ebp+var_4]
.text:42CFB286                 add     ecx, 1
.text:42CFB289                 mov     [ebp+var_4], ecx
.text:42CFB28C                 jmp     loc_42CFB37C
.text:42CFB291 ; ---------------------------------------------------------------------------
.text:42CFB291
.text:42CFB291 loc_42CFB291:                           ; CODE XREF: sub_42CFAD0B+4AB\u2191j
.text:42CFB291                 push    offset aSsmsvi70 ; "ssmsvi70"
.text:42CFB296                 mov     edx, [ebp+Str1]
.text:42CFB299                 push    edx             ; Str
.text:42CFB29A                 call    ds:strstr
.text:42CFB2A0                 add     esp, 8
.text:42CFB2A3                 test    eax, eax
.text:42CFB2A5                 jnz     short loc_42CFB2C1
.text:42CFB2A7                 push    offset aSsmsvi60 ; "ssmsvi60"
.text:42CFB2AC                 mov     eax, [ebp+Str1]
.text:42CFB2AF                 push    eax             ; Str
.text:42CFB2B0                 call    ds:strstr
.text:42CFB2B6                 add     esp, 8
.text:42CFB2B9                 test    eax, eax
.text:42CFB2BB                 jz      loc_42CFB354
.text:42CFB2C1
.text:42CFB2C1 loc_42CFB2C1:                           ; CODE XREF: sub_42CFAD0B+59A\u2191j
.text:42CFB2C1                 push    offset aBv_0    ; "bv;"
.text:42CFB2C6                 mov     ecx, [ebp+arg_4]
.text:42CFB2C9                 mov     edx, [ebp+arg_0]
.text:42CFB2CC                 add     edx, [ecx]
.text:42CFB2CE                 push    edx             ; Buffer
.text:42CFB2CF                 call    ds:sprintf
.text:42CFB2D5                 add     esp, 8
.text:42CFB2D8                 mov     eax, [ebp+arg_4]
.text:42CFB2DB                 mov     ecx, [ebp+arg_0]
.text:42CFB2DE                 add     ecx, [eax]
.text:42CFB2E0                 push    ecx             ; Str
.text:42CFB2E1                 call    strlen
.text:42CFB2E6                 add     esp, 4
.text:42CFB2E9                 mov     edx, [ebp+arg_4]
.text:42CFB2EC                 mov     ecx, [edx]
.text:42CFB2EE                 add     ecx, eax
.text:42CFB2F0                 mov     edx, [ebp+arg_4]
.text:42CFB2F3                 mov     [edx], ecx
.text:42CFB2F5                 push    offset asc_42D00A10 ; ","
.text:42CFB2FA                 mov     eax, [ebp+Str1]
.text:42CFB2FD                 push    eax             ; Str
.text:42CFB2FE                 call    ds:strcspn
.text:42CFB304                 add     esp, 8
.text:42CFB307                 mov     ecx, [ebp+Str1]
.text:42CFB30A                 lea     edx, [ecx+eax+1]
.text:42CFB30E                 mov     [ebp+Str], edx
.text:42CFB311                 mov     eax, [ebp+Str]
.text:42CFB314                 push    eax
.text:42CFB315                 push    offset aS_3     ; "%s;"
.text:42CFB31A                 mov     ecx, [ebp+arg_4]
.text:42CFB31D                 mov     edx, [ebp+arg_0]
.text:42CFB320                 add     edx, [ecx]
.text:42CFB322                 push    edx             ; Buffer
.text:42CFB323                 call    ds:sprintf
.text:42CFB329                 add     esp, 0Ch
.text:42CFB32C                 mov     eax, [ebp+arg_4]
.text:42CFB32F                 mov     ecx, [ebp+arg_0]
.text:42CFB332                 add     ecx, [eax]
.text:42CFB334                 push    ecx             ; Str
.text:42CFB335                 call    strlen
.text:42CFB33A                 add     esp, 4
.text:42CFB33D                 mov     edx, [ebp+arg_4]
.text:42CFB340                 mov     ecx, [edx]
.text:42CFB342                 add     ecx, eax
.text:42CFB344                 mov     edx, [ebp+arg_4]
.text:42CFB347                 mov     [edx], ecx
.text:42CFB349                 mov     eax, [ebp+var_4]
.text:42CFB34C                 add     eax, 1
.text:42CFB34F                 mov     [ebp+var_4], eax
.text:42CFB352                 jmp     short loc_42CFB37C
.text:42CFB354 ; ---------------------------------------------------------------------------
.text:42CFB354
.text:42CFB354 loc_42CFB354:                           ; CODE XREF: sub_42CFAD0B+5B0\u2191j
.text:42CFB354                 push    offset aSsmssh70 ; "ssmssh70"
.text:42CFB359                 mov     ecx, [ebp+Str1]
.text:42CFB35C                 push    ecx             ; Str
.text:42CFB35D                 call    ds:strstr
.text:42CFB363                 add     esp, 8
.text:42CFB366                 test    eax, eax
.text:42CFB368                 jz      short loc_42CFB378
.text:42CFB36A                 mov     edx, [ebp+var_4]
.text:42CFB36D                 add     edx, 1
.text:42CFB370                 mov     [ebp+var_4], edx
.text:42CFB373                 jmp     loc_42CFADBE
.text:42CFB378 ; ---------------------------------------------------------------------------
.text:42CFB378
.text:42CFB378 loc_42CFB378:                           ; CODE XREF: sub_42CFAD0B+65D\u2191j
.text:42CFB378                 xor     eax, eax
.text:42CFB37A                 jmp     short loc_42CFB38E
.text:42CFB37C ; ---------------------------------------------------------------------------
.text:42CFB37C
.text:42CFB37C loc_42CFB37C:                           ; CODE XREF: sub_42CFAD0B+1B9\u2191j
.text:42CFB37C                                         ; sub_42CFAD0B+2D6\u2191j ...
.text:42CFB37C                 jmp     loc_42CFADBE
.text:42CFB381 ; ---------------------------------------------------------------------------
.text:42CFB381
.text:42CFB381 loc_42CFB381:                           ; CODE XREF: sub_42CFAD0B+CC\u2191j
.text:42CFB381                 mov     eax, [ebp+arg_8]
.text:42CFB384                 mov     ecx, [ebp+var_4]
.text:42CFB387                 mov     [eax], ecx
.text:42CFB389                 mov     eax, 1
.text:42CFB38E
.text:42CFB38E loc_42CFB38E:                           ; CODE XREF: sub_42CFAD0B+5A\u2191j
.text:42CFB38E                                         ; sub_42CFAD0B+9A\u2191j ...
.text:42CFB38E                 mov     esp, ebp
.text:42CFB390                 pop     ebp
.text:42CFB391                 retn
.text:42CFB391 sub_42CFAD0B    endp
.text:42CFB391
.text:42CFB392
.text:42CFB392 ; =============== S U B R O U T I N E =======================================
.text:42CFB392
.text:42CFB392 ; Attributes: bp-based frame
.text:42CFB392
.text:42CFB392 ; int __cdecl sub_42CFB392(char *Str1, int, int, int)
.text:42CFB392 sub_42CFB392    proc near               ; CODE XREF: sub_42CFAC6F+54\u2191p
.text:42CFB392
.text:42CFB392 var_2914        = dword ptr -2914h
.text:42CFB392 var_2910        = dword ptr -2910h
.text:42CFB392 var_290C        = dword ptr -290Ch
.text:42CFB392 var_2908        = dword ptr -2908h
.text:42CFB392 Destination     = byte ptr -2904h
.text:42CFB392 var_2704        = byte ptr -2704h
.text:42CFB392 lpData          = dword ptr -2504h
.text:42CFB392 phkResult       = dword ptr -2500h
.text:42CFB392 var_24FC        = byte ptr -24FCh
.text:42CFB392 String1         = dword ptr -24C8h
.text:42CFB392 var_24C4        = dword ptr -24C4h
.text:42CFB392 var_24C0        = byte ptr -24C0h
.text:42CFB392 var_520         = dword ptr -520h
.text:42CFB392 var_51C         = dword ptr -51Ch
.text:42CFB392 var_518         = dword ptr -518h
.text:42CFB392 var_514         = dword ptr -514h
.text:42CFB392 var_510         = byte ptr -510h
.text:42CFB392 var_50D         = byte ptr -50Dh
.text:42CFB392 var_504         = byte ptr -504h
.text:42CFB392 Data            = byte ptr -310h
.text:42CFB392 var_290         = dword ptr -290h
.text:42CFB392 var_28C         = byte ptr -28Ch
.text:42CFB392 Str             = dword ptr -8Ch
.text:42CFB392 cbData          = dword ptr -88h
.text:42CFB392 Buffer          = byte ptr -84h
.text:42CFB392 var_4           = dword ptr -4
.text:42CFB392 Str1            = dword ptr  8
.text:42CFB392 arg_4           = dword ptr  0Ch
.text:42CFB392 arg_8           = dword ptr  10h
.text:42CFB392 arg_C           = dword ptr  14h
.text:42CFB392
.text:42CFB392                 push    ebp             ; Save the old frame pointer
.text:42CFB393                 mov     ebp, esp        ; Make current stack pointer the new frame pointer
.text:42CFB395                 mov     eax, 2914h      ; Space allocated for local variables
.text:42CFB39A                 call    __alloca_probe
.text:42CFB39F                 mov     [ebp+phkResult], 0 ; initialize local variable to 0
.text:42CFB3A9                 mov     [ebp+lpData], 0 ; initialize local variable to 0
.text:42CFB3B3                 mov     [ebp+cbData], 0 ; initialize local variable to 0
.text:42CFB3BD                 mov     [ebp+var_24C4], 0 ; initialize local variable to 0
.text:42CFB3C7                 mov     [ebp+var_290], 0 ; initialize local variable to 0
.text:42CFB3D1                 mov     [ebp+var_518], 0 ; initialize local variable to 0
.text:42CFB3DB                 mov     eax, [ebp+arg_8] ; eax = 0 (from param)
.text:42CFB3DE                 mov     dword ptr [eax], 0 ; set eax to 0
.text:42CFB3E4                 mov     ecx, [ebp+arg_C] ; ecx = arg_c from param
.text:42CFB3E7                 mov     dword ptr [ecx], 0 ; argc = 0
.text:42CFB3ED                 cmp     [ebp+Str1], 0   ; null string in param?
.text:42CFB3F1                 jz      short loc_42CFB40C ; yes so jump here
.text:42CFB3F3                 push    offset byte_42D01200 ; Str2
.text:42CFB3F8                 mov     edx, [ebp+Str1] ; push str1 onto stack
.text:42CFB3FB                 push    edx             ; Str1
.text:42CFB3FC                 call    strcmp          ; strcmp(str1 , str2)
.text:42CFB401                 add     esp, 8          ; remove var_2914 and var_2910 from stack
.text:42CFB404                 test    eax, eax        ; check return value of strcmp
.text:42CFB406                 jnz     loc_42CFB4CC    ; strings are not the same so jump here
.text:42CFB40C
.text:42CFB40C loc_42CFB40C:                           ; CODE XREF: sub_42CFB392+5F\u2191j
.text:42CFB40C                 lea     eax, [ebp+phkResult]
.text:42CFB412                 push    eax             ; phkResult
.text:42CFB413                 push    20019h          ; samDesired
.text:42CFB418                 push    0               ; ulOptions
.text:42CFB41A                 push    offset aSoftwareMicros_13 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFB41F                 push    80000002h       ; hKey
.text:42CFB424                 call    ds:RegOpenKeyExA
.text:42CFB42A                 mov     [ebp+var_518], eax
.text:42CFB430                 cmp     [ebp+var_518], 0
.text:42CFB437                 jz      short loc_42CFB43E
.text:42CFB439                 jmp     loc_42CFC13B
.text:42CFB43E ; ---------------------------------------------------------------------------
.text:42CFB43E
.text:42CFB43E loc_42CFB43E:                           ; CODE XREF: sub_42CFB392+A5\u2191j
.text:42CFB43E                 lea     ecx, [ebp+cbData]
.text:42CFB444                 push    ecx             ; lpcbData
.text:42CFB445                 push    0               ; lpData
.text:42CFB447                 push    0               ; lpType
.text:42CFB449                 push    0               ; lpReserved
.text:42CFB44B                 push    offset aInstalledinsta_1 ; "InstalledInstances"
.text:42CFB450                 mov     edx, [ebp+phkResult]
.text:42CFB456                 push    edx             ; hKey
.text:42CFB457                 call    ds:RegQueryValueExA
.text:42CFB45D                 push    1               ; Size
.text:42CFB45F                 mov     eax, [ebp+cbData]
.text:42CFB465                 add     eax, 2
.text:42CFB468                 push    eax             ; Count
.text:42CFB469                 call    ds:calloc
.text:42CFB46F                 add     esp, 8
.text:42CFB472                 mov     [ebp+lpData], eax
.text:42CFB478                 cmp     [ebp+lpData], 0
.text:42CFB47F                 jnz     short loc_42CFB486
.text:42CFB481                 jmp     loc_42CFC13B
.text:42CFB486 ; ---------------------------------------------------------------------------
.text:42CFB486
.text:42CFB486 loc_42CFB486:                           ; CODE XREF: sub_42CFB392+ED\u2191j
.text:42CFB486                 lea     ecx, [ebp+cbData]
.text:42CFB48C                 push    ecx             ; lpcbData
.text:42CFB48D                 mov     edx, [ebp+lpData]
.text:42CFB493                 push    edx             ; lpData
.text:42CFB494                 push    0               ; lpType
.text:42CFB496                 push    0               ; lpReserved
.text:42CFB498                 push    offset aInstalledinsta_2 ; "InstalledInstances"
.text:42CFB49D                 mov     eax, [ebp+phkResult]
.text:42CFB4A3                 push    eax             ; hKey
.text:42CFB4A4                 call    ds:RegQueryValueExA
.text:42CFB4AA                 cmp     [ebp+phkResult], 0
.text:42CFB4B1                 jz      short loc_42CFB4CA
.text:42CFB4B3                 mov     ecx, [ebp+phkResult]
.text:42CFB4B9                 push    ecx             ; hKey
.text:42CFB4BA                 call    ds:RegCloseKey
.text:42CFB4C0                 mov     [ebp+phkResult], 0
.text:42CFB4CA
.text:42CFB4CA loc_42CFB4CA:                           ; CODE XREF: sub_42CFB392+11F\u2191j
.text:42CFB4CA                 jmp     short loc_42CFB50E
.text:42CFB4CC ; ---------------------------------------------------------------------------
.text:42CFB4CC
.text:42CFB4CC loc_42CFB4CC:                           ; CODE XREF: sub_42CFB392+74\u2191j
.text:42CFB4CC                 push    1               ; Size
.text:42CFB4CE                 mov     edx, [ebp+Str1] ; edx = str1
.text:42CFB4D1                 push    edx             ; Str
.text:42CFB4D2                 call    strlen          ; strlen(str1)
.text:42CFB4D7                 add     esp, 4          ; remove str1 from the stack
.text:42CFB4DA                 add     eax, 2          ; length of str1 + 2
.text:42CFB4DD                 push    eax             ; Count
.text:42CFB4DE                 call    ds:calloc       ; calloc((length of str1 + 2), 1)
.text:42CFB4E4                 add     esp, 8          ; remove count and size from the stack
.text:42CFB4E7                 mov     [ebp+lpData], eax ; lpdata contains the pointer of where the calloc was assigned
.text:42CFB4ED                 cmp     [ebp+lpData], 0 ; lpdata null?
.text:42CFB4F4                 jnz     short loc_42CFB4FB ; no that means calloc was successful so jump here
.text:42CFB4F6                 jmp     loc_42CFC13B    ; calloc failed
.text:42CFB4FB ; ---------------------------------------------------------------------------
.text:42CFB4FB
.text:42CFB4FB loc_42CFB4FB:                           ; CODE XREF: sub_42CFB392+162\u2191j
.text:42CFB4FB                 mov     eax, [ebp+Str1] ; eax = str1
.text:42CFB4FE                 push    eax             ; Source
.text:42CFB4FF                 mov     ecx, [ebp+lpData] ; ecx = lpdata
.text:42CFB505                 push    ecx             ; Destination
.text:42CFB506                 call    strcpy          ; strcpy(lpdata, str1)
.text:42CFB50B                 add     esp, 8          ; remove source and destination from the stack
.text:42CFB50E
.text:42CFB50E loc_42CFB50E:                           ; CODE XREF: sub_42CFB392:loc_42CFB4CA\u2191j
.text:42CFB50E                 mov     edx, [ebp+lpData] ; edx = lpdata
.text:42CFB514                 mov     [ebp+String1], edx ; string1 = lpdata
.text:42CFB51A
.text:42CFB51A loc_42CFB51A:                           ; CODE XREF: sub_42CFB392+2A5\u2193j
.text:42CFB51A                                         ; sub_42CFB392:loc_42CFC102\u2193j
.text:42CFB51A                 push    offset byte_42D01204 ; Str2
.text:42CFB51F                 mov     eax, [ebp+String1] ; eax = String1
.text:42CFB525                 push    eax             ; Str1
.text:42CFB526                 call    strcmp          ; strcmp(String1 , byte_42D01204)
.text:42CFB52B                 add     esp, 8          ; remove str1 and str 2 from the stack
.text:42CFB52E                 test    eax, eax        ; str1 = str2?
.text:42CFB530                 jz      loc_42CFC107    ; yes so jump here
.text:42CFB536                 mov     [ebp+var_2908], 0 ; var_2908 = 0
.text:42CFB540                 mov     ecx, [ebp+arg_8] ; ecx = arg_8
.text:42CFB543                 mov     edx, [ecx]      ; edx = *arg_8
.text:42CFB545                 mov     [ebp+var_290C], edx ; var_290C = *arg_8
.text:42CFB54B                 push    offset aMssqlserver_7 ; "MSSQLServer"
.text:42CFB550                 mov     eax, [ebp+String1] ; eax = string1
.text:42CFB556                 push    eax             ; String1
.text:42CFB557                 call    ds:_stricmp     ; stricmp(string1,aMssqlserver_7)
.text:42CFB55D                 add     esp, 8          ; remove str1 and aMssqlserver_7 from the stack
.text:42CFB560                 test    eax, eax        ; are they the same string?
.text:42CFB562                 jnz     short loc_42CFB58E ; no jump here
.text:42CFB564                 push    offset aSoftwareMicros_14 ; "SOFTWARE\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CFB569                 lea     ecx, [ebp+Destination]
.text:42CFB56F                 push    ecx             ; Destination
.text:42CFB570                 call    strcpy
.text:42CFB575                 add     esp, 8
.text:42CFB578                 push    offset aSoftwareMicros_15 ; "Software\\Microsoft\\MSSQLServer\\MSSQL"...
.text:42CFB57D                 lea     edx, [ebp+Buffer]
.text:42CFB583                 push    edx             ; Destination
.text:42CFB584                 call    strcpy
.text:42CFB589                 add     esp, 8
.text:42CFB58C                 jmp     short loc_42CFB5D0
.text:42CFB58E ; ---------------------------------------------------------------------------
.text:42CFB58E
.text:42CFB58E loc_42CFB58E:                           ; CODE XREF: sub_42CFB392+1D0\u2191j
.text:42CFB58E                 mov     eax, [ebp+String1] ; eax = string1
.text:42CFB594                 push    eax             ; push String1 onto stack
.text:42CFB595                 push    offset aSoftwareMicros_16 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFB59A                 push    offset aSSMssqlserverS_0 ; "%s%s\\MSSQLServer\\SuperSocketNetLib\\"
.text:42CFB59F                 lea     ecx, [ebp+Destination] ; ecx = &Destination
.text:42CFB5A5                 push    ecx             ; Buffer
.text:42CFB5A6                 call    ds:sprintf      ; sprintf()
.text:42CFB5AC                 add     esp, 10h        ; remove sprintf arguements from the stack
.text:42CFB5AF                 mov     edx, [ebp+String1] ; edx = String1
.text:42CFB5B5                 push    edx             ; push string1 onto the stack
.text:42CFB5B6                 push    offset aSoftwareMicros_17 ; "SOFTWARE\\Microsoft\\Microsoft SQL Serv"...
.text:42CFB5BB                 push    offset aSSMssqlserverC ; "%s%s\\MSSQLServer\\CurrentVersion"
.text:42CFB5C0                 lea     eax, [ebp+Buffer] ; eax = &buffer
.text:42CFB5C6                 push    eax             ; Buffer
.text:42CFB5C7                 call    ds:sprintf      ; Stack smash
.text:42CFB5CD                 add     esp, 10h        ; Remove sprintf arguments from the stack
.text:42CFB5D0
.text:42CFB5D0 loc_42CFB5D0:                           ; CODE XREF: sub_42CFB392+1FA\u2191j
.text:42CFB5D0                 lea     ecx, [ebp+phkResult]
.text:42CFB5D6                 push    ecx             ; phkResult
.text:42CFB5D7                 push    20019h          ; samDesired
.text:42CFB5DC                 push    0               ; ulOptions
.text:42CFB5DE                 lea     edx, [ebp+Buffer]
.text:42CFB5E4                 push    edx             ; lpSubKey
.text:42CFB5E5                 push    80000002h       ; hKey
.text:42CFB5EA                 call    ds:RegOpenKeyExA
.text:42CFB5F0                 mov     [ebp+var_518], eax
.text:42CFB5F6                 cmp     [ebp+var_518], 0
.text:42CFB5FD                 jz      short loc_42CFB641
.text:42CFB5FF                 push    offset aMssqlserver_8 ; "MSSQLServer"
.text:42CFB604                 mov     eax, [ebp+String1]
.text:42CFB60A                 push    eax             ; String1
.text:42CFB60B                 call    ds:_stricmp
.text:42CFB611                 add     esp, 8
.text:42CFB614                 test    eax, eax
.text:42CFB616                 jnz     short loc_42CFB63C
.text:42CFB618                 mov     ecx, [ebp+String1]
.text:42CFB61E                 push    ecx             ; Str
.text:42CFB61F                 call    strlen
.text:42CFB624                 add     esp, 4
.text:42CFB627                 mov     edx, [ebp+String1]
.text:42CFB62D                 lea     eax, [edx+eax+1]
.text:42CFB631                 mov     [ebp+String1], eax
.text:42CFB637                 jmp     loc_42CFB51A
.text:42CFB63C ; ---------------------------------------------------------------------------
.text:42CFB63C
.text:42CFB63C loc_42CFB63C:                           ; CODE XREF: sub_42CFB392+284\u2191j
.text:42CFB63C                 jmp     loc_42CFC13B
.text:42CFB641 ; ---------------------------------------------------------------------------
.text:42CFB641
.text:42CFB641 loc_42CFB641:                           ; CODE XREF: sub_42CFB392+26B\u2191j
.text:42CFB641                 mov     [ebp+cbData], 80h ; '€'
.text:42CFB64B                 lea     ecx, [ebp+cbData]
.text:42CFB651                 push    ecx             ; lpcbData
.text:42CFB652                 lea     edx, [ebp+Data]
.text:42CFB658                 push    edx             ; lpData
.text:42CFB659                 push    0               ; lpType
.text:42CFB65B                 push    0               ; lpReserved
.text:42CFB65D                 push    offset aCurrentversion_0 ; "CurrentVersion"
.text:42CFB662                 mov     eax, [ebp+phkResult]
.text:42CFB668                 push    eax             ; hKey
.text:42CFB669                 call    ds:RegQueryValueExA
.text:42CFB66F                 test    eax, eax
.text:42CFB671                 jz      short loc_42CFB678
.text:42CFB673                 jmp     loc_42CFC13B
.text:42CFB678 ; ---------------------------------------------------------------------------
.text:42CFB678
.text:42CFB678 loc_42CFB678:                           ; CODE XREF: sub_42CFB392+2DF\u2191j
.text:42CFB678                 mov     ecx, [ebp+phkResult]
.text:42CFB67E                 push    ecx             ; hKey
.text:42CFB67F                 call    ds:RegCloseKey
.text:42CFB685                 mov     [ebp+phkResult], 0
.text:42CFB68F                 lea     edx, [ebp+var_2704]
.text:42CFB695                 push    edx             ; lpData
.text:42CFB696                 mov     eax, [ebp+String1]
.text:42CFB69C                 push    eax             ; Str1
.text:42CFB69D                 call    sub_42CF9D87
.text:42CFB6A2                 add     esp, 8
.text:42CFB6A5                 mov     [ebp+var_51C], eax
.text:42CFB6AB                 cmp     [ebp+var_51C], 1
.text:42CFB6B2                 jnz     short loc_42CFB6DB
.text:42CFB6B4                 mov     ecx, [ebp+String1]
.text:42CFB6BA                 push    ecx
.text:42CFB6BB                 lea     edx, [ebp+var_2704]
.text:42CFB6C1                 push    edx
.text:42CFB6C2                 push    offset aServernameSIns ; "ServerName;%s;InstanceName;%s;IsCluster"...
.text:42CFB6C7                 mov     eax, [ebp+arg_8]
.text:42CFB6CA                 mov     ecx, [ebp+arg_4]
.text:42CFB6CD                 add     ecx, [eax]
.text:42CFB6CF                 push    ecx             ; Buffer
.text:42CFB6D0                 call    ds:sprintf
.text:42CFB6D6                 add     esp, 10h
.text:42CFB6D9                 jmp     short loc_42CFB6FE
.text:42CFB6DB ; ---------------------------------------------------------------------------
.text:42CFB6DB
.text:42CFB6DB loc_42CFB6DB:                           ; CODE XREF: sub_42CFB392+320\u2191j
.text:42CFB6DB                 mov     edx, [ebp+String1]
.text:42CFB6E1                 push    edx
.text:42CFB6E2                 push    offset name
.text:42CFB6E7                 push    offset aServernameSIns_0 ; "ServerName;%s;InstanceName;%s;IsCluster"...
.text:42CFB6EC                 mov     eax, [ebp+arg_8]
.text:42CFB6EF                 mov     ecx, [ebp+arg_4]
.text:42CFB6F2                 add     ecx, [eax]
.text:42CFB6F4                 push    ecx             ; Buffer
.text:42CFB6F5                 call    ds:sprintf
.text:42CFB6FB                 add     esp, 10h
.text:42CFB6FE
.text:42CFB6FE loc_42CFB6FE:                           ; CODE XREF: sub_42CFB392+347\u2191j
.text:42CFB6FE                 mov     edx, [ebp+arg_8]
.text:42CFB701                 mov     eax, [ebp+arg_4]
.text:42CFB704                 add     eax, [edx]
.text:42CFB706                 push    eax             ; Str
.text:42CFB707                 call    strlen
.text:42CFB70C                 add     esp, 4
.text:42CFB70F                 mov     ecx, [ebp+arg_8]
.text:42CFB712                 mov     edx, [ecx]
.text:42CFB714                 add     edx, eax
.text:42CFB716                 mov     eax, [ebp+arg_8]
.text:42CFB719                 mov     [eax], edx
.text:42CFB71B                 lea     ecx, [ebp+Data]
.text:42CFB721                 push    ecx
.text:42CFB722                 push    offset aVersionS ; "Version;%s;"
.text:42CFB727                 mov     edx, [ebp+arg_8]
.text:42CFB72A                 mov     eax, [ebp+arg_4]
.text:42CFB72D                 add     eax, [edx]
.text:42CFB72F                 push    eax             ; Buffer
.text:42CFB730                 call    ds:sprintf
.text:42CFB736                 add     esp, 0Ch
.text:42CFB739                 mov     ecx, [ebp+arg_8]
.text:42CFB73C                 mov     edx, [ebp+arg_4]
.text:42CFB73F                 add     edx, [ecx]
.text:42CFB741                 push    edx             ; Str
.text:42CFB742                 call    strlen
.text:42CFB747                 add     esp, 4
.text:42CFB74A                 mov     ecx, [ebp+arg_8]
.text:42CFB74D                 mov     edx, [ecx]
.text:42CFB74F                 add     edx, eax
.text:42CFB751                 mov     eax, [ebp+arg_8]
.text:42CFB754                 mov     [eax], edx
.text:42CFB756                 push    offset asc_42D00C24 ; "."
.text:42CFB75B                 lea     ecx, [ebp+Data]
.text:42CFB761                 push    ecx             ; String
.text:42CFB762                 call    ds:strtok
.text:42CFB768                 add     esp, 8
.text:42CFB76B                 push    eax             ; String
.text:42CFB76C                 call    ds:atoi
.text:42CFB772                 add     esp, 4
.text:42CFB775                 mov     [ebp+var_4], eax
.text:42CFB778                 push    offset asc_42D00C28 ; "."
.text:42CFB77D                 push    0               ; String
.text:42CFB77F                 call    ds:strtok
.text:42CFB785                 add     esp, 8
.text:42CFB788                 push    eax             ; String
.text:42CFB789                 call    ds:atoi
.text:42CFB78F                 add     esp, 4
.text:42CFB792                 mov     [ebp+var_520], eax
.text:42CFB798                 cmp     [ebp+var_4], 7
.text:42CFB79C                 jl      short loc_42CFB7AD
.text:42CFB79E                 cmp     [ebp+var_4], 7
.text:42CFB7A2                 jnz     short loc_42CFB7B7
.text:42CFB7A4                 cmp     [ebp+var_520], 5
.text:42CFB7AB                 jge     short loc_42CFB7B7
.text:42CFB7AD
.text:42CFB7AD loc_42CFB7AD:                           ; CODE XREF: sub_42CFB392+40A\u2191j
.text:42CFB7AD                 mov     [ebp+var_290], 1
.text:42CFB7B7
.text:42CFB7B7 loc_42CFB7B7:                           ; CODE XREF: sub_42CFB392+410\u2191j
.text:42CFB7B7                                         ; sub_42CFB392+419\u2191j
.text:42CFB7B7                 push    offset aMssqlserver_9 ; "MSSQLServer"
.text:42CFB7BC                 mov     edx, [ebp+String1]
.text:42CFB7C2                 push    edx             ; String1
.text:42CFB7C3                 call    ds:_stricmp
.text:42CFB7C9                 add     esp, 8
.text:42CFB7CC                 test    eax, eax
.text:42CFB7CE                 jnz     short loc_42CFB7FE
.text:42CFB7D0                 cmp     [ebp+var_290], 0
.text:42CFB7D7                 jz      short loc_42CFB7FE
.text:42CFB7D9                 lea     eax, [ebp+var_2908]
.text:42CFB7DF                 push    eax
.text:42CFB7E0                 mov     ecx, [ebp+arg_8]
.text:42CFB7E3                 push    ecx
.text:42CFB7E4                 mov     edx, [ebp+arg_4]
.text:42CFB7E7                 push    edx
.text:42CFB7E8                 call    sub_42CFAD0B
.text:42CFB7ED                 add     esp, 0Ch
.text:42CFB7F0                 test    eax, eax
.text:42CFB7F2                 jnz     short loc_42CFB7F9
.text:42CFB7F4                 jmp     loc_42CFC13B
.text:42CFB7F9 ; ---------------------------------------------------------------------------
.text:42CFB7F9
.text:42CFB7F9 loc_42CFB7F9:                           ; CODE XREF: sub_42CFB392+460\u2191j
.text:42CFB7F9                 jmp     loc_42CFC0AB
.text:42CFB7FE ; ---------------------------------------------------------------------------
.text:42CFB7FE
.text:42CFB7FE loc_42CFB7FE:                           ; CODE XREF: sub_42CFB392+43C\u2191j
.text:42CFB7FE                                         ; sub_42CFB392+445\u2191j
.text:42CFB7FE                 mov     [ebp+phkResult], 0
.text:42CFB808                 lea     eax, [ebp+phkResult]
.text:42CFB80E                 push    eax             ; phkResult
.text:42CFB80F                 push    20019h          ; samDesired
.text:42CFB814                 push    0               ; ulOptions
.text:42CFB816                 lea     ecx, [ebp+Destination]
.text:42CFB81C                 push    ecx             ; lpSubKey
.text:42CFB81D                 push    80000002h       ; hKey
.text:42CFB822                 call    ds:RegOpenKeyExA
.text:42CFB828                 mov     [ebp+var_518], eax
.text:42CFB82E                 cmp     [ebp+var_518], 0
.text:42CFB835                 jz      short loc_42CFB83C
.text:42CFB837                 jmp     loc_42CFC13B
.text:42CFB83C ; ---------------------------------------------------------------------------
.text:42CFB83C
.text:42CFB83C loc_42CFB83C:                           ; CODE XREF: sub_42CFB392+4A3\u2191j
.text:42CFB83C                 mov     [ebp+var_514], 32h ; '2'
.text:42CFB846                 lea     edx, [ebp+var_514]
.text:42CFB84C                 push    edx             ; lpcbData
.text:42CFB84D                 lea     eax, [ebp+var_24FC]
.text:42CFB853                 push    eax             ; lpData
.text:42CFB854                 push    0               ; lpType
.text:42CFB856                 push    0               ; lpReserved
.text:42CFB858                 push    offset aProtocollist_0 ; "ProtocolList"
.text:42CFB85D                 mov     ecx, [ebp+phkResult]
.text:42CFB863                 push    ecx             ; hKey
.text:42CFB864                 call    ds:RegQueryValueExA
.text:42CFB86A                 test    eax, eax
.text:42CFB86C                 jz      short loc_42CFB873
.text:42CFB86E                 jmp     loc_42CFC13B
.text:42CFB873 ; ---------------------------------------------------------------------------
.text:42CFB873
.text:42CFB873 loc_42CFB873:                           ; CODE XREF: sub_42CFB392+4DA\u2191j
.text:42CFB873                 mov     edx, [ebp+phkResult]
.text:42CFB879                 push    edx             ; hKey
.text:42CFB87A                 call    ds:RegCloseKey
.text:42CFB880                 mov     [ebp+phkResult], 0
.text:42CFB88A                 lea     eax, [ebp+Destination]
.text:42CFB890                 push    eax             ; Source
.text:42CFB891                 lea     ecx, [ebp+var_28C]
.text:42CFB897                 push    ecx             ; Destination
.text:42CFB898                 call    strcpy
.text:42CFB89D                 add     esp, 8
.text:42CFB8A0                 lea     edx, [ebp+var_24FC]
.text:42CFB8A6                 mov     [ebp+Str], edx
.text:42CFB8AC                 jmp     short loc_42CFB8B8
.text:42CFB8AE ; ---------------------------------------------------------------------------
.text:42CFB8AE
.text:42CFB8AE loc_42CFB8AE:                           ; CODE XREF: sub_42CFB392+57A\u2193j
.text:42CFB8AE                                         ; sub_42CFB392+D14\u2193j
.text:42CFB8AE                 mov     [ebp+cbData], 100h
.text:42CFB8B8
.text:42CFB8B8 loc_42CFB8B8:                           ; CODE XREF: sub_42CFB392+51A\u2191j
.text:42CFB8B8                 push    offset byte_42D01208 ; Str2
.text:42CFB8BD                 mov     eax, [ebp+Str]
.text:42CFB8C3                 push    eax             ; Str1
.text:42CFB8C4                 call    strcmp
.text:42CFB8C9                 add     esp, 8
.text:42CFB8CC                 test    eax, eax
.text:42CFB8CE                 jz      loc_42CFC0AB
.text:42CFB8D4                 push    offset aWsp     ; "wsp"
.text:42CFB8D9                 mov     ecx, [ebp+Str]
.text:42CFB8DF                 push    ecx             ; String1
.text:42CFB8E0                 call    ds:_stricmp
.text:42CFB8E6                 add     esp, 8
.text:42CFB8E9                 test    eax, eax
.text:42CFB8EB                 jnz     short loc_42CFB90E
.text:42CFB8ED                 mov     edx, [ebp+Str]
.text:42CFB8F3                 push    edx             ; Str
.text:42CFB8F4                 call    strlen
.text:42CFB8F9                 add     esp, 4
.text:42CFB8FC                 mov     ecx, [ebp+Str]
.text:42CFB902                 lea     edx, [ecx+eax+1]
.text:42CFB906                 mov     [ebp+Str], edx
.text:42CFB90C                 jmp     short loc_42CFB8AE
.text:42CFB90E ; ---------------------------------------------------------------------------
.text:42CFB90E
.text:42CFB90E loc_42CFB90E:                           ; CODE XREF: sub_42CFB392+559\u2191j
.text:42CFB90E                 mov     eax, [ebp+Str]
.text:42CFB914                 push    eax
.text:42CFB915                 push    offset aS_4     ; "%s;"
.text:42CFB91A                 mov     ecx, [ebp+arg_8]
.text:42CFB91D                 mov     edx, [ebp+arg_4]
.text:42CFB920                 add     edx, [ecx]
.text:42CFB922                 push    edx             ; Buffer
.text:42CFB923                 call    ds:sprintf
.text:42CFB929                 add     esp, 0Ch
.text:42CFB92C                 mov     eax, [ebp+arg_8]
.text:42CFB92F                 mov     ecx, [ebp+arg_4]
.text:42CFB932                 add     ecx, [eax]
.text:42CFB934                 push    ecx             ; Str
.text:42CFB935                 call    strlen
.text:42CFB93A                 add     esp, 4
.text:42CFB93D                 mov     edx, [ebp+arg_8]
.text:42CFB940                 mov     ecx, [edx]
.text:42CFB942                 add     ecx, eax
.text:42CFB944                 mov     edx, [ebp+arg_8]
.text:42CFB947                 mov     [edx], ecx
.text:42CFB949                 mov     eax, [ebp+Str]
.text:42CFB94F                 push    eax
.text:42CFB950                 lea     ecx, [ebp+var_28C]
.text:42CFB956                 push    ecx
.text:42CFB957                 push    offset aSS      ; "%s%s"
.text:42CFB95C                 lea     edx, [ebp+Destination]
.text:42CFB962                 push    edx             ; Buffer
.text:42CFB963                 call    ds:sprintf
.text:42CFB969                 add     esp, 10h
.text:42CFB96C                 mov     [ebp+phkResult], 0
.text:42CFB976                 lea     eax, [ebp+phkResult]
.text:42CFB97C                 push    eax             ; phkResult
.text:42CFB97D                 push    20019h          ; samDesired
.text:42CFB982                 push    0               ; ulOptions
.text:42CFB984                 lea     ecx, [ebp+Destination]
.text:42CFB98A                 push    ecx             ; lpSubKey
.text:42CFB98B                 push    80000002h       ; hKey
.text:42CFB990                 call    ds:RegOpenKeyExA
.text:42CFB996                 mov     [ebp+var_518], eax
.text:42CFB99C                 cmp     [ebp+var_518], 0
.text:42CFB9A3                 jz      short loc_42CFB9AA
.text:42CFB9A5                 jmp     loc_42CFC13B
.text:42CFB9AA ; ---------------------------------------------------------------------------
.text:42CFB9AA
.text:42CFB9AA loc_42CFB9AA:                           ; CODE XREF: sub_42CFB392+611\u2191j
.text:42CFB9AA                 mov     [ebp+cbData], 200h
.text:42CFB9B4                 mov     edx, [ebp+Str]
.text:42CFB9BA                 movsx   eax, byte ptr [edx]
.text:42CFB9BD                 mov     [ebp+var_2914], eax
.text:42CFB9C3                 mov     ecx, [ebp+var_2914]
.text:42CFB9C9                 sub     ecx, 56h ; 'V'  ; switch 33 cases
.text:42CFB9CC                 mov     [ebp+var_2914], ecx
.text:42CFB9D2                 cmp     [ebp+var_2914], 20h
.text:42CFB9D9                 ja      def_42CFB9ED    ; jumptable 42CFB9ED default case, cases 87-96,99-109,111-113,117
.text:42CFB9DF                 mov     eax, [ebp+var_2914]
.text:42CFB9E5                 xor     edx, edx
.text:42CFB9E7                 mov     dl, ds:byte_42CFC1AB[eax]
.text:42CFB9ED                 jmp     ds:jpt_42CFB9ED[edx*4] ; switch jump
.text:42CFB9F4 ; ---------------------------------------------------------------------------
.text:42CFB9F4
.text:42CFB9F4 loc_42CFB9F4:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFB9F4                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFB9F4                 lea     ecx, [ebp+cbData] ; jumptable 42CFB9ED case 116
.text:42CFB9FA                 push    ecx             ; lpcbData
.text:42CFB9FB                 lea     edx, [ebp+var_510]
.text:42CFBA01                 push    edx             ; lpData
.text:42CFBA02                 push    0               ; lpType
.text:42CFBA04                 push    0               ; lpReserved
.text:42CFBA06                 push    offset aTcphideflag_0 ; "TcpHideFlag"
.text:42CFBA0B                 mov     eax, [ebp+phkResult]
.text:42CFBA11                 push    eax             ; hKey
.text:42CFBA12                 call    ds:RegQueryValueExA
.text:42CFBA18                 test    eax, eax
.text:42CFBA1A                 jnz     short loc_42CFBA46
.text:42CFBA1C                 movsx   ecx, [ebp+var_510]
.text:42CFBA23                 cmp     ecx, 1
.text:42CFBA26                 jnz     short loc_42CFBA46
.text:42CFBA28                 push    offset Str      ; "tcp;"
.text:42CFBA2D                 call    strlen
.text:42CFBA32                 add     esp, 4
.text:42CFBA35                 mov     edx, [ebp+arg_8]
.text:42CFBA38                 mov     ecx, [edx]
.text:42CFBA3A                 sub     ecx, eax
.text:42CFBA3C                 mov     edx, [ebp+arg_8]
.text:42CFBA3F                 mov     [edx], ecx
.text:42CFBA41                 jmp     loc_42CFC070
.text:42CFBA46 ; ---------------------------------------------------------------------------
.text:42CFBA46
.text:42CFBA46 loc_42CFBA46:                           ; CODE XREF: sub_42CFB392+688\u2191j
.text:42CFBA46                                         ; sub_42CFB392+694\u2191j
.text:42CFBA46                 mov     [ebp+cbData], 1FA0h
.text:42CFBA50                 lea     eax, [ebp+cbData]
.text:42CFBA56                 push    eax             ; lpcbData
.text:42CFBA57                 lea     ecx, [ebp+var_24C0]
.text:42CFBA5D                 push    ecx             ; lpData
.text:42CFBA5E                 push    0               ; lpType
.text:42CFBA60                 push    0               ; lpReserved
.text:42CFBA62                 push    offset aTcpport_2 ; "TcpPort"
.text:42CFBA67                 mov     edx, [ebp+phkResult]
.text:42CFBA6D                 push    edx             ; hKey
.text:42CFBA6E                 call    ds:RegQueryValueExA
.text:42CFBA74                 test    eax, eax
.text:42CFBA76                 jnz     loc_42CFBB1D
.text:42CFBA7C                 cmp     [ebp+cbData], 1
.text:42CFBA83                 jbe     loc_42CFBB1D
.text:42CFBA89                 push    2Ch ; ','       ; Val
.text:42CFBA8B                 lea     eax, [ebp+var_24C0]
.text:42CFBA91                 push    eax             ; Str
.text:42CFBA92                 call    ds:strchr
.text:42CFBA98                 add     esp, 8
.text:42CFBA9B                 test    eax, eax
.text:42CFBA9D                 jz      short loc_42CFBAD7
.text:42CFBA9F                 push    offset asc_42D00C74 ; ","
.text:42CFBAA4                 lea     ecx, [ebp+var_24C0]
.text:42CFBAAA                 push    ecx             ; String
.text:42CFBAAB                 call    ds:strtok
.text:42CFBAB1                 add     esp, 8
.text:42CFBAB4                 push    eax             ; char *
.text:42CFBAB5                 call    sub_42CF9C63
.text:42CFBABA                 add     esp, 4
.text:42CFBABD                 push    eax
.text:42CFBABE                 push    offset aD_1     ; "%d;"
.text:42CFBAC3                 mov     edx, [ebp+arg_8]
.text:42CFBAC6                 mov     eax, [ebp+arg_4]
.text:42CFBAC9                 add     eax, [edx]
.text:42CFBACB                 push    eax             ; Buffer
.text:42CFBACC                 call    ds:sprintf
.text:42CFBAD2                 add     esp, 0Ch
.text:42CFBAD5                 jmp     short loc_42CFBAFE
.text:42CFBAD7 ; ---------------------------------------------------------------------------
.text:42CFBAD7
.text:42CFBAD7 loc_42CFBAD7:                           ; CODE XREF: sub_42CFB392+70B\u2191j
.text:42CFBAD7                 lea     ecx, [ebp+var_24C0]
.text:42CFBADD                 push    ecx             ; char *
.text:42CFBADE                 call    sub_42CF9C63
.text:42CFBAE3                 add     esp, 4
.text:42CFBAE6                 push    eax
.text:42CFBAE7                 push    offset aD_2     ; "%d;"
.text:42CFBAEC                 mov     edx, [ebp+arg_8]
.text:42CFBAEF                 mov     eax, [ebp+arg_4]
.text:42CFBAF2                 add     eax, [edx]
.text:42CFBAF4                 push    eax             ; Buffer
.text:42CFBAF5                 call    ds:sprintf
.text:42CFBAFB                 add     esp, 0Ch
.text:42CFBAFE
.text:42CFBAFE loc_42CFBAFE:                           ; CODE XREF: sub_42CFB392+743\u2191j
.text:42CFBAFE                 mov     ecx, [ebp+arg_8]
.text:42CFBB01                 mov     edx, [ebp+arg_4]
.text:42CFBB04                 add     edx, [ecx]
.text:42CFBB06                 push    edx             ; Str
.text:42CFBB07                 call    strlen
.text:42CFBB0C                 add     esp, 4
.text:42CFBB0F                 mov     ecx, [ebp+arg_8]
.text:42CFBB12                 mov     edx, [ecx]
.text:42CFBB14                 add     edx, eax
.text:42CFBB16                 mov     eax, [ebp+arg_8]
.text:42CFBB19                 mov     [eax], edx
.text:42CFBB1B                 jmp     short loc_42CFBB22
.text:42CFBB1D ; ---------------------------------------------------------------------------
.text:42CFBB1D
.text:42CFBB1D loc_42CFBB1D:                           ; CODE XREF: sub_42CFB392+6E4\u2191j
.text:42CFBB1D                                         ; sub_42CFB392+6F1\u2191j
.text:42CFBB1D                 jmp     loc_42CFC13B
.text:42CFBB22 ; ---------------------------------------------------------------------------
.text:42CFBB22
.text:42CFBB22 loc_42CFBB22:                           ; CODE XREF: sub_42CFB392+789\u2191j
.text:42CFBB22                 mov     ecx, [ebp+var_2908]
.text:42CFBB28                 add     ecx, 1
.text:42CFBB2B                 mov     [ebp+var_2908], ecx
.text:42CFBB31                 jmp     loc_42CFC070
.text:42CFBB36 ; ---------------------------------------------------------------------------
.text:42CFBB36
.text:42CFBB36 loc_42CFBB36:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFBB36                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFBB36                 lea     edx, [ebp+cbData] ; jumptable 42CFB9ED case 110
.text:42CFBB3C                 push    edx             ; lpcbData
.text:42CFBB3D                 lea     eax, [ebp+var_510]
.text:42CFBB43                 push    eax             ; lpData
.text:42CFBB44                 push    0               ; lpType
.text:42CFBB46                 push    0               ; lpReserved
.text:42CFBB48                 push    offset aPipename_0 ; "PipeName"
.text:42CFBB4D                 mov     ecx, [ebp+phkResult]
.text:42CFBB53                 push    ecx             ; hKey
.text:42CFBB54                 call    ds:RegQueryValueExA
.text:42CFBB5A                 test    eax, eax
.text:42CFBB5C                 jnz     loc_42CFBC28
.text:42CFBB62                 cmp     [ebp+cbData], 1
.text:42CFBB69                 jbe     loc_42CFBC28
.text:42CFBB6F                 cmp     [ebp+var_51C], 1
.text:42CFBB76                 jnz     short loc_42CFBBE6
.text:42CFBB78                 push    offset aPipe    ; "\\\\.\\pipe\\$$"
.text:42CFBB7D                 lea     edx, [ebp+var_510]
.text:42CFBB83                 push    edx             ; Str
.text:42CFBB84                 call    ds:strstr
.text:42CFBB8A                 add     esp, 8
.text:42CFBB8D                 test    eax, eax
.text:42CFBB8F                 jz      short loc_42CFBBDF
.text:42CFBB91                 lea     eax, [ebp+var_504]
.text:42CFBB97                 mov     [ebp+var_2910], eax
.text:42CFBB9D                 push    offset asc_42D00C98 ; "\\"
.text:42CFBBA2                 mov     ecx, [ebp+var_2910]
.text:42CFBBA8                 push    ecx             ; Str
.text:42CFBBA9                 call    ds:strstr
.text:42CFBBAF                 add     esp, 8
.text:42CFBBB2                 mov     [ebp+var_2910], eax
.text:42CFBBB8                 mov     edx, [ebp+var_2910]
.text:42CFBBBE                 push    edx
.text:42CFBBBF                 lea     eax, [ebp+var_2704]
.text:42CFBBC5                 push    eax
.text:42CFBBC6                 push    offset aSPipeS_0 ; "\\\\%s\\pipe%s;"
.text:42CFBBCB                 mov     ecx, [ebp+arg_8]
.text:42CFBBCE                 mov     edx, [ebp+arg_4]
.text:42CFBBD1                 add     edx, [ecx]
.text:42CFBBD3                 push    edx             ; Buffer
.text:42CFBBD4                 call    ds:sprintf
.text:42CFBBDA                 add     esp, 10h
.text:42CFBBDD                 jmp     short loc_42CFBBE4
.text:42CFBBDF ; ---------------------------------------------------------------------------
.text:42CFBBDF
.text:42CFBBDF loc_42CFBBDF:                           ; CODE XREF: sub_42CFB392+7FD\u2191j
.text:42CFBBDF                 jmp     loc_42CFC13B
.text:42CFBBE4 ; ---------------------------------------------------------------------------
.text:42CFBBE4
.text:42CFBBE4 loc_42CFBBE4:                           ; CODE XREF: sub_42CFB392+84B\u2191j
.text:42CFBBE4                 jmp     short loc_42CFBC09
.text:42CFBBE6 ; ---------------------------------------------------------------------------
.text:42CFBBE6
.text:42CFBBE6 loc_42CFBBE6:                           ; CODE XREF: sub_42CFB392+7E4\u2191j
.text:42CFBBE6                 lea     eax, [ebp+var_50D]
.text:42CFBBEC                 push    eax
.text:42CFBBED                 push    offset name
.text:42CFBBF2                 push    offset aSS_0    ; "\\\\%s%s;"
.text:42CFBBF7                 mov     ecx, [ebp+arg_8]
.text:42CFBBFA                 mov     edx, [ebp+arg_4]
.text:42CFBBFD                 add     edx, [ecx]
.text:42CFBBFF                 push    edx             ; Buffer
.text:42CFBC00                 call    ds:sprintf
.text:42CFBC06                 add     esp, 10h
.text:42CFBC09
.text:42CFBC09 loc_42CFBC09:                           ; CODE XREF: sub_42CFB392:loc_42CFBBE4\u2191j
.text:42CFBC09                 mov     eax, [ebp+arg_8]
.text:42CFBC0C                 mov     ecx, [ebp+arg_4]
.text:42CFBC0F                 add     ecx, [eax]
.text:42CFBC11                 push    ecx             ; Str
.text:42CFBC12                 call    strlen
.text:42CFBC17                 add     esp, 4
.text:42CFBC1A                 mov     edx, [ebp+arg_8]
.text:42CFBC1D                 mov     ecx, [edx]
.text:42CFBC1F                 add     ecx, eax
.text:42CFBC21                 mov     edx, [ebp+arg_8]
.text:42CFBC24                 mov     [edx], ecx
.text:42CFBC26                 jmp     short loc_42CFBC2D
.text:42CFBC28 ; ---------------------------------------------------------------------------
.text:42CFBC28
.text:42CFBC28 loc_42CFBC28:                           ; CODE XREF: sub_42CFB392+7CA\u2191j
.text:42CFBC28                                         ; sub_42CFB392+7D7\u2191j
.text:42CFBC28                 jmp     loc_42CFC13B
.text:42CFBC2D ; ---------------------------------------------------------------------------
.text:42CFBC2D
.text:42CFBC2D loc_42CFBC2D:                           ; CODE XREF: sub_42CFB392+894\u2191j
.text:42CFBC2D                 mov     eax, [ebp+var_2908]
.text:42CFBC33                 add     eax, 1
.text:42CFBC36                 mov     [ebp+var_2908], eax
.text:42CFBC3C                 jmp     loc_42CFC070
.text:42CFBC41 ; ---------------------------------------------------------------------------
.text:42CFBC41
.text:42CFBC41 loc_42CFBC41:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFBC41                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFBC41                 push    offset name     ; jumptable 42CFB9ED case 114
.text:42CFBC46                 push    offset aS_5     ; "%s;"
.text:42CFBC4B                 mov     ecx, [ebp+arg_8]
.text:42CFBC4E                 mov     edx, [ebp+arg_4]
.text:42CFBC51                 add     edx, [ecx]
.text:42CFBC53                 push    edx             ; Buffer
.text:42CFBC54                 call    ds:sprintf
.text:42CFBC5A                 add     esp, 0Ch
.text:42CFBC5D                 mov     eax, [ebp+arg_8]
.text:42CFBC60                 mov     ecx, [ebp+arg_4]
.text:42CFBC63                 add     ecx, [eax]
.text:42CFBC65                 push    ecx             ; Str
.text:42CFBC66                 call    strlen
.text:42CFBC6B                 add     esp, 4
.text:42CFBC6E                 mov     edx, [ebp+arg_8]
.text:42CFBC71                 mov     ecx, [edx]
.text:42CFBC73                 add     ecx, eax
.text:42CFBC75                 mov     edx, [ebp+arg_8]
.text:42CFBC78                 mov     [edx], ecx
.text:42CFBC7A                 mov     eax, [ebp+var_2908]
.text:42CFBC80                 add     eax, 1
.text:42CFBC83                 mov     [ebp+var_2908], eax
.text:42CFBC89                 jmp     loc_42CFC070
.text:42CFBC8E ; ---------------------------------------------------------------------------
.text:42CFBC8E
.text:42CFBC8E loc_42CFBC8E:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFBC8E                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFBC8E                 lea     ecx, [ebp+cbData] ; jumptable 42CFB9ED case 115
.text:42CFBC94                 push    ecx             ; lpcbData
.text:42CFBC95                 lea     edx, [ebp+var_510]
.text:42CFBC9B                 push    edx             ; lpData
.text:42CFBC9C                 push    0               ; lpType
.text:42CFBC9E                 push    0               ; lpReserved
.text:42CFBCA0                 push    offset aSpxhidflag ; "SpxHidFlag"
.text:42CFBCA5                 mov     eax, [ebp+phkResult]
.text:42CFBCAB                 push    eax             ; hKey
.text:42CFBCAC                 call    ds:RegQueryValueExA
.text:42CFBCB2                 test    eax, eax
.text:42CFBCB4                 jnz     short loc_42CFBCE0
.text:42CFBCB6                 movsx   ecx, [ebp+var_510]
.text:42CFBCBD                 cmp     ecx, 1
.text:42CFBCC0                 jnz     short loc_42CFBCE0
.text:42CFBCC2                 push    offset aSpx_2   ; "spx;"
.text:42CFBCC7                 call    strlen
.text:42CFBCCC                 add     esp, 4
.text:42CFBCCF                 mov     edx, [ebp+arg_8]
.text:42CFBCD2                 mov     ecx, [edx]
.text:42CFBCD4                 sub     ecx, eax
.text:42CFBCD6                 mov     edx, [ebp+arg_8]
.text:42CFBCD9                 mov     [edx], ecx
.text:42CFBCDB                 jmp     loc_42CFC070
.text:42CFBCE0 ; ---------------------------------------------------------------------------
.text:42CFBCE0
.text:42CFBCE0 loc_42CFBCE0:                           ; CODE XREF: sub_42CFB392+922\u2191j
.text:42CFBCE0                                         ; sub_42CFB392+92E\u2191j
.text:42CFBCE0                 lea     eax, [ebp+cbData]
.text:42CFBCE6                 push    eax             ; lpcbData
.text:42CFBCE7                 lea     ecx, [ebp+var_510]
.text:42CFBCED                 push    ecx             ; lpData
.text:42CFBCEE                 push    0               ; lpType
.text:42CFBCF0                 push    0               ; lpReserved
.text:42CFBCF2                 push    offset aSpxservicename_0 ; "SpxServiceName"
.text:42CFBCF7                 mov     edx, [ebp+phkResult]
.text:42CFBCFD                 push    edx             ; hKey
.text:42CFBCFE                 call    ds:RegQueryValueExA
.text:42CFBD04                 test    eax, eax
.text:42CFBD06                 jnz     short loc_42CFBD4E
.text:42CFBD08                 cmp     [ebp+cbData], 1
.text:42CFBD0F                 jbe     short loc_42CFBD4E
.text:42CFBD11                 lea     eax, [ebp+var_510]
.text:42CFBD17                 push    eax
.text:42CFBD18                 push    offset aS_6     ; "%s;"
.text:42CFBD1D                 mov     ecx, [ebp+arg_8]
.text:42CFBD20                 mov     edx, [ebp+arg_4]
.text:42CFBD23                 add     edx, [ecx]
.text:42CFBD25                 push    edx             ; Buffer
.text:42CFBD26                 call    ds:sprintf
.text:42CFBD2C                 add     esp, 0Ch
.text:42CFBD2F                 mov     eax, [ebp+arg_8]
.text:42CFBD32                 mov     ecx, [ebp+arg_4]
.text:42CFBD35                 add     ecx, [eax]
.text:42CFBD37                 push    ecx             ; Str
.text:42CFBD38                 call    strlen
.text:42CFBD3D                 add     esp, 4
.text:42CFBD40                 mov     edx, [ebp+arg_8]
.text:42CFBD43                 mov     ecx, [edx]
.text:42CFBD45                 add     ecx, eax
.text:42CFBD47                 mov     edx, [ebp+arg_8]
.text:42CFBD4A                 mov     [edx], ecx
.text:42CFBD4C                 jmp     short loc_42CFBDC1
.text:42CFBD4E ; ---------------------------------------------------------------------------
.text:42CFBD4E
.text:42CFBD4E loc_42CFBD4E:                           ; CODE XREF: sub_42CFB392+974\u2191j
.text:42CFBD4E                                         ; sub_42CFB392+97D\u2191j
.text:42CFBD4E                 lea     eax, [ebp+cbData]
.text:42CFBD54                 push    eax             ; lpcbData
.text:42CFBD55                 lea     ecx, [ebp+var_510]
.text:42CFBD5B                 push    ecx             ; lpData
.text:42CFBD5C                 push    0               ; lpType
.text:42CFBD5E                 push    0               ; lpReserved
.text:42CFBD60                 push    offset aSpxport_0 ; "SpxPort"
.text:42CFBD65                 mov     edx, [ebp+phkResult]
.text:42CFBD6B                 push    edx             ; hKey
.text:42CFBD6C                 call    ds:RegQueryValueExA
.text:42CFBD72                 test    eax, eax
.text:42CFBD74                 jnz     short loc_42CFBDBC
.text:42CFBD76                 cmp     [ebp+cbData], 1
.text:42CFBD7D                 jbe     short loc_42CFBDBC
.text:42CFBD7F                 lea     eax, [ebp+var_510]
.text:42CFBD85                 push    eax
.text:42CFBD86                 push    offset aS_7     ; "%s;"
.text:42CFBD8B                 mov     ecx, [ebp+arg_8]
.text:42CFBD8E                 mov     edx, [ebp+arg_4]
.text:42CFBD91                 add     edx, [ecx]
.text:42CFBD93                 push    edx             ; Buffer
.text:42CFBD94                 call    ds:sprintf
.text:42CFBD9A                 add     esp, 0Ch
.text:42CFBD9D                 mov     eax, [ebp+arg_8]
.text:42CFBDA0                 mov     ecx, [ebp+arg_4]
.text:42CFBDA3                 add     ecx, [eax]
.text:42CFBDA5                 push    ecx             ; Str
.text:42CFBDA6                 call    strlen
.text:42CFBDAB                 add     esp, 4
.text:42CFBDAE                 mov     edx, [ebp+arg_8]
.text:42CFBDB1                 mov     ecx, [edx]
.text:42CFBDB3                 add     ecx, eax
.text:42CFBDB5                 mov     edx, [ebp+arg_8]
.text:42CFBDB8                 mov     [edx], ecx
.text:42CFBDBA                 jmp     short loc_42CFBDC1
.text:42CFBDBC ; ---------------------------------------------------------------------------
.text:42CFBDBC
.text:42CFBDBC loc_42CFBDBC:                           ; CODE XREF: sub_42CFB392+9E2\u2191j
.text:42CFBDBC                                         ; sub_42CFB392+9EB\u2191j
.text:42CFBDBC                 jmp     loc_42CFC13B
.text:42CFBDC1 ; ---------------------------------------------------------------------------
.text:42CFBDC1
.text:42CFBDC1 loc_42CFBDC1:                           ; CODE XREF: sub_42CFB392+9BA\u2191j
.text:42CFBDC1                                         ; sub_42CFB392+A28\u2191j
.text:42CFBDC1                 mov     eax, [ebp+var_2908]
.text:42CFBDC7                 add     eax, 1
.text:42CFBDCA                 mov     [ebp+var_2908], eax
.text:42CFBDD0                 jmp     loc_42CFC070
.text:42CFBDD5 ; ---------------------------------------------------------------------------
.text:42CFBDD5
.text:42CFBDD5 loc_42CFBDD5:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFBDD5                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFBDD5                 lea     ecx, [ebp+cbData] ; jumptable 42CFB9ED case 97
.text:42CFBDDB                 push    ecx             ; lpcbData
.text:42CFBDDC                 lea     edx, [ebp+var_510]
.text:42CFBDE2                 push    edx             ; lpData
.text:42CFBDE3                 push    0               ; lpType
.text:42CFBDE5                 push    0               ; lpReserved
.text:42CFBDE7                 push    offset aAdspobjectname_0 ; "AdspObjectName"
.text:42CFBDEC                 mov     eax, [ebp+phkResult]
.text:42CFBDF2                 push    eax             ; hKey
.text:42CFBDF3                 call    ds:RegQueryValueExA
.text:42CFBDF9                 test    eax, eax
.text:42CFBDFB                 jnz     short loc_42CFBE43
.text:42CFBDFD                 cmp     [ebp+cbData], 1
.text:42CFBE04                 jbe     short loc_42CFBE43
.text:42CFBE06                 lea     ecx, [ebp+var_510]
.text:42CFBE0C                 push    ecx
.text:42CFBE0D                 push    offset aS_8     ; "%s;"
.text:42CFBE12                 mov     edx, [ebp+arg_8]
.text:42CFBE15                 mov     eax, [ebp+arg_4]
.text:42CFBE18                 add     eax, [edx]
.text:42CFBE1A                 push    eax             ; Buffer
.text:42CFBE1B                 call    ds:sprintf
.text:42CFBE21                 add     esp, 0Ch
.text:42CFBE24                 mov     ecx, [ebp+arg_8]
.text:42CFBE27                 mov     edx, [ebp+arg_4]
.text:42CFBE2A                 add     edx, [ecx]
.text:42CFBE2C                 push    edx             ; Str
.text:42CFBE2D                 call    strlen
.text:42CFBE32                 add     esp, 4
.text:42CFBE35                 mov     ecx, [ebp+arg_8]
.text:42CFBE38                 mov     edx, [ecx]
.text:42CFBE3A                 add     edx, eax
.text:42CFBE3C                 mov     eax, [ebp+arg_8]
.text:42CFBE3F                 mov     [eax], edx
.text:42CFBE41                 jmp     short loc_42CFBE48
.text:42CFBE43 ; ---------------------------------------------------------------------------
.text:42CFBE43
.text:42CFBE43 loc_42CFBE43:                           ; CODE XREF: sub_42CFB392+A69\u2191j
.text:42CFBE43                                         ; sub_42CFB392+A72\u2191j
.text:42CFBE43                 jmp     loc_42CFC13B
.text:42CFBE48 ; ---------------------------------------------------------------------------
.text:42CFBE48
.text:42CFBE48 loc_42CFBE48:                           ; CODE XREF: sub_42CFB392+AAF\u2191j
.text:42CFBE48                 mov     ecx, [ebp+var_2908]
.text:42CFBE4E                 add     ecx, 1
.text:42CFBE51                 mov     [ebp+var_2908], ecx
.text:42CFBE57                 jmp     loc_42CFC070
.text:42CFBE5C ; ---------------------------------------------------------------------------
.text:42CFBE5C
.text:42CFBE5C loc_42CFBE5C:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFBE5C                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFBE5C                 lea     edx, [ebp+cbData] ; jumptable 42CFB9ED case 98
.text:42CFBE62                 push    edx             ; lpcbData
.text:42CFBE63                 lea     eax, [ebp+var_510]
.text:42CFBE69                 push    eax             ; lpData
.text:42CFBE6A                 push    0               ; lpType
.text:42CFBE6C                 push    0               ; lpReserved
.text:42CFBE6E                 push    offset aItemname_0 ; "ItemName"
.text:42CFBE73                 mov     ecx, [ebp+phkResult]
.text:42CFBE79                 push    ecx             ; hKey
.text:42CFBE7A                 call    ds:RegQueryValueExA
.text:42CFBE80                 test    eax, eax
.text:42CFBE82                 jnz     short loc_42CFBEC8
.text:42CFBE84                 cmp     [ebp+cbData], 1
.text:42CFBE8B                 jbe     short loc_42CFBEC8
.text:42CFBE8D                 lea     edx, [ebp+var_510]
.text:42CFBE93                 push    edx
.text:42CFBE94                 push    offset aS_9     ; "%s;"
.text:42CFBE99                 mov     eax, [ebp+arg_8]
.text:42CFBE9C                 mov     ecx, [ebp+arg_4]
.text:42CFBE9F                 add     ecx, [eax]
.text:42CFBEA1                 push    ecx             ; Buffer
.text:42CFBEA2                 call    ds:sprintf
.text:42CFBEA8                 add     esp, 0Ch
.text:42CFBEAB                 mov     edx, [ebp+arg_8]
.text:42CFBEAE                 mov     eax, [ebp+arg_4]
.text:42CFBEB1                 add     eax, [edx]
.text:42CFBEB3                 push    eax             ; Str
.text:42CFBEB4                 call    strlen
.text:42CFBEB9                 add     esp, 4
.text:42CFBEBC                 mov     ecx, [ebp+arg_8]
.text:42CFBEBF                 mov     edx, [ecx]
.text:42CFBEC1                 add     edx, eax
.text:42CFBEC3                 mov     eax, [ebp+arg_8]
.text:42CFBEC6                 mov     [eax], edx
.text:42CFBEC8
.text:42CFBEC8 loc_42CFBEC8:                           ; CODE XREF: sub_42CFB392+AF0\u2191j
.text:42CFBEC8                                         ; sub_42CFB392+AF9\u2191j
.text:42CFBEC8                 mov     [ebp+cbData], 200h
.text:42CFBED2                 lea     ecx, [ebp+cbData]
.text:42CFBED8                 push    ecx             ; lpcbData
.text:42CFBED9                 lea     edx, [ebp+var_510]
.text:42CFBEDF                 push    edx             ; lpData
.text:42CFBEE0                 push    0               ; lpType
.text:42CFBEE2                 push    0               ; lpReserved
.text:42CFBEE4                 push    offset aGroupname_0 ; "GroupName"
.text:42CFBEE9                 mov     eax, [ebp+phkResult]
.text:42CFBEEF                 push    eax             ; hKey
.text:42CFBEF0                 call    ds:RegQueryValueExA
.text:42CFBEF6                 test    eax, eax
.text:42CFBEF8                 jnz     short loc_42CFBF4B
.text:42CFBEFA                 cmp     [ebp+cbData], 1
.text:42CFBF01                 jbe     short loc_42CFBF4B
.text:42CFBF03                 mov     ecx, [ebp+arg_8]
.text:42CFBF06                 mov     edx, [ecx]
.text:42CFBF08                 sub     edx, 1
.text:42CFBF0B                 mov     eax, [ebp+arg_8]
.text:42CFBF0E                 mov     [eax], edx
.text:42CFBF10                 lea     ecx, [ebp+var_510]
.text:42CFBF16                 push    ecx
.text:42CFBF17                 push    offset aS_10    ; "@%s;"
.text:42CFBF1C                 mov     edx, [ebp+arg_8]
.text:42CFBF1F                 mov     eax, [ebp+arg_4]
.text:42CFBF22                 add     eax, [edx]
.text:42CFBF24                 push    eax             ; Buffer
.text:42CFBF25                 call    ds:sprintf
.text:42CFBF2B                 add     esp, 0Ch
.text:42CFBF2E                 mov     ecx, [ebp+arg_8]
.text:42CFBF31                 mov     edx, [ebp+arg_4]
.text:42CFBF34                 add     edx, [ecx]
.text:42CFBF36                 push    edx             ; Str
.text:42CFBF37                 call    strlen
.text:42CFBF3C                 add     esp, 4
.text:42CFBF3F                 mov     ecx, [ebp+arg_8]
.text:42CFBF42                 mov     edx, [ecx]
.text:42CFBF44                 add     edx, eax
.text:42CFBF46                 mov     eax, [ebp+arg_8]
.text:42CFBF49                 mov     [eax], edx
.text:42CFBF4B
.text:42CFBF4B loc_42CFBF4B:                           ; CODE XREF: sub_42CFB392+B66\u2191j
.text:42CFBF4B                                         ; sub_42CFB392+B6F\u2191j
.text:42CFBF4B                 mov     [ebp+cbData], 200h
.text:42CFBF55                 lea     ecx, [ebp+cbData]
.text:42CFBF5B                 push    ecx             ; lpcbData
.text:42CFBF5C                 lea     edx, [ebp+var_510]
.text:42CFBF62                 push    edx             ; lpData
.text:42CFBF63                 push    0               ; lpType
.text:42CFBF65                 push    0               ; lpReserved
.text:42CFBF67                 push    offset aOrgname_0 ; "OrgName"
.text:42CFBF6C                 mov     eax, [ebp+phkResult]
.text:42CFBF72                 push    eax             ; hKey
.text:42CFBF73                 call    ds:RegQueryValueExA
.text:42CFBF79                 test    eax, eax
.text:42CFBF7B                 jnz     short loc_42CFBFCE
.text:42CFBF7D                 cmp     [ebp+cbData], 1
.text:42CFBF84                 jbe     short loc_42CFBFCE
.text:42CFBF86                 mov     ecx, [ebp+arg_8]
.text:42CFBF89                 mov     edx, [ecx]
.text:42CFBF8B                 sub     edx, 1
.text:42CFBF8E                 mov     eax, [ebp+arg_8]
.text:42CFBF91                 mov     [eax], edx
.text:42CFBF93                 lea     ecx, [ebp+var_510]
.text:42CFBF99                 push    ecx
.text:42CFBF9A                 push    offset aS_11    ; "@%s;"
.text:42CFBF9F                 mov     edx, [ebp+arg_8]
.text:42CFBFA2                 mov     eax, [ebp+arg_4]
.text:42CFBFA5                 add     eax, [edx]
.text:42CFBFA7                 push    eax             ; Buffer
.text:42CFBFA8                 call    ds:sprintf
.text:42CFBFAE                 add     esp, 0Ch
.text:42CFBFB1                 mov     ecx, [ebp+arg_8]
.text:42CFBFB4                 mov     edx, [ebp+arg_4]
.text:42CFBFB7                 add     edx, [ecx]
.text:42CFBFB9                 push    edx             ; Str
.text:42CFBFBA                 call    strlen
.text:42CFBFBF                 add     esp, 4
.text:42CFBFC2                 mov     ecx, [ebp+arg_8]
.text:42CFBFC5                 mov     edx, [ecx]
.text:42CFBFC7                 add     edx, eax
.text:42CFBFC9                 mov     eax, [ebp+arg_8]
.text:42CFBFCC                 mov     [eax], edx
.text:42CFBFCE
.text:42CFBFCE loc_42CFBFCE:                           ; CODE XREF: sub_42CFB392+BE9\u2191j
.text:42CFBFCE                                         ; sub_42CFB392+BF2\u2191j
.text:42CFBFCE                 mov     ecx, [ebp+var_2908]
.text:42CFBFD4                 add     ecx, 1
.text:42CFBFD7                 mov     [ebp+var_2908], ecx
.text:42CFBFDD                 jmp     loc_42CFC070
.text:42CFBFE2 ; ---------------------------------------------------------------------------
.text:42CFBFE2
.text:42CFBFE2 loc_42CFBFE2:                           ; CODE XREF: sub_42CFB392+65B\u2191j
.text:42CFBFE2                                         ; DATA XREF: .text:jpt_42CFB9ED\u2193o
.text:42CFBFE2                 lea     edx, [ebp+cbData] ; jumptable 42CFB9ED cases 86,118
.text:42CFBFE8                 push    edx             ; lpcbData
.text:42CFBFE9                 lea     eax, [ebp+var_510]
.text:42CFBFEF                 push    eax             ; lpData
.text:42CFBFF0                 push    0               ; lpType
.text:42CFBFF2                 push    0               ; lpReserved
.text:42CFBFF4                 push    offset aListeninfo_0 ; "ListenInfo"
.text:42CFBFF9                 mov     ecx, [ebp+phkResult]
.text:42CFBFFF                 push    ecx             ; hKey
.text:42CFC000                 call    ds:RegQueryValueExA
.text:42CFC006                 test    eax, eax
.text:42CFC008                 jnz     short loc_42CFC055
.text:42CFC00A                 cmp     [ebp+cbData], 1
.text:42CFC011                 jbe     short loc_42CFC055
.text:42CFC013                 lea     edx, [ebp+var_510]
.text:42CFC019                 push    edx
.text:42CFC01A                 push    offset name
.text:42CFC01F                 push    offset aSS_1    ; "%s,%s;"
.text:42CFC024                 mov     eax, [ebp+arg_8]
.text:42CFC027                 mov     ecx, [ebp+arg_4]
.text:42CFC02A                 add     ecx, [eax]
.text:42CFC02C                 push    ecx             ; Buffer
.text:42CFC02D                 call    ds:sprintf
.text:42CFC033                 add     esp, 10h
.text:42CFC036                 mov     edx, [ebp+arg_8]
.text:42CFC039                 mov     eax, [ebp+arg_4]
.text:42CFC03C                 add     eax, [edx]
.text:42CFC03E                 push    eax             ; Str
.text:42CFC03F                 call    strlen
.text:42CFC044                 add     esp, 4
.text:42CFC047                 mov     ecx, [ebp+arg_8]
.text:42CFC04A                 mov     edx, [ecx]
.text:42CFC04C                 add     edx, eax
.text:42CFC04E                 mov     eax, [ebp+arg_8]
.text:42CFC051                 mov     [eax], edx
.text:42CFC053                 jmp     short loc_42CFC05A
.text:42CFC055 ; ---------------------------------------------------------------------------
.text:42CFC055
.text:42CFC055 loc_42CFC055:                           ; CODE XREF: sub_42CFB392+C76\u2191j
.text:42CFC055                                         ; sub_42CFB392+C7F\u2191j
.text:42CFC055                 jmp     loc_42CFC13B
.text:42CFC05A ; ---------------------------------------------------------------------------
.text:42CFC05A
.text:42CFC05A loc_42CFC05A:                           ; CODE XREF: sub_42CFB392+CC1\u2191j
.text:42CFC05A                 mov     ecx, [ebp+var_2908]
.text:42CFC060                 add     ecx, 1
.text:42CFC063                 mov     [ebp+var_2908], ecx
.text:42CFC069                 jmp     short loc_42CFC070
.text:42CFC06B ; ---------------------------------------------------------------------------
.text:42CFC06B
.text:42CFC06B def_42CFB9ED:                           ; CODE XREF: sub_42CFB392+647\u2191j
.text:42CFC06B                                         ; sub_42CFB392+65B\u2191j
.text:42CFC06B                                         ; DATA XREF: ...
.text:42CFC06B                 jmp     loc_42CFC13B    ; jumptable 42CFB9ED default case, cases 87-96,99-109,111-113,117
.text:42CFC070 ; ---------------------------------------------------------------------------
.text:42CFC070
.text:42CFC070 loc_42CFC070:                           ; CODE XREF: sub_42CFB392+6AF\u2191j
.text:42CFC070                                         ; sub_42CFB392+79F\u2191j ...
.text:42CFC070                 mov     edx, [ebp+phkResult]
.text:42CFC076                 push    edx             ; hKey
.text:42CFC077                 call    ds:RegCloseKey
.text:42CFC07D                 mov     [ebp+phkResult], 0
.text:42CFC087                 mov     eax, [ebp+Str]
.text:42CFC08D                 push    eax             ; Str
.text:42CFC08E                 call    strlen
.text:42CFC093                 add     esp, 4
.text:42CFC096                 mov     ecx, [ebp+Str]
.text:42CFC09C                 lea     edx, [ecx+eax+1]
.text:42CFC0A0                 mov     [ebp+Str], edx
.text:42CFC0A6                 jmp     loc_42CFB8AE
.text:42CFC0AB ; ---------------------------------------------------------------------------
.text:42CFC0AB
.text:42CFC0AB loc_42CFC0AB:                           ; CODE XREF: sub_42CFB392:loc_42CFB7F9\u2191j
.text:42CFC0AB                                         ; sub_42CFB392+53C\u2191j
.text:42CFC0AB                 push    offset asc_42D00D48 ; ";"
.text:42CFC0B0                 mov     eax, [ebp+arg_8]
.text:42CFC0B3                 mov     ecx, [ebp+arg_4]
.text:42CFC0B6                 add     ecx, [eax]
.text:42CFC0B8                 push    ecx             ; Buffer
.text:42CFC0B9                 call    ds:sprintf
.text:42CFC0BF                 add     esp, 8
.text:42CFC0C2                 mov     edx, [ebp+arg_8]
.text:42CFC0C5                 mov     eax, [edx]
.text:42CFC0C7                 add     eax, 1
.text:42CFC0CA                 mov     ecx, [ebp+arg_8]
.text:42CFC0CD                 mov     [ecx], eax
.text:42CFC0CF                 mov     edx, [ebp+String1]
.text:42CFC0D5                 push    edx             ; Str
.text:42CFC0D6                 call    strlen
.text:42CFC0DB                 add     esp, 4
.text:42CFC0DE                 mov     ecx, [ebp+String1]
.text:42CFC0E4                 lea     edx, [ecx+eax+1]
.text:42CFC0E8                 mov     [ebp+String1], edx
.text:42CFC0EE                 cmp     [ebp+var_2908], 1
.text:42CFC0F5                 jnb     short loc_42CFC102
.text:42CFC0F7                 mov     eax, [ebp+arg_8]
.text:42CFC0FA                 mov     ecx, [ebp+var_290C]
.text:42CFC100                 mov     [eax], ecx
.text:42CFC102
.text:42CFC102 loc_42CFC102:                           ; CODE XREF: sub_42CFB392+D63\u2191j
.text:42CFC102                 jmp     loc_42CFB51A
.text:42CFC107 ; ---------------------------------------------------------------------------
.text:42CFC107
.text:42CFC107 loc_42CFC107:                           ; CODE XREF: sub_42CFB392+19E\u2191j
.text:42CFC107                 cmp     [ebp+lpData], 0
.text:42CFC10E                 jz      short loc_42CFC12A
.text:42CFC110                 mov     edx, [ebp+lpData]
.text:42CFC116                 push    edx             ; Block
.text:42CFC117                 call    ds:free
.text:42CFC11D                 add     esp, 4
.text:42CFC120                 mov     [ebp+lpData], 0
.text:42CFC12A
.text:42CFC12A loc_42CFC12A:                           ; CODE XREF: sub_42CFB392+D7C\u2191j
.text:42CFC12A                 mov     eax, [ebp+arg_8]
.text:42CFC12D                 cmp     dword ptr [eax], 0
.text:42CFC130                 jnz     short loc_42CFC134
.text:42CFC132                 jmp     short loc_42CFC13B
.text:42CFC134 ; ---------------------------------------------------------------------------
.text:42CFC134
.text:42CFC134 loc_42CFC134:                           ; CODE XREF: sub_42CFB392+D9E\u2191j
.text:42CFC134                 mov     eax, 1
.text:42CFC139                 jmp     short loc_42CFC187
.text:42CFC13B ; ---------------------------------------------------------------------------
.text:42CFC13B
.text:42CFC13B loc_42CFC13B:                           ; CODE XREF: sub_42CFB392+A7\u2191j
.text:42CFC13B                                         ; sub_42CFB392+EF\u2191j ...
.text:42CFC13B                 cmp     [ebp+phkResult], 0
.text:42CFC142                 jz      short loc_42CFC151
.text:42CFC144                 mov     ecx, [ebp+phkResult]
.text:42CFC14A                 push    ecx             ; hKey
.text:42CFC14B                 call    ds:RegCloseKey
.text:42CFC151
.text:42CFC151 loc_42CFC151:                           ; CODE XREF: sub_42CFB392+DB0\u2191j
.text:42CFC151                 cmp     [ebp+lpData], 0
.text:42CFC158                 jz      short loc_42CFC16A
.text:42CFC15A                 mov     edx, [ebp+lpData]
.text:42CFC160                 push    edx             ; Block
.text:42CFC161                 call    ds:free
.text:42CFC167                 add     esp, 4
.text:42CFC16A
.text:42CFC16A loc_42CFC16A:                           ; CODE XREF: sub_42CFB392+DC6\u2191j
.text:42CFC16A                 mov     eax, [ebp+arg_8]
.text:42CFC16D                 mov     dword ptr [eax], 0
.text:42CFC173                 cmp     [ebp+var_518], 5
.text:42CFC17A                 jnz     short loc_42CFC185
.text:42CFC17C                 mov     ecx, [ebp+arg_C]
.text:42CFC17F                 mov     dword ptr [ecx], 5
.text:42CFC185
.text:42CFC185 loc_42CFC185:                           ; CODE XREF: sub_42CFB392+DE8\u2191j
.text:42CFC185                 xor     eax, eax
.text:42CFC187
.text:42CFC187 loc_42CFC187:                           ; CODE XREF: sub_42CFB392+DA7\u2191j
.text:42CFC187                 mov     esp, ebp
.text:42CFC189                 pop     ebp
.text:42CFC18A                 retn
.text:42CFC18A sub_42CFB392    endp
.text:42CFC18A
.text:42CFC18A ; ---------------------------------------------------------------------------
.text:42CFC18B jpt_42CFB9ED    dd offset loc_42CFBFE2  ; DATA XREF: sub_42CFB392+65B\u2191r
.text:42CFC18B                 dd offset loc_42CFBDD5  ; jump table for switch statement
.text:42CFC18B                 dd offset loc_42CFBE5C
.text:42CFC18B                 dd offset loc_42CFBB36
.text:42CFC18B                 dd offset loc_42CFBC41
.text:42CFC18B                 dd offset loc_42CFBC8E
.text:42CFC18B                 dd offset loc_42CFB9F4
.text:42CFC18B                 dd offset def_42CFB9ED
.text:42CFC1AB byte_42CFC1AB   db      0,     7,     7,     7
.text:42CFC1AB                                         ; DATA XREF: sub_42CFB392+655\u2191r
.text:42CFC1AB                 db      7,     7,     7,     7 ; indirect table for switch statement
.text:42CFC1AB                 db      7,     7,     7,     1
.text:42CFC1AB                 db      2,     7,     7,     7
.text:42CFC1AB                 db      7,     7,     7,     7
.text:42CFC1AB                 db      7,     7,     7,     7
.text:42CFC1AB                 db      3,     7,     7,     7
.text:42CFC1AB                 db      4,     5,     6,     7
.text:42CFC1AB                 db      0
.text:42CFC1CC                 align 10h
.text:42CFC1D0
.text:42CFC1D0 ; =============== S U B R O U T I N E =======================================
.text:42CFC1D0
.text:42CFC1D0 ; Attributes: bp-based frame
.text:42CFC1D0
.text:42CFC1D0 sub_42CFC1D0    proc near               ; CODE XREF: ConnectionInitialize+3\u2191p
.text:42CFC1D0
.text:42CFC1D0 lpLibFileName   = dword ptr -1Ch
.text:42CFC1D0 var_18          = dword ptr -18h
.text:42CFC1D0 var_14          = dword ptr -14h
.text:42CFC1D0 var_10          = dword ptr -10h
.text:42CFC1D0 hModule         = dword ptr -0Ch
.text:42CFC1D0 var_8           = dword ptr -8
.text:42CFC1D0 var_4           = dword ptr -4
.text:42CFC1D0
.text:42CFC1D0                 push    ebp
.text:42CFC1D1                 mov     ebp, esp
.text:42CFC1D3                 sub     esp, 1Ch
.text:42CFC1D6                 cmp     dword_42D01A1C, 0
.text:42CFC1DD                 jz      short loc_42CFC1E8
.text:42CFC1DF                 mov     [ebp+lpLibFileName], offset aSecurityDll_0 ; "security.dll"
.text:42CFC1E6                 jmp     short loc_42CFC1EF
.text:42CFC1E8 ; ---------------------------------------------------------------------------
.text:42CFC1E8
.text:42CFC1E8 loc_42CFC1E8:                           ; CODE XREF: sub_42CFC1D0+D\u2191j
.text:42CFC1E8                 mov     [ebp+lpLibFileName], offset aSecur32Dll ; "secur32.dll"
.text:42CFC1EF
.text:42CFC1EF loc_42CFC1EF:                           ; CODE XREF: sub_42CFC1D0+16\u2191j
.text:42CFC1EF                 mov     eax, [ebp+lpLibFileName]
.text:42CFC1F2                 push    eax             ; lpLibFileName
.text:42CFC1F3                 call    ds:LoadLibraryA
.text:42CFC1F9                 mov     [ebp+hModule], eax
.text:42CFC1FC                 cmp     [ebp+hModule], 0
.text:42CFC200                 jnz     short loc_42CFC209
.text:42CFC202                 xor     eax, eax
.text:42CFC204                 jmp     loc_42CFC2CD
.text:42CFC209 ; ---------------------------------------------------------------------------
.text:42CFC209
.text:42CFC209 loc_42CFC209:                           ; CODE XREF: sub_42CFC1D0+30\u2191j
.text:42CFC209                 push    offset aInitsecurityin_0 ; "InitSecurityInterfaceA"
.text:42CFC20E                 mov     ecx, [ebp+hModule]
.text:42CFC211                 push    ecx             ; hModule
.text:42CFC212                 call    ds:GetProcAddress
.text:42CFC218                 mov     [ebp+var_18], eax
.text:42CFC21B                 cmp     [ebp+var_18], 0
.text:42CFC21F                 jnz     short loc_42CFC228
.text:42CFC221                 xor     eax, eax
.text:42CFC223                 jmp     loc_42CFC2CD
.text:42CFC228 ; ---------------------------------------------------------------------------
.text:42CFC228
.text:42CFC228 loc_42CFC228:                           ; CODE XREF: sub_42CFC1D0+4F\u2191j
.text:42CFC228                 call    [ebp+var_18]
.text:42CFC22B                 mov     dword_42D0120C, eax
.text:42CFC230                 cmp     dword_42D0120C, 0
.text:42CFC237                 jnz     short loc_42CFC240
.text:42CFC239                 xor     eax, eax
.text:42CFC23B                 jmp     loc_42CFC2CD
.text:42CFC240 ; ---------------------------------------------------------------------------
.text:42CFC240
.text:42CFC240 loc_42CFC240:                           ; CODE XREF: sub_42CFC1D0+67\u2191j
.text:42CFC240                 mov     [ebp+var_14], 0
.text:42CFC247                 mov     [ebp+var_8], 0
.text:42CFC24E                 jmp     short loc_42CFC259
.text:42CFC250 ; ---------------------------------------------------------------------------
.text:42CFC250
.text:42CFC250 loc_42CFC250:                           ; CODE XREF: sub_42CFC1D0:loc_42CFC281\u2193j
.text:42CFC250                 mov     edx, [ebp+var_14]
.text:42CFC253                 add     edx, 1
.text:42CFC256                 mov     [ebp+var_14], edx
.text:42CFC259
.text:42CFC259 loc_42CFC259:                           ; CODE XREF: sub_42CFC1D0+7E\u2191j
.text:42CFC259                 cmp     [ebp+var_14], 3
.text:42CFC25D                 jge     short loc_42CFC283
.text:42CFC25F                 lea     eax, [ebp+var_4]
.text:42CFC262                 push    eax
.text:42CFC263                 mov     ecx, [ebp+var_14]
.text:42CFC266                 mov     edx, Src[ecx*4]
.text:42CFC26D                 push    edx
.text:42CFC26E                 mov     eax, dword_42D0120C
.text:42CFC273                 call    dword ptr [eax+44h]
.text:42CFC276                 mov     [ebp+var_10], eax
.text:42CFC279                 cmp     [ebp+var_10], 0
.text:42CFC27D                 jnz     short loc_42CFC281
.text:42CFC27F                 jmp     short loc_42CFC283
.text:42CFC281 ; ---------------------------------------------------------------------------
.text:42CFC281
.text:42CFC281 loc_42CFC281:                           ; CODE XREF: sub_42CFC1D0+AD\u2191j
.text:42CFC281                 jmp     short loc_42CFC250
.text:42CFC283 ; ---------------------------------------------------------------------------
.text:42CFC283
.text:42CFC283 loc_42CFC283:                           ; CODE XREF: sub_42CFC1D0+8D\u2191j
.text:42CFC283                                         ; sub_42CFC1D0+AF\u2191j
.text:42CFC283                 cmp     [ebp+var_14], 3
.text:42CFC287                 jl      short loc_42CFC28D
.text:42CFC289                 xor     eax, eax
.text:42CFC28B                 jmp     short loc_42CFC2CD
.text:42CFC28D ; ---------------------------------------------------------------------------
.text:42CFC28D
.text:42CFC28D loc_42CFC28D:                           ; CODE XREF: sub_42CFC1D0+B7\u2191j
.text:42CFC28D                 mov     ecx, [ebp+var_14]
.text:42CFC290                 mov     edx, dword_42D00D58[ecx*4]
.text:42CFC297                 push    edx             ; Size
.text:42CFC298                 mov     eax, [ebp+var_14]
.text:42CFC29B                 mov     ecx, Src[eax*4]
.text:42CFC2A2                 push    ecx             ; Src
.text:42CFC2A3                 push    offset unk_42D01210 ; void *
.text:42CFC2A8                 call    memcpy
.text:42CFC2AD                 add     esp, 0Ch
.text:42CFC2B0                 mov     edx, [ebp+var_4]
.text:42CFC2B3                 mov     eax, [edx+8]
.text:42CFC2B6                 mov     dword_42D020A0, eax
.text:42CFC2BB                 mov     ecx, [ebp+var_4]
.text:42CFC2BE                 push    ecx
.text:42CFC2BF                 mov     edx, dword_42D0120C
.text:42CFC2C5                 call    dword ptr [edx+40h]
.text:42CFC2C8                 mov     eax, 1
.text:42CFC2CD
.text:42CFC2CD loc_42CFC2CD:                           ; CODE XREF: sub_42CFC1D0+34\u2191j
.text:42CFC2CD                                         ; sub_42CFC1D0+53\u2191j ...
.text:42CFC2CD                 mov     esp, ebp
.text:42CFC2CF                 pop     ebp
.text:42CFC2D0                 retn
.text:42CFC2D0 sub_42CFC1D0    endp
.text:42CFC2D0
.text:42CFC2D1
.text:42CFC2D1 ; =============== S U B R O U T I N E =======================================
.text:42CFC2D1
.text:42CFC2D1 ; Attributes: bp-based frame
.text:42CFC2D1
.text:42CFC2D1 sub_42CFC2D1    proc near               ; CODE XREF: ConnectionTermSec+4B\u2191p
.text:42CFC2D1
.text:42CFC2D1 arg_0           = dword ptr  8
.text:42CFC2D1 arg_4           = dword ptr  0Ch
.text:42CFC2D1 arg_C           = dword ptr  14h
.text:42CFC2D1
.text:42CFC2D1                 push    ebp
.text:42CFC2D2                 mov     ebp, esp
.text:42CFC2D4                 cmp     [ebp+arg_0], 0
.text:42CFC2D8                 jnz     short loc_42CFC2DE
.text:42CFC2DA                 xor     eax, eax
.text:42CFC2DC                 jmp     short loc_42CFC323
.text:42CFC2DE ; ---------------------------------------------------------------------------
.text:42CFC2DE
.text:42CFC2DE loc_42CFC2DE:                           ; CODE XREF: sub_42CFC2D1+7\u2191j
.text:42CFC2DE                 mov     eax, [ebp+arg_0]
.text:42CFC2E1                 cmp     dword ptr [eax+10h], 0
.text:42CFC2E5                 jz      short loc_42CFC2F7
.text:42CFC2E7                 mov     ecx, [ebp+arg_0]
.text:42CFC2EA                 add     ecx, 14h
.text:42CFC2ED                 push    ecx
.text:42CFC2EE                 mov     edx, dword_42D0120C
.text:42CFC2F4                 call    dword ptr [edx+24h]
.text:42CFC2F7
.text:42CFC2F7 loc_42CFC2F7:                           ; CODE XREF: sub_42CFC2D1+14\u2191j
.text:42CFC2F7                 mov     eax, [ebp+arg_0]
.text:42CFC2FA                 cmp     dword ptr [eax+0Ch], 0
.text:42CFC2FE                 jz      short loc_42CFC310
.text:42CFC300                 mov     ecx, [ebp+arg_0]
.text:42CFC303                 add     ecx, 4
.text:42CFC306                 push    ecx
.text:42CFC307                 mov     edx, dword_42D0120C
.text:42CFC30D                 call    dword ptr [edx+10h]
.text:42CFC310
.text:42CFC310 loc_42CFC310:                           ; CODE XREF: sub_42CFC2D1+2D\u2191j
.text:42CFC310                 mov     eax, [ebp+arg_0]
.text:42CFC313                 push    eax
.text:42CFC314                 mov     ecx, [ebp+arg_4]
.text:42CFC317                 push    ecx
.text:42CFC318                 call    [ebp+arg_C]
.text:42CFC31B                 add     esp, 8
.text:42CFC31E                 mov     eax, 1
.text:42CFC323
.text:42CFC323 loc_42CFC323:                           ; CODE XREF: sub_42CFC2D1+B\u2191j
.text:42CFC323                 pop     ebp
.text:42CFC324                 retn
.text:42CFC324 sub_42CFC2D1    endp
.text:42CFC324
.text:42CFC325
.text:42CFC325 ; =============== S U B R O U T I N E =======================================
.text:42CFC325
.text:42CFC325 ; Attributes: bp-based frame
.text:42CFC325
.text:42CFC325 sub_42CFC325    proc near               ; CODE XREF: ConnectionSecureClient+DA\u2191p
.text:42CFC325
.text:42CFC325 var_4C          = dword ptr -4Ch
.text:42CFC325 var_48          = dword ptr -48h
.text:42CFC325 var_44          = dword ptr -44h
.text:42CFC325 var_40          = dword ptr -40h
.text:42CFC325 var_3C          = dword ptr -3Ch
.text:42CFC325 var_38          = dword ptr -38h
.text:42CFC325 var_34          = dword ptr -34h
.text:42CFC325 var_30          = dword ptr -30h
.text:42CFC325 var_2C          = dword ptr -2Ch
.text:42CFC325 var_28          = dword ptr -28h
.text:42CFC325 var_24          = dword ptr -24h
.text:42CFC325 var_20          = dword ptr -20h
.text:42CFC325 var_1C          = dword ptr -1Ch
.text:42CFC325 var_18          = dword ptr -18h
.text:42CFC325 var_14          = dword ptr -14h
.text:42CFC325 var_10          = dword ptr -10h
.text:42CFC325 var_C           = byte ptr -0Ch
.text:42CFC325 var_4           = dword ptr -4
.text:42CFC325 arg_0           = dword ptr  8
.text:42CFC325 arg_4           = dword ptr  0Ch
.text:42CFC325 arg_8           = dword ptr  10h
.text:42CFC325 arg_C           = dword ptr  14h
.text:42CFC325 arg_10          = dword ptr  18h
.text:42CFC325 arg_14          = dword ptr  1Ch
.text:42CFC325
.text:42CFC325                 push    ebp
.text:42CFC326                 mov     ebp, esp
.text:42CFC328                 sub     esp, 4Ch
.text:42CFC32B                 cmp     [ebp+arg_0], 0
.text:42CFC32F                 jnz     short loc_42CFC336
.text:42CFC331                 jmp     loc_42CFC4EA
.text:42CFC336 ; ---------------------------------------------------------------------------
.text:42CFC336
.text:42CFC336 loc_42CFC336:                           ; CODE XREF: sub_42CFC325+A\u2191j
.text:42CFC336                 mov     eax, [ebp+arg_0]
.text:42CFC339                 cmp     dword ptr [eax], 0
.text:42CFC33C                 jz      short loc_42CFC37C
.text:42CFC33E                 lea     ecx, [ebp+var_C]
.text:42CFC341                 push    ecx
.text:42CFC342                 mov     edx, [ebp+arg_0]
.text:42CFC345                 add     edx, 4
.text:42CFC348                 push    edx
.text:42CFC349                 push    0
.text:42CFC34B                 push    0
.text:42CFC34D                 push    0
.text:42CFC34F                 push    0
.text:42CFC351                 push    3
.text:42CFC353                 push    offset unk_42D01210
.text:42CFC358                 push    0
.text:42CFC35A                 mov     eax, dword_42D0120C
.text:42CFC35F                 call    dword ptr [eax+0Ch]
.text:42CFC362                 mov     [ebp+var_28], eax
.text:42CFC365                 cmp     [ebp+var_28], 0
.text:42CFC369                 jl      short loc_42CFC377
.text:42CFC36B                 mov     ecx, [ebp+arg_0]
.text:42CFC36E                 mov     dword ptr [ecx+0Ch], 1
.text:42CFC375                 jmp     short loc_42CFC37C
.text:42CFC377 ; ---------------------------------------------------------------------------
.text:42CFC377
.text:42CFC377 loc_42CFC377:                           ; CODE XREF: sub_42CFC325+44\u2191j
.text:42CFC377                 jmp     loc_42CFC4EA
.text:42CFC37C ; ---------------------------------------------------------------------------
.text:42CFC37C
.text:42CFC37C loc_42CFC37C:                           ; CODE XREF: sub_42CFC325+17\u2191j
.text:42CFC37C                                         ; sub_42CFC325+50\u2191j
.text:42CFC37C                 mov     [ebp+var_24], 0
.text:42CFC383                 mov     [ebp+var_20], 1
.text:42CFC38A                 lea     edx, [ebp+var_34]
.text:42CFC38D                 mov     [ebp+var_1C], edx
.text:42CFC390                 mov     eax, [ebp+arg_10]
.text:42CFC393                 mov     ecx, [eax]
.text:42CFC395                 mov     [ebp+var_34], ecx
.text:42CFC398                 mov     [ebp+var_30], 2
.text:42CFC39F                 mov     edx, [ebp+arg_C]
.text:42CFC3A2                 mov     [ebp+var_2C], edx
.text:42CFC3A5                 mov     [ebp+var_18], 0
.text:42CFC3AC                 mov     [ebp+var_14], 1
.text:42CFC3B3                 lea     eax, [ebp+var_40]
.text:42CFC3B6                 mov     [ebp+var_10], eax
.text:42CFC3B9                 mov     ecx, [ebp+arg_8]
.text:42CFC3BC                 mov     [ebp+var_40], ecx
.text:42CFC3BF                 mov     [ebp+var_3C], 2
.text:42CFC3C6                 mov     edx, [ebp+arg_4]
.text:42CFC3C9                 mov     [ebp+var_38], edx
.text:42CFC3CC                 mov     eax, [ebp+arg_0]
.text:42CFC3CF                 cmp     dword ptr [eax], 0
.text:42CFC3D2                 jz      short loc_42CFC3DD
.text:42CFC3D4                 mov     [ebp+var_48], 0
.text:42CFC3DB                 jmp     short loc_42CFC3E6
.text:42CFC3DD ; ---------------------------------------------------------------------------
.text:42CFC3DD
.text:42CFC3DD loc_42CFC3DD:                           ; CODE XREF: sub_42CFC325+AD\u2191j
.text:42CFC3DD                 mov     ecx, [ebp+arg_0]
.text:42CFC3E0                 add     ecx, 14h
.text:42CFC3E3                 mov     [ebp+var_48], ecx
.text:42CFC3E6
.text:42CFC3E6 loc_42CFC3E6:                           ; CODE XREF: sub_42CFC325+B6\u2191j
.text:42CFC3E6                 lea     edx, [ebp+var_C]
.text:42CFC3E9                 push    edx
.text:42CFC3EA                 lea     eax, [ebp+var_44]
.text:42CFC3ED                 push    eax
.text:42CFC3EE                 lea     ecx, [ebp+var_24]
.text:42CFC3F1                 push    ecx
.text:42CFC3F2                 mov     edx, [ebp+arg_0]
.text:42CFC3F5                 add     edx, 14h
.text:42CFC3F8                 push    edx
.text:42CFC3F9                 push    10h
.text:42CFC3FB                 push    3
.text:42CFC3FD                 lea     eax, [ebp+var_18]
.text:42CFC400                 push    eax
.text:42CFC401                 mov     ecx, [ebp+var_48]
.text:42CFC404                 push    ecx
.text:42CFC405                 mov     edx, [ebp+arg_0]
.text:42CFC408                 add     edx, 4
.text:42CFC40B                 push    edx
.text:42CFC40C                 mov     eax, dword_42D0120C
.text:42CFC411                 call    dword ptr [eax+1Ch]
.text:42CFC414                 mov     [ebp+var_28], eax
.text:42CFC417                 cmp     [ebp+var_28], 0
.text:42CFC41B                 jge     short loc_42CFC446
.text:42CFC41D                 cmp     [ebp+var_28], 80090321h
.text:42CFC424                 jz      short loc_42CFC42F
.text:42CFC426                 cmp     [ebp+var_28], 80090300h
.text:42CFC42D                 jnz     short loc_42CFC441
.text:42CFC42F
.text:42CFC42F loc_42CFC42F:                           ; CODE XREF: sub_42CFC325+FF\u2191j
.text:42CFC42F                 mov     ecx, [ebp+arg_10]
.text:42CFC432                 mov     edx, dword_42D020A0
.text:42CFC438                 mov     [ecx], edx
.text:42CFC43A                 xor     eax, eax
.text:42CFC43C                 jmp     loc_42CFC4F5
.text:42CFC441 ; ---------------------------------------------------------------------------
.text:42CFC441
.text:42CFC441 loc_42CFC441:                           ; CODE XREF: sub_42CFC325+108\u2191j
.text:42CFC441                 jmp     loc_42CFC4EA
.text:42CFC446 ; ---------------------------------------------------------------------------
.text:42CFC446
.text:42CFC446 loc_42CFC446:                           ; CODE XREF: sub_42CFC325+F6\u2191j
.text:42CFC446                 mov     eax, [ebp+arg_0]
.text:42CFC449                 mov     dword ptr [eax+10h], 1
.text:42CFC450                 cmp     [ebp+var_28], 90313h
.text:42CFC457                 jz      short loc_42CFC462
.text:42CFC459                 cmp     [ebp+var_28], 90314h
.text:42CFC460                 jnz     short loc_42CFC491
.text:42CFC462
.text:42CFC462 loc_42CFC462:                           ; CODE XREF: sub_42CFC325+132\u2191j
.text:42CFC462                 mov     ecx, dword_42D0120C
.text:42CFC468                 cmp     dword ptr [ecx+20h], 0
.text:42CFC46C                 jz      short loc_42CFC48F
.text:42CFC46E                 lea     edx, [ebp+var_24]
.text:42CFC471                 push    edx
.text:42CFC472                 mov     eax, [ebp+arg_0]
.text:42CFC475                 add     eax, 14h
.text:42CFC478                 push    eax
.text:42CFC479                 mov     ecx, dword_42D0120C
.text:42CFC47F                 call    dword ptr [ecx+20h]
.text:42CFC482                 mov     [ebp+var_28], eax
.text:42CFC485                 cmp     [ebp+var_28], 0
.text:42CFC489                 jge     short loc_42CFC48D
.text:42CFC48B                 jmp     short loc_42CFC4EA
.text:42CFC48D ; ---------------------------------------------------------------------------
.text:42CFC48D
.text:42CFC48D loc_42CFC48D:                           ; CODE XREF: sub_42CFC325+164\u2191j
.text:42CFC48D                 jmp     short loc_42CFC491
.text:42CFC48F ; ---------------------------------------------------------------------------
.text:42CFC48F
.text:42CFC48F loc_42CFC48F:                           ; CODE XREF: sub_42CFC325+147\u2191j
.text:42CFC48F                 jmp     short loc_42CFC4EA
.text:42CFC491 ; ---------------------------------------------------------------------------
.text:42CFC491
.text:42CFC491 loc_42CFC491:                           ; CODE XREF: sub_42CFC325+13B\u2191j
.text:42CFC491                                         ; sub_42CFC325:loc_42CFC48D\u2191j
.text:42CFC491                 mov     edx, [ebp+arg_10]
.text:42CFC494                 mov     eax, [ebp+var_34]
.text:42CFC497                 mov     [edx], eax
.text:42CFC499                 mov     ecx, [ebp+arg_0]
.text:42CFC49C                 cmp     dword ptr [ecx], 0
.text:42CFC49F                 jz      short loc_42CFC4AA
.text:42CFC4A1                 mov     edx, [ebp+arg_0]
.text:42CFC4A4                 mov     dword ptr [edx], 0
.text:42CFC4AA
.text:42CFC4AA loc_42CFC4AA:                           ; CODE XREF: sub_42CFC325+17A\u2191j
.text:42CFC4AA                 cmp     [ebp+var_28], 90312h
.text:42CFC4B1                 jz      short loc_42CFC4C5
.text:42CFC4B3                 cmp     [ebp+var_28], 90314h
.text:42CFC4BA                 jz      short loc_42CFC4C5
.text:42CFC4BC                 mov     [ebp+var_4C], 1
.text:42CFC4C3                 jmp     short loc_42CFC4CC
.text:42CFC4C5 ; ---------------------------------------------------------------------------
.text:42CFC4C5
.text:42CFC4C5 loc_42CFC4C5:                           ; CODE XREF: sub_42CFC325+18C\u2191j
.text:42CFC4C5                                         ; sub_42CFC325+195\u2191j
.text:42CFC4C5                 mov     [ebp+var_4C], 0
.text:42CFC4CC
.text:42CFC4CC loc_42CFC4CC:                           ; CODE XREF: sub_42CFC325+19E\u2191j
.text:42CFC4CC                 mov     eax, [ebp+arg_14]
.text:42CFC4CF                 mov     ecx, [ebp+var_4C]
.text:42CFC4D2                 mov     [eax], ecx
.text:42CFC4D4                 mov     edx, [ebp+var_44]
.text:42CFC4D7                 and     edx, 1
.text:42CFC4DA                 neg     edx
.text:42CFC4DC                 sbb     edx, edx
.text:42CFC4DE                 neg     edx
.text:42CFC4E0                 mov     [ebp+var_4], edx
.text:42CFC4E3                 mov     eax, 1
.text:42CFC4E8                 jmp     short loc_42CFC4F5
.text:42CFC4EA ; ---------------------------------------------------------------------------
.text:42CFC4EA
.text:42CFC4EA loc_42CFC4EA:                           ; CODE XREF: sub_42CFC325+C\u2191j
.text:42CFC4EA                                         ; sub_42CFC325:loc_42CFC377\u2191j ...
.text:42CFC4EA                 mov     eax, [ebp+arg_10]
.text:42CFC4ED                 mov     dword ptr [eax], 0
.text:42CFC4F3                 xor     eax, eax
.text:42CFC4F5
.text:42CFC4F5 loc_42CFC4F5:                           ; CODE XREF: sub_42CFC325+117\u2191j
.text:42CFC4F5                                         ; sub_42CFC325+1C3\u2191j
.text:42CFC4F5                 mov     esp, ebp
.text:42CFC4F7                 pop     ebp
.text:42CFC4F8                 retn
.text:42CFC4F8 sub_42CFC325    endp
.text:42CFC4F8
.text:42CFC4F9
.text:42CFC4F9 ; =============== S U B R O U T I N E =======================================
.text:42CFC4F9
.text:42CFC4F9 ; Attributes: bp-based frame
.text:42CFC4F9
.text:42CFC4F9 ; int __cdecl sub_42CFC4F9(HANDLE hNamedPipe, int, int)
.text:42CFC4F9 sub_42CFC4F9    proc near               ; CODE XREF: ConnectionImpersonate+7F\u2191p
.text:42CFC4F9
.text:42CFC4F9 var_8           = dword ptr -8
.text:42CFC4F9 var_4           = dword ptr -4
.text:42CFC4F9 hNamedPipe      = dword ptr  8
.text:42CFC4F9 arg_4           = dword ptr  0Ch
.text:42CFC4F9 arg_8           = dword ptr  10h
.text:42CFC4F9
.text:42CFC4F9                 push    ebp
.text:42CFC4FA                 mov     ebp, esp
.text:42CFC4FC                 sub     esp, 8
.text:42CFC4FF                 mov     eax, [ebp+arg_8]
.text:42CFC502                 mov     [ebp+var_8], eax
.text:42CFC505                 cmp     [ebp+var_8], 1
.text:42CFC509                 jz      short loc_42CFC513
.text:42CFC50B                 cmp     [ebp+var_8], 3
.text:42CFC50F                 jz      short loc_42CFC52A
.text:42CFC511                 jmp     short loc_42CFC547
.text:42CFC513 ; ---------------------------------------------------------------------------
.text:42CFC513
.text:42CFC513 loc_42CFC513:                           ; CODE XREF: sub_42CFC4F9+10\u2191j
.text:42CFC513                 mov     ecx, [ebp+hNamedPipe]
.text:42CFC516                 push    ecx             ; hNamedPipe
.text:42CFC517                 call    ds:ImpersonateNamedPipeClient
.text:42CFC51D                 test    eax, eax
.text:42CFC51F                 jz      short loc_42CFC528
.text:42CFC521                 mov     eax, 1
.text:42CFC526                 jmp     short loc_42CFC573
.text:42CFC528 ; ---------------------------------------------------------------------------
.text:42CFC528
.text:42CFC528 loc_42CFC528:                           ; CODE XREF: sub_42CFC4F9+26\u2191j
.text:42CFC528                 jmp     short loc_42CFC571
.text:42CFC52A ; ---------------------------------------------------------------------------
.text:42CFC52A
.text:42CFC52A loc_42CFC52A:                           ; CODE XREF: sub_42CFC4F9+16\u2191j
.text:42CFC52A                 cmp     [ebp+hNamedPipe], 0
.text:42CFC52E                 jz      short loc_42CFC545
.text:42CFC530                 mov     edx, [ebp+hNamedPipe]
.text:42CFC533                 push    edx             ; hToken
.text:42CFC534                 call    ds:ImpersonateLoggedOnUser
.text:42CFC53A                 test    eax, eax
.text:42CFC53C                 jz      short loc_42CFC545
.text:42CFC53E                 mov     eax, 1
.text:42CFC543                 jmp     short loc_42CFC573
.text:42CFC545 ; ---------------------------------------------------------------------------
.text:42CFC545
.text:42CFC545 loc_42CFC545:                           ; CODE XREF: sub_42CFC4F9+35\u2191j
.text:42CFC545                                         ; sub_42CFC4F9+43\u2191j
.text:42CFC545                 jmp     short loc_42CFC571
.text:42CFC547 ; ---------------------------------------------------------------------------
.text:42CFC547
.text:42CFC547 loc_42CFC547:                           ; CODE XREF: sub_42CFC4F9+18\u2191j
.text:42CFC547                 cmp     [ebp+arg_4], 0
.text:42CFC54B                 jnz     short loc_42CFC551
.text:42CFC54D                 xor     eax, eax
.text:42CFC54F                 jmp     short loc_42CFC573
.text:42CFC551 ; ---------------------------------------------------------------------------
.text:42CFC551
.text:42CFC551 loc_42CFC551:                           ; CODE XREF: sub_42CFC4F9+52\u2191j
.text:42CFC551                 mov     eax, [ebp+arg_4]
.text:42CFC554                 add     eax, 14h
.text:42CFC557                 push    eax
.text:42CFC558                 mov     ecx, dword_42D0120C
.text:42CFC55E                 call    dword ptr [ecx+30h]
.text:42CFC561                 mov     [ebp+var_4], eax
.text:42CFC564                 cmp     [ebp+var_4], 0
.text:42CFC568                 jl      short loc_42CFC571
.text:42CFC56A                 mov     eax, 1
.text:42CFC56F                 jmp     short loc_42CFC573
.text:42CFC571 ; ---------------------------------------------------------------------------
.text:42CFC571
.text:42CFC571 loc_42CFC571:                           ; CODE XREF: sub_42CFC4F9:loc_42CFC528\u2191j
.text:42CFC571                                         ; sub_42CFC4F9:loc_42CFC545\u2191j ...
.text:42CFC571                 xor     eax, eax
.text:42CFC573
.text:42CFC573 loc_42CFC573:                           ; CODE XREF: sub_42CFC4F9+2D\u2191j
.text:42CFC573                                         ; sub_42CFC4F9+4A\u2191j ...
.text:42CFC573                 mov     esp, ebp
.text:42CFC575                 pop     ebp
.text:42CFC576                 retn
.text:42CFC576 sub_42CFC4F9    endp
.text:42CFC576
.text:42CFC577
.text:42CFC577 ; =============== S U B R O U T I N E =======================================
.text:42CFC577
.text:42CFC577 ; Attributes: bp-based frame
.text:42CFC577
.text:42CFC577 sub_42CFC577    proc near               ; CODE XREF: ConnectionRevert+1E\u2191p
.text:42CFC577
.text:42CFC577 var_8           = dword ptr -8
.text:42CFC577 var_4           = dword ptr -4
.text:42CFC577 arg_0           = dword ptr  8
.text:42CFC577 arg_4           = dword ptr  0Ch
.text:42CFC577
.text:42CFC577                 push    ebp
.text:42CFC578                 mov     ebp, esp
.text:42CFC57A                 sub     esp, 8
.text:42CFC57D                 mov     eax, [ebp+arg_4]
.text:42CFC580                 mov     [ebp+var_8], eax
.text:42CFC583                 cmp     [ebp+var_8], 5
.text:42CFC587                 jz      short loc_42CFC591
.text:42CFC589                 cmp     [ebp+var_8], 7
.text:42CFC58D                 jz      short loc_42CFC591
.text:42CFC58F                 jmp     short loc_42CFC5BD
.text:42CFC591 ; ---------------------------------------------------------------------------
.text:42CFC591
.text:42CFC591 loc_42CFC591:                           ; CODE XREF: sub_42CFC577+10\u2191j
.text:42CFC591                                         ; sub_42CFC577+16\u2191j
.text:42CFC591                 cmp     [ebp+arg_0], 0
.text:42CFC595                 jnz     short loc_42CFC59B
.text:42CFC597                 xor     eax, eax
.text:42CFC599                 jmp     short loc_42CFC5D1
.text:42CFC59B ; ---------------------------------------------------------------------------
.text:42CFC59B
.text:42CFC59B loc_42CFC59B:                           ; CODE XREF: sub_42CFC577+1E\u2191j
.text:42CFC59B                 mov     ecx, [ebp+arg_0]
.text:42CFC59E                 add     ecx, 14h
.text:42CFC5A1                 push    ecx
.text:42CFC5A2                 mov     edx, dword_42D0120C
.text:42CFC5A8                 call    dword ptr [edx+34h]
.text:42CFC5AB                 mov     [ebp+var_4], eax
.text:42CFC5AE                 cmp     [ebp+var_4], 0
.text:42CFC5B2                 jl      short loc_42CFC5BB
.text:42CFC5B4                 mov     eax, 1
.text:42CFC5B9                 jmp     short loc_42CFC5D1
.text:42CFC5BB ; ---------------------------------------------------------------------------
.text:42CFC5BB
.text:42CFC5BB loc_42CFC5BB:                           ; CODE XREF: sub_42CFC577+3B\u2191j
.text:42CFC5BB                 jmp     short loc_42CFC5CF
.text:42CFC5BD ; ---------------------------------------------------------------------------
.text:42CFC5BD
.text:42CFC5BD loc_42CFC5BD:                           ; CODE XREF: sub_42CFC577+18\u2191j
.text:42CFC5BD                 call    ds:RevertToSelf
.text:42CFC5C3                 cmp     eax, 1
.text:42CFC5C6                 jnz     short loc_42CFC5CF
.text:42CFC5C8                 mov     eax, 1
.text:42CFC5CD                 jmp     short loc_42CFC5D1
.text:42CFC5CF ; ---------------------------------------------------------------------------
.text:42CFC5CF
.text:42CFC5CF loc_42CFC5CF:                           ; CODE XREF: sub_42CFC577:loc_42CFC5BB\u2191j
.text:42CFC5CF                                         ; sub_42CFC577+4F\u2191j
.text:42CFC5CF                 xor     eax, eax
.text:42CFC5D1
.text:42CFC5D1 loc_42CFC5D1:                           ; CODE XREF: sub_42CFC577+22\u2191j
.text:42CFC5D1                                         ; sub_42CFC577+42\u2191j ...
.text:42CFC5D1                 mov     esp, ebp
.text:42CFC5D3                 pop     ebp
.text:42CFC5D4                 retn
.text:42CFC5D4 sub_42CFC577    endp
.text:42CFC5D4
.text:42CFC5D4 ; ---------------------------------------------------------------------------
.text:42CFC5D5                 align 10h
.text:42CFC5E0
.text:42CFC5E0 ; =============== S U B R O U T I N E =======================================
.text:42CFC5E0
.text:42CFC5E0 ; Attributes: bp-based frame
.text:42CFC5E0
.text:42CFC5E0 ; int __cdecl sub_42CFC5E0(int, int, char *Source)
.text:42CFC5E0 sub_42CFC5E0    proc near               ; CODE XREF: ConnectionListen+FB4\u2191p
.text:42CFC5E0
.text:42CFC5E0 arg_0           = dword ptr  8
.text:42CFC5E0 arg_4           = dword ptr  0Ch
.text:42CFC5E0 Source          = dword ptr  10h
.text:42CFC5E0
.text:42CFC5E0                 push    ebp
.text:42CFC5E1                 mov     ebp, esp
.text:42CFC5E3                 push    50h ; 'P'       ; Size
.text:42CFC5E5                 push    0               ; Val
.text:42CFC5E7                 push    offset dword_42D014C0 ; void *
.text:42CFC5EC                 call    memset
.text:42CFC5F1                 add     esp, 0Ch
.text:42CFC5F4                 push    0               ; lpName
.text:42CFC5F6                 push    0               ; bInitialState
.text:42CFC5F8                 push    1               ; bManualReset
.text:42CFC5FA                 push    0               ; lpEventAttributes
.text:42CFC5FC                 call    ds:CreateEventA
.text:42CFC602                 mov     dword_42D014C8, eax
.text:42CFC607                 mov     eax, dword_42D014C8
.text:42CFC60C                 push    eax             ; hEvent
.text:42CFC60D                 call    ds:ResetEvent
.text:42CFC613                 push    0               ; lpName
.text:42CFC615                 push    0               ; bInitialOwner
.text:42CFC617                 push    0               ; lpMutexAttributes
.text:42CFC619                 call    ds:CreateMutexA
.text:42CFC61F                 mov     dword_42D014CC, eax
.text:42CFC624                 push    0               ; lpName
.text:42CFC626                 push    0               ; bInitialState
.text:42CFC628                 push    1               ; bManualReset
.text:42CFC62A                 push    0               ; lpEventAttributes
.text:42CFC62C                 call    ds:CreateEventA
.text:42CFC632                 mov     dword_42D014D0, eax
.text:42CFC637                 mov     dword_42D014D4, 0
.text:42CFC641                 cmp     [ebp+arg_4], 0
.text:42CFC645                 jz      short loc_42CFC652
.text:42CFC647                 mov     word_42D01508, 3F5h
.text:42CFC650                 jmp     short loc_42CFC65B
.text:42CFC652 ; ---------------------------------------------------------------------------
.text:42CFC652
.text:42CFC652 loc_42CFC652:                           ; CODE XREF: sub_42CFC5E0+65\u2191j
.text:42CFC652                 mov     word_42D01508, 496h
.text:42CFC65B
.text:42CFC65B loc_42CFC65B:                           ; CODE XREF: sub_42CFC5E0+70\u2191j
.text:42CFC65B                 mov     ecx, [ebp+Source]
.text:42CFC65E                 push    ecx             ; Source
.text:42CFC65F                 push    offset Destination ; Destination
.text:42CFC664                 call    strcpy
.text:42CFC669                 add     esp, 8
.text:42CFC66C                 mov     edx, [ebp+arg_0]
.text:42CFC66F                 mov     dword_42D0150C, edx
.text:42CFC675                 push    offset dword_42D014C4 ; lpThreadId
.text:42CFC67A                 push    0               ; dwCreationFlags
.text:42CFC67C                 push    0               ; lpParameter
.text:42CFC67E                 push    offset sub_42CFC6C2 ; lpStartAddress
.text:42CFC683                 push    1000h           ; dwStackSize
.text:42CFC688                 push    0               ; lpThreadAttributes
.text:42CFC68A                 call    ds:CreateThread
.text:42CFC690                 mov     dword_42D014C0, eax
.text:42CFC695                 cmp     dword_42D014C0, 0
.text:42CFC69C                 jnz     short loc_42CFC6A2
.text:42CFC69E                 xor     eax, eax
.text:42CFC6A0                 jmp     short loc_42CFC6C0
.text:42CFC6A2 ; ---------------------------------------------------------------------------
.text:42CFC6A2
.text:42CFC6A2 loc_42CFC6A2:                           ; CODE XREF: sub_42CFC5E0+BC\u2191j
.text:42CFC6A2                 push    3A98h           ; dwMilliseconds
.text:42CFC6A7                 mov     eax, dword_42D014C8
.text:42CFC6AC                 push    eax             ; hHandle
.text:42CFC6AD                 call    ds:WaitForSingleObject
.text:42CFC6B3                 test    eax, eax
.text:42CFC6B5                 jz      short loc_42CFC6BB
.text:42CFC6B7                 xor     eax, eax
.text:42CFC6B9                 jmp     short loc_42CFC6C0
.text:42CFC6BB ; ---------------------------------------------------------------------------
.text:42CFC6BB
.text:42CFC6BB loc_42CFC6BB:                           ; CODE XREF: sub_42CFC5E0+D5\u2191j
.text:42CFC6BB                 mov     eax, 1
.text:42CFC6C0
.text:42CFC6C0 loc_42CFC6C0:                           ; CODE XREF: sub_42CFC5E0+C0\u2191j
.text:42CFC6C0                                         ; sub_42CFC5E0+D9\u2191j
.text:42CFC6C0                 pop     ebp
.text:42CFC6C1                 retn
.text:42CFC6C1 sub_42CFC5E0    endp
.text:42CFC6C1
.text:42CFC6C2
.text:42CFC6C2 ; =============== S U B R O U T I N E =======================================
.text:42CFC6C2
.text:42CFC6C2 ; Attributes: noreturn bp-based frame
.text:42CFC6C2
.text:42CFC6C2 ; DWORD __stdcall sub_42CFC6C2(LPVOID lpThreadParameter)
.text:42CFC6C2 sub_42CFC6C2    proc near               ; DATA XREF: sub_42CFC5E0+9E\u2191o
.text:42CFC6C2
.text:42CFC6C2 s               = dword ptr -0DCh
.text:42CFC6C2 var_D8          = sockaddr ptr -0D8h
.text:42CFC6C2 var_C8          = byte ptr -0C8h
.text:42CFC6C2 namelen         = dword ptr -64h
.text:42CFC6C2 buf             = byte ptr -60h
.text:42CFC6C2 var_5E          = word ptr -5Eh
.text:42CFC6C2 Destination     = byte ptr -5Ch
.text:42CFC6C2 var_2C          = byte ptr -2Ch
.text:42CFC6C2 var_28          = byte ptr -28h
.text:42CFC6C2 var_22          = word ptr -22h
.text:42CFC6C2 var_20          = word ptr -20h
.text:42CFC6C2 var_1C          = byte ptr -1Ch
.text:42CFC6C2 name            = sockaddr ptr -18h
.text:42CFC6C2 optval          = byte ptr -8
.text:42CFC6C2 var_4           = dword ptr -4
.text:42CFC6C2 lpThreadParameter= dword ptr  8
.text:42CFC6C2
.text:42CFC6C2                 push    ebp
.text:42CFC6C3                 mov     ebp, esp
.text:42CFC6C5                 sub     esp, 0DCh
.text:42CFC6CB                 push    3E8h            ; protocol
.text:42CFC6D0                 push    2               ; type
.text:42CFC6D2                 push    6               ; af
.text:42CFC6D4                 call    ds:socket
.text:42CFC6DA                 mov     [ebp+s], eax
.text:42CFC6E0                 cmp     [ebp+s], 0FFFFFFFFh
.text:42CFC6E7                 jnz     short loc_42CFC6EE
.text:42CFC6E9                 jmp     loc_42CFC9AD
.text:42CFC6EE ; ---------------------------------------------------------------------------
.text:42CFC6EE
.text:42CFC6EE loc_42CFC6EE:                           ; CODE XREF: sub_42CFC6C2+25\u2191j
.text:42CFC6EE                 mov     dword ptr [ebp+optval], 1
.text:42CFC6F5                 push    4               ; optlen
.text:42CFC6F7                 lea     eax, [ebp+optval]
.text:42CFC6FA                 push    eax             ; optval
.text:42CFC6FB                 push    20h ; ' '       ; optname
.text:42CFC6FD                 push    0FFFFh          ; level
.text:42CFC702                 mov     ecx, [ebp+s]
.text:42CFC708                 push    ecx             ; s
.text:42CFC709                 call    ds:setsockopt
.text:42CFC70F                 cmp     eax, 0FFFFFFFFh
.text:42CFC712                 jnz     short loc_42CFC719
.text:42CFC714                 jmp     loc_42CFC9AD
.text:42CFC719 ; ---------------------------------------------------------------------------
.text:42CFC719
.text:42CFC719 loc_42CFC719:                           ; CODE XREF: sub_42CFC6C2+50\u2191j
.text:42CFC719                 push    0Eh             ; Size
.text:42CFC71B                 push    0               ; Val
.text:42CFC71D                 lea     edx, [ebp+name]
.text:42CFC720                 push    edx             ; void *
.text:42CFC721                 call    memset
.text:42CFC726                 add     esp, 0Ch
.text:42CFC729                 mov     [ebp+name.sa_data+3], 0
.text:42CFC72D                 mov     [ebp+name.sa_family], 6
.text:42CFC733                 push    0               ; hostshort
.text:42CFC735                 call    ds:htons
.text:42CFC73B                 mov     word ptr [ebp+name.sa_data+0Ah], ax
.text:42CFC73F                 push    0Eh             ; namelen
.text:42CFC741                 lea     eax, [ebp+name]
.text:42CFC744                 push    eax             ; name
.text:42CFC745                 mov     ecx, [ebp+s]
.text:42CFC74B                 push    ecx             ; s
.text:42CFC74C                 call    ds:bind
.text:42CFC752                 cmp     eax, 0FFFFFFFFh
.text:42CFC755                 jnz     short loc_42CFC75C
.text:42CFC757                 jmp     loc_42CFC9AD
.text:42CFC75C ; ---------------------------------------------------------------------------
.text:42CFC75C
.text:42CFC75C loc_42CFC75C:                           ; CODE XREF: sub_42CFC6C2+93\u2191j
.text:42CFC75C                 push    0Eh             ; Size
.text:42CFC75E                 push    0               ; Val
.text:42CFC760                 lea     edx, [ebp+var_D8]
.text:42CFC766                 push    edx             ; void *
.text:42CFC767                 call    memset
.text:42CFC76C                 add     esp, 0Ch
.text:42CFC76F                 mov     [ebp+var_D8.sa_family], 6
.text:42CFC778                 push    6               ; Size
.text:42CFC77A                 push    0FFh            ; Val
.text:42CFC77F                 lea     eax, [ebp+var_D8.sa_data+4]
.text:42CFC785                 push    eax             ; void *
.text:42CFC786                 call    memset
.text:42CFC78B                 add     esp, 0Ch
.text:42CFC78E                 push    452h            ; hostshort
.text:42CFC793                 call    ds:htons
.text:42CFC799                 mov     word ptr [ebp+var_D8.sa_data+0Ah], ax
.text:42CFC7A0                 push    0Eh             ; namelen
.text:42CFC7A2                 lea     ecx, [ebp+var_D8]
.text:42CFC7A8                 push    ecx             ; name
.text:42CFC7A9                 mov     edx, [ebp+s]
.text:42CFC7AF                 push    edx             ; s
.text:42CFC7B0                 call    ds:connect
.text:42CFC7B6                 cmp     eax, 0FFFFFFFFh
.text:42CFC7B9                 jnz     short loc_42CFC7C0
.text:42CFC7BB                 jmp     loc_42CFC9AD
.text:42CFC7C0 ; ---------------------------------------------------------------------------
.text:42CFC7C0
.text:42CFC7C0 loc_42CFC7C0:                           ; CODE XREF: sub_42CFC6C2+F7\u2191j
.text:42CFC7C0                 mov     [ebp+namelen], 64h ; 'd'
.text:42CFC7C7                 lea     eax, [ebp+var_C8]
.text:42CFC7CD                 mov     [ebp+var_4], eax
.text:42CFC7D0                 lea     ecx, [ebp+namelen]
.text:42CFC7D3                 push    ecx             ; namelen
.text:42CFC7D4                 mov     edx, [ebp+var_4]
.text:42CFC7D7                 push    edx             ; name
.text:42CFC7D8                 mov     eax, dword_42D0150C
.text:42CFC7DD                 push    eax             ; s
.text:42CFC7DE                 call    ds:getsockname
.text:42CFC7E4                 cmp     eax, 0FFFFFFFFh
.text:42CFC7E7                 jnz     short loc_42CFC7EE
.text:42CFC7E9                 jmp     loc_42CFC9AD
.text:42CFC7EE ; ---------------------------------------------------------------------------
.text:42CFC7EE
.text:42CFC7EE loc_42CFC7EE:                           ; CODE XREF: sub_42CFC6C2+125\u2191j
.text:42CFC7EE                 push    42h ; 'B'       ; Size
.text:42CFC7F0                 push    0               ; Val
.text:42CFC7F2                 lea     ecx, [ebp+buf]
.text:42CFC7F5                 push    ecx             ; void *
.text:42CFC7F6                 call    memset
.text:42CFC7FB                 add     esp, 0Ch
.text:42CFC7FE                 mov     word ptr [ebp+buf], 200h
.text:42CFC804                 mov     dx, word_42D01508
.text:42CFC80B                 mov     [ebp+var_5E], dx
.text:42CFC80F                 push    offset Destination ; Source
.text:42CFC814                 lea     eax, [ebp+Destination]
.text:42CFC817                 push    eax             ; Destination
.text:42CFC818                 call    strcpy
.text:42CFC81D                 add     esp, 8
.text:42CFC820                 push    4               ; Size
.text:42CFC822                 mov     ecx, [ebp+var_4]
.text:42CFC825                 add     ecx, 2
.text:42CFC828                 push    ecx             ; Src
.text:42CFC829                 lea     edx, [ebp+var_2C]
.text:42CFC82C                 push    edx             ; void *
.text:42CFC82D                 call    memcpy
.text:42CFC832                 add     esp, 0Ch
.text:42CFC835                 push    6               ; Size
.text:42CFC837                 mov     eax, [ebp+var_4]
.text:42CFC83A                 add     eax, 6
.text:42CFC83D                 push    eax             ; Src
.text:42CFC83E                 lea     ecx, [ebp+var_28]
.text:42CFC841                 push    ecx             ; void *
.text:42CFC842                 call    memcpy
.text:42CFC847                 add     esp, 0Ch
.text:42CFC84A                 mov     edx, [ebp+var_4]
.text:42CFC84D                 mov     ax, [edx+0Ch]
.text:42CFC851                 mov     [ebp+var_22], ax
.text:42CFC855                 mov     [ebp+var_20], 100h
.text:42CFC85B                 push    0               ; flags
.text:42CFC85D                 push    42h ; 'B'       ; len
.text:42CFC85F                 lea     ecx, [ebp+buf]
.text:42CFC862                 push    ecx             ; buf
.text:42CFC863                 mov     edx, [ebp+s]
.text:42CFC869                 push    edx             ; s
.text:42CFC86A                 call    ds:send
.text:42CFC870                 cmp     eax, 0FFFFFFFFh
.text:42CFC873                 jnz     short loc_42CFC87A
.text:42CFC875                 jmp     loc_42CFC9AD
.text:42CFC87A ; ---------------------------------------------------------------------------
.text:42CFC87A
.text:42CFC87A loc_42CFC87A:                           ; CODE XREF: sub_42CFC6C2+1B1\u2191j
.text:42CFC87A                 mov     eax, dword_42D014C8
.text:42CFC87F                 push    eax             ; hEvent
.text:42CFC880                 call    ds:SetEvent
.text:42CFC886
.text:42CFC886 loc_42CFC886:                           ; CODE XREF: sub_42CFC6C2:loc_42CFC9A0\u2193j
.text:42CFC886                 mov     ecx, 1
.text:42CFC88B                 test    ecx, ecx
.text:42CFC88D                 jz      loc_42CFC9A5
.text:42CFC893
.text:42CFC893 loc_42CFC893:                           ; CODE XREF: sub_42CFC6C2:loc_42CFC908\u2193j
.text:42CFC893                 mov     edx, 1
.text:42CFC898                 test    edx, edx
.text:42CFC89A                 jz      short loc_42CFC90A
.text:42CFC89C                 push    0               ; flags
.text:42CFC89E                 push    42h ; 'B'       ; len
.text:42CFC8A0                 lea     eax, [ebp+buf]
.text:42CFC8A3                 push    eax             ; buf
.text:42CFC8A4                 mov     ecx, [ebp+s]
.text:42CFC8AA                 push    ecx             ; s
.text:42CFC8AB                 call    ds:send
.text:42CFC8B1                 cmp     eax, 0FFFFFFFFh
.text:42CFC8B4                 jnz     short loc_42CFC906
.text:42CFC8B6                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CFC8B8                 mov     edx, dword_42D014CC
.text:42CFC8BE                 push    edx             ; hHandle
.text:42CFC8BF                 call    ds:WaitForSingleObject
.text:42CFC8C5                 cmp     dword_42D014D4, 0
.text:42CFC8CC                 jz      short loc_42CFC8EC
.text:42CFC8CE                 mov     eax, dword_42D014D0
.text:42CFC8D3                 push    eax             ; hEvent
.text:42CFC8D4                 call    ds:SetEvent
.text:42CFC8DA                 mov     ecx, dword_42D014CC
.text:42CFC8E0                 push    ecx             ; hMutex
.text:42CFC8E1                 call    ds:ReleaseMutex
.text:42CFC8E7                 jmp     loc_42CFC9A5
.text:42CFC8EC ; ---------------------------------------------------------------------------
.text:42CFC8EC
.text:42CFC8EC loc_42CFC8EC:                           ; CODE XREF: sub_42CFC6C2+20A\u2191j
.text:42CFC8EC                 mov     edx, dword_42D014CC
.text:42CFC8F2                 push    edx             ; hMutex
.text:42CFC8F3                 call    ds:ReleaseMutex
.text:42CFC8F9                 push    3E8h            ; dwMilliseconds
.text:42CFC8FE                 call    ds:Sleep
.text:42CFC904                 jmp     short loc_42CFC908
.text:42CFC906 ; ---------------------------------------------------------------------------
.text:42CFC906
.text:42CFC906 loc_42CFC906:                           ; CODE XREF: sub_42CFC6C2+1F2\u2191j
.text:42CFC906                 jmp     short loc_42CFC90A
.text:42CFC908 ; ---------------------------------------------------------------------------
.text:42CFC908
.text:42CFC908 loc_42CFC908:                           ; CODE XREF: sub_42CFC6C2+242\u2191j
.text:42CFC908                 jmp     short loc_42CFC893
.text:42CFC90A ; ---------------------------------------------------------------------------
.text:42CFC90A
.text:42CFC90A loc_42CFC90A:                           ; CODE XREF: sub_42CFC6C2+1D8\u2191j
.text:42CFC90A                                         ; sub_42CFC6C2:loc_42CFC906\u2191j
.text:42CFC90A                 mov     [ebp+var_1C], 0
.text:42CFC90E                 jmp     short loc_42CFC918
.text:42CFC910 ; ---------------------------------------------------------------------------
.text:42CFC910
.text:42CFC910 loc_42CFC910:                           ; CODE XREF: sub_42CFC6C2+2D9\u2193j
.text:42CFC910                 mov     al, [ebp+var_1C]
.text:42CFC913                 add     al, 1
.text:42CFC915                 mov     [ebp+var_1C], al
.text:42CFC918
.text:42CFC918 loc_42CFC918:                           ; CODE XREF: sub_42CFC6C2+24C\u2191j
.text:42CFC918                 movsx   ecx, [ebp+var_1C]
.text:42CFC91C                 cmp     ecx, 0Bh
.text:42CFC91F                 jge     short loc_42CFC9A0
.text:42CFC921                 push    1388h           ; dwMilliseconds
.text:42CFC926                 call    ds:Sleep
.text:42CFC92C                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CFC92E                 mov     edx, dword_42D014CC
.text:42CFC934                 push    edx             ; hHandle
.text:42CFC935                 call    ds:WaitForSingleObject
.text:42CFC93B                 cmp     dword_42D014D4, 0
.text:42CFC942                 jz      short loc_42CFC98E
.text:42CFC944                 mov     [ebp+var_20], 1
.text:42CFC94A                 push    0               ; flags
.text:42CFC94C                 push    42h ; 'B'       ; len
.text:42CFC94E                 lea     eax, [ebp+buf]
.text:42CFC951                 push    eax             ; buf
.text:42CFC952                 mov     ecx, [ebp+s]
.text:42CFC958                 push    ecx             ; s
.text:42CFC959                 call    ds:send
.text:42CFC95F                 cmp     eax, 0FFFFFFFFh
.text:42CFC962                 jnz     short loc_42CFC966
.text:42CFC964                 jmp     short loc_42CFC9AD
.text:42CFC966 ; ---------------------------------------------------------------------------
.text:42CFC966
.text:42CFC966 loc_42CFC966:                           ; CODE XREF: sub_42CFC6C2+2A0\u2191j
.text:42CFC966                 mov     edx, [ebp+s]
.text:42CFC96C                 push    edx             ; s
.text:42CFC96D                 call    ds:closesocket
.text:42CFC973                 mov     eax, dword_42D014D0
.text:42CFC978                 push    eax             ; hEvent
.text:42CFC979                 call    ds:SetEvent
.text:42CFC97F                 mov     ecx, dword_42D014CC
.text:42CFC985                 push    ecx             ; hMutex
.text:42CFC986                 call    ds:ReleaseMutex
.text:42CFC98C                 jmp     short loc_42CFC9A5
.text:42CFC98E ; ---------------------------------------------------------------------------
.text:42CFC98E
.text:42CFC98E loc_42CFC98E:                           ; CODE XREF: sub_42CFC6C2+280\u2191j
.text:42CFC98E                 mov     edx, dword_42D014CC
.text:42CFC994                 push    edx             ; hMutex
.text:42CFC995                 call    ds:ReleaseMutex
.text:42CFC99B                 jmp     loc_42CFC910
.text:42CFC9A0 ; ---------------------------------------------------------------------------
.text:42CFC9A0
.text:42CFC9A0 loc_42CFC9A0:                           ; CODE XREF: sub_42CFC6C2+25D\u2191j
.text:42CFC9A0                 jmp     loc_42CFC886
.text:42CFC9A5 ; ---------------------------------------------------------------------------
.text:42CFC9A5
.text:42CFC9A5 loc_42CFC9A5:                           ; CODE XREF: sub_42CFC6C2+1CB\u2191j
.text:42CFC9A5                                         ; sub_42CFC6C2+225\u2191j ...
.text:42CFC9A5                 push    0               ; dwExitCode
.text:42CFC9A7                 call    ds:ExitThread
.text:42CFC9AD ; ---------------------------------------------------------------------------
.text:42CFC9AD
.text:42CFC9AD loc_42CFC9AD:                           ; CODE XREF: sub_42CFC6C2+27\u2191j
.text:42CFC9AD                                         ; sub_42CFC6C2+52\u2191j ...
.text:42CFC9AD                 mov     dword_42D014C0, 0
.text:42CFC9B7                 push    1               ; dwExitCode
.text:42CFC9B9                 call    ds:ExitThread
.text:42CFC9B9 sub_42CFC6C2    endp
.text:42CFC9B9
.text:42CFC9BF ; ---------------------------------------------------------------------------
.text:42CFC9BF                 mov     esp, ebp
.text:42CFC9C1                 pop     ebp
.text:42CFC9C2                 retn
.text:42CFC9C3
.text:42CFC9C3 ; =============== S U B R O U T I N E =======================================
.text:42CFC9C3
.text:42CFC9C3 ; Attributes: bp-based frame
.text:42CFC9C3
.text:42CFC9C3 sub_42CFC9C3    proc near               ; CODE XREF: ConnectionClose+16F\u2191p
.text:42CFC9C3                 push    ebp
.text:42CFC9C4                 mov     ebp, esp
.text:42CFC9C6                 cmp     dword_42D014C0, 0
.text:42CFC9CD                 jz      short loc_42CFCA24
.text:42CFC9CF                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CFC9D1                 mov     eax, dword_42D014CC
.text:42CFC9D6                 push    eax             ; hHandle
.text:42CFC9D7                 call    ds:WaitForSingleObject
.text:42CFC9DD                 mov     dword_42D014D4, 1
.text:42CFC9E7                 mov     ecx, dword_42D014D0
.text:42CFC9ED                 push    ecx             ; hEvent
.text:42CFC9EE                 call    ds:ResetEvent
.text:42CFC9F4                 mov     edx, dword_42D014CC
.text:42CFC9FA                 push    edx             ; hMutex
.text:42CFC9FB                 call    ds:ReleaseMutex
.text:42CFCA01                 push    0FFFFFFFFh      ; dwMilliseconds
.text:42CFCA03                 mov     eax, dword_42D014D0
.text:42CFCA08                 push    eax             ; hHandle
.text:42CFCA09                 call    ds:WaitForSingleObject
.text:42CFCA0F                 push    1F4h            ; dwMilliseconds
.text:42CFCA14                 call    ds:Sleep
.text:42CFCA1A                 mov     dword_42D014C0, 0
.text:42CFCA24
.text:42CFCA24 loc_42CFCA24:                           ; CODE XREF: sub_42CFC9C3+A\u2191j
.text:42CFCA24                 pop     ebp
.text:42CFCA25                 retn
.text:42CFCA25 sub_42CFC9C3    endp
.text:42CFCA25
.text:42CFCA25 ; ---------------------------------------------------------------------------
.text:42CFCA26                 align 10h
.text:42CFCA30
.text:42CFCA30 ; =============== S U B R O U T I N E =======================================
.text:42CFCA30
.text:42CFCA30 ; Attributes: bp-based frame
.text:42CFCA30
.text:42CFCA30 sub_42CFCA30    proc near               ; CODE XREF: sub_42CFCA5A+61\u2193p
.text:42CFCA30
.text:42CFCA30 arg_0           = dword ptr  8
.text:42CFCA30 arg_4           = dword ptr  0Ch
.text:42CFCA30
.text:42CFCA30                 push    ebp
.text:42CFCA31                 mov     ebp, esp
.text:42CFCA33                 mov     eax, [ebp+arg_0]
.text:42CFCA36                 push    eax
.text:42CFCA37                 mov     ecx, [ebp+arg_4]
.text:42CFCA3A                 push    ecx
.text:42CFCA3B                 push    0
.text:42CFCA3D                 push    0
.text:42CFCA3F                 push    0
.text:42CFCA41                 mov     dx, word ptr dword_42D0148C
.text:42CFCA48                 push    edx
.text:42CFCA49                 push    0
.text:42CFCA4B                 push    offset aMssqlsvc ; "MSSQLSvc"
.text:42CFCA50                 push    0
.text:42CFCA52                 call    dword_42D01228
.text:42CFCA58                 pop     ebp
.text:42CFCA59                 retn
.text:42CFCA59 sub_42CFCA30    endp
.text:42CFCA59
.text:42CFCA5A
.text:42CFCA5A ; =============== S U B R O U T I N E =======================================
.text:42CFCA5A
.text:42CFCA5A ; Attributes: bp-based frame
.text:42CFCA5A
.text:42CFCA5A sub_42CFCA5A    proc near               ; CODE XREF: ConnectionListen+1101\u2191p
.text:42CFCA5A                                         ; ConnectionClose+C8\u2191p
.text:42CFCA5A
.text:42CFCA5A var_22C         = dword ptr -22Ch
.text:42CFCA5A var_228         = dword ptr -228h
.text:42CFCA5A var_224         = dword ptr -224h
.text:42CFCA5A var_220         = dword ptr -220h
.text:42CFCA5A var_21C         = dword ptr -21Ch
.text:42CFCA5A var_218         = dword ptr -218h
.text:42CFCA5A Destination     = byte ptr -214h
.text:42CFCA5A Buffer          = byte ptr -110h
.text:42CFCA5A var_10          = dword ptr -10h
.text:42CFCA5A var_C           = dword ptr -0Ch
.text:42CFCA5A pcbBuffer       = dword ptr -8
.text:42CFCA5A var_4           = dword ptr -4
.text:42CFCA5A arg_0           = dword ptr  8
.text:42CFCA5A arg_4           = dword ptr  0Ch
.text:42CFCA5A
.text:42CFCA5A                 push    ebp
.text:42CFCA5B                 mov     ebp, esp
.text:42CFCA5D                 sub     esp, 22Ch
.text:42CFCA63                 mov     [ebp+var_10], 0
.text:42CFCA6A                 mov     [ebp+var_4], 0
.text:42CFCA71                 mov     [ebp+var_21C], 1
.text:42CFCA7B                 mov     [ebp+pcbBuffer], 0FFh
.text:42CFCA82                 lea     eax, [ebp+Buffer]
.text:42CFCA88                 mov     [ebp+var_218], eax
.text:42CFCA8E                 cmp     [ebp+arg_4], 0
.text:42CFCA92                 jz      short loc_42CFCAB0
.text:42CFCA94                 mov     ecx, [ebp+arg_0]
.text:42CFCA97                 mov     dword_42D0148C, ecx
.text:42CFCA9D                 call    sub_42CFCCDC
.text:42CFCAA2                 test    eax, eax
.text:42CFCAA4                 jnz     short loc_42CFCAB0
.text:42CFCAA6                 mov     eax, 0Bh
.text:42CFCAAB                 jmp     loc_42CFCCD8
.text:42CFCAB0 ; ---------------------------------------------------------------------------
.text:42CFCAB0
.text:42CFCAB0 loc_42CFCAB0:                           ; CODE XREF: sub_42CFCA5A+38\u2191j
.text:42CFCAB0                                         ; sub_42CFCA5A+4A\u2191j
.text:42CFCAB0                 lea     edx, [ebp+var_21C]
.text:42CFCAB6                 push    edx
.text:42CFCAB7                 lea     eax, [ebp+var_10]
.text:42CFCABA                 push    eax
.text:42CFCABB                 call    sub_42CFCA30
.text:42CFCAC0                 add     esp, 8
.text:42CFCAC3                 mov     [ebp+var_228], eax
.text:42CFCAC9                 cmp     [ebp+var_228], 0
.text:42CFCAD0                 jz      short loc_42CFCADD
.text:42CFCAD2                 mov     eax, [ebp+var_228]
.text:42CFCAD8                 jmp     loc_42CFCCD8
.text:42CFCADD ; ---------------------------------------------------------------------------
.text:42CFCADD
.text:42CFCADD loc_42CFCADD:                           ; CODE XREF: sub_42CFCA5A+76\u2191j
.text:42CFCADD                 lea     ecx, [ebp+var_C]
.text:42CFCAE0                 push    ecx
.text:42CFCAE1                 push    40000000h
.text:42CFCAE6                 push    0
.text:42CFCAE8                 push    0
.text:42CFCAEA                 push    0
.text:42CFCAEC                 push    0
.text:42CFCAEE                 call    dword_42D01498
.text:42CFCAF4                 mov     [ebp+var_228], eax
.text:42CFCAFA                 cmp     [ebp+var_228], 0
.text:42CFCB01                 jz      short loc_42CFCB0E
.text:42CFCB03                 mov     eax, [ebp+var_228]
.text:42CFCB09                 jmp     loc_42CFCCD8
.text:42CFCB0E ; ---------------------------------------------------------------------------
.text:42CFCB0E
.text:42CFCB0E loc_42CFCB0E:                           ; CODE XREF: sub_42CFCA5A+A7\u2191j
.text:42CFCB0E                 lea     edx, [ebp+var_224]
.text:42CFCB14                 push    edx
.text:42CFCB15                 mov     eax, [ebp+var_C]
.text:42CFCB18                 mov     ecx, [eax+1Ch]
.text:42CFCB1B                 push    ecx
.text:42CFCB1C                 push    0
.text:42CFCB1E                 call    dword_42D01220
.text:42CFCB24                 mov     [ebp+var_228], eax
.text:42CFCB2A                 cmp     [ebp+var_228], 0
.text:42CFCB31                 jz      short loc_42CFCB3E
.text:42CFCB33                 mov     eax, [ebp+var_228]
.text:42CFCB39                 jmp     loc_42CFCCD8
.text:42CFCB3E ; ---------------------------------------------------------------------------
.text:42CFCB3E
.text:42CFCB3E loc_42CFCB3E:                           ; CODE XREF: sub_42CFCA5A+D7\u2191j
.text:42CFCB3E                 mov     edx, [ebp+var_C]
.text:42CFCB41                 push    edx
.text:42CFCB42                 call    dword_42D01488
.text:42CFCB48                 lea     eax, [ebp+pcbBuffer]
.text:42CFCB4B                 push    eax             ; pcbBuffer
.text:42CFCB4C                 lea     ecx, [ebp+Buffer]
.text:42CFCB52                 push    ecx             ; lpBuffer
.text:42CFCB53                 call    ds:GetUserNameA
.text:42CFCB59                 test    eax, eax
.text:42CFCB5B                 jnz     short loc_42CFCB6E
.text:42CFCB5D                 call    ds:GetLastError
.text:42CFCB63                 mov     [ebp+var_228], eax
.text:42CFCB69                 jmp     loc_42CFCCA3
.text:42CFCB6E ; ---------------------------------------------------------------------------
.text:42CFCB6E
.text:42CFCB6E loc_42CFCB6E:                           ; CODE XREF: sub_42CFCA5A+101\u2191j
.text:42CFCB6E                 mov     [ebp+var_4], 104h
.text:42CFCB75                 push    offset aSystem  ; "SYSTEM"
.text:42CFCB7A                 lea     edx, [ebp+Buffer]
.text:42CFCB80                 push    edx             ; String1
.text:42CFCB81                 call    ds:_stricmp
.text:42CFCB87                 add     esp, 8
.text:42CFCB8A                 test    eax, eax
.text:42CFCB8C                 jz      loc_42CFCC46
.text:42CFCB92                 mov     [ebp+var_22C], 0FFh
.text:42CFCB9C                 lea     eax, [ebp+var_22C]
.text:42CFCBA2                 push    eax
.text:42CFCBA3                 lea     ecx, [ebp+Buffer]
.text:42CFCBA9                 push    ecx
.text:42CFCBAA                 push    2
.text:42CFCBAC                 call    dword_42D01490
.text:42CFCBB2                 and     eax, 0FFh
.text:42CFCBB7                 test    eax, eax
.text:42CFCBB9                 jnz     short loc_42CFCBCC
.text:42CFCBBB                 call    ds:GetLastError
.text:42CFCBC1                 mov     [ebp+var_228], eax
.text:42CFCBC7                 jmp     loc_42CFCCA3
.text:42CFCBCC ; ---------------------------------------------------------------------------
.text:42CFCBCC
.text:42CFCBCC loc_42CFCBCC:                           ; CODE XREF: sub_42CFCA5A+15F\u2191j
.text:42CFCBCC                 lea     edx, [ebp+var_220]
.text:42CFCBD2                 push    edx
.text:42CFCBD3                 lea     eax, [ebp+var_218]
.text:42CFCBD9                 push    eax
.text:42CFCBDA                 push    1
.text:42CFCBDC                 push    1
.text:42CFCBDE                 push    2
.text:42CFCBE0                 push    0
.text:42CFCBE2                 mov     ecx, [ebp+var_224]
.text:42CFCBE8                 push    ecx
.text:42CFCBE9                 call    dword_42D01238
.text:42CFCBEF                 mov     [ebp+var_228], eax
.text:42CFCBF5                 cmp     [ebp+var_228], 0
.text:42CFCBFC                 jz      short loc_42CFCC03
.text:42CFCBFE                 jmp     loc_42CFCCA3
.text:42CFCC03 ; ---------------------------------------------------------------------------
.text:42CFCC03
.text:42CFCC03 loc_42CFCC03:                           ; CODE XREF: sub_42CFCA5A+1A2\u2191j
.text:42CFCC03                 cmp     [ebp+var_220], 0
.text:42CFCC0A                 jz      short loc_42CFCC44
.text:42CFCC0C                 mov     edx, [ebp+var_220]
.text:42CFCC12                 mov     eax, [edx+4]
.text:42CFCC15                 cmp     dword ptr [eax+8], 0
.text:42CFCC19                 jz      short loc_42CFCC44
.text:42CFCC1B                 mov     ecx, [ebp+var_220]
.text:42CFCC21                 mov     edx, [ecx+4]
.text:42CFCC24                 mov     eax, [edx+8]
.text:42CFCC27                 push    eax             ; Source
.text:42CFCC28                 lea     ecx, [ebp+Destination]
.text:42CFCC2E                 push    ecx             ; Destination
.text:42CFCC2F                 call    strcpy
.text:42CFCC34                 add     esp, 8
.text:42CFCC37                 mov     edx, [ebp+var_220]
.text:42CFCC3D                 push    edx
.text:42CFCC3E                 call    dword_42D01234
.text:42CFCC44
.text:42CFCC44 loc_42CFCC44:                           ; CODE XREF: sub_42CFCA5A+1B0\u2191j
.text:42CFCC44                                         ; sub_42CFCA5A+1BF\u2191j
.text:42CFCC44                 jmp     short loc_42CFCC70
.text:42CFCC46 ; ---------------------------------------------------------------------------
.text:42CFCC46
.text:42CFCC46 loc_42CFCC46:                           ; CODE XREF: sub_42CFCA5A+132\u2191j
.text:42CFCC46                 lea     eax, [ebp+var_4]
.text:42CFCC49                 push    eax
.text:42CFCC4A                 lea     ecx, [ebp+Destination]
.text:42CFCC50                 push    ecx
.text:42CFCC51                 push    1
.text:42CFCC53                 call    dword_42D01494
.text:42CFCC59                 and     eax, 0FFh
.text:42CFCC5E                 test    eax, eax
.text:42CFCC60                 jnz     short loc_42CFCC70
.text:42CFCC62                 call    ds:GetLastError
.text:42CFCC68                 mov     [ebp+var_228], eax
.text:42CFCC6E                 jmp     short loc_42CFCCA3
.text:42CFCC70 ; ---------------------------------------------------------------------------
.text:42CFCC70
.text:42CFCC70 loc_42CFCC70:                           ; CODE XREF: sub_42CFCA5A:loc_42CFCC44\u2191j
.text:42CFCC70                                         ; sub_42CFCA5A+206\u2191j
.text:42CFCC70                 mov     edx, [ebp+var_10]
.text:42CFCC73                 push    edx
.text:42CFCC74                 mov     eax, [ebp+var_21C]
.text:42CFCC7A                 push    eax
.text:42CFCC7B                 lea     ecx, [ebp+Destination]
.text:42CFCC81                 push    ecx
.text:42CFCC82                 mov     edx, [ebp+arg_4]
.text:42CFCC85                 sub     edx, 1
.text:42CFCC88                 neg     edx
.text:42CFCC8A                 sbb     edx, edx
.text:42CFCC8C                 and     edx, 2
.text:42CFCC8F                 push    edx
.text:42CFCC90                 mov     eax, [ebp+var_224]
.text:42CFCC96                 push    eax
.text:42CFCC97                 call    dword_42D01230
.text:42CFCC9D                 mov     [ebp+var_228], eax
.text:42CFCCA3
.text:42CFCCA3 loc_42CFCCA3:                           ; CODE XREF: sub_42CFCA5A+10F\u2191j
.text:42CFCCA3                                         ; sub_42CFCA5A+16D\u2191j ...
.text:42CFCCA3                 lea     ecx, [ebp+var_224]
.text:42CFCCA9                 push    ecx
.text:42CFCCAA                 call    dword_42D01224
.text:42CFCCB0                 cmp     [ebp+var_10], 0
.text:42CFCCB4                 jz      short loc_42CFCCC7
.text:42CFCCB6                 mov     edx, [ebp+var_10]
.text:42CFCCB9                 push    edx
.text:42CFCCBA                 mov     eax, [ebp+var_21C]
.text:42CFCCC0                 push    eax
.text:42CFCCC1                 call    dword_42D0122C
.text:42CFCCC7
.text:42CFCCC7 loc_42CFCCC7:                           ; CODE XREF: sub_42CFCA5A+25A\u2191j
.text:42CFCCC7                 cmp     [ebp+arg_4], 0
.text:42CFCCCB                 jnz     short loc_42CFCCD2
.text:42CFCCCD                 call    sub_42CFCF7C
.text:42CFCCD2
.text:42CFCCD2 loc_42CFCCD2:                           ; CODE XREF: sub_42CFCA5A+271\u2191j
.text:42CFCCD2                 mov     eax, [ebp+var_228]
.text:42CFCCD8
.text:42CFCCD8 loc_42CFCCD8:                           ; CODE XREF: sub_42CFCA5A+51\u2191j
.text:42CFCCD8                                         ; sub_42CFCA5A+7E\u2191j ...
.text:42CFCCD8                 mov     esp, ebp
.text:42CFCCDA                 pop     ebp
.text:42CFCCDB                 retn
.text:42CFCCDB sub_42CFCA5A    endp
.text:42CFCCDB
.text:42CFCCDC
.text:42CFCCDC ; =============== S U B R O U T I N E =======================================
.text:42CFCCDC
.text:42CFCCDC ; Attributes: bp-based frame
.text:42CFCCDC
.text:42CFCCDC sub_42CFCCDC    proc near               ; CODE XREF: sub_42CFCA5A+43\u2191p
.text:42CFCCDC
.text:42CFCCDC Src             = dword ptr -40h
.text:42CFCCDC var_24          = dword ptr -24h
.text:42CFCCDC var_20          = dword ptr -20h
.text:42CFCCDC lpProcName      = dword ptr -1Ch
.text:42CFCCDC var_18          = dword ptr -18h
.text:42CFCCDC var_14          = dword ptr -14h
.text:42CFCCDC var_10          = dword ptr -10h
.text:42CFCCDC var_C           = dword ptr -0Ch
.text:42CFCCDC var_8           = dword ptr -8
.text:42CFCCDC var_4           = dword ptr -4
.text:42CFCCDC
.text:42CFCCDC                 push    ebp
.text:42CFCCDD                 mov     ebp, esp
.text:42CFCCDF                 sub     esp, 40h
.text:42CFCCE2                 mov     [ebp+lpProcName], offset aDsbinda ; "DsBindA"
.text:42CFCCE9                 mov     [ebp+var_18], offset aDsunbinda ; "DsUnBindA"
.text:42CFCCF0                 mov     [ebp+var_14], offset aDsgetspna ; "DsGetSpnA"
.text:42CFCCF7                 mov     [ebp+var_10], offset aDsfreespnarray ; "DsFreeSpnArrayA"
.text:42CFCCFE                 mov     [ebp+var_C], offset aDswriteaccount ; "DsWriteAccountSpnA"
.text:42CFCD05                 mov     [ebp+var_8], offset aDsfreenameresu ; "DsFreeNameResultA"
.text:42CFCD0C                 mov     [ebp+var_4], offset aDscracknamesa ; "DsCrackNamesA"
.text:42CFCD13                 push    offset aNtdsapiDll ; "ntdsapi.dll"
.text:42CFCD18                 call    ds:LoadLibraryA
.text:42CFCD1E                 mov     dword_42D014A0, eax
.text:42CFCD23                 cmp     dword_42D014A0, 0
.text:42CFCD2A                 jnz     short loc_42CFCD33
.text:42CFCD2C                 xor     eax, eax
.text:42CFCD2E                 jmp     loc_42CFCF78
.text:42CFCD33 ; ---------------------------------------------------------------------------
.text:42CFCD33
.text:42CFCD33 loc_42CFCD33:                           ; CODE XREF: sub_42CFCCDC+4E\u2191j
.text:42CFCD33                 mov     [ebp+var_20], 0
.text:42CFCD3A                 jmp     short loc_42CFCD45
.text:42CFCD3C ; ---------------------------------------------------------------------------
.text:42CFCD3C
.text:42CFCD3C loc_42CFCD3C:                           ; CODE XREF: sub_42CFCCDC:loc_42CFCD8D\u2193j
.text:42CFCD3C                 mov     eax, [ebp+var_20]
.text:42CFCD3F                 add     eax, 1
.text:42CFCD42                 mov     [ebp+var_20], eax
.text:42CFCD45
.text:42CFCD45 loc_42CFCD45:                           ; CODE XREF: sub_42CFCCDC+5E\u2191j
.text:42CFCD45                 cmp     [ebp+var_20], 7
.text:42CFCD49                 jge     short loc_42CFCD8F
.text:42CFCD4B                 mov     ecx, [ebp+var_20]
.text:42CFCD4E                 mov     edx, [ebp+ecx*4+lpProcName]
.text:42CFCD52                 push    edx             ; lpProcName
.text:42CFCD53                 mov     eax, dword_42D014A0
.text:42CFCD58                 push    eax             ; hModule
.text:42CFCD59                 call    ds:GetProcAddress
.text:42CFCD5F                 mov     ecx, [ebp+var_20]
.text:42CFCD62                 mov     [ebp+ecx*4+Src], eax
.text:42CFCD66                 mov     edx, [ebp+var_20]
.text:42CFCD69                 cmp     [ebp+edx*4+Src], 0
.text:42CFCD6E                 jnz     short loc_42CFCD8D
.text:42CFCD70                 mov     eax, dword_42D014A0
.text:42CFCD75                 push    eax             ; hLibModule
.text:42CFCD76                 call    ds:FreeLibrary
.text:42CFCD7C                 mov     dword_42D014A0, 0
.text:42CFCD86                 xor     eax, eax
.text:42CFCD88                 jmp     loc_42CFCF78
.text:42CFCD8D ; ---------------------------------------------------------------------------
.text:42CFCD8D
.text:42CFCD8D loc_42CFCD8D:                           ; CODE XREF: sub_42CFCCDC+92\u2191j
.text:42CFCD8D                 jmp     short loc_42CFCD3C
.text:42CFCD8F ; ---------------------------------------------------------------------------
.text:42CFCD8F
.text:42CFCD8F loc_42CFCD8F:                           ; CODE XREF: sub_42CFCCDC+6D\u2191j
.text:42CFCD8F                 push    1Ch             ; Size
.text:42CFCD91                 lea     ecx, [ebp+Src]
.text:42CFCD94                 push    ecx             ; Src
.text:42CFCD95                 push    offset dword_42D01220 ; void *
.text:42CFCD9A                 call    memcpy
.text:42CFCD9F                 add     esp, 0Ch
.text:42CFCDA2                 push    offset aKernel32Dll_0 ; "kernel32.dll"
.text:42CFCDA7                 call    ds:LoadLibraryA
.text:42CFCDAD                 mov     dword_42D014A4, eax
.text:42CFCDB2                 cmp     dword_42D014A4, 0
.text:42CFCDB9                 jnz     short loc_42CFCDC2
.text:42CFCDBB                 xor     eax, eax
.text:42CFCDBD                 jmp     loc_42CFCF78
.text:42CFCDC2 ; ---------------------------------------------------------------------------
.text:42CFCDC2
.text:42CFCDC2 loc_42CFCDC2:                           ; CODE XREF: sub_42CFCCDC+DD\u2191j
.text:42CFCDC2                 push    offset aGetcomputernam ; "GetComputerNameExA"
.text:42CFCDC7                 mov     edx, dword_42D014A4
.text:42CFCDCD                 push    edx             ; hModule
.text:42CFCDCE                 call    ds:GetProcAddress
.text:42CFCDD4                 mov     [ebp+var_24], eax
.text:42CFCDD7                 cmp     [ebp+var_24], 0
.text:42CFCDDB                 jnz     short loc_42CFCDFA
.text:42CFCDDD                 mov     eax, dword_42D014A4
.text:42CFCDE2                 push    eax             ; hLibModule
.text:42CFCDE3                 call    ds:FreeLibrary
.text:42CFCDE9                 mov     dword_42D014A4, 0
.text:42CFCDF3                 xor     eax, eax
.text:42CFCDF5                 jmp     loc_42CFCF78
.text:42CFCDFA ; ---------------------------------------------------------------------------
.text:42CFCDFA
.text:42CFCDFA loc_42CFCDFA:                           ; CODE XREF: sub_42CFCCDC+FF\u2191j
.text:42CFCDFA                 push    4               ; Size
.text:42CFCDFC                 lea     ecx, [ebp+var_24]
.text:42CFCDFF                 push    ecx             ; Src
.text:42CFCE00                 push    offset unk_42D0149C ; void *
.text:42CFCE05                 call    memcpy
.text:42CFCE0A                 add     esp, 0Ch
.text:42CFCE0D                 push    offset aSecur32Dll_0 ; "secur32.dll"
.text:42CFCE12                 call    ds:LoadLibraryA
.text:42CFCE18                 mov     dword_42D01484, eax
.text:42CFCE1D                 cmp     dword_42D01484, 0
.text:42CFCE24                 jnz     short loc_42CFCE2D
.text:42CFCE26                 xor     eax, eax
.text:42CFCE28                 jmp     loc_42CFCF78
.text:42CFCE2D ; ---------------------------------------------------------------------------
.text:42CFCE2D
.text:42CFCE2D loc_42CFCE2D:                           ; CODE XREF: sub_42CFCCDC+148\u2191j
.text:42CFCE2D                 push    offset aGetcomputerobj ; "GetComputerObjectNameA"
.text:42CFCE32                 mov     edx, dword_42D01484
.text:42CFCE38                 push    edx             ; hModule
.text:42CFCE39                 call    ds:GetProcAddress
.text:42CFCE3F                 mov     [ebp+var_24], eax
.text:42CFCE42                 cmp     [ebp+var_24], 0
.text:42CFCE46                 jnz     short loc_42CFCE65
.text:42CFCE48                 mov     eax, dword_42D01484
.text:42CFCE4D                 push    eax             ; hLibModule
.text:42CFCE4E                 call    ds:FreeLibrary
.text:42CFCE54                 mov     dword_42D01484, 0
.text:42CFCE5E                 xor     eax, eax
.text:42CFCE60                 jmp     loc_42CFCF78
.text:42CFCE65 ; ---------------------------------------------------------------------------
.text:42CFCE65
.text:42CFCE65 loc_42CFCE65:                           ; CODE XREF: sub_42CFCCDC+16A\u2191j
.text:42CFCE65                 push    4               ; Size
.text:42CFCE67                 lea     ecx, [ebp+var_24]
.text:42CFCE6A                 push    ecx             ; Src
.text:42CFCE6B                 push    offset dword_42D01494 ; void *
.text:42CFCE70                 call    memcpy
.text:42CFCE75                 add     esp, 0Ch
.text:42CFCE78                 push    offset aGetusernameexa ; "GetUserNameExA"
.text:42CFCE7D                 mov     edx, dword_42D01484
.text:42CFCE83                 push    edx             ; hModule
.text:42CFCE84                 call    ds:GetProcAddress
.text:42CFCE8A                 mov     [ebp+var_24], eax
.text:42CFCE8D                 cmp     [ebp+var_24], 0
.text:42CFCE91                 jnz     short loc_42CFCEB0
.text:42CFCE93                 mov     eax, dword_42D01484
.text:42CFCE98                 push    eax             ; hLibModule
.text:42CFCE99                 call    ds:FreeLibrary
.text:42CFCE9F                 mov     dword_42D01484, 0
.text:42CFCEA9                 xor     eax, eax
.text:42CFCEAB                 jmp     loc_42CFCF78
.text:42CFCEB0 ; ---------------------------------------------------------------------------
.text:42CFCEB0
.text:42CFCEB0 loc_42CFCEB0:                           ; CODE XREF: sub_42CFCCDC+1B5\u2191j
.text:42CFCEB0                 push    4               ; Size
.text:42CFCEB2                 lea     ecx, [ebp+var_24]
.text:42CFCEB5                 push    ecx             ; Src
.text:42CFCEB6                 push    offset dword_42D01490 ; void *
.text:42CFCEBB                 call    memcpy
.text:42CFCEC0                 add     esp, 0Ch
.text:42CFCEC3                 push    offset aNetapi32Dll ; "netapi32.dll"
.text:42CFCEC8                 call    ds:LoadLibraryA
.text:42CFCECE                 mov     dword_42D014A8, eax
.text:42CFCED3                 cmp     dword_42D014A8, 0
.text:42CFCEDA                 jnz     short loc_42CFCEE3
.text:42CFCEDC                 xor     eax, eax
.text:42CFCEDE                 jmp     loc_42CFCF78
.text:42CFCEE3 ; ---------------------------------------------------------------------------
.text:42CFCEE3
.text:42CFCEE3 loc_42CFCEE3:                           ; CODE XREF: sub_42CFCCDC+1FE\u2191j
.text:42CFCEE3                 push    offset aNetapibufferfr ; "NetApiBufferFree"
.text:42CFCEE8                 mov     edx, dword_42D014A8
.text:42CFCEEE                 push    edx             ; hModule
.text:42CFCEEF                 call    ds:GetProcAddress
.text:42CFCEF5                 mov     [ebp+var_24], eax
.text:42CFCEF8                 cmp     [ebp+var_24], 0
.text:42CFCEFC                 jnz     short loc_42CFCF18
.text:42CFCEFE                 mov     eax, dword_42D014A8
.text:42CFCF03                 push    eax             ; hLibModule
.text:42CFCF04                 call    ds:FreeLibrary
.text:42CFCF0A                 mov     dword_42D014A8, 0
.text:42CFCF14                 xor     eax, eax
.text:42CFCF16                 jmp     short loc_42CFCF78
.text:42CFCF18 ; ---------------------------------------------------------------------------
.text:42CFCF18
.text:42CFCF18 loc_42CFCF18:                           ; CODE XREF: sub_42CFCCDC+220\u2191j
.text:42CFCF18                 push    4               ; Size
.text:42CFCF1A                 lea     ecx, [ebp+var_24]
.text:42CFCF1D                 push    ecx             ; Src
.text:42CFCF1E                 push    offset dword_42D01488 ; void *
.text:42CFCF23                 call    memcpy
.text:42CFCF28                 add     esp, 0Ch
.text:42CFCF2B                 push    offset aDsgetdcnamea ; "DsGetDcNameA"
.text:42CFCF30                 mov     edx, dword_42D014A8
.text:42CFCF36                 push    edx             ; hModule
.text:42CFCF37                 call    ds:GetProcAddress
.text:42CFCF3D                 mov     [ebp+var_24], eax
.text:42CFCF40                 cmp     [ebp+var_24], 0
.text:42CFCF44                 jnz     short loc_42CFCF60
.text:42CFCF46                 mov     eax, dword_42D014A8
.text:42CFCF4B                 push    eax             ; hLibModule
.text:42CFCF4C                 call    ds:FreeLibrary
.text:42CFCF52                 mov     dword_42D014A8, 0
.text:42CFCF5C                 xor     eax, eax
.text:42CFCF5E                 jmp     short loc_42CFCF78
.text:42CFCF60 ; ---------------------------------------------------------------------------
.text:42CFCF60
.text:42CFCF60 loc_42CFCF60:                           ; CODE XREF: sub_42CFCCDC+268\u2191j
.text:42CFCF60                 push    4               ; Size
.text:42CFCF62                 lea     ecx, [ebp+var_24]
.text:42CFCF65                 push    ecx             ; Src
.text:42CFCF66                 push    offset dword_42D01498 ; void *
.text:42CFCF6B                 call    memcpy
.text:42CFCF70                 add     esp, 0Ch
.text:42CFCF73                 mov     eax, 1
.text:42CFCF78
.text:42CFCF78 loc_42CFCF78:                           ; CODE XREF: sub_42CFCCDC+52\u2191j
.text:42CFCF78                                         ; sub_42CFCCDC+AC\u2191j ...
.text:42CFCF78                 mov     esp, ebp
.text:42CFCF7A                 pop     ebp
.text:42CFCF7B                 retn
.text:42CFCF7B sub_42CFCCDC    endp
.text:42CFCF7B
.text:42CFCF7C
.text:42CFCF7C ; =============== S U B R O U T I N E =======================================
.text:42CFCF7C
.text:42CFCF7C ; Attributes: bp-based frame
.text:42CFCF7C
.text:42CFCF7C sub_42CFCF7C    proc near               ; CODE XREF: sub_42CFCA5A+273\u2191p
.text:42CFCF7C                 push    ebp
.text:42CFCF7D                 mov     ebp, esp
.text:42CFCF7F                 cmp     dword_42D014A0, 0
.text:42CFCF86                 jz      short loc_42CFCF94
.text:42CFCF88                 mov     eax, dword_42D014A0
.text:42CFCF8D                 push    eax             ; hLibModule
.text:42CFCF8E                 call    ds:FreeLibrary
.text:42CFCF94
.text:42CFCF94 loc_42CFCF94:                           ; CODE XREF: sub_42CFCF7C+A\u2191j
.text:42CFCF94                 cmp     dword_42D014A4, 0
.text:42CFCF9B                 jz      short loc_42CFCFAA
.text:42CFCF9D                 mov     ecx, dword_42D014A4
.text:42CFCFA3                 push    ecx             ; hLibModule
.text:42CFCFA4                 call    ds:FreeLibrary
.text:42CFCFAA
.text:42CFCFAA loc_42CFCFAA:                           ; CODE XREF: sub_42CFCF7C+1F\u2191j
.text:42CFCFAA                 cmp     dword_42D01484, 0
.text:42CFCFB1                 jz      short loc_42CFCFC0
.text:42CFCFB3                 mov     edx, dword_42D01484
.text:42CFCFB9                 push    edx             ; hLibModule
.text:42CFCFBA                 call    ds:FreeLibrary
.text:42CFCFC0
.text:42CFCFC0 loc_42CFCFC0:                           ; CODE XREF: sub_42CFCF7C+35\u2191j
.text:42CFCFC0                 cmp     dword_42D014A8, 0
.text:42CFCFC7                 jz      short loc_42CFCFD5
.text:42CFCFC9                 mov     eax, dword_42D014A8
.text:42CFCFCE                 push    eax             ; hLibModule
.text:42CFCFCF                 call    ds:FreeLibrary
.text:42CFCFD5
.text:42CFCFD5 loc_42CFCFD5:                           ; CODE XREF: sub_42CFCF7C+4B\u2191j
.text:42CFCFD5                 pop     ebp
.text:42CFCFD6                 retn
.text:42CFCFD6 sub_42CFCF7C    endp
.text:42CFCFD6
.text:42CFCFD6 ; ---------------------------------------------------------------------------
.text:42CFCFD7                 align 10h
.text:42CFCFE0
.text:42CFCFE0 ; =============== S U B R O U T I N E =======================================
.text:42CFCFE0
.text:42CFCFE0 ; Attributes: bp-based frame
.text:42CFCFE0
.text:42CFCFE0 sub_42CFCFE0    proc near               ; CODE XREF: sub_42CFD35A:loc_42CFD423\u2193p
.text:42CFCFE0                 push    ebp
.text:42CFCFE1                 mov     ebp, esp
.text:42CFCFE3                 mov     eax, offset WideCharStr
.text:42CFCFE8                 pop     ebp
.text:42CFCFE9                 retn
.text:42CFCFE9 sub_42CFCFE0    endp
.text:42CFCFE9
.text:42CFCFEA
.text:42CFCFEA ; =============== S U B R O U T I N E =======================================
.text:42CFCFEA
.text:42CFCFEA ; Attributes: bp-based frame
.text:42CFCFEA
.text:42CFCFEA ; int __cdecl sub_42CFCFEA(LPSTR, LPCCH lpMultiByteStr)
.text:42CFCFEA sub_42CFCFEA    proc near               ; CODE XREF: ConnectionListen+14F\u2191p
.text:42CFCFEA
.text:42CFCFEA var_414         = dword ptr -414h
.text:42CFCFEA var_410         = dword ptr -410h
.text:42CFCFEA var_40C         = byte ptr -40Ch
.text:42CFCFEA WideCharStr     = word ptr -20Ch
.text:42CFCFEA var_C           = dword ptr -0Ch
.text:42CFCFEA var_8           = dword ptr -8
.text:42CFCFEA var_4           = dword ptr -4
.text:42CFCFEA arg_0           = dword ptr  8
.text:42CFCFEA lpMultiByteStr  = dword ptr  0Ch
.text:42CFCFEA
.text:42CFCFEA                 push    ebp
.text:42CFCFEB                 mov     ebp, esp
.text:42CFCFED                 sub     esp, 414h
.text:42CFCFF3                 mov     [ebp+var_414], 0
.text:42CFCFFD                 mov     [ebp+var_4], 0FFh
.text:42CFD004                 mov     [ebp+var_8], 0FFh
.text:42CFD00B                 push    offset dword_42D01440
.text:42CFD010                 call    sub_42CFD464
.text:42CFD015                 add     esp, 4
.text:42CFD018                 test    eax, eax
.text:42CFD01A                 jnz     short loc_42CFD02B
.text:42CFD01C                 mov     [ebp+var_410], 0
.text:42CFD026                 jmp     loc_42CFD0FA
.text:42CFD02B ; ---------------------------------------------------------------------------
.text:42CFD02B
.text:42CFD02B loc_42CFD02B:                           ; CODE XREF: sub_42CFCFEA+30\u2191j
.text:42CFD02B                 push    0FFh            ; cchWideChar
.text:42CFD030                 push    offset WideCharStr ; lpWideCharStr
.text:42CFD035                 push    0FFFFFFFFh      ; cbMultiByte
.text:42CFD037                 mov     eax, [ebp+lpMultiByteStr]
.text:42CFD03A                 push    eax             ; lpMultiByteStr
.text:42CFD03B                 push    0               ; dwFlags
.text:42CFD03D                 push    0               ; CodePage
.text:42CFD03F                 call    ds:MultiByteToWideChar
.text:42CFD045                 push    0
.text:42CFD047                 call    dword_42D01444
.text:42CFD04D                 mov     [ebp+var_414], eax
.text:42CFD053                 cmp     [ebp+var_414], 0
.text:42CFD05A                 jnz     short loc_42CFD06B
.text:42CFD05C                 mov     [ebp+var_410], 0
.text:42CFD066                 jmp     loc_42CFD0FA
.text:42CFD06B ; ---------------------------------------------------------------------------
.text:42CFD06B
.text:42CFD06B loc_42CFD06B:                           ; CODE XREF: sub_42CFCFEA+70\u2191j
.text:42CFD06B                 mov     ecx, [ebp+var_414]
.text:42CFD071                 push    ecx
.text:42CFD072                 call    sub_42CFD12F
.text:42CFD077                 add     esp, 4
.text:42CFD07A                 mov     [ebp+var_C], eax
.text:42CFD07D                 cmp     [ebp+var_C], 0
.text:42CFD081                 jnz     short loc_42CFD08F
.text:42CFD083                 mov     [ebp+var_410], 0
.text:42CFD08D                 jmp     short loc_42CFD0FA
.text:42CFD08F ; ---------------------------------------------------------------------------
.text:42CFD08F
.text:42CFD08F loc_42CFD08F:                           ; CODE XREF: sub_42CFCFEA+97\u2191j
.text:42CFD08F                 lea     edx, [ebp+var_4]
.text:42CFD092                 push    edx
.text:42CFD093                 lea     eax, [ebp+var_40C]
.text:42CFD099                 push    eax
.text:42CFD09A                 lea     ecx, [ebp+var_8]
.text:42CFD09D                 push    ecx
.text:42CFD09E                 lea     edx, [ebp+WideCharStr]
.text:42CFD0A4                 push    edx
.text:42CFD0A5                 mov     eax, [ebp+var_C]
.text:42CFD0A8                 push    eax
.text:42CFD0A9                 call    dword_42D01458
.text:42CFD0AF                 cmp     eax, 0FFFFFFFFh
.text:42CFD0B2                 jnz     short loc_42CFD0C0
.text:42CFD0B4                 mov     [ebp+var_410], 0
.text:42CFD0BE                 jmp     short loc_42CFD0FA
.text:42CFD0C0 ; ---------------------------------------------------------------------------
.text:42CFD0C0
.text:42CFD0C0 loc_42CFD0C0:                           ; CODE XREF: sub_42CFCFEA+C8\u2191j
.text:42CFD0C0                 push    0               ; lpUsedDefaultChar
.text:42CFD0C2                 push    0               ; lpDefaultChar
.text:42CFD0C4                 push    0FFh            ; cbMultiByte
.text:42CFD0C9                 mov     ecx, [ebp+arg_0]
.text:42CFD0CC                 push    ecx             ; lpMultiByteStr
.text:42CFD0CD                 push    0FFFFFFFFh      ; cchWideChar
.text:42CFD0CF                 lea     edx, [ebp+WideCharStr]
.text:42CFD0D5                 push    edx             ; lpWideCharStr
.text:42CFD0D6                 push    0               ; dwFlags
.text:42CFD0D8                 push    0               ; CodePage
.text:42CFD0DA                 call    ds:WideCharToMultiByte
.text:42CFD0E0                 test    eax, eax
.text:42CFD0E2                 jnz     short loc_42CFD0F0
.text:42CFD0E4                 mov     [ebp+var_410], 0
.text:42CFD0EE                 jmp     short loc_42CFD0FA
.text:42CFD0F0 ; ---------------------------------------------------------------------------
.text:42CFD0F0
.text:42CFD0F0 loc_42CFD0F0:                           ; CODE XREF: sub_42CFCFEA+F8\u2191j
.text:42CFD0F0                 mov     [ebp+var_410], 1
.text:42CFD0FA
.text:42CFD0FA loc_42CFD0FA:                           ; CODE XREF: sub_42CFCFEA+3C\u2191j
.text:42CFD0FA                                         ; sub_42CFCFEA+7C\u2191j ...
.text:42CFD0FA                 cmp     dword_42D01440, 0
.text:42CFD101                 jz      short loc_42CFD10F
.text:42CFD103                 mov     eax, dword_42D01440
.text:42CFD108                 push    eax             ; hLibModule
.text:42CFD109                 call    ds:FreeLibrary
.text:42CFD10F
.text:42CFD10F loc_42CFD10F:                           ; CODE XREF: sub_42CFCFEA+117\u2191j
.text:42CFD10F                 cmp     dword_42D0147C, 0
.text:42CFD116                 jz      short loc_42CFD125
.text:42CFD118                 mov     ecx, dword_42D0147C
.text:42CFD11E                 push    ecx             ; hLibModule
.text:42CFD11F                 call    ds:FreeLibrary
.text:42CFD125
.text:42CFD125 loc_42CFD125:                           ; CODE XREF: sub_42CFCFEA+12C\u2191j
.text:42CFD125                 mov     eax, [ebp+var_410]
.text:42CFD12B                 mov     esp, ebp
.text:42CFD12D                 pop     ebp
.text:42CFD12E                 retn
.text:42CFD12E sub_42CFCFEA    endp
.text:42CFD12E
.text:42CFD12F
.text:42CFD12F ; =============== S U B R O U T I N E =======================================
.text:42CFD12F
.text:42CFD12F ; Attributes: bp-based frame
.text:42CFD12F
.text:42CFD12F sub_42CFD12F    proc near               ; CODE XREF: sub_42CFCFEA+88\u2191p
.text:42CFD12F
.text:42CFD12F Block           = dword ptr -1Ch
.text:42CFD12F var_18          = dword ptr -18h
.text:42CFD12F var_14          = dword ptr -14h
.text:42CFD12F var_10          = dword ptr -10h
.text:42CFD12F var_C           = dword ptr -0Ch
.text:42CFD12F var_8           = byte ptr -8
.text:42CFD12F var_4           = dword ptr -4
.text:42CFD12F arg_0           = dword ptr  8
.text:42CFD12F
.text:42CFD12F                 push    ebp
.text:42CFD130                 mov     ebp, esp
.text:42CFD132                 sub     esp, 1Ch
.text:42CFD135                 mov     [ebp+var_4], 0
.text:42CFD13C                 mov     [ebp+var_C], 0
.text:42CFD143                 mov     [ebp+Block], 0
.text:42CFD14A                 push    4
.text:42CFD14C                 mov     eax, [ebp+arg_0]
.text:42CFD14F                 push    eax
.text:42CFD150                 call    dword_42D01460
.text:42CFD156                 mov     [ebp+var_4], eax
.text:42CFD159                 cmp     [ebp+var_4], 0
.text:42CFD15D                 jnz     short loc_42CFD164
.text:42CFD15F                 jmp     loc_42CFD248
.text:42CFD164 ; ---------------------------------------------------------------------------
.text:42CFD164
.text:42CFD164 loc_42CFD164:                           ; CODE XREF: sub_42CFD12F+2E\u2191j
.text:42CFD164                 mov     [ebp+var_10], 0
.text:42CFD16B                 jmp     short loc_42CFD176
.text:42CFD16D ; ---------------------------------------------------------------------------
.text:42CFD16D
.text:42CFD16D loc_42CFD16D:                           ; CODE XREF: sub_42CFD12F+114\u2193j
.text:42CFD16D                 mov     ecx, [ebp+var_10]
.text:42CFD170                 add     ecx, 1
.text:42CFD173                 mov     [ebp+var_10], ecx
.text:42CFD176
.text:42CFD176 loc_42CFD176:                           ; CODE XREF: sub_42CFD12F+3C\u2191j
.text:42CFD176                 mov     [ebp+var_18], 0
.text:42CFD17D                 lea     edx, [ebp+var_18]
.text:42CFD180                 push    edx
.text:42CFD181                 push    0
.text:42CFD183                 lea     eax, [ebp+var_8]
.text:42CFD186                 push    eax
.text:42CFD187                 mov     ecx, [ebp+var_10]
.text:42CFD18A                 push    ecx
.text:42CFD18B                 mov     edx, [ebp+var_4]
.text:42CFD18E                 push    edx
.text:42CFD18F                 call    dword_42D01464
.text:42CFD195                 mov     [ebp+var_14], eax
.text:42CFD198                 cmp     [ebp+var_14], 0
.text:42CFD19C                 jz      short loc_42CFD1A3
.text:42CFD19E                 jmp     loc_42CFD248
.text:42CFD1A3 ; ---------------------------------------------------------------------------
.text:42CFD1A3
.text:42CFD1A3 loc_42CFD1A3:                           ; CODE XREF: sub_42CFD12F+6D\u2191j
.text:42CFD1A3                 mov     eax, [ebp+var_18]
.text:42CFD1A6                 add     eax, 1
.text:42CFD1A9                 mov     [ebp+var_18], eax
.text:42CFD1AC                 mov     ecx, [ebp+var_18]
.text:42CFD1AF                 shl     ecx, 1
.text:42CFD1B1                 push    ecx             ; Size
.text:42CFD1B2                 call    ds:malloc
.text:42CFD1B8                 add     esp, 4
.text:42CFD1BB                 mov     [ebp+Block], eax
.text:42CFD1BE                 lea     edx, [ebp+var_18]
.text:42CFD1C1                 push    edx
.text:42CFD1C2                 mov     eax, [ebp+Block]
.text:42CFD1C5                 push    eax
.text:42CFD1C6                 lea     ecx, [ebp+var_8]
.text:42CFD1C9                 push    ecx
.text:42CFD1CA                 mov     edx, [ebp+var_10]
.text:42CFD1CD                 push    edx
.text:42CFD1CE                 mov     eax, [ebp+var_4]
.text:42CFD1D1                 push    eax
.text:42CFD1D2                 call    dword_42D01464
.text:42CFD1D8                 mov     [ebp+var_14], eax
.text:42CFD1DB                 cmp     [ebp+var_14], 0
.text:42CFD1DF                 jz      short loc_42CFD1E3
.text:42CFD1E1                 jmp     short loc_42CFD248
.text:42CFD1E3 ; ---------------------------------------------------------------------------
.text:42CFD1E3
.text:42CFD1E3 loc_42CFD1E3:                           ; CODE XREF: sub_42CFD12F+B0\u2191j
.text:42CFD1E3                 mov     ecx, [ebp+Block]
.text:42CFD1E6                 push    ecx
.text:42CFD1E7                 mov     edx, [ebp+arg_0]
.text:42CFD1EA                 push    edx
.text:42CFD1EB                 call    dword_42D01454
.text:42CFD1F1                 mov     [ebp+var_C], eax
.text:42CFD1F4                 cmp     [ebp+var_C], 0
.text:42CFD1F8                 jnz     short loc_42CFD1FC
.text:42CFD1FA                 jmp     short loc_42CFD248
.text:42CFD1FC ; ---------------------------------------------------------------------------
.text:42CFD1FC
.text:42CFD1FC loc_42CFD1FC:                           ; CODE XREF: sub_42CFD12F+C9\u2191j
.text:42CFD1FC                 mov     eax, [ebp+Block]
.text:42CFD1FF                 push    eax             ; Block
.text:42CFD200                 call    ds:free
.text:42CFD206                 add     esp, 4
.text:42CFD209                 mov     [ebp+Block], 0
.text:42CFD210                 mov     ecx, [ebp+var_C]
.text:42CFD213                 push    ecx
.text:42CFD214                 call    sub_42CFD272
.text:42CFD219                 add     esp, 4
.text:42CFD21C                 test    eax, eax
.text:42CFD21E                 jz      short loc_42CFD232
.text:42CFD220                 mov     edx, [ebp+var_C]
.text:42CFD223                 push    edx
.text:42CFD224                 call    sub_42CFD35A
.text:42CFD229                 add     esp, 4
.text:42CFD22C                 test    eax, eax
.text:42CFD22E                 jz      short loc_42CFD232
.text:42CFD230                 jmp     short loc_42CFD248
.text:42CFD232 ; ---------------------------------------------------------------------------
.text:42CFD232
.text:42CFD232 loc_42CFD232:                           ; CODE XREF: sub_42CFD12F+EF\u2191j
.text:42CFD232                                         ; sub_42CFD12F+FF\u2191j
.text:42CFD232                 mov     eax, [ebp+var_C]
.text:42CFD235                 push    eax
.text:42CFD236                 call    dword_42D0145C
.text:42CFD23C                 mov     [ebp+var_C], 0
.text:42CFD243                 jmp     loc_42CFD16D
.text:42CFD248 ; ---------------------------------------------------------------------------
.text:42CFD248
.text:42CFD248 loc_42CFD248:                           ; CODE XREF: sub_42CFD12F+30\u2191j
.text:42CFD248                                         ; sub_42CFD12F+6F\u2191j ...
.text:42CFD248                 cmp     [ebp+Block], 0
.text:42CFD24C                 jz      short loc_42CFD25B
.text:42CFD24E                 mov     ecx, [ebp+Block]
.text:42CFD251                 push    ecx             ; Block
.text:42CFD252                 call    ds:free
.text:42CFD258                 add     esp, 4
.text:42CFD25B
.text:42CFD25B loc_42CFD25B:                           ; CODE XREF: sub_42CFD12F+11D\u2191j
.text:42CFD25B                 cmp     [ebp+var_4], 0
.text:42CFD25F                 jz      short loc_42CFD26B
.text:42CFD261                 mov     edx, [ebp+var_4]
.text:42CFD264                 push    edx
.text:42CFD265                 call    dword_42D01468
.text:42CFD26B
.text:42CFD26B loc_42CFD26B:                           ; CODE XREF: sub_42CFD12F+130\u2191j
.text:42CFD26B                 mov     eax, [ebp+var_C]
.text:42CFD26E                 mov     esp, ebp
.text:42CFD270                 pop     ebp
.text:42CFD271                 retn
.text:42CFD271 sub_42CFD12F    endp
.text:42CFD271
.text:42CFD272
.text:42CFD272 ; =============== S U B R O U T I N E =======================================
.text:42CFD272
.text:42CFD272 ; Attributes: bp-based frame
.text:42CFD272
.text:42CFD272 sub_42CFD272    proc near               ; CODE XREF: sub_42CFD12F+E5\u2191p
.text:42CFD272
.text:42CFD272 var_21C         = dword ptr -21Ch
.text:42CFD272 var_218         = dword ptr -218h
.text:42CFD272 String1         = word ptr -214h
.text:42CFD272 Size            = dword ptr -8
.text:42CFD272 String2         = dword ptr -4
.text:42CFD272 arg_0           = dword ptr  8
.text:42CFD272
.text:42CFD272                 push    ebp
.text:42CFD273                 mov     ebp, esp
.text:42CFD275                 sub     esp, 21Ch
.text:42CFD27B                 mov     [ebp+String2], 0
.text:42CFD282                 mov     [ebp+var_218], 0
.text:42CFD28C                 lea     eax, [ebp+Size]
.text:42CFD28F                 push    eax
.text:42CFD290                 push    0
.text:42CFD292                 push    0
.text:42CFD294                 push    0
.text:42CFD296                 push    0
.text:42CFD298                 push    100002Dh
.text:42CFD29D                 push    0
.text:42CFD29F                 mov     ecx, [ebp+arg_0]
.text:42CFD2A2                 push    ecx
.text:42CFD2A3                 call    dword_42D01478
.text:42CFD2A9                 mov     [ebp+var_21C], eax
.text:42CFD2AF                 cmp     [ebp+var_21C], 0
.text:42CFD2B6                 jz      short loc_42CFD2BD
.text:42CFD2B8                 jmp     loc_42CFD33D
.text:42CFD2BD ; ---------------------------------------------------------------------------
.text:42CFD2BD
.text:42CFD2BD loc_42CFD2BD:                           ; CODE XREF: sub_42CFD272+44\u2191j
.text:42CFD2BD                 mov     edx, [ebp+Size]
.text:42CFD2C0                 add     edx, 1
.text:42CFD2C3                 mov     [ebp+Size], edx
.text:42CFD2C6                 mov     eax, [ebp+Size]
.text:42CFD2C9                 push    eax             ; Size
.text:42CFD2CA                 call    ds:malloc
.text:42CFD2D0                 add     esp, 4
.text:42CFD2D3                 mov     [ebp+String2], eax
.text:42CFD2D6                 push    0
.text:42CFD2D8                 mov     ecx, [ebp+Size]
.text:42CFD2DB                 push    ecx
.text:42CFD2DC                 mov     edx, [ebp+String2]
.text:42CFD2DF                 push    edx
.text:42CFD2E0                 push    0
.text:42CFD2E2                 push    0
.text:42CFD2E4                 push    100002Dh
.text:42CFD2E9                 push    0
.text:42CFD2EB                 mov     eax, [ebp+arg_0]
.text:42CFD2EE                 push    eax
.text:42CFD2EF                 call    dword_42D01478
.text:42CFD2F5                 mov     [ebp+var_21C], eax
.text:42CFD2FB                 cmp     [ebp+var_21C], 0
.text:42CFD302                 jz      short loc_42CFD306
.text:42CFD304                 jmp     short loc_42CFD33D
.text:42CFD306 ; ---------------------------------------------------------------------------
.text:42CFD306
.text:42CFD306 loc_42CFD306:                           ; CODE XREF: sub_42CFD272+90\u2191j
.text:42CFD306                 lea     ecx, [ebp+String1]
.text:42CFD30C                 push    ecx             ; Buffer
.text:42CFD30D                 call    sub_42CFD6F0
.text:42CFD312                 add     esp, 4
.text:42CFD315                 test    eax, eax
.text:42CFD317                 jnz     short loc_42CFD31B
.text:42CFD319                 jmp     short loc_42CFD33D
.text:42CFD31B ; ---------------------------------------------------------------------------
.text:42CFD31B
.text:42CFD31B loc_42CFD31B:                           ; CODE XREF: sub_42CFD272+A5\u2191j
.text:42CFD31B                 mov     edx, [ebp+String2]
.text:42CFD31E                 push    edx             ; String2
.text:42CFD31F                 lea     eax, [ebp+String1]
.text:42CFD325                 push    eax             ; String1
.text:42CFD326                 call    ds:wcscmp
.text:42CFD32C                 add     esp, 8
.text:42CFD32F                 test    eax, eax
.text:42CFD331                 jnz     short loc_42CFD33D
.text:42CFD333                 mov     [ebp+var_218], 1
.text:42CFD33D
.text:42CFD33D loc_42CFD33D:                           ; CODE XREF: sub_42CFD272+46\u2191j
.text:42CFD33D                                         ; sub_42CFD272+92\u2191j ...
.text:42CFD33D                 cmp     [ebp+String2], 0
.text:42CFD341                 jz      short loc_42CFD350
.text:42CFD343                 mov     ecx, [ebp+String2]
.text:42CFD346                 push    ecx             ; Block
.text:42CFD347                 call    ds:free
.text:42CFD34D                 add     esp, 4
.text:42CFD350
.text:42CFD350 loc_42CFD350:                           ; CODE XREF: sub_42CFD272+CF\u2191j
.text:42CFD350                 mov     eax, [ebp+var_218]
.text:42CFD356                 mov     esp, ebp
.text:42CFD358                 pop     ebp
.text:42CFD359                 retn
.text:42CFD359 sub_42CFD272    endp
.text:42CFD359
.text:42CFD35A
.text:42CFD35A ; =============== S U B R O U T I N E =======================================
.text:42CFD35A
.text:42CFD35A ; Attributes: bp-based frame
.text:42CFD35A
.text:42CFD35A sub_42CFD35A    proc near               ; CODE XREF: sub_42CFD12F+F5\u2191p
.text:42CFD35A
.text:42CFD35A String1         = dword ptr -220h
.text:42CFD35A var_21C         = dword ptr -21Ch
.text:42CFD35A var_218         = dword ptr -218h
.text:42CFD35A var_214         = byte ptr -214h
.text:42CFD35A Size            = dword ptr -8
.text:42CFD35A Block           = dword ptr -4
.text:42CFD35A arg_0           = dword ptr  8
.text:42CFD35A
.text:42CFD35A                 push    ebp
.text:42CFD35B                 mov     ebp, esp
.text:42CFD35D                 sub     esp, 220h
.text:42CFD363                 lea     eax, [ebp+var_214]
.text:42CFD369                 mov     [ebp+String1], eax
.text:42CFD36F                 mov     [ebp+Block], 0
.text:42CFD376                 mov     [ebp+var_218], 0
.text:42CFD380                 mov     [ebp+Size], 0
.text:42CFD387                 lea     ecx, [ebp+Size]
.text:42CFD38A                 push    ecx
.text:42CFD38B                 push    0
.text:42CFD38D                 push    0
.text:42CFD38F                 push    0
.text:42CFD391                 push    0
.text:42CFD393                 push    1000081h
.text:42CFD398                 push    0
.text:42CFD39A                 mov     edx, [ebp+arg_0]
.text:42CFD39D                 push    edx
.text:42CFD39E                 call    dword_42D01478
.text:42CFD3A4                 mov     [ebp+var_21C], eax
.text:42CFD3AA                 cmp     [ebp+var_21C], 0
.text:42CFD3B1                 jz      short loc_42CFD3B8
.text:42CFD3B3                 jmp     loc_42CFD447
.text:42CFD3B8 ; ---------------------------------------------------------------------------
.text:42CFD3B8
.text:42CFD3B8 loc_42CFD3B8:                           ; CODE XREF: sub_42CFD35A+57\u2191j
.text:42CFD3B8                 mov     eax, [ebp+Size]
.text:42CFD3BB                 push    eax             ; Size
.text:42CFD3BC                 call    ds:malloc
.text:42CFD3C2                 add     esp, 4
.text:42CFD3C5                 mov     [ebp+Block], eax
.text:42CFD3C8                 push    0
.text:42CFD3CA                 mov     ecx, [ebp+Size]
.text:42CFD3CD                 push    ecx
.text:42CFD3CE                 mov     edx, [ebp+Block]
.text:42CFD3D1                 push    edx
.text:42CFD3D2                 push    0
.text:42CFD3D4                 push    0
.text:42CFD3D6                 push    1000081h
.text:42CFD3DB                 push    0
.text:42CFD3DD                 mov     eax, [ebp+arg_0]
.text:42CFD3E0                 push    eax
.text:42CFD3E1                 call    dword_42D01478
.text:42CFD3E7                 mov     [ebp+var_21C], eax
.text:42CFD3ED                 cmp     [ebp+var_21C], 0
.text:42CFD3F4                 jz      short loc_42CFD3F8
.text:42CFD3F6                 jmp     short loc_42CFD447
.text:42CFD3F8 ; ---------------------------------------------------------------------------
.text:42CFD3F8
.text:42CFD3F8 loc_42CFD3F8:                           ; CODE XREF: sub_42CFD35A+9A\u2191j
.text:42CFD3F8                 lea     ecx, [ebp+String1]
.text:42CFD3FE                 push    ecx
.text:42CFD3FF                 push    offset aInstancename ; "InstanceName"
.text:42CFD404                 mov     edx, [ebp+Size]
.text:42CFD407                 push    edx
.text:42CFD408                 mov     eax, [ebp+Block]
.text:42CFD40B                 push    eax
.text:42CFD40C                 call    dword_42D01480
.text:42CFD412                 mov     [ebp+var_21C], eax
.text:42CFD418                 cmp     [ebp+var_21C], 0
.text:42CFD41F                 jz      short loc_42CFD423
.text:42CFD421                 jmp     short loc_42CFD447
.text:42CFD423 ; ---------------------------------------------------------------------------
.text:42CFD423
.text:42CFD423 loc_42CFD423:                           ; CODE XREF: sub_42CFD35A+C5\u2191j
.text:42CFD423                 call    sub_42CFCFE0
.text:42CFD428                 push    eax             ; String2
.text:42CFD429                 mov     ecx, [ebp+String1]
.text:42CFD42F                 push    ecx             ; String1
.text:42CFD430                 call    ds:_wcsicmp
.text:42CFD436                 add     esp, 8
.text:42CFD439                 test    eax, eax
.text:42CFD43B                 jnz     short loc_42CFD447
.text:42CFD43D                 mov     [ebp+var_218], 1
.text:42CFD447
.text:42CFD447 loc_42CFD447:                           ; CODE XREF: sub_42CFD35A+59\u2191j
.text:42CFD447                                         ; sub_42CFD35A+9C\u2191j ...
.text:42CFD447                 cmp     [ebp+Block], 0
.text:42CFD44B                 jz      short loc_42CFD45A
.text:42CFD44D                 mov     edx, [ebp+Block]
.text:42CFD450                 push    edx             ; Block
.text:42CFD451                 call    ds:free
.text:42CFD457                 add     esp, 4
.text:42CFD45A
.text:42CFD45A loc_42CFD45A:                           ; CODE XREF: sub_42CFD35A+F1\u2191j
.text:42CFD45A                 mov     eax, [ebp+var_218]
.text:42CFD460                 mov     esp, ebp
.text:42CFD462                 pop     ebp
.text:42CFD463                 retn
.text:42CFD463 sub_42CFD35A    endp
.text:42CFD463
.text:42CFD464
.text:42CFD464 ; =============== S U B R O U T I N E =======================================
.text:42CFD464
.text:42CFD464 ; Attributes: bp-based frame
.text:42CFD464
.text:42CFD464 sub_42CFD464    proc near               ; CODE XREF: sub_42CFCFEA+26\u2191p
.text:42CFD464
.text:42CFD464 hModule         = dword ptr -4
.text:42CFD464 arg_0           = dword ptr  8
.text:42CFD464
.text:42CFD464                 push    ebp
.text:42CFD465                 mov     ebp, esp
.text:42CFD467                 push    ecx
.text:42CFD468                 mov     eax, [ebp+arg_0]
.text:42CFD46B                 mov     dword ptr [eax], 0
.text:42CFD471                 mov     ecx, [ebp+arg_0]
.text:42CFD474                 mov     dword ptr [ecx+3Ch], 0
.text:42CFD47B                 push    offset aClusapiDll ; "CLUSAPI.DLL"
.text:42CFD480                 call    ds:LoadLibraryA
.text:42CFD486                 mov     [ebp+hModule], eax
.text:42CFD489                 cmp     [ebp+hModule], 0
.text:42CFD48D                 jz      loc_42CFD69D
.text:42CFD493                 mov     edx, [ebp+arg_0]
.text:42CFD496                 mov     eax, [ebp+hModule]
.text:42CFD499                 mov     [edx], eax
.text:42CFD49B                 push    offset aOpencluster ; "OpenCluster"
.text:42CFD4A0                 mov     ecx, [ebp+hModule]
.text:42CFD4A3                 push    ecx             ; hModule
.text:42CFD4A4                 call    ds:GetProcAddress
.text:42CFD4AA                 mov     edx, [ebp+arg_0]
.text:42CFD4AD                 mov     [edx+4], eax
.text:42CFD4B0                 mov     eax, [ebp+arg_0]
.text:42CFD4B3                 cmp     dword ptr [eax+4], 0
.text:42CFD4B7                 jnz     short loc_42CFD4C0
.text:42CFD4B9                 xor     eax, eax
.text:42CFD4BB                 jmp     loc_42CFD6EB
.text:42CFD4C0 ; ---------------------------------------------------------------------------
.text:42CFD4C0
.text:42CFD4C0 loc_42CFD4C0:                           ; CODE XREF: sub_42CFD464+53\u2191j
.text:42CFD4C0                 push    offset aClosecluster ; "CloseCluster"
.text:42CFD4C5                 mov     ecx, [ebp+hModule]
.text:42CFD4C8                 push    ecx             ; hModule
.text:42CFD4C9                 call    ds:GetProcAddress
.text:42CFD4CF                 mov     edx, [ebp+arg_0]
.text:42CFD4D2                 mov     [edx+8], eax
.text:42CFD4D5                 mov     eax, [ebp+arg_0]
.text:42CFD4D8                 cmp     dword ptr [eax+8], 0
.text:42CFD4DC                 jnz     short loc_42CFD4E5
.text:42CFD4DE                 xor     eax, eax
.text:42CFD4E0                 jmp     loc_42CFD6EB
.text:42CFD4E5 ; ---------------------------------------------------------------------------
.text:42CFD4E5
.text:42CFD4E5 loc_42CFD4E5:                           ; CODE XREF: sub_42CFD464+78\u2191j
.text:42CFD4E5                 push    offset aOpenclustergro ; "OpenClusterGroup"
.text:42CFD4EA                 mov     ecx, [ebp+hModule]
.text:42CFD4ED                 push    ecx             ; hModule
.text:42CFD4EE                 call    ds:GetProcAddress
.text:42CFD4F4                 mov     edx, [ebp+arg_0]
.text:42CFD4F7                 mov     [edx+0Ch], eax
.text:42CFD4FA                 mov     eax, [ebp+arg_0]
.text:42CFD4FD                 cmp     dword ptr [eax+0Ch], 0
.text:42CFD501                 jnz     short loc_42CFD50A
.text:42CFD503                 xor     eax, eax
.text:42CFD505                 jmp     loc_42CFD6EB
.text:42CFD50A ; ---------------------------------------------------------------------------
.text:42CFD50A
.text:42CFD50A loc_42CFD50A:                           ; CODE XREF: sub_42CFD464+9D\u2191j
.text:42CFD50A                 push    offset aCloseclustergr ; "CloseClusterGroup"
.text:42CFD50F                 mov     ecx, [ebp+hModule]
.text:42CFD512                 push    ecx             ; hModule
.text:42CFD513                 call    ds:GetProcAddress
.text:42CFD519                 mov     edx, [ebp+arg_0]
.text:42CFD51C                 mov     [edx+10h], eax
.text:42CFD51F                 mov     eax, [ebp+arg_0]
.text:42CFD522                 cmp     dword ptr [eax+10h], 0
.text:42CFD526                 jnz     short loc_42CFD52F
.text:42CFD528                 xor     eax, eax
.text:42CFD52A                 jmp     loc_42CFD6EB
.text:42CFD52F ; ---------------------------------------------------------------------------
.text:42CFD52F
.text:42CFD52F loc_42CFD52F:                           ; CODE XREF: sub_42CFD464+C2\u2191j
.text:42CFD52F                 push    offset aOpenclusterres ; "OpenClusterResource"
.text:42CFD534                 mov     ecx, [ebp+hModule]
.text:42CFD537                 push    ecx             ; hModule
.text:42CFD538                 call    ds:GetProcAddress
.text:42CFD53E                 mov     edx, [ebp+arg_0]
.text:42CFD541                 mov     [edx+14h], eax
.text:42CFD544                 mov     eax, [ebp+arg_0]
.text:42CFD547                 cmp     dword ptr [eax+14h], 0
.text:42CFD54B                 jnz     short loc_42CFD554
.text:42CFD54D                 xor     eax, eax
.text:42CFD54F                 jmp     loc_42CFD6EB
.text:42CFD554 ; ---------------------------------------------------------------------------
.text:42CFD554
.text:42CFD554 loc_42CFD554:                           ; CODE XREF: sub_42CFD464+E7\u2191j
.text:42CFD554                 push    offset aGetclusterreso ; "GetClusterResourceState"
.text:42CFD559                 mov     ecx, [ebp+hModule]
.text:42CFD55C                 push    ecx             ; hModule
.text:42CFD55D                 call    ds:GetProcAddress
.text:42CFD563                 mov     edx, [ebp+arg_0]
.text:42CFD566                 mov     [edx+18h], eax
.text:42CFD569                 mov     eax, [ebp+arg_0]
.text:42CFD56C                 cmp     dword ptr [eax+18h], 0
.text:42CFD570                 jnz     short loc_42CFD579
.text:42CFD572                 xor     eax, eax
.text:42CFD574                 jmp     loc_42CFD6EB
.text:42CFD579 ; ---------------------------------------------------------------------------
.text:42CFD579
.text:42CFD579 loc_42CFD579:                           ; CODE XREF: sub_42CFD464+10C\u2191j
.text:42CFD579                 push    offset aCloseclusterre ; "CloseClusterResource"
.text:42CFD57E                 mov     ecx, [ebp+hModule]
.text:42CFD581                 push    ecx             ; hModule
.text:42CFD582                 call    ds:GetProcAddress
.text:42CFD588                 mov     edx, [ebp+arg_0]
.text:42CFD58B                 mov     [edx+1Ch], eax
.text:42CFD58E                 mov     eax, [ebp+arg_0]
.text:42CFD591                 cmp     dword ptr [eax+1Ch], 0
.text:42CFD595                 jnz     short loc_42CFD59E
.text:42CFD597                 xor     eax, eax
.text:42CFD599                 jmp     loc_42CFD6EB
.text:42CFD59E ; ---------------------------------------------------------------------------
.text:42CFD59E
.text:42CFD59E loc_42CFD59E:                           ; CODE XREF: sub_42CFD464+131\u2191j
.text:42CFD59E                 push    offset aClusteropenenu ; "ClusterOpenEnum"
.text:42CFD5A3                 mov     ecx, [ebp+hModule]
.text:42CFD5A6                 push    ecx             ; hModule
.text:42CFD5A7                 call    ds:GetProcAddress
.text:42CFD5AD                 mov     edx, [ebp+arg_0]
.text:42CFD5B0                 mov     [edx+20h], eax
.text:42CFD5B3                 mov     eax, [ebp+arg_0]
.text:42CFD5B6                 cmp     dword ptr [eax+20h], 0
.text:42CFD5BA                 jnz     short loc_42CFD5C3
.text:42CFD5BC                 xor     eax, eax
.text:42CFD5BE                 jmp     loc_42CFD6EB
.text:42CFD5C3 ; ---------------------------------------------------------------------------
.text:42CFD5C3
.text:42CFD5C3 loc_42CFD5C3:                           ; CODE XREF: sub_42CFD464+156\u2191j
.text:42CFD5C3                 push    offset aClusterenum ; "ClusterEnum"
.text:42CFD5C8                 mov     ecx, [ebp+hModule]
.text:42CFD5CB                 push    ecx             ; hModule
.text:42CFD5CC                 call    ds:GetProcAddress
.text:42CFD5D2                 mov     edx, [ebp+arg_0]
.text:42CFD5D5                 mov     [edx+24h], eax
.text:42CFD5D8                 mov     eax, [ebp+arg_0]
.text:42CFD5DB                 cmp     dword ptr [eax+24h], 0
.text:42CFD5DF                 jnz     short loc_42CFD5E8
.text:42CFD5E1                 xor     eax, eax
.text:42CFD5E3                 jmp     loc_42CFD6EB
.text:42CFD5E8 ; ---------------------------------------------------------------------------
.text:42CFD5E8
.text:42CFD5E8 loc_42CFD5E8:                           ; CODE XREF: sub_42CFD464+17B\u2191j
.text:42CFD5E8                 push    offset aClustercloseen ; "ClusterCloseEnum"
.text:42CFD5ED                 mov     ecx, [ebp+hModule]
.text:42CFD5F0                 push    ecx             ; hModule
.text:42CFD5F1                 call    ds:GetProcAddress
.text:42CFD5F7                 mov     edx, [ebp+arg_0]
.text:42CFD5FA                 mov     [edx+28h], eax
.text:42CFD5FD                 mov     eax, [ebp+arg_0]
.text:42CFD600                 cmp     dword ptr [eax+28h], 0
.text:42CFD604                 jnz     short loc_42CFD60D
.text:42CFD606                 xor     eax, eax
.text:42CFD608                 jmp     loc_42CFD6EB
.text:42CFD60D ; ---------------------------------------------------------------------------
.text:42CFD60D
.text:42CFD60D loc_42CFD60D:                           ; CODE XREF: sub_42CFD464+1A0\u2191j
.text:42CFD60D                 push    offset aClusterresourc ; "ClusterResourceOpenEnum"
.text:42CFD612                 mov     ecx, [ebp+hModule]
.text:42CFD615                 push    ecx             ; hModule
.text:42CFD616                 call    ds:GetProcAddress
.text:42CFD61C                 mov     edx, [ebp+arg_0]
.text:42CFD61F                 mov     [edx+2Ch], eax
.text:42CFD622                 mov     eax, [ebp+arg_0]
.text:42CFD625                 cmp     dword ptr [eax+2Ch], 0
.text:42CFD629                 jnz     short loc_42CFD632
.text:42CFD62B                 xor     eax, eax
.text:42CFD62D                 jmp     loc_42CFD6EB
.text:42CFD632 ; ---------------------------------------------------------------------------
.text:42CFD632
.text:42CFD632 loc_42CFD632:                           ; CODE XREF: sub_42CFD464+1C5\u2191j
.text:42CFD632                 push    offset aClusterresourc_0 ; "ClusterResourceEnum"
.text:42CFD637                 mov     ecx, [ebp+hModule]
.text:42CFD63A                 push    ecx             ; hModule
.text:42CFD63B                 call    ds:GetProcAddress
.text:42CFD641                 mov     edx, [ebp+arg_0]
.text:42CFD644                 mov     [edx+30h], eax
.text:42CFD647                 mov     eax, [ebp+arg_0]
.text:42CFD64A                 cmp     dword ptr [eax+30h], 0
.text:42CFD64E                 jnz     short loc_42CFD657
.text:42CFD650                 xor     eax, eax
.text:42CFD652                 jmp     loc_42CFD6EB
.text:42CFD657 ; ---------------------------------------------------------------------------
.text:42CFD657
.text:42CFD657 loc_42CFD657:                           ; CODE XREF: sub_42CFD464+1EA\u2191j
.text:42CFD657                 push    offset aClusterresourc_1 ; "ClusterResourceCloseEnum"
.text:42CFD65C                 mov     ecx, [ebp+hModule]
.text:42CFD65F                 push    ecx             ; hModule
.text:42CFD660                 call    ds:GetProcAddress
.text:42CFD666                 mov     edx, [ebp+arg_0]
.text:42CFD669                 mov     [edx+34h], eax
.text:42CFD66C                 mov     eax, [ebp+arg_0]
.text:42CFD66F                 cmp     dword ptr [eax+34h], 0
.text:42CFD673                 jnz     short loc_42CFD679
.text:42CFD675                 xor     eax, eax
.text:42CFD677                 jmp     short loc_42CFD6EB
.text:42CFD679 ; ---------------------------------------------------------------------------
.text:42CFD679
.text:42CFD679 loc_42CFD679:                           ; CODE XREF: sub_42CFD464+20F\u2191j
.text:42CFD679                 push    offset aClusterresourc_2 ; "ClusterResourceControl"
.text:42CFD67E                 mov     ecx, [ebp+hModule]
.text:42CFD681                 push    ecx             ; hModule
.text:42CFD682                 call    ds:GetProcAddress
.text:42CFD688                 mov     edx, [ebp+arg_0]
.text:42CFD68B                 mov     [edx+38h], eax
.text:42CFD68E                 mov     eax, [ebp+arg_0]
.text:42CFD691                 cmp     dword ptr [eax+38h], 0
.text:42CFD695                 jnz     short loc_42CFD69B
.text:42CFD697                 xor     eax, eax
.text:42CFD699                 jmp     short loc_42CFD6EB
.text:42CFD69B ; ---------------------------------------------------------------------------
.text:42CFD69B
.text:42CFD69B loc_42CFD69B:                           ; CODE XREF: sub_42CFD464+231\u2191j
.text:42CFD69B                 jmp     short loc_42CFD6A1
.text:42CFD69D ; ---------------------------------------------------------------------------
.text:42CFD69D
.text:42CFD69D loc_42CFD69D:                           ; CODE XREF: sub_42CFD464+29\u2191j
.text:42CFD69D                 xor     eax, eax
.text:42CFD69F                 jmp     short loc_42CFD6EB
.text:42CFD6A1 ; ---------------------------------------------------------------------------
.text:42CFD6A1
.text:42CFD6A1 loc_42CFD6A1:                           ; CODE XREF: sub_42CFD464:loc_42CFD69B\u2191j
.text:42CFD6A1                 push    offset aResutilsDll ; "RESUTILS.DLL"
.text:42CFD6A6                 call    ds:LoadLibraryA
.text:42CFD6AC                 mov     [ebp+hModule], eax
.text:42CFD6AF                 cmp     [ebp+hModule], 0
.text:42CFD6B3                 jz      short loc_42CFD6E2
.text:42CFD6B5                 mov     ecx, [ebp+arg_0]
.text:42CFD6B8                 mov     edx, [ebp+hModule]
.text:42CFD6BB                 mov     [ecx+3Ch], edx
.text:42CFD6BE                 push    offset aResutilfindszp ; "ResUtilFindSzProperty"
.text:42CFD6C3                 mov     eax, [ebp+hModule]
.text:42CFD6C6                 push    eax             ; hModule
.text:42CFD6C7                 call    ds:GetProcAddress
.text:42CFD6CD                 mov     ecx, [ebp+arg_0]
.text:42CFD6D0                 mov     [ecx+40h], eax
.text:42CFD6D3                 mov     edx, [ebp+arg_0]
.text:42CFD6D6                 cmp     dword ptr [edx+40h], 0
.text:42CFD6DA                 jnz     short loc_42CFD6E0
.text:42CFD6DC                 xor     eax, eax
.text:42CFD6DE                 jmp     short loc_42CFD6EB
.text:42CFD6E0 ; ---------------------------------------------------------------------------
.text:42CFD6E0
.text:42CFD6E0 loc_42CFD6E0:                           ; CODE XREF: sub_42CFD464+276\u2191j
.text:42CFD6E0                 jmp     short loc_42CFD6E6
.text:42CFD6E2 ; ---------------------------------------------------------------------------
.text:42CFD6E2
.text:42CFD6E2 loc_42CFD6E2:                           ; CODE XREF: sub_42CFD464+24F\u2191j
.text:42CFD6E2                 xor     eax, eax
.text:42CFD6E4                 jmp     short loc_42CFD6EB
.text:42CFD6E6 ; ---------------------------------------------------------------------------
.text:42CFD6E6
.text:42CFD6E6 loc_42CFD6E6:                           ; CODE XREF: sub_42CFD464:loc_42CFD6E0\u2191j
.text:42CFD6E6                 mov     eax, 1
.text:42CFD6EB
.text:42CFD6EB loc_42CFD6EB:                           ; CODE XREF: sub_42CFD464+57\u2191j
.text:42CFD6EB                                         ; sub_42CFD464+7C\u2191j ...
.text:42CFD6EB                 mov     esp, ebp
.text:42CFD6ED                 pop     ebp
.text:42CFD6EE                 retn
.text:42CFD6EE sub_42CFD464    endp
.text:42CFD6EE
.text:42CFD6EE ; ---------------------------------------------------------------------------
.text:42CFD6EF                 align 10h
.text:42CFD6F0
.text:42CFD6F0 ; =============== S U B R O U T I N E =======================================
.text:42CFD6F0
.text:42CFD6F0 ; Attributes: bp-based frame
.text:42CFD6F0
.text:42CFD6F0 ; int __cdecl sub_42CFD6F0(wchar_t *Buffer)
.text:42CFD6F0 sub_42CFD6F0    proc near               ; CODE XREF: sub_42CFD272+9B\u2191p
.text:42CFD6F0
.text:42CFD6F0 Buffer          = dword ptr  8
.text:42CFD6F0
.text:42CFD6F0                 push    ebp
.text:42CFD6F1                 mov     ebp, esp
.text:42CFD6F3                 cmp     [ebp+Buffer], 0
.text:42CFD6F7                 jnz     short loc_42CFD6FD
.text:42CFD6F9                 xor     eax, eax
.text:42CFD6FB                 jmp     short loc_42CFD717
.text:42CFD6FD ; ---------------------------------------------------------------------------
.text:42CFD6FD
.text:42CFD6FD loc_42CFD6FD:                           ; CODE XREF: sub_42CFD6F0+7\u2191j
.text:42CFD6FD                 push    offset aSqlServer ; "SQL Server"
.text:42CFD702                 push    offset aLs      ; "%ls"
.text:42CFD707                 mov     eax, [ebp+Buffer]
.text:42CFD70A                 push    eax             ; Buffer
.text:42CFD70B                 call    ds:swprintf
.text:42CFD711                 add     esp, 0Ch
.text:42CFD714                 mov     eax, [ebp+Buffer]
.text:42CFD717
.text:42CFD717 loc_42CFD717:                           ; CODE XREF: sub_42CFD6F0+B\u2191j
.text:42CFD717                 pop     ebp
.text:42CFD718                 retn
.text:42CFD718 sub_42CFD6F0    endp
.text:42CFD718
.text:42CFD718 ; ---------------------------------------------------------------------------
.text:42CFD719                 align 2
.text:42CFD71A ; [00000006 BYTES: COLLAPSED FUNCTION inet_addr. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD720 ; [00000006 BYTES: COLLAPSED FUNCTION gethostbyname. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD726 ; [00000006 BYTES: COLLAPSED FUNCTION strcat. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD72C ; [00000006 BYTES: COLLAPSED FUNCTION memset. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD732 ; [00000006 BYTES: COLLAPSED FUNCTION strcpy. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD738 ; [00000006 BYTES: COLLAPSED FUNCTION strcmp. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD73E                 align 10h
.text:42CFD740 ; [0000002F BYTES: COLLAPSED FUNCTION __alloca_probe. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD76F                 align 10h
.text:42CFD770 ; [00000006 BYTES: COLLAPSED FUNCTION memcpy. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD776 ; [00000006 BYTES: COLLAPSED FUNCTION memcmp. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD77C ; [00000006 BYTES: COLLAPSED FUNCTION strlen. PRESS CTRL-NUMPAD+ TO EXPAND]
.text:42CFD782                 align 1000h
.text:42CFD782 _text           ends
.text:42CFD782
.idata:42CFE000 ; Section 2. (virtual address 0000E000)
.idata:42CFE000 ; Virtual size                  : 00000BBC (   3004.)
.idata:42CFE000 ; Section size in file          : 00001000 (   4096.)
.idata:42CFE000 ; Offset to raw data for section: 0000E000
.idata:42CFE000 ; Flags 40000040: Data Readable
.idata:42CFE000 ; Alignment     : default
.idata:42CFE000 ;
.idata:42CFE000 ; Imports from ADVAPI32.dll
.idata:42CFE000 ;
.idata:42CFE000 ; ===========================================================================
.idata:42CFE000
.idata:42CFE000 ; Segment type: Externs
.idata:42CFE000 ; _idata
.idata:42CFE000 ; BOOL __stdcall GetUserNameA(LPSTR lpBuffer, LPDWORD pcbBuffer)
.idata:42CFE000                 extrn GetUserNameA:dword
.idata:42CFE000                                         ; CODE XREF: sub_42CFCA5A+F9\u2191p
.idata:42CFE000                                         ; DATA XREF: sub_42CFCA5A+F9\u2191r ...
.idata:42CFE004 ; BOOL __stdcall RevertToSelf()
.idata:42CFE004                 extrn RevertToSelf:dword
.idata:42CFE004                                         ; CODE XREF: sub_42CFC577:loc_42CFC5BD\u2191p
.idata:42CFE004                                         ; DATA XREF: sub_42CFC577:loc_42CFC5BD\u2191r
.idata:42CFE008 ; BOOL __stdcall ImpersonateLoggedOnUser(HANDLE hToken)
.idata:42CFE008                 extrn ImpersonateLoggedOnUser:dword
.idata:42CFE008                                         ; CODE XREF: sub_42CFC4F9+3B\u2191p
.idata:42CFE008                                         ; DATA XREF: sub_42CFC4F9+3B\u2191r
.idata:42CFE00C ; LSTATUS __stdcall RegDeleteValueA(HKEY hKey, LPCSTR lpValueName)
.idata:42CFE00C                 extrn RegDeleteValueA:dword
.idata:42CFE00C                                         ; CODE XREF: sub_42CFAB38+11F\u2191p
.idata:42CFE00C                                         ; DATA XREF: sub_42CFAB38+11F\u2191r
.idata:42CFE010 ; BOOL __stdcall ImpersonateNamedPipeClient(HANDLE hNamedPipe)
.idata:42CFE010                 extrn ImpersonateNamedPipeClient:dword
.idata:42CFE010                                         ; CODE XREF: sub_42CFC4F9+1E\u2191p
.idata:42CFE010                                         ; DATA XREF: sub_42CFC4F9+1E\u2191r
.idata:42CFE014 ; LSTATUS __stdcall RegSetValueExA(HKEY hKey, LPCSTR lpValueName, DWORD Reserved, DWORD dwType, const BYTE *lpData, DWORD cbData)
.idata:42CFE014                 extrn RegSetValueExA:dword
.idata:42CFE014                                         ; CODE XREF: sub_42CF9A35+EF\u2191p
.idata:42CFE014                                         ; sub_42CF9A35+1FB\u2191p ...
.idata:42CFE018 ; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult)
.idata:42CFE018                 extrn RegOpenKeyExA:dword
.idata:42CFE018                                         ; CODE XREF: sub_42CF8300+14E\u2191p
.idata:42CFE018                                         ; sub_42CF8300+2BA\u2191p ...
.idata:42CFE01C ; LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD Reserved, LPSTR lpClass, DWORD dwOptions, REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
.idata:42CFE01C                 extrn RegCreateKeyExA:dword
.idata:42CFE01C                                         ; CODE XREF: sub_42CFA2CE+4E\u2191p
.idata:42CFE01C                                         ; sub_42CFA3AD+21\u2191p
.idata:42CFE01C                                         ; DATA XREF: ...
.idata:42CFE020 ; LSTATUS __stdcall RegCloseKey(HKEY hKey)
.idata:42CFE020                 extrn RegCloseKey:dword ; CODE XREF: sub_42CF8300+264\u2191p
.idata:42CFE020                                         ; sub_42CF8300+42E\u2191p ...
.idata:42CFE024 ; BOOL __stdcall DeregisterEventSource(HANDLE hEventLog)
.idata:42CFE024                 extrn DeregisterEventSource:dword
.idata:42CFE024                                         ; CODE XREF: ConnectionClose+3A5\u2191p
.idata:42CFE024                                         ; DATA XREF: ConnectionClose+3A5\u2191r
.idata:42CFE028 ; LSTATUS __stdcall RegQueryValueExA(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData)
.idata:42CFE028                 extrn RegQueryValueExA:dword
.idata:42CFE028                                         ; CODE XREF: sub_42CF8300+189\u2191p
.idata:42CFE028                                         ; sub_42CF8300+1DC\u2191p ...
.idata:42CFE02C ; HANDLE __stdcall RegisterEventSourceA(LPCSTR lpUNCServerName, LPCSTR lpSourceName)
.idata:42CFE02C                 extrn RegisterEventSourceA:dword
.idata:42CFE02C                                         ; CODE XREF: ConnectionListen+1BF\u2191p
.idata:42CFE02C                                         ; ConnectionListen+21E\u2191p
.idata:42CFE02C                                         ; DATA XREF: ...
.idata:42CFE030 ; BOOL __stdcall ReportEventA(HANDLE hEventLog, WORD wType, WORD wCategory, DWORD dwEventID, PSID lpUserSid, WORD wNumStrings, DWORD dwDataSize, LPCSTR *lpStrings, LPVOID lpRawData)
.idata:42CFE030                 extrn ReportEventA:dword
.idata:42CFE030                                         ; CODE XREF: sub_42CF1197+36\u2191p
.idata:42CFE030                                         ; ConnectionListen+42C\u2191p ...
.idata:42CFE034
.idata:42CFE038 ;
.idata:42CFE038 ; Imports from KERNEL32.dll
.idata:42CFE038 ;
.idata:42CFE038 ; DWORD __stdcall GetLastError()
.idata:42CFE038                 extrn GetLastError:dword
.idata:42CFE038                                         ; CODE XREF: sub_42CF2BC5+150\u2191p
.idata:42CFE038                                         ; sub_42CF2F5B+AB\u2191p ...
.idata:42CFE03C ; BOOL __stdcall ReleaseSemaphore(HANDLE hSemaphore, LONG lReleaseCount, LPLONG lpPreviousCount)
.idata:42CFE03C                 extrn ReleaseSemaphore:dword
.idata:42CFE03C                                         ; CODE XREF: ConnectionAccept+20\u2191p
.idata:42CFE03C                                         ; DATA XREF: ConnectionAccept+20\u2191r
.idata:42CFE040 ; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:42CFE040                 extrn LeaveCriticalSection:dword
.idata:42CFE040                                         ; CODE XREF: sub_42CF2683+10A\u2191p
.idata:42CFE040                                         ; sub_42CF2683+13B\u2191p ...
.idata:42CFE044 ; BOOL __stdcall TerminateThread(HANDLE hThread, DWORD dwExitCode)
.idata:42CFE044                 extrn TerminateThread:dword
.idata:42CFE044                                         ; CODE XREF: ConnectionClose+227\u2191p
.idata:42CFE044                                         ; ConnectionClose+23E\u2191p ...
.idata:42CFE048 ; BOOL __stdcall ReleaseMutex(HANDLE hMutex)
.idata:42CFE048                 extrn ReleaseMutex:dword
.idata:42CFE048                                         ; CODE XREF: ConnectionClose+148\u2191p
.idata:42CFE048                                         ; StartAddress+28D\u2191p ...
.idata:42CFE04C ; BOOL __stdcall ResetEvent(HANDLE hEvent)
.idata:42CFE04C                 extrn ResetEvent:dword  ; CODE XREF: ConnectionClose+13B\u2191p
.idata:42CFE04C                                         ; sub_42CF508D+1E\u2191p ...
.idata:42CFE050 ; LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend)
.idata:42CFE050                 extrn InterlockedIncrement:dword
.idata:42CFE050                                         ; CODE XREF: ConnectionReadAsync+55\u2191p
.idata:42CFE050                                         ; DATA XREF: ConnectionReadAsync+55\u2191r
.idata:42CFE054 ; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:42CFE054                 extrn EnterCriticalSection:dword
.idata:42CFE054                                         ; CODE XREF: sub_42CF2683+EE\u2191p
.idata:42CFE054                                         ; sub_42CF2683+11D\u2191p ...
.idata:42CFE058 ; LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend)
.idata:42CFE058                 extrn InterlockedDecrement:dword
.idata:42CFE058                                         ; CODE XREF: ConnectionClose+3D9\u2191p
.idata:42CFE058                                         ; ConnectionReadAsync+3E6\u2191p ...
.idata:42CFE05C ; void __stdcall __noreturn ExitThread(DWORD dwExitCode)
.idata:42CFE05C                 extrn ExitThread:dword  ; CODE XREF: sub_42CF23E9+33\u2191p
.idata:42CFE05C                                         ; StartAddress+295\u2191p ...
.idata:42CFE060 ; DWORD __stdcall WaitForSingleObjectEx(HANDLE hHandle, DWORD dwMilliseconds, BOOL bAlertable)
.idata:42CFE060                 extrn WaitForSingleObjectEx:dword
.idata:42CFE060                                         ; CODE XREF: ConnectionWriteStatus+BC\u2191p
.idata:42CFE060                                         ; DATA XREF: ConnectionWriteStatus+BC\u2191r
.idata:42CFE064 ; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId)
.idata:42CFE064                 extrn CreateThread:dword
.idata:42CFE064                                         ; CODE XREF: sub_42CF508D+6A\u2191p
.idata:42CFE064                                         ; sub_42CF69B4+24\u2191p ...
.idata:42CFE068 ; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
.idata:42CFE068                 extrn CreateMutexA:dword
.idata:42CFE068                                         ; CODE XREF: sub_42CF508D+2A\u2191p
.idata:42CFE068                                         ; sub_42CFC5E0+39\u2191p
.idata:42CFE068                                         ; DATA XREF: ...
.idata:42CFE06C ; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
.idata:42CFE06C                 extrn GetProcAddress:dword
.idata:42CFE06C                                         ; CODE XREF: sub_42CF5128+BB\u2191p
.idata:42CFE06C                                         ; sub_42CF5128+16A\u2191p ...
.idata:42CFE070 ; HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName)
.idata:42CFE070                 extrn LoadLibraryA:dword
.idata:42CFE070                                         ; CODE XREF: sub_42CF5128+6F\u2191p
.idata:42CFE070                                         ; sub_42CF5128+81\u2191p ...
.idata:42CFE074 ; BOOL __stdcall IsDBCSLeadByte(BYTE TestChar)
.idata:42CFE074                 extrn IsDBCSLeadByte:dword
.idata:42CFE074                                         ; CODE XREF: .text:42CF67CF\u2191p
.idata:42CFE074                                         ; DATA XREF: .text:42CF67CF\u2191r
.idata:42CFE078 ; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
.idata:42CFE078                 extrn InitializeCriticalSection:dword
.idata:42CFE078                                         ; CODE XREF: sub_42CF69B4+18A\u2191p
.idata:42CFE078                                         ; DATA XREF: sub_42CF69B4+18A\u2191r
.idata:42CFE07C ; int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar)
.idata:42CFE07C                 extrn WideCharToMultiByte:dword
.idata:42CFE07C                                         ; CODE XREF: sub_42CFCFEA+F0\u2191p
.idata:42CFE07C                                         ; DATA XREF: sub_42CFCFEA+F0\u2191r
.idata:42CFE080 ; void __stdcall Sleep(DWORD dwMilliseconds)
.idata:42CFE080                 extrn Sleep:dword       ; CODE XREF: sub_42CF24E5+1F\u2191p
.idata:42CFE080                                         ; sub_42CF2683+112\u2191p ...
.idata:42CFE084 ; BOOL __stdcall SetEvent(HANDLE hEvent)
.idata:42CFE084                 extrn SetEvent:dword    ; CODE XREF: sub_42CF23E9+2B\u2191p
.idata:42CFE084                                         ; sub_42CF6D55+3D\u2191p ...
.idata:42CFE088 ; HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName)
.idata:42CFE088                 extrn CreateEventA:dword
.idata:42CFE088                                         ; CODE XREF: ConnectionListen+4A7\u2191p
.idata:42CFE088                                         ; sub_42CF2585+17\u2191p ...
.idata:42CFE08C ; BOOL __stdcall GetComputerNameA(LPSTR lpBuffer, LPDWORD nSize)
.idata:42CFE08C                 extrn GetComputerNameA:dword
.idata:42CFE08C                                         ; CODE XREF: ConnectionListen+9E\u2191p
.idata:42CFE08C                                         ; DATA XREF: ConnectionListen+9E\u2191r
.idata:42CFE090 ; HANDLE __stdcall CreateSemaphoreA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCSTR lpName)
.idata:42CFE090                 extrn CreateSemaphoreA:dword
.idata:42CFE090                                         ; CODE XREF: ConnectionListen+47D\u2191p
.idata:42CFE090                                         ; DATA XREF: ConnectionListen+47D\u2191r
.idata:42CFE094 ; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation)
.idata:42CFE094                 extrn GetVersionExA:dword
.idata:42CFE094                                         ; CODE XREF: DllEntryPoint+63\u2191p
.idata:42CFE094                                         ; DATA XREF: DllEntryPoint+63\u2191r
.idata:42CFE098 ; DWORD __stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
.idata:42CFE098                 extrn WaitForSingleObject:dword
.idata:42CFE098                                         ; CODE XREF: ConnectionListen+4D2\u2191p
.idata:42CFE098                                         ; sub_42CF23E9+B\u2191p ...
.idata:42CFE09C ; int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar)
.idata:42CFE09C                 extrn MultiByteToWideChar:dword
.idata:42CFE09C                                         ; CODE XREF: ConnectionListen+11A0\u2191p
.idata:42CFE09C                                         ; sub_42CFCFEA+55\u2191p
.idata:42CFE09C                                         ; DATA XREF: ...
.idata:42CFE0A0 ; BOOL __stdcall CloseHandle(HANDLE hObject)
.idata:42CFE0A0                 extrn CloseHandle:dword ; CODE XREF: DllEntryPoint+F1\u2191p
.idata:42CFE0A0                                         ; ConnectionClose+93\u2191p ...
.idata:42CFE0A4 ; DWORD __stdcall GetEnvironmentVariableA(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize)
.idata:42CFE0A4                 extrn GetEnvironmentVariableA:dword
.idata:42CFE0A4                                         ; CODE XREF: DllEntryPoint+98\u2191p
.idata:42CFE0A4                                         ; DATA XREF: DllEntryPoint+98\u2191r
.idata:42CFE0A8 ; HANDLE __stdcall CreateIoCompletionPort(HANDLE FileHandle, HANDLE ExistingCompletionPort, ULONG_PTR CompletionKey, DWORD NumberOfConcurrentThreads)
.idata:42CFE0A8                 extrn CreateIoCompletionPort:dword
.idata:42CFE0A8                                         ; CODE XREF: DllEntryPoint+D1\u2191p
.idata:42CFE0A8                                         ; ConnectionAccept+B2\u2191p
.idata:42CFE0A8                                         ; DATA XREF: ...
.idata:42CFE0AC ; void __stdcall SetLastError(DWORD dwErrCode)
.idata:42CFE0AC                 extrn SetLastError:dword
.idata:42CFE0AC                                         ; CODE XREF: ConnectionReadAsyncWait+125\u2191p
.idata:42CFE0AC                                         ; DATA XREF: ConnectionReadAsyncWait+125\u2191r
.idata:42CFE0B0 ; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
.idata:42CFE0B0                 extrn FreeLibrary:dword ; CODE XREF: DllEntryPoint+110\u2191p
.idata:42CFE0B0                                         ; DllEntryPoint+126\u2191p ...
.idata:42CFE0B4 ; BOOL __stdcall GetQueuedCompletionStatus(HANDLE CompletionPort, LPDWORD lpNumberOfBytesTransferred, PULONG_PTR lpCompletionKey, LPOVERLAPPED *lpOverlapped, DWORD dwMilliseconds)
.idata:42CFE0B4                 extrn GetQueuedCompletionStatus:dword
.idata:42CFE0B4                                         ; CODE XREF: ConnectionReadAsyncWait+3B\u2191p
.idata:42CFE0B4                                         ; DATA XREF: ConnectionReadAsyncWait+3B\u2191r
.idata:42CFE0B8
.idata:42CFE0BC ;
.idata:42CFE0BC ; Imports from MSVCRT.dll
.idata:42CFE0BC ;
.idata:42CFE0BC ; char *__cdecl strupr(char *String)
.idata:42CFE0BC                 extrn _strupr:dword     ; CODE XREF: sub_42CF9C63+4D\u2191p
.idata:42CFE0BC                                         ; DATA XREF: sub_42CF9C63+4D\u2191r ...
.idata:42CFE0C0 ; void *__cdecl memcpy(void *, const void *Src, size_t Size)
.idata:42CFE0C0                 extrn __imp_memcpy:dword
.idata:42CFE0C0                                         ; DATA XREF: memcpy\u2191r
.idata:42CFE0C4 ; int __cdecl wcsicmp(const wchar_t *String1, const wchar_t *String2)
.idata:42CFE0C4                 extrn _wcsicmp:dword    ; CODE XREF: sub_42CFD35A+D6\u2191p
.idata:42CFE0C4                                         ; DATA XREF: sub_42CFD35A+D6\u2191r
.idata:42CFE0C8 ; int swprintf(wchar_t *const Buffer, const size_t BufferCount, const wchar_t *const Format, ...)
.idata:42CFE0C8                 extrn swprintf:dword    ; CODE XREF: sub_42CFD6F0+1B\u2191p
.idata:42CFE0C8                                         ; DATA XREF: sub_42CFD6F0+1B\u2191r
.idata:42CFE0CC ; int __cdecl wcscmp(const wchar_t *String1, const wchar_t *String2)
.idata:42CFE0CC                 extrn wcscmp:dword      ; CODE XREF: sub_42CFD272+B4\u2191p
.idata:42CFE0CC                                         ; DATA XREF: sub_42CFD272+B4\u2191r
.idata:42CFE0D0 ; char *__cdecl strlwr(char *String)
.idata:42CFE0D0                 extrn _strlwr:dword     ; CODE XREF: sub_42CFAD0B+EC\u2191p
.idata:42CFE0D0                                         ; DATA XREF: sub_42CFAD0B+EC\u2191r
.idata:42CFE0D4 ; double __cdecl difftime(const __time32_t Time1, const __time32_t Time2)
.idata:42CFE0D4                 extrn difftime:dword    ; CODE XREF: sub_42CFA283+1E\u2191p
.idata:42CFE0D4                                         ; sub_42CFA4FE+92\u2191p
.idata:42CFE0D4                                         ; DATA XREF: ...
.idata:42CFE0D8 ; int __cdecl stricmp(const char *String1, const char *String2)
.idata:42CFE0D8                 extrn _stricmp:dword    ; CODE XREF: ConnectionListen+DA\u2191p
.idata:42CFE0D8                                         ; ConnectionListen+1AB\u2191p ...
.idata:42CFE0DC ; __time32_t __cdecl time(__time32_t *const Time)
.idata:42CFE0DC                 extrn time:dword        ; CODE XREF: StartAddress+64\u2191p
.idata:42CFE0DC                                         ; StartAddress+10D\u2191p ...
.idata:42CFE0E0 ; int __cdecl toupper(int C)
.idata:42CFE0E0                 extrn toupper:dword     ; CODE XREF: sub_42CF9C63+2E\u2191p
.idata:42CFE0E0                                         ; DATA XREF: sub_42CF9C63+2E\u2191r
.idata:42CFE0E4 ; char *__cdecl itoa(int Value, char *Buffer, int Radix)
.idata:42CFE0E4                 extrn _itoa:dword       ; CODE XREF: sub_42CF9A35+80\u2191p
.idata:42CFE0E4                                         ; sub_42CF9A35+170\u2191p ...
.idata:42CFE0E8 ; size_t __cdecl strcspn(const char *Str, const char *Control)
.idata:42CFE0E8                 extrn strcspn:dword     ; CODE XREF: sub_42CF9388+48A\u2191p
.idata:42CFE0E8                                         ; sub_42CFAD0B+162\u2191p ...
.idata:42CFE0EC ; char *__cdecl strstr(const char *Str, const char *SubStr)
.idata:42CFE0EC                 extrn strstr:dword      ; CODE XREF: sub_42CF8300+291\u2191p
.idata:42CFE0EC                                         ; sub_42CF9388+426\u2191p ...
.idata:42CFE0F0 ; size_t __cdecl strlen(const char *Str)
.idata:42CFE0F0                 extrn __imp_strlen:dword
.idata:42CFE0F0                                         ; DATA XREF: strlen\u2191r
.idata:42CFE0F4 ; char *__cdecl strchr(const char *Str, int Val)
.idata:42CFE0F4                 extrn strchr:dword      ; CODE XREF: sub_42CF8300+601\u2191p
.idata:42CFE0F4                                         ; sub_42CF9388+1B3\u2191p ...
.idata:42CFE0F8 ; void *__cdecl calloc(size_t Count, size_t Size)
.idata:42CFE0F8                 extrn calloc:dword      ; CODE XREF: sub_42CF7275+22\u2191p
.idata:42CFE0F8                                         ; sub_42CF75BC+31\u2191p ...
.idata:42CFE0FC ; char *__cdecl strtok(char *String, const char *Delimiter)
.idata:42CFE0FC                 extrn strtok:dword      ; CODE XREF: sub_42CF67F5+14\u2191p
.idata:42CFE0FC                                         ; sub_42CF8300+61A\u2191p ...
.idata:42CFE100 ; int __cdecl memcmp(const void *Buf1, const void *Buf2, size_t Size)
.idata:42CFE100                 extrn __imp_memcmp:dword
.idata:42CFE100                                         ; DATA XREF: memcmp\u2191r
.idata:42CFE104                 extrn _assert:dword     ; CODE XREF: ConnectionReadAsync+35\u2191p
.idata:42CFE104                                         ; ConnectionReadAsync+404\u2191p ...
.idata:42CFE108 ; void *__cdecl malloc(size_t Size)
.idata:42CFE108                 extrn malloc:dword      ; CODE XREF: ConnectionListen+16E\u2191p
.idata:42CFE108                                         ; ConnectionListen+579\u2191p ...
.idata:42CFE10C ; int printf(const char *const Format, ...)
.idata:42CFE10C                 extrn printf:dword      ; CODE XREF: sub_42CF2BC5+366\u2191p
.idata:42CFE10C                                         ; DATA XREF: sub_42CF2BC5+366\u2191r
.idata:42CFE110 ; int sprintf(char *const Buffer, const char *const Format, ...)
.idata:42CFE110                 extrn sprintf:dword     ; CODE XREF: sub_42CF56FE+21\u2191p
.idata:42CFE110                                         ; sub_42CF7880+24\u2191p ...
.idata:42CFE114 ; int __cdecl strcmp(const char *Str1, const char *Str2)
.idata:42CFE114                 extrn __imp_strcmp:dword
.idata:42CFE114                                         ; DATA XREF: strcmp\u2191r
.idata:42CFE118 ; char *__cdecl strcpy(char *Destination, const char *Source)
.idata:42CFE118                 extrn __imp_strcpy:dword
.idata:42CFE118                                         ; DATA XREF: strcpy\u2191r
.idata:42CFE11C ; char *__cdecl strcat(char *Destination, const char *Source)
.idata:42CFE11C                 extrn __imp_strcat:dword
.idata:42CFE11C                                         ; DATA XREF: strcat\u2191r
.idata:42CFE120 ; void __cdecl free(void *Block)
.idata:42CFE120                 extrn free:dword        ; CODE XREF: ConnectionListen+5B9\u2191p
.idata:42CFE120                                         ; ConnectionListen+1054\u2191p ...
.idata:42CFE124 ; void *__cdecl memset(void *, int Val, size_t Size)
.idata:42CFE124                 extrn __imp_memset:dword
.idata:42CFE124                                         ; DATA XREF: memset\u2191r
.idata:42CFE128 ; wchar_t *__cdecl itow(int Value, wchar_t *Buffer, int Radix)
.idata:42CFE128                 extrn _itow:dword       ; CODE XREF: ConnectionListen+D1A\u2191p
.idata:42CFE128                                         ; DATA XREF: ConnectionListen+D1A\u2191r
.idata:42CFE12C ; int __cdecl atoi(const char *String)
.idata:42CFE12C                 extrn atoi:dword        ; CODE XREF: DllEntryPoint+A9\u2191p
.idata:42CFE12C                                         ; sub_42CF9388+31C\u2191p ...
.idata:42CFE130 ; wchar_t *__cdecl wcscat(wchar_t *Destination, const wchar_t *Source)
.idata:42CFE130                 extrn wcscat:dword      ; CODE XREF: ConnectionListen+741\u2191p
.idata:42CFE130                                         ; ConnectionListen+F30\u2191p ...
.idata:42CFE134
.idata:42CFE138 ;
.idata:42CFE138 ; Imports from WS2_32.dll
.idata:42CFE138 ;
.idata:42CFE138 ; int __stdcall WSAEnumNetworkEvents(SOCKET s, HANDLE hEventObject, LPWSANETWORKEVENTS lpNetworkEvents)
.idata:42CFE138                 extrn WSAEnumNetworkEvents:dword
.idata:42CFE138                                         ; CODE XREF: sub_42CF2BC5+BD\u2191p
.idata:42CFE138                                         ; DATA XREF: sub_42CF2BC5+BD\u2191r ...
.idata:42CFE13C ; HANDLE __stdcall WSACreateEvent()
.idata:42CFE13C                 extrn WSACreateEvent:dword
.idata:42CFE13C                                         ; CODE XREF: sub_42CF2424+2A\u2191p
.idata:42CFE13C                                         ; DATA XREF: sub_42CF2424+2A\u2191r
.idata:42CFE140 ; int __stdcall WSARecv(SOCKET s, LPWSABUF lpBuffers, DWORD dwBufferCount, LPDWORD lpNumberOfBytesRecvd, LPDWORD lpFlags, LPWSAOVERLAPPED lpOverlapped, LPWSAOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)
.idata:42CFE140                 extrn WSARecv:dword     ; CODE XREF: ConnectionReadAsync+30A\u2191p
.idata:42CFE140                                         ; ConnectionReadAsync+3A5\u2191p
.idata:42CFE140                                         ; DATA XREF: ...
.idata:42CFE144 ; DWORD __stdcall WSAWaitForMultipleEvents(DWORD cEvents, const HANDLE *lphEvents, BOOL fWaitAll, DWORD dwTimeout, BOOL fAlertable)
.idata:42CFE144                 extrn WSAWaitForMultipleEvents:dword
.idata:42CFE144                                         ; CODE XREF: sub_42CF2BC5+7D\u2191p
.idata:42CFE144                                         ; DATA XREF: sub_42CF2BC5+7D\u2191r
.idata:42CFE148 ; int __stdcall WSAIoctl(SOCKET s, DWORD dwIoControlCode, LPVOID lpvInBuffer, DWORD cbInBuffer, LPVOID lpvOutBuffer, DWORD cbOutBuffer, LPDWORD lpcbBytesReturned, LPWSAOVERLAPPED lpOverlapped, LPWSAOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)
.idata:42CFE148                 extrn WSAIoctl:dword    ; CODE XREF: sub_42CF2BC5+345\u2191p
.idata:42CFE148                                         ; DATA XREF: sub_42CF2BC5+345\u2191r
.idata:42CFE14C ; int __stdcall WSASend(SOCKET s, LPWSABUF lpBuffers, DWORD dwBufferCount, LPDWORD lpNumberOfBytesSent, DWORD dwFlags, LPWSAOVERLAPPED lpOverlapped, LPWSAOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine)
.idata:42CFE14C                 extrn WSASend:dword     ; CODE XREF: ConnectionWriteAsync+1FD\u2191p
.idata:42CFE14C                                         ; DATA XREF: ConnectionWriteAsync+1FD\u2191r
.idata:42CFE150 ; int __stdcall WSAEventSelect(SOCKET s, HANDLE hEventObject, int lNetworkEvents)
.idata:42CFE150                 extrn WSAEventSelect:dword
.idata:42CFE150                                         ; CODE XREF: sub_42CF2424+52\u2191p
.idata:42CFE150                                         ; sub_42CF2BC5+228\u2191p ...
.idata:42CFE154 ; int __stdcall WSAEnumProtocolsA(LPINT lpiProtocols, LPWSAPROTOCOL_INFOA lpProtocolBuffer, LPDWORD lpdwBufferLength)
.idata:42CFE154                 extrn WSAEnumProtocolsA:dword
.idata:42CFE154                                         ; CODE XREF: ConnectionListen+535\u2191p
.idata:42CFE154                                         ; ConnectionListen+5A6\u2191p
.idata:42CFE154                                         ; DATA XREF: ...
.idata:42CFE158 ; BOOL __stdcall WSAGetOverlappedResult(SOCKET s, LPWSAOVERLAPPED lpOverlapped, LPDWORD lpcbTransfer, BOOL fWait, LPDWORD lpdwFlags)
.idata:42CFE158                 extrn WSAGetOverlappedResult:dword
.idata:42CFE158                                         ; CODE XREF: ConnectionWriteStatus+10A\u2191p
.idata:42CFE158                                         ; DATA XREF: ConnectionWriteStatus+10A\u2191r
.idata:42CFE15C
.idata:42CFE160 ;
.idata:42CFE160 ; Imports from WSOCK32.dll
.idata:42CFE160 ;
.idata:42CFE160 ; int __stdcall ioctlsocket(SOCKET s, int cmd, u_long *argp)
.idata:42CFE160                 extrn ioctlsocket:dword ; CODE XREF: sub_42CF24E5+37\u2191p
.idata:42CFE160                                         ; sub_42CF2BC5+253\u2191p ...
.idata:42CFE164 ; int __stdcall connect(SOCKET s, const struct sockaddr *name, int namelen)
.idata:42CFE164                 extrn connect:dword     ; CODE XREF: sub_42CFC6C2+EE\u2191p
.idata:42CFE164                                         ; DATA XREF: sub_42CFC6C2+EE\u2191r
.idata:42CFE168 ; int __stdcall sendto(SOCKET s, const char *buf, int len, int flags, const struct sockaddr *to, int tolen)
.idata:42CFE168                 extrn sendto:dword      ; CODE XREF: sub_42CFA5C6+7B\u2191p
.idata:42CFE168                                         ; DATA XREF: sub_42CFA5C6+7B\u2191r
.idata:42CFE16C ; int __stdcall recvfrom(SOCKET s, char *buf, int len, int flags, struct sockaddr *from, int *fromlen)
.idata:42CFE16C                 extrn recvfrom:dword    ; CODE XREF: sub_42CFA4FE+28\u2191p
.idata:42CFE16C                                         ; DATA XREF: sub_42CFA4FE+28\u2191r
.idata:42CFE170 ; u_long __stdcall htonl(u_long hostlong)
.idata:42CFE170                 extrn htonl:dword       ; CODE XREF: sub_42CF6E4F+7E\u2191p
.idata:42CFE170                                         ; sub_42CFA406+3E\u2191p ...
.idata:42CFE174 ; u_short __stdcall htons(u_short hostshort)
.idata:42CFE174                 extrn htons:dword       ; CODE XREF: sub_42CF4FA0+3D\u2191p
.idata:42CFE174                                         ; sub_42CF4FA0+7A\u2191p ...
.idata:42CFE178 ; int __stdcall send(SOCKET s, const char *buf, int len, int flags)
.idata:42CFE178                 extrn send:dword        ; CODE XREF: ConnectionWrite+1D1\u2191p
.idata:42CFE178                                         ; sub_42CFC6C2+1A8\u2191p ...
.idata:42CFE17C ; int __stdcall select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, const struct timeval *timeout)
.idata:42CFE17C                 extrn select:dword      ; CODE XREF: ConnectionPeek+172\u2191p
.idata:42CFE17C                                         ; DATA XREF: ConnectionPeek+172\u2191r
.idata:42CFE180 ; int __stdcall recv(SOCKET s, char *buf, int len, int flags)
.idata:42CFE180                 extrn recv:dword        ; CODE XREF: ConnectionRead+309\u2191p
.idata:42CFE180                                         ; ConnectionRead+4B9\u2191p ...
.idata:42CFE184 ; SOCKET __stdcall accept(SOCKET s, struct sockaddr *addr, int *addrlen)
.idata:42CFE184                 extrn accept:dword      ; CODE XREF: sub_42CF2BC5+FD\u2191p
.idata:42CFE184                                         ; sub_42CF2F5B+6F\u2191p
.idata:42CFE184                                         ; DATA XREF: ...
.idata:42CFE188 ; int __stdcall WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData)
.idata:42CFE188                 extrn WSAStartup:dword  ; CODE XREF: DllEntryPoint+39\u2191p
.idata:42CFE188                                         ; DATA XREF: DllEntryPoint+39\u2191r
.idata:42CFE18C ; char *__stdcall inet_ntoa(struct in_addr in)
.idata:42CFE18C                 extrn inet_ntoa:dword   ; CODE XREF: sub_42CF7880+11\u2191p
.idata:42CFE18C                                         ; DATA XREF: sub_42CF7880+11\u2191r
.idata:42CFE190 ; int __stdcall WSAGetLastError()
.idata:42CFE190                 extrn WSAGetLastError:dword
.idata:42CFE190                                         ; CODE XREF: ConnectionListen+54A\u2191p
.idata:42CFE190                                         ; ConnectionListen+5C2\u2191p ...
.idata:42CFE194 ; struct hostent *__stdcall gethostbyname(const char *name)
.idata:42CFE194                 extrn __imp_gethostbyname:dword
.idata:42CFE194                                         ; CODE XREF: ConnectionListen+80C\u2191p
.idata:42CFE194                                         ; sub_42CF67F5+52\u2191p
.idata:42CFE194                                         ; DATA XREF: ...
.idata:42CFE198 ; int __stdcall WSACleanup()
.idata:42CFE198                 extrn WSACleanup:dword  ; CODE XREF: DllEntryPoint:loc_42CF116D\u2191p
.idata:42CFE198                                         ; DATA XREF: DllEntryPoint:loc_42CF116D\u2191r
.idata:42CFE19C ; int __stdcall closesocket(SOCKET s)
.idata:42CFE19C                 extrn closesocket:dword ; CODE XREF: ConnectionListen+AB3\u2191p
.idata:42CFE19C                                         ; ConnectionListen+B30\u2191p ...
.idata:42CFE1A0 ; int __stdcall setsockopt(SOCKET s, int level, int optname, const char *optval, int optlen)
.idata:42CFE1A0                 extrn setsockopt:dword  ; CODE XREF: ConnectionListen+B09\u2191p
.idata:42CFE1A0                                         ; sub_42CF2BC5+196\u2191p ...
.idata:42CFE1A4 ; int __stdcall bind(SOCKET s, const struct sockaddr *name, int namelen)
.idata:42CFE1A4                 extrn bind:dword        ; CODE XREF: ConnectionListen+B78\u2191p
.idata:42CFE1A4                                         ; sub_42CF67F5+12F\u2191p ...
.idata:42CFE1A8 ; int __stdcall getsockname(SOCKET s, struct sockaddr *name, int *namelen)
.idata:42CFE1A8                 extrn getsockname:dword ; CODE XREF: ConnectionListen+D80\u2191p
.idata:42CFE1A8                                         ; sub_42CFA84B+2F\u2191p ...
.idata:42CFE1AC ; u_short __stdcall ntohs(u_short netshort)
.idata:42CFE1AC                 extrn ntohs:dword       ; CODE XREF: ConnectionListen+D95\u2191p
.idata:42CFE1AC                                         ; ConnectionListen+DC7\u2191p ...
.idata:42CFE1B0 ; int __stdcall listen(SOCKET s, int backlog)
.idata:42CFE1B0                 extrn listen:dword      ; CODE XREF: ConnectionListen+E16\u2191p
.idata:42CFE1B0                                         ; sub_42CF67F5+17E\u2191p
.idata:42CFE1B0                                         ; DATA XREF: ...
.idata:42CFE1B4 ; SOCKET __stdcall socket(int af, int type, int protocol)
.idata:42CFE1B4                 extrn socket:dword      ; CODE XREF: ConnectionListen+A09\u2191p
.idata:42CFE1B4                                         ; sub_42CF67F5+AA\u2191p ...
.idata:42CFE1B8 ; unsigned int __stdcall inet_addr(const char *cp)
.idata:42CFE1B8                 extrn __imp_inet_addr:dword
.idata:42CFE1B8                                         ; CODE XREF: ConnectionListen+904\u2191p
.idata:42CFE1B8                                         ; ConnectionListen+951\u2191p ...
.idata:42CFE1BC
.idata:42CFE1BC
.rdata:42CFE1C0 ; Debug Directory entries
.rdata:42CFE1C0 ; ===========================================================================
.rdata:42CFE1C0
.rdata:42CFE1C0 ; Segment type: Pure data
.rdata:42CFE1C0 ; Segment permissions: Read
.rdata:42CFE1C0 _rdata          segment para public 'DATA' use32
.rdata:42CFE1C0                 assume cs:_rdata
.rdata:42CFE1C0                 ;org 42CFE1C0h
.rdata:42CFE1C0                 dd 0                    ; Characteristics
.rdata:42CFE1C4                 dd 398D1352h            ; TimeDateStamp: Sun Aug 06 07:27:14 2000
.rdata:42CFE1C8                 dw 0                    ; MajorVersion
.rdata:42CFE1CA                 dw 0                    ; MinorVersion
.rdata:42CFE1CC                 dd 2                    ; Type: IMAGE_DEBUG_TYPE_CODEVIEW
.rdata:42CFE1D0                 dd 3Eh                  ; SizeOfData
.rdata:42CFE1D4                 dd 0                    ; AddressOfRawData
.rdata:42CFE1D8                 dd 15000h               ; PointerToRawData
.rdata:42CFE1DC                 align 10h
.rdata:42CFE1E0 dbl_42CFE1E0    dq 20.0                 ; DATA XREF: sub_42CFA283+27\u2191r
.rdata:42CFE1E8 dbl_42CFE1E8    dq 3.0                  ; DATA XREF: sub_42CFA4FE+9B\u2191r
.rdata:42CFE1F0 __IMPORT_DESCRIPTOR_KERNEL32 dd rva off_42CFE2A0 ; Import Name Table
.rdata:42CFE1F4                 dd 0                    ; Time stamp
.rdata:42CFE1F8                 dd 0                    ; Forwarder Chain
.rdata:42CFE1FC                 dd rva aKernel32Dll     ; DLL Name
.rdata:42CFE200                 dd rva GetLastError     ; Import Address Table
.rdata:42CFE204 __IMPORT_DESCRIPTOR_ADVAPI32 dd rva off_42CFE268 ; Import Name Table
.rdata:42CFE208                 dd 0                    ; Time stamp
.rdata:42CFE20C                 dd 0                    ; Forwarder Chain
.rdata:42CFE210                 dd rva aAdvapi32Dll     ; DLL Name
.rdata:42CFE214                 dd rva GetUserNameA     ; Import Address Table
.rdata:42CFE218 __IMPORT_DESCRIPTOR_WSOCK32 dd rva dword_42CFE3C8 ; Import Name Table
.rdata:42CFE21C                 dd 0                    ; Time stamp
.rdata:42CFE220                 dd 0                    ; Forwarder Chain
.rdata:42CFE224                 dd rva aWsock32Dll      ; DLL Name
.rdata:42CFE228                 dd rva ioctlsocket      ; Import Address Table
.rdata:42CFE22C __IMPORT_DESCRIPTOR_WS2_32 dd rva off_42CFE3A0 ; Import Name Table
.rdata:42CFE230                 dd 0                    ; Time stamp
.rdata:42CFE234                 dd 0                    ; Forwarder Chain
.rdata:42CFE238                 dd rva aWs232Dll        ; DLL Name
.rdata:42CFE23C                 dd rva WSAEnumNetworkEvents ; Import Address Table
.rdata:42CFE240 __IMPORT_DESCRIPTOR_MSVCRT dd rva off_42CFE324 ; Import Name Table
.rdata:42CFE244                 dd 0                    ; Time stamp
.rdata:42CFE248                 dd 0                    ; Forwarder Chain
.rdata:42CFE24C                 dd rva aMsvcrtDll       ; DLL Name
.rdata:42CFE250                 dd rva _strupr          ; Import Address Table
.rdata:42CFE254                 db    0
.rdata:42CFE255                 db    0
.rdata:42CFE256                 db    0
.rdata:42CFE257                 db    0
.rdata:42CFE258                 db    0
.rdata:42CFE259                 db    0
.rdata:42CFE25A                 db    0
.rdata:42CFE25B                 db    0
.rdata:42CFE25C                 db    0
.rdata:42CFE25D                 db    0
.rdata:42CFE25E                 db    0
.rdata:42CFE25F                 db    0
.rdata:42CFE260                 db    0
.rdata:42CFE261                 db    0
.rdata:42CFE262                 db    0
.rdata:42CFE263                 db    0
.rdata:42CFE264                 db    0
.rdata:42CFE265                 db    0
.rdata:42CFE266                 db    0
.rdata:42CFE267                 db    0
.rdata:42CFE268 ;
.rdata:42CFE268 ; Import names for ADVAPI32.dll
.rdata:42CFE268 ;
.rdata:42CFE268 off_42CFE268    dd rva word_42CFE78A    ; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32\u2191o
.rdata:42CFE26C                 dd rva word_42CFE77A
.rdata:42CFE270                 dd rva word_42CFE742
.rdata:42CFE274                 dd rva word_42CFE730
.rdata:42CFE278                 dd rva word_42CFE75C
.rdata:42CFE27C                 dd rva word_42CFE70C
.rdata:42CFE280                 dd rva word_42CFE6FC
.rdata:42CFE284                 dd rva word_42CFE71E
.rdata:42CFE288                 dd rva word_42CFE6DA
.rdata:42CFE28C                 dd rva word_42CFE6C2
.rdata:42CFE290                 dd rva word_42CFE6E8
.rdata:42CFE294                 dd rva word_42CFE6AA
.rdata:42CFE298                 dd rva word_42CFE69A
.rdata:42CFE29C                 dd 0
.rdata:42CFE2A0 ;
.rdata:42CFE2A0 ; Import names for KERNEL32.dll
.rdata:42CFE2A0 ;
.rdata:42CFE2A0 off_42CFE2A0    dd rva word_42CFE53E    ; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32\u2191o
.rdata:42CFE2A4                 dd rva word_42CFE54E
.rdata:42CFE2A8                 dd rva word_42CFE50E
.rdata:42CFE2AC                 dd rva word_42CFE57A
.rdata:42CFE2B0                 dd rva word_42CFE58C
.rdata:42CFE2B4                 dd rva word_42CFE59C
.rdata:42CFE2B8                 dd rva word_42CFE5AA
.rdata:42CFE2BC                 dd rva word_42CFE526
.rdata:42CFE2C0                 dd rva word_42CFE562
.rdata:42CFE2C4                 dd rva word_42CFE4EC
.rdata:42CFE2C8                 dd rva word_42CFE5EE
.rdata:42CFE2CC                 dd rva word_42CFE606
.rdata:42CFE2D0                 dd rva word_42CFE616
.rdata:42CFE2D4                 dd rva word_42CFE626
.rdata:42CFE2D8                 dd rva word_42CFE638
.rdata:42CFE2DC                 dd rva word_42CFE648
.rdata:42CFE2E0                 dd rva word_42CFE65A
.rdata:42CFE2E4                 dd rva word_42CFE676
.rdata:42CFE2E8                 dd rva word_42CFE506
.rdata:42CFE2EC                 dd rva word_42CFE4FA
.rdata:42CFE2F0                 dd rva word_42CFE4B4
.rdata:42CFE2F4                 dd rva word_42CFE4D8
.rdata:42CFE2F8                 dd rva word_42CFE4C4
.rdata:42CFE2FC                 dd rva word_42CFE478
.rdata:42CFE300                 dd rva word_42CFE49E
.rdata:42CFE304                 dd rva word_42CFE488
.rdata:42CFE308                 dd rva word_42CFE436
.rdata:42CFE30C                 dd rva word_42CFE45E
.rdata:42CFE310                 dd rva word_42CFE444
.rdata:42CFE314                 dd rva word_42CFE5C2
.rdata:42CFE318                 dd rva word_42CFE428
.rdata:42CFE31C                 dd rva word_42CFE5D2
.rdata:42CFE320                 dd 0
.rdata:42CFE324 ;
.rdata:42CFE324 ; Import names for MSVCRT.dll
.rdata:42CFE324 ;
.rdata:42CFE324 off_42CFE324    dd rva word_42CFE992    ; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCRT\u2191o
.rdata:42CFE328                 dd rva word_42CFE8CE
.rdata:42CFE32C                 dd rva word_42CFE96E
.rdata:42CFE330                 dd rva word_42CFE962
.rdata:42CFE334                 dd rva word_42CFE958
.rdata:42CFE338                 dd rva word_42CFE94E
.rdata:42CFE33C                 dd rva word_42CFE942
.rdata:42CFE340                 dd rva word_42CFE986
.rdata:42CFE344                 dd rva word_42CFE93A
.rdata:42CFE348                 dd rva word_42CFE930
.rdata:42CFE34C                 dd rva word_42CFE928
.rdata:42CFE350                 dd rva word_42CFE91E
.rdata:42CFE354                 dd rva word_42CFE914
.rdata:42CFE358                 dd rva word_42CFE90A
.rdata:42CFE35C                 dd rva word_42CFE900
.rdata:42CFE360                 dd rva word_42CFE8F6
.rdata:42CFE364                 dd rva word_42CFE8EC
.rdata:42CFE368                 dd rva word_42CFE8E2
.rdata:42CFE36C                 dd rva word_42CFE8D8
.rdata:42CFE370                 dd rva word_42CFE89C
.rdata:42CFE374                 dd rva word_42CFE8C4
.rdata:42CFE378                 dd rva word_42CFE8BA
.rdata:42CFE37C                 dd rva word_42CFE8B0
.rdata:42CFE380                 dd rva word_42CFE8A6
.rdata:42CFE384                 dd rva word_42CFE888
.rdata:42CFE388                 dd rva word_42CFE880
.rdata:42CFE38C                 dd rva word_42CFE892
.rdata:42CFE390                 dd rva word_42CFE86E
.rdata:42CFE394                 dd rva word_42CFE866
.rdata:42CFE398                 dd rva word_42CFE876
.rdata:42CFE39C                 dd 0
.rdata:42CFE3A0 ;
.rdata:42CFE3A0 ; Import names for WS2_32.dll
.rdata:42CFE3A0 ;
.rdata:42CFE3A0 off_42CFE3A0    dd rva word_42CFE7F8    ; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WS2_32\u2191o
.rdata:42CFE3A4                 dd rva word_42CFE7DA
.rdata:42CFE3A8                 dd rva word_42CFE82C
.rdata:42CFE3AC                 dd rva word_42CFE810
.rdata:42CFE3B0                 dd rva word_42CFE7EC
.rdata:42CFE3B4                 dd rva word_42CFE836
.rdata:42CFE3B8                 dd rva word_42CFE7C8
.rdata:42CFE3BC                 dd rva word_42CFE7B4
.rdata:42CFE3C0                 dd rva word_42CFE840
.rdata:42CFE3C4                 dd 0
.rdata:42CFE3C8 ;
.rdata:42CFE3C8 ; Import names for WSOCK32.dll
.rdata:42CFE3C8 ;
.rdata:42CFE3C8 dword_42CFE3C8  dd 8000000Ch            ; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WSOCK32\u2191o
.rdata:42CFE3CC                 dd 80000004h
.rdata:42CFE3D0                 dd 80000014h
.rdata:42CFE3D4                 dd 80000011h
.rdata:42CFE3D8                 dd 80000008h
.rdata:42CFE3DC                 dd 80000009h
.rdata:42CFE3E0                 dd 80000013h
.rdata:42CFE3E4                 dd 80000012h
.rdata:42CFE3E8                 dd 80000010h
.rdata:42CFE3EC                 dd 80000001h
.rdata:42CFE3F0                 dd 80000073h
.rdata:42CFE3F4                 dd 8000000Bh
.rdata:42CFE3F8                 dd 8000006Fh
.rdata:42CFE3FC                 dd 80000034h
.rdata:42CFE400                 dd 80000074h
.rdata:42CFE404                 dd 80000003h
.rdata:42CFE408                 dd 80000015h
.rdata:42CFE40C                 dd 80000002h
.rdata:42CFE410                 dd 80000006h
.rdata:42CFE414                 dd 8000000Fh
.rdata:42CFE418                 dd 8000000Dh
.rdata:42CFE41C                 dd 80000017h
.rdata:42CFE420                 dd 8000000Ah
.rdata:42CFE424                 dd 0
.rdata:42CFE428 word_42CFE428   dw 0B4h                 ; DATA XREF: .rdata:42CFE318\u2191o
.rdata:42CFE42A                 db 'FreeLibrary',0
.rdata:42CFE436 word_42CFE436   dw 1Bh                  ; DATA XREF: .rdata:42CFE308\u2191o
.rdata:42CFE438                 db 'CloseHandle',0
.rdata:42CFE444 word_42CFE444   dw 3Ah                  ; DATA XREF: .rdata:42CFE310\u2191o
.rdata:42CFE446                 db 'CreateIoCompletionPort',0
.rdata:42CFE45D                 align 2
.rdata:42CFE45E word_42CFE45E   dw 109h                 ; DATA XREF: .rdata:42CFE30C\u2191o
.rdata:42CFE460                 db 'GetEnvironmentVariableA',0
.rdata:42CFE478 word_42CFE478   dw 175h                 ; DATA XREF: .rdata:42CFE2FC\u2191o
.rdata:42CFE47A                 db 'GetVersionExA',0
.rdata:42CFE488 word_42CFE488   dw 1E4h                 ; DATA XREF: .rdata:42CFE304\u2191o
.rdata:42CFE48A                 db 'MultiByteToWideChar',0
.rdata:42CFE49E word_42CFE49E   dw 2CEh                 ; DATA XREF: .rdata:42CFE300\u2191o
.rdata:42CFE4A0                 db 'WaitForSingleObject',0
.rdata:42CFE4B4 word_42CFE4B4   dw 31h                  ; DATA XREF: .rdata:42CFE2F0\u2191o
.rdata:42CFE4B6                 db 'CreateEventA',0
.rdata:42CFE4C3                 align 4
.rdata:42CFE4C4 word_42CFE4C4   dw 47h                  ; DATA XREF: .rdata:42CFE2F8\u2191o
.rdata:42CFE4C6                 db 'CreateSemaphoreA',0
.rdata:42CFE4D7                 align 4
.rdata:42CFE4D8 word_42CFE4D8   dw 0CEh                 ; DATA XREF: .rdata:42CFE2F4\u2191o
.rdata:42CFE4DA                 db 'GetComputerNameA',0
.rdata:42CFE4EB                 align 4
.rdata:42CFE4EC word_42CFE4EC   dw 7Eh                  ; DATA XREF: .rdata:42CFE2C4\u2191o
.rdata:42CFE4EE                 db 'ExitThread',0
.rdata:42CFE4F9                 align 2
.rdata:42CFE4FA word_42CFE4FA   dw 265h                 ; DATA XREF: .rdata:42CFE2EC\u2191o
.rdata:42CFE4FC                 db 'SetEvent',0
.rdata:42CFE505                 align 2
.rdata:42CFE506 word_42CFE506   dw 296h                 ; DATA XREF: .rdata:42CFE2E8\u2191o
.rdata:42CFE508                 db 'Sleep',0
.rdata:42CFE50E word_42CFE50E   dw 1C1h                 ; DATA XREF: .rdata:42CFE2A8\u2191o
.rdata:42CFE510                 db 'LeaveCriticalSection',0
.rdata:42CFE525                 align 2
.rdata:42CFE526 word_42CFE526   dw 66h                  ; DATA XREF: .rdata:42CFE2BC\u2191o
.rdata:42CFE528                 db 'EnterCriticalSection',0
.rdata:42CFE53D                 align 2
.rdata:42CFE53E word_42CFE53E   dw 11Ah                 ; DATA XREF: .rdata:off_42CFE2A0\u2191o
.rdata:42CFE540                 db 'GetLastError',0
.rdata:42CFE54D                 align 2
.rdata:42CFE54E word_42CFE54E   dw 226h                 ; DATA XREF: .rdata:42CFE2A4\u2191o
.rdata:42CFE550                 db 'ReleaseSemaphore',0
.rdata:42CFE561                 align 2
.rdata:42CFE562 word_42CFE562   dw 1ADh                 ; DATA XREF: .rdata:42CFE2C0\u2191o
.rdata:42CFE564                 db 'InterlockedDecrement',0
.rdata:42CFE579                 align 2
.rdata:42CFE57A word_42CFE57A   dw 29Fh                 ; DATA XREF: .rdata:42CFE2AC\u2191o
.rdata:42CFE57C                 db 'TerminateThread',0
.rdata:42CFE58C word_42CFE58C   dw 225h                 ; DATA XREF: .rdata:42CFE2B0\u2191o
.rdata:42CFE58E                 db 'ReleaseMutex',0
.rdata:42CFE59B                 align 4
.rdata:42CFE59C word_42CFE59C   dw 22Bh                 ; DATA XREF: .rdata:42CFE2B4\u2191o
.rdata:42CFE59E                 db 'ResetEvent',0
.rdata:42CFE5A9                 align 2
.rdata:42CFE5AA word_42CFE5AA   dw 1B0h                 ; DATA XREF: .rdata:42CFE2B8\u2191o
.rdata:42CFE5AC                 db 'InterlockedIncrement',0
.rdata:42CFE5C1                 align 2
.rdata:42CFE5C2 word_42CFE5C2   dw 271h                 ; DATA XREF: .rdata:42CFE314\u2191o
.rdata:42CFE5C4                 db 'SetLastError',0
.rdata:42CFE5D1                 align 2
.rdata:42CFE5D2 word_42CFE5D2   dw 14Dh                 ; DATA XREF: .rdata:42CFE31C\u2191o
.rdata:42CFE5D4                 db 'GetQueuedCompletionStatus',0
.rdata:42CFE5EE word_42CFE5EE   dw 2CFh                 ; DATA XREF: .rdata:42CFE2C8\u2191o
.rdata:42CFE5F0                 db 'WaitForSingleObjectEx',0
.rdata:42CFE606 word_42CFE606   dw 4Ah                  ; DATA XREF: .rdata:42CFE2CC\u2191o
.rdata:42CFE608                 db 'CreateThread',0
.rdata:42CFE615                 align 2
.rdata:42CFE616 word_42CFE616   dw 3Fh                  ; DATA XREF: .rdata:42CFE2D0\u2191o
.rdata:42CFE618                 db 'CreateMutexA',0
.rdata:42CFE625                 align 2
.rdata:42CFE626 word_42CFE626   dw 13Eh                 ; DATA XREF: .rdata:42CFE2D4\u2191o
.rdata:42CFE628                 db 'GetProcAddress',0
.rdata:42CFE637                 align 4
.rdata:42CFE638 word_42CFE638   dw 1C2h                 ; DATA XREF: .rdata:42CFE2D8\u2191o
.rdata:42CFE63A                 db 'LoadLibraryA',0
.rdata:42CFE647                 align 4
.rdata:42CFE648 word_42CFE648   dw 1B9h                 ; DATA XREF: .rdata:42CFE2DC\u2191o
.rdata:42CFE64A                 db 'IsDBCSLeadByte',0
.rdata:42CFE659                 align 2
.rdata:42CFE65A word_42CFE65A   dw 1AAh                 ; DATA XREF: .rdata:42CFE2E0\u2191o
.rdata:42CFE65C                 db 'InitializeCriticalSection',0
.rdata:42CFE676 word_42CFE676   dw 2D2h                 ; DATA XREF: .rdata:42CFE2E4\u2191o
.rdata:42CFE678                 db 'WideCharToMultiByte',0
.rdata:42CFE68C aKernel32Dll    db 'KERNEL32.dll',0     ; DATA XREF: .rdata:42CFE1FC\u2191o
.rdata:42CFE699                 align 2
.rdata:42CFE69A word_42CFE69A   dw 191h                 ; DATA XREF: .rdata:42CFE298\u2191o
.rdata:42CFE69C                 db 'ReportEventA',0
.rdata:42CFE6A9                 align 2
.rdata:42CFE6AA word_42CFE6AA   dw 18Ch                 ; DATA XREF: .rdata:42CFE294\u2191o
.rdata:42CFE6AC                 db 'RegisterEventSourceA',0
.rdata:42CFE6C1                 align 2
.rdata:42CFE6C2 word_42CFE6C2   dw 79h                  ; DATA XREF: .rdata:42CFE28C\u2191o
.rdata:42CFE6C4                 db 'DeregisterEventSource',0
.rdata:42CFE6DA word_42CFE6DA   dw 15Bh                 ; DATA XREF: .rdata:42CFE288\u2191o
.rdata:42CFE6DC                 db 'RegCloseKey',0
.rdata:42CFE6E8 word_42CFE6E8   dw 17Bh                 ; DATA XREF: .rdata:42CFE290\u2191o
.rdata:42CFE6EA                 db 'RegQueryValueExA',0
.rdata:42CFE6FB                 align 4
.rdata:42CFE6FC word_42CFE6FC   dw 172h                 ; DATA XREF: .rdata:42CFE280\u2191o
.rdata:42CFE6FE                 db 'RegOpenKeyExA',0
.rdata:42CFE70C word_42CFE70C   dw 186h                 ; DATA XREF: .rdata:42CFE27C\u2191o
.rdata:42CFE70E                 db 'RegSetValueExA',0
.rdata:42CFE71D                 align 2
.rdata:42CFE71E word_42CFE71E   dw 15Fh                 ; DATA XREF: .rdata:42CFE284\u2191o
.rdata:42CFE720                 db 'RegCreateKeyExA',0
.rdata:42CFE730 word_42CFE730   dw 164h                 ; DATA XREF: .rdata:42CFE274\u2191o
.rdata:42CFE732                 db 'RegDeleteValueA',0
.rdata:42CFE742 word_42CFE742   dw 0DBh                 ; DATA XREF: .rdata:42CFE270\u2191o
.rdata:42CFE744                 db 'ImpersonateLoggedOnUser',0
.rdata:42CFE75C word_42CFE75C   dw 0DCh                 ; DATA XREF: .rdata:42CFE278\u2191o
.rdata:42CFE75E                 db 'ImpersonateNamedPipeClient',0
.rdata:42CFE779                 align 2
.rdata:42CFE77A word_42CFE77A   dw 193h                 ; DATA XREF: .rdata:42CFE26C\u2191o
.rdata:42CFE77C                 db 'RevertToSelf',0
.rdata:42CFE789                 align 2
.rdata:42CFE78A word_42CFE78A   dw 0D7h                 ; DATA XREF: .rdata:off_42CFE268\u2191o
.rdata:42CFE78C                 db 'GetUserNameA',0
.rdata:42CFE799                 align 2
.rdata:42CFE79A aAdvapi32Dll    db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:42CFE210\u2191o
.rdata:42CFE7A7                 align 4
.rdata:42CFE7A8 aWsock32Dll     db 'WSOCK32.dll',0      ; DATA XREF: .rdata:42CFE224\u2191o
.rdata:42CFE7B4 word_42CFE7B4   dw 17h                  ; DATA XREF: .rdata:42CFE3BC\u2191o
.rdata:42CFE7B6                 db 'WSAEnumProtocolsA',0
.rdata:42CFE7C8 word_42CFE7C8   dw 19h                  ; DATA XREF: .rdata:42CFE3B8\u2191o
.rdata:42CFE7CA                 db 'WSAEventSelect',0
.rdata:42CFE7D9                 align 2
.rdata:42CFE7DA word_42CFE7DA   dw 11h                  ; DATA XREF: .rdata:42CFE3A4\u2191o
.rdata:42CFE7DC                 db 'WSACreateEvent',0
.rdata:42CFE7EB                 align 4
.rdata:42CFE7EC word_42CFE7EC   dw 25h                  ; DATA XREF: .rdata:42CFE3B0\u2191o
.rdata:42CFE7EE                 db 'WSAIoctl',0
.rdata:42CFE7F7                 align 4
.rdata:42CFE7F8 word_42CFE7F8   dw 16h                  ; DATA XREF: .rdata:off_42CFE3A0\u2191o
.rdata:42CFE7FA                 db 'WSAEnumNetworkEvents',0
.rdata:42CFE80F                 align 10h
.rdata:42CFE810 word_42CFE810   dw 43h                  ; DATA XREF: .rdata:42CFE3AC\u2191o
.rdata:42CFE812                 db 'WSAWaitForMultipleEvents',0
.rdata:42CFE82B                 align 4
.rdata:42CFE82C word_42CFE82C   dw 30h                  ; DATA XREF: .rdata:42CFE3A8\u2191o
.rdata:42CFE82E                 db 'WSARecv',0
.rdata:42CFE836 word_42CFE836   dw 35h                  ; DATA XREF: .rdata:42CFE3B4\u2191o
.rdata:42CFE838                 db 'WSASend',0
.rdata:42CFE840 word_42CFE840   dw 1Bh                  ; DATA XREF: .rdata:42CFE3C0\u2191o
.rdata:42CFE842                 db 'WSAGetOverlappedResult',0
.rdata:42CFE859                 align 2
.rdata:42CFE85A aWs232Dll       db 'WS2_32.dll',0       ; DATA XREF: .rdata:42CFE238\u2191o
.rdata:42CFE865                 align 2
.rdata:42CFE866 word_42CFE866   dw 23Dh                 ; DATA XREF: .rdata:42CFE394\u2191o
.rdata:42CFE868                 db 'atoi',0
.rdata:42CFE86D                 align 2
.rdata:42CFE86E word_42CFE86E   dw 135h                 ; DATA XREF: .rdata:42CFE390\u2191o
.rdata:42CFE870                 db '_itow',0
.rdata:42CFE876 word_42CFE876   dw 2DFh                 ; DATA XREF: .rdata:42CFE398\u2191o
.rdata:42CFE878                 db 'wcscat',0
.rdata:42CFE87F                 align 10h
.rdata:42CFE880 word_42CFE880   dw 25Eh                 ; DATA XREF: .rdata:42CFE388\u2191o
.rdata:42CFE882                 db 'free',0
.rdata:42CFE887                 align 4
.rdata:42CFE888 word_42CFE888   dw 2B6h                 ; DATA XREF: .rdata:42CFE384\u2191o
.rdata:42CFE88A                 db 'strcat',0
.rdata:42CFE891                 align 2
.rdata:42CFE892 word_42CFE892   dw 299h                 ; DATA XREF: .rdata:42CFE38C\u2191o
.rdata:42CFE894                 db 'memset',0
.rdata:42CFE89B                 align 4
.rdata:42CFE89C word_42CFE89C   dw 291h                 ; DATA XREF: .rdata:42CFE370\u2191o
.rdata:42CFE89E                 db 'malloc',0
.rdata:42CFE8A5                 align 2
.rdata:42CFE8A6 word_42CFE8A6   dw 2BAh                 ; DATA XREF: .rdata:42CFE380\u2191o
.rdata:42CFE8A8                 db 'strcpy',0
.rdata:42CFE8AF                 align 10h
.rdata:42CFE8B0 word_42CFE8B0   dw 2B8h                 ; DATA XREF: .rdata:42CFE37C\u2191o
.rdata:42CFE8B2                 db 'strcmp',0
.rdata:42CFE8B9                 align 2
.rdata:42CFE8BA word_42CFE8BA   dw 2B2h                 ; DATA XREF: .rdata:42CFE378\u2191o
.rdata:42CFE8BC                 db 'sprintf',0
.rdata:42CFE8C4 word_42CFE8C4   dw 29Eh                 ; DATA XREF: .rdata:42CFE374\u2191o
.rdata:42CFE8C6                 db 'printf',0
.rdata:42CFE8CD                 align 2
.rdata:42CFE8CE word_42CFE8CE   dw 297h                 ; DATA XREF: .rdata:42CFE328\u2191o
.rdata:42CFE8D0                 db 'memcpy',0
.rdata:42CFE8D7                 align 4
.rdata:42CFE8D8 word_42CFE8D8   dw 0A0h                 ; DATA XREF: .rdata:42CFE36C\u2191o
.rdata:42CFE8DA                 db '_assert',0
.rdata:42CFE8E2 word_42CFE8E2   dw 296h                 ; DATA XREF: .rdata:42CFE368\u2191o
.rdata:42CFE8E4                 db 'memcmp',0
.rdata:42CFE8EB                 align 4
.rdata:42CFE8EC word_42CFE8EC   dw 2C7h                 ; DATA XREF: .rdata:42CFE364\u2191o
.rdata:42CFE8EE                 db 'strtok',0
.rdata:42CFE8F5                 align 2
.rdata:42CFE8F6 word_42CFE8F6   dw 240h                 ; DATA XREF: .rdata:42CFE360\u2191o
.rdata:42CFE8F8                 db 'calloc',0
.rdata:42CFE8FF                 align 10h
.rdata:42CFE900 word_42CFE900   dw 2B7h                 ; DATA XREF: .rdata:42CFE35C\u2191o
.rdata:42CFE902                 db 'strchr',0
.rdata:42CFE909                 align 2
.rdata:42CFE90A word_42CFE90A   dw 2BEh                 ; DATA XREF: .rdata:42CFE358\u2191o
.rdata:42CFE90C                 db 'strlen',0
.rdata:42CFE913                 align 4
.rdata:42CFE914 word_42CFE914   dw 2C5h                 ; DATA XREF: .rdata:42CFE354\u2191o
.rdata:42CFE916                 db 'strstr',0
.rdata:42CFE91D                 align 2
.rdata:42CFE91E word_42CFE91E   dw 2BBh                 ; DATA XREF: .rdata:42CFE350\u2191o
.rdata:42CFE920                 db 'strcspn',0
.rdata:42CFE928 word_42CFE928   dw 134h                 ; DATA XREF: .rdata:42CFE34C\u2191o
.rdata:42CFE92A                 db '_itoa',0
.rdata:42CFE930 word_42CFE930   dw 2D4h                 ; DATA XREF: .rdata:42CFE348\u2191o
.rdata:42CFE932                 db 'toupper',0
.rdata:42CFE93A word_42CFE93A   dw 2D0h                 ; DATA XREF: .rdata:42CFE344\u2191o
.rdata:42CFE93C                 db 'time',0
.rdata:42CFE941                 align 2
.rdata:42CFE942 word_42CFE942   dw 247h                 ; DATA XREF: .rdata:42CFE33C\u2191o
.rdata:42CFE944                 db 'difftime',0
.rdata:42CFE94D                 align 2
.rdata:42CFE94E word_42CFE94E   dw 1C3h                 ; DATA XREF: .rdata:42CFE338\u2191o
.rdata:42CFE950                 db '_strlwr',0
.rdata:42CFE958 word_42CFE958   dw 2E1h                 ; DATA XREF: .rdata:42CFE334\u2191o
.rdata:42CFE95A                 db 'wcscmp',0
.rdata:42CFE961                 align 2
.rdata:42CFE962 word_42CFE962   dw 2CBh                 ; DATA XREF: .rdata:42CFE330\u2191o
.rdata:42CFE964                 db 'swprintf',0
.rdata:42CFE96D                 align 2
.rdata:42CFE96E word_42CFE96E   dw 1EAh                 ; DATA XREF: .rdata:42CFE32C\u2191o
.rdata:42CFE970                 db '_wcsicmp',0
.rdata:42CFE979                 align 2
.rdata:42CFE97A aMsvcrtDll      db 'MSVCRT.dll',0       ; DATA XREF: .rdata:42CFE24C\u2191o
.rdata:42CFE985                 align 2
.rdata:42CFE986 word_42CFE986   dw 1C1h                 ; DATA XREF: .rdata:42CFE340\u2191o
.rdata:42CFE988                 db '_stricmp',0
.rdata:42CFE991                 align 2
.rdata:42CFE992 word_42CFE992   dw 1CBh                 ; DATA XREF: .rdata:off_42CFE324\u2191o
.rdata:42CFE994                 db '_strupr',0
.rdata:42CFE99C                 align 10h
.rdata:42CFE9A0 ;
.rdata:42CFE9A0 ; Export directory for SSnetlib.dll
.rdata:42CFE9A0 ;
.rdata:42CFE9A0                 dd 0                    ; Characteristics
.rdata:42CFE9A4                 dd 398D1352h            ; TimeDateStamp: Sun Aug 06 07:27:14 2000
.rdata:42CFE9A8                 dw 0                    ; MajorVersion
.rdata:42CFE9AA                 dw 0                    ; MinorVersion
.rdata:42CFE9AC                 dd rva aSsnetlibDll     ; Name
.rdata:42CFE9B0                 dd 1                    ; Base
.rdata:42CFE9B4                 dd 11h                  ; NumberOfFunctions
.rdata:42CFE9B8                 dd 11h                  ; NumberOfNames
.rdata:42CFE9BC                 dd rva off_42CFE9C8     ; AddressOfFunctions
.rdata:42CFE9C0                 dd rva off_42CFEA0C     ; AddressOfNames
.rdata:42CFE9C4                 dd rva word_42CFEA50    ; AddressOfNameOrdinals
.rdata:42CFE9C8 ;
.rdata:42CFE9C8 ; Export Address Table for SSnetlib.dll
.rdata:42CFE9C8 ;
.rdata:42CFE9C8 off_42CFE9C8    dd rva ConnectionRead, rva ConnectionWrite, rva ConnectionClose
.rdata:42CFE9C8                                         ; DATA XREF: .rdata:42CFE9BC\u2191o
.rdata:42CFE9C8                 dd rva ConnectionListen, rva ConnectionAccept, rva ConnectionPeek
.rdata:42CFE9C8                 dd rva ConnectionReadAsync, rva ConnectionReadAsyncWait
.rdata:42CFE9C8                 dd rva ConnectionVer, rva ConnectionWriteAsync, rva ConnectionWriteStatus
.rdata:42CFE9C8                 dd rva ConnectionSecureClient, rva ConnectionImpersonate
.rdata:42CFE9C8                 dd rva ConnectionRevert, rva ConnectionTermSec, rva ConnectionInitialize
.rdata:42CFE9C8                 dd rva ConnectionPreLogin
.rdata:42CFEA0C ;
.rdata:42CFEA0C ; Export Names Table for SSnetlib.dll
.rdata:42CFEA0C ;
.rdata:42CFEA0C off_42CFEA0C    dd rva aConnectionacce, rva aConnectionclos, rva aConnectionimpe
.rdata:42CFEA0C                                         ; DATA XREF: .rdata:42CFE9C0\u2191o
.rdata:42CFEA0C                 dd rva aConnectioninit, rva aConnectionlist, rva aConnectionpeek ; "ConnectionAccept" ...
.rdata:42CFEA0C                 dd rva aConnectionprel, rva aConnectionread, rva aConnectionread_0
.rdata:42CFEA0C                 dd rva aConnectionread_1, rva aConnectionreve, rva aConnectionsecu
.rdata:42CFEA0C                 dd rva aConnectionterm, rva aConnectionver, rva aConnectionwrit
.rdata:42CFEA0C                 dd rva aConnectionwrit_0, rva aConnectionwrit_1
.rdata:42CFEA50 ;
.rdata:42CFEA50 ; Export Ordinals Table for SSnetlib.dll
.rdata:42CFEA50 ;
.rdata:42CFEA50 word_42CFEA50   dw 4, 2, 0Ch, 0Fh, 3, 5, 10h, 0, 6, 7, 0Dh, 0Bh, 0Eh, 8
.rdata:42CFEA50                                         ; DATA XREF: .rdata:42CFE9C4\u2191o
.rdata:42CFEA50                 dw 1, 9, 0Ah
.rdata:42CFEA72 aSsnetlibDll    db 'SSnetlib.dll',0     ; DATA XREF: .rdata:42CFE9AC\u2191o
.rdata:42CFEA7F aConnectionacce db 'ConnectionAccept',0 ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEA90 aConnectionclos db 'ConnectionClose',0  ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEAA0 aConnectionimpe db 'ConnectionImpersonate',0
.rdata:42CFEAA0                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEAB6 aConnectioninit db 'ConnectionInitialize',0
.rdata:42CFEAB6                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEACB aConnectionlist db 'ConnectionListen',0 ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEADC aConnectionpeek db 'ConnectionPeek',0   ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEAEB aConnectionprel db 'ConnectionPreLogin',0
.rdata:42CFEAEB                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEAFE aConnectionread db 'ConnectionRead',0   ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB0D aConnectionread_0 db 'ConnectionReadAsync',0
.rdata:42CFEB0D                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB21 aConnectionread_1 db 'ConnectionReadAsyncWait',0
.rdata:42CFEB21                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB39 aConnectionreve db 'ConnectionRevert',0 ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB4A aConnectionsecu db 'ConnectionSecureClient',0
.rdata:42CFEB4A                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB61 aConnectionterm db 'ConnectionTermSec',0
.rdata:42CFEB61                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB73 aConnectionver  db 'ConnectionVer',0    ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB81 aConnectionwrit db 'ConnectionWrite',0  ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEB91 aConnectionwrit_0 db 'ConnectionWriteAsync',0
.rdata:42CFEB91                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEBA6 aConnectionwrit_1 db 'ConnectionWriteStatus',0
.rdata:42CFEBA6                                         ; DATA XREF: .rdata:off_42CFEA0C\u2191o
.rdata:42CFEBBC                 align 800h
.rdata:42CFEBBC _rdata          ends
.rdata:42CFEBBC
.data:42CFF000 ; Section 3. (virtual address 0000F000)
.data:42CFF000 ; Virtual size                  : 00003104 (  12548.)
.data:42CFF000 ; Section size in file          : 00003000 (  12288.)
.data:42CFF000 ; Offset to raw data for section: 0000F000
.data:42CFF000 ; Flags C0000040: Data Readable Writable
.data:42CFF000 ; Alignment     : default
.data:42CFF000 ; ===========================================================================
.data:42CFF000
.data:42CFF000 ; Segment type: Pure data
.data:42CFF000 ; Segment permissions: Read/Write
.data:42CFF000 _data           segment para public 'DATA' use32
.data:42CFF000                 assume cs:_data
.data:42CFF000                 ;org 42CFF000h
.data:42CFF000                 db 0FFh ; ÿ
.data:42CFF001                 db 0FFh ; ÿ
.data:42CFF002                 db 0FFh ; ÿ
.data:42CFF003                 db 0FFh ; ÿ
.data:42CFF004 ; DWORD nSize
.data:42CFF004 nSize           dd 0FFh                 ; DATA XREF: ConnectionListen+94\u2191o
.data:42CFF008 unk_42CFF008    db 0A1h ; ¡             ; DATA XREF: sub_42CF78D0+5\u2191o
.data:42CFF009                 db 0E6h ; æ
.data:42CFF00A                 db 0ACh ; ¬
.data:42CFF00B                 db 0ADh ; ­
.data:42CFF00C                 db 0B1h ; ±
.data:42CFF00D                 db  3Bh ; ;
.data:42CFF00E                 db 0D0h ; Ð
.data:42CFF00F                 db  11h
.data:42CFF010                 db 0A7h ; §
.data:42CFF011                 db 0CAh ; Ê
.data:42CFF012                 db    0
.data:42CFF013                 db 0A0h ;  
.data:42CFF014                 db  24h ; $
.data:42CFF015                 db  8Eh ; Ž
.data:42CFF016                 db  63h ; c
.data:42CFF017                 db  1Bh
.data:42CFF018 unk_42CFF018    db 0E0h ; à             ; DATA XREF: sub_42CF7900+5\u2191o
.data:42CFF019                 db 0A9h ; ©
.data:42CFF01A                 db  60h ; `
.data:42CFF01B                 db  9Dh
.data:42CFF01C                 db  7Ah ; z
.data:42CFF01D                 db  33h ; 3
.data:42CFF01E                 db 0D0h ; Ð
.data:42CFF01F                 db  11h
.data:42CFF020                 db 0BDh ; ½
.data:42CFF021                 db  88h ; ˆ
.data:42CFF022                 db    0
.data:42CFF023                 db    0
.data:42CFF024                 db 0C0h ; À
.data:42CFF025                 db  82h ; ‚
.data:42CFF026                 db 0E6h ; æ
.data:42CFF027                 db  9Ah ; š
.data:42CFF028 ; CHAR Name[]
.data:42CFF028 Name            db 'CONCURRENT',0       ; DATA XREF: DllEntryPoint+93\u2191o
.data:42CFF033                 align 4
.data:42CFF034 ; char String2[]
.data:42CFF034 String2         db 'MSSQLServer',0      ; DATA XREF: ConnectionListen+D1\u2191o
.data:42CFF040 ; char Source[]
.data:42CFF040 Source          db 'MSSQLServer',0      ; DATA XREF: ConnectionListen:loc_42CF12D7\u2191o
.data:42CFF04C ; char aMssqlserver_1[]
.data:42CFF04C aMssqlserver_1  db 'MSSQLServer',0      ; DATA XREF: ConnectionListen+1A1\u2191o
.data:42CFF058 dword_42CFF058  dd 5153534Dh            ; DATA XREF: ConnectionListen:loc_42CF13BC\u2191r
.data:42CFF05C word_42CFF05C   dw 244Ch                ; DATA XREF: ConnectionListen+1D8\u2191r
.data:42CFF05E byte_42CFF05E   db 0                    ; DATA XREF: ConnectionListen+1E6\u2191r
.data:42CFF05F                 align 10h
.data:42CFF060 unk_42CFF060    db  53h ; S             ; DATA XREF: ConnectionListen+249\u2191o
.data:42CFF061                 db  70h ; p
.data:42CFF062                 db  78h ; x
.data:42CFF063                 db    0
.data:42CFF064 aClustered      db 'Clustered',0        ; DATA XREF: ConnectionListen+24E\u2191o
.data:42CFF06E                 align 10h
.data:42CFF070 aAdsp           db 'Adsp',0             ; DATA XREF: ConnectionListen+26E\u2191o
.data:42CFF075                 align 4
.data:42CFF078 aClustered_0    db 'Clustered',0        ; DATA XREF: ConnectionListen+273\u2191o
.data:42CFF082                 align 4
.data:42CFF084 aWsproxy        db 'WsProxy',0          ; DATA XREF: ConnectionListen+293\u2191o
.data:42CFF08C aClustered_1    db 'Clustered',0        ; DATA XREF: ConnectionListen+298\u2191o
.data:42CFF096                 align 4
.data:42CFF098 aRpc            db 'Rpc',0              ; DATA XREF: ConnectionListen+2B8\u2191o
.data:42CFF09C aClustered_2    db 'Clustered',0        ; DATA XREF: ConnectionListen+2BD\u2191o
.data:42CFF0A6                 align 4
.data:42CFF0A8 aBanyanVines    db 'Banyan Vines',0     ; DATA XREF: ConnectionListen+2DD\u2191o
.data:42CFF0B5                 align 4
.data:42CFF0B8 aClustered_3    db 'Clustered',0        ; DATA XREF: ConnectionListen+2E2\u2191o
.data:42CFF0C2                 align 4
.data:42CFF0C4 ; char aMssqlserver_2[]
.data:42CFF0C4 aMssqlserver_2  db 'MSSQLServer',0      ; DATA XREF: ConnectionListen:loc_42CF14DF\u2191o
.data:42CFF0D0 aAdsp_0         db 'Adsp',0             ; DATA XREF: ConnectionListen+31D\u2191o
.data:42CFF0D5                 align 4
.data:42CFF0D8 aNonDefaultInst db 'Non-Default Instance',0
.data:42CFF0D8                                         ; DATA XREF: ConnectionListen+322\u2191o
.data:42CFF0ED                 align 10h
.data:42CFF0F0 aWsproxy_0      db 'WsProxy',0          ; DATA XREF: ConnectionListen+342\u2191o
.data:42CFF0F8 aNonDefault     db 'Non-Default',0      ; DATA XREF: ConnectionListen+347\u2191o
.data:42CFF104 aRpc_0          db 'Rpc',0              ; DATA XREF: ConnectionListen+367\u2191o
.data:42CFF108 aNonDefault_0   db 'Non-Default',0      ; DATA XREF: ConnectionListen+36C\u2191o
.data:42CFF114 aBanyanVines_0  db 'Banyan Vines',0     ; DATA XREF: ConnectionListen+38C\u2191o
.data:42CFF121                 align 4
.data:42CFF124 aNonDefault_1   db 'Non-Default',0      ; DATA XREF: ConnectionListen+391\u2191o
.data:42CFF130 aWsproxy_1      db 'WSProxy',0          ; DATA XREF: ConnectionListen+707\u2191o
.data:42CFF138 ; wchar_t aWinsockProxy
.data:42CFF138 aWinsockProxy:                          ; DATA XREF: ConnectionListen:loc_42CF1925\u2191o
.data:42CFF138                 text "UTF-16LE", ', Winsock Proxy',0
.data:42CFF158 aGethostbyname  db 'gethostbyname',0    ; DATA XREF: ConnectionListen+821\u2191o
.data:42CFF166                 align 4
.data:42CFF168 ; char cp[]
.data:42CFF168 cp              db '127.0.0.1',0        ; DATA XREF: ConnectionListen+8FF\u2191o
.data:42CFF172                 align 4
.data:42CFF174 ; char a127001_0[]
.data:42CFF174 a127001_0       db '127.0.0.1',0        ; DATA XREF: ConnectionListen+94C\u2191o
.data:42CFF17E                 align 10h
.data:42CFF180 aSocket         db 'Socket',0           ; DATA XREF: ConnectionListen+A1E\u2191o
.data:42CFF187                 align 4
.data:42CFF188 aFilladdress    db 'FillAddress',0      ; DATA XREF: ConnectionListen+A97\u2191o
.data:42CFF194 aSoExclusiveadd db 'SO_EXCLUSIVEADDRUSE',0
.data:42CFF194                                         ; DATA XREF: ConnectionListen+B14\u2191o
.data:42CFF1A8 aBind           db 'Bind',0             ; DATA XREF: ConnectionListen+B91\u2191o
.data:42CFF1AD                 align 10h
.data:42CFF1B0 aFailedToGetExc db 'Failed to get Exclusive port use',0
.data:42CFF1B0                                         ; DATA XREF: ConnectionListen+BB7\u2191o
.data:42CFF1D1                 align 4
.data:42CFF1D4 aBindPortInUse  db 'Bind - Port in use',0
.data:42CFF1D4                                         ; DATA XREF: ConnectionListen:loc_42CF1EB3\u2191o
.data:42CFF1E7                 align 4
.data:42CFF1E8 aListen         db 'Listen',0           ; DATA XREF: ConnectionListen:loc_42CF2038\u2191o
.data:42CFF1EF                 align 10h
.data:42CFF1F0 ; wchar_t aTcp
.data:42CFF1F0 aTcp:                                   ; DATA XREF: ConnectionListen+F24\u2191o
.data:42CFF1F0                 text "UTF-16LE", ', TCP',0
.data:42CFF1FC aUpdatetcpport  db 'UpdateTcpPort',0    ; DATA XREF: ConnectionListen+F58\u2191o
.data:42CFF20A                 align 4
.data:42CFF20C aAdvertisespx   db 'AdvertiseSPX',0     ; DATA XREF: ConnectionListen+FC0\u2191o
.data:42CFF219                 align 4
.data:42CFF21C ; wchar_t aSpx
.data:42CFF21C aSpx:                                   ; DATA XREF: ConnectionListen+1038\u2191o
.data:42CFF21C                 text "UTF-16LE", ', Spx',0
.data:42CFF228 aStartssrp      db 'StartSsrp',0        ; DATA XREF: ConnectionListen+1099\u2191o
.data:42CFF232                 align 4
.data:42CFF234 aSpnregister    db 'SpnRegister',0      ; DATA XREF: ConnectionListen+112F\u2191o
.data:42CFF240 ; char Format[]
.data:42CFF240 Format          db 'Error SIO_KEEPALIVE_VALS: %d',0Ah,0
.data:42CFF240                                         ; DATA XREF: sub_42CF2BC5+361\u2191o
.data:42CFF25E                 align 10h
.data:42CFF260 aSpnunregister  db 'SpnUnRegister',0    ; DATA XREF: ConnectionClose+E7\u2191o
.data:42CFF26E                 align 10h
.data:42CFF270 aConnectionclos_0 db 'ConnectionClose',0
.data:42CFF270                                         ; DATA XREF: ConnectionClose+1BA\u2191o
.data:42CFF280 aTcpClosesocket db 'TCP: closesocket()',0
.data:42CFF280                                         ; DATA XREF: ConnectionClose+1BF\u2191o
.data:42CFF293                 align 4
.data:42CFF294 aConnectionclos_1 db 'ConnectionClose',0
.data:42CFF294                                         ; DATA XREF: ConnectionClose+1FF\u2191o
.data:42CFF2A4 aWinsockProxyCl db 'Winsock Proxy: closesocket()',0
.data:42CFF2A4                                         ; DATA XREF: ConnectionClose+204\u2191o
.data:42CFF2C1                 align 4
.data:42CFF2C4 aSecdecryptdata db 'SECDecryptData',0   ; DATA XREF: ConnectionRead:loc_42CF3BD2\u2191o
.data:42CFF2D3                 align 4
.data:42CFF2D4 aQSphinxNetlibs db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF2D4                                         ; DATA XREF: ConnectionReadAsync+2B\u2191o
.data:42CFF2FE                 align 10h
.data:42CFF300 aFalsePconnecti db 'FALSE == pConnectionObject->fReadFlag',0
.data:42CFF300                                         ; DATA XREF: ConnectionReadAsync+30\u2191o
.data:42CFF326                 align 4
.data:42CFF328 aQSphinxNetlibs_0 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF328                                         ; DATA XREF: ConnectionReadAsync+3FA\u2191o
.data:42CFF352                 align 4
.data:42CFF354 aCref0          db 'cRef > 0',0         ; DATA XREF: ConnectionReadAsync+3FF\u2191o
.data:42CFF35D                 align 10h
.data:42CFF360 aQSphinxNetlibs_1 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF360                                         ; DATA XREF: ConnectionReadAsyncWait+90\u2191o
.data:42CFF38A                 align 4
.data:42CFF38C aTruePconnectio db 'TRUE == pConnectionObject->fReadFlag',0
.data:42CFF38C                                         ; DATA XREF: ConnectionReadAsyncWait+95\u2191o
.data:42CFF3B1                 align 4
.data:42CFF3B4 aQSphinxNetlibs_2 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF3B4                                         ; DATA XREF: ConnectionReadAsyncWait+168\u2191o
.data:42CFF3DE                 align 10h
.data:42CFF3E0 aTruePconnectio_0 db 'TRUE == pConnectionObject->fReadFlag',0
.data:42CFF3E0                                         ; DATA XREF: ConnectionReadAsyncWait+16D\u2191o
.data:42CFF405                 align 4
.data:42CFF408 aQSphinxNetlibs_3 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF408                                         ; DATA XREF: ConnectionReadAsyncWait+1CC\u2191o
.data:42CFF432                 align 4
.data:42CFF434 aTruePconnectio_1 db 'TRUE == pConnectionObject->fReadFlag',0
.data:42CFF434                                         ; DATA XREF: ConnectionReadAsyncWait+1D1\u2191o
.data:42CFF459                 align 4
.data:42CFF45C aSecdecryptdata_0 db 'SECDecryptData',0 ; DATA XREF: ConnectionReadAsyncWait:loc_42CF43BB\u2191o
.data:42CFF46B                 align 4
.data:42CFF46C aQSphinxNetlibs_4 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF46C                                         ; DATA XREF: ConnectionWrite+70\u2191o
.data:42CFF496                 align 4
.data:42CFF498 aPconnectionobj db 'pConnectionObject->pEncryptBuffer != NULL',0
.data:42CFF498                                         ; DATA XREF: ConnectionWrite+75\u2191o
.data:42CFF4C2                 align 4
.data:42CFF4C4 aQSphinxNetlibs_5 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF4C4                                         ; DATA XREF: ConnectionWrite+93\u2191o
.data:42CFF4EE                 align 10h
.data:42CFF4F0 aPconnectionobj_0 db 'pConnectionObject->dwMaxEncryptBufSize >= dwWriteCount',0
.data:42CFF4F0                                         ; DATA XREF: ConnectionWrite+98\u2191o
.data:42CFF527                 align 4
.data:42CFF528 aSecencryptdata db 'SECEncryptData',0   ; DATA XREF: ConnectionWrite+11F\u2191o
.data:42CFF537                 align 4
.data:42CFF538 aQSphinxNetlibs_6 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF538                                         ; DATA XREF: ConnectionWriteAsync+70\u2191o
.data:42CFF562                 align 4
.data:42CFF564 aPconnectionobj_1 db 'pConnectionObject->pEncryptBuffer != NULL',0
.data:42CFF564                                         ; DATA XREF: ConnectionWriteAsync+75\u2191o
.data:42CFF58E                 align 10h
.data:42CFF590 aQSphinxNetlibs_7 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF590                                         ; DATA XREF: ConnectionWriteAsync+93\u2191o
.data:42CFF5BA                 align 4
.data:42CFF5BC aPconnectionobj_2 db 'pConnectionObject->dwMaxEncryptBufSize >= dwWriteCount',0
.data:42CFF5BC                                         ; DATA XREF: ConnectionWriteAsync+98\u2191o
.data:42CFF5F3                 align 4
.data:42CFF5F4 aSecencryptdata_0 db 'SECEncryptData',0 ; DATA XREF: ConnectionWriteAsync+11F\u2191o
.data:42CFF603                 align 4
.data:42CFF604 aQSphinxNetlibs_8 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFF604                                         ; DATA XREF: ConnectionSecureClient+99\u2191o
.data:42CFF62E                 align 10h
.data:42CFF630 aPconnobjPas    db 'pConnObj->pAS',0    ; DATA XREF: ConnectionSecureClient+9E\u2191o
.data:42CFF63E                 align 10h
.data:42CFF640 aAdvertiseservi db 'AdvertiseService: Tcp - CreateThread',0
.data:42CFF640                                         ; DATA XREF: sub_42CF508D+89\u2191o
.data:42CFF665                 align 4
.data:42CFF668 aConnectionread_6 db 'ConnectionRead',0
.data:42CFF677                 align 4
.data:42CFF678 aConnectionread_2 db 'ConnectionRead',0 ; DATA XREF: sub_42CF5128+6\u2191o
.data:42CFF687                 align 4
.data:42CFF688 aConnectionwrit_8 db 'ConnectionWrite',0
.data:42CFF698 aConnectionwrit_2 db 'ConnectionWrite',0
.data:42CFF698                                         ; DATA XREF: sub_42CF5128+D\u2191o
.data:42CFF6A8 aConnectionclos_4 db 'ConnectionClose',0
.data:42CFF6B8 aConnectionclos_2 db 'ConnectionClose',0
.data:42CFF6B8                                         ; DATA XREF: sub_42CF5128+14\u2191o
.data:42CFF6C8 aConnectionlist_9 db 'ConnectionListen',0
.data:42CFF6D9                 align 4
.data:42CFF6DC aConnectionlist_0 db 'ConnectionListen',0
.data:42CFF6DC                                         ; DATA XREF: sub_42CF5128+1B\u2191o
.data:42CFF6ED                 align 10h
.data:42CFF6F0 aConnectionacce_2 db 'ConnectionAccept',0
.data:42CFF701                 align 4
.data:42CFF704 aConnectionacce_0 db 'ConnectionAccept',0
.data:42CFF704                                         ; DATA XREF: sub_42CF5128+22\u2191o
.data:42CFF715                 align 4
.data:42CFF718 aConnectionpeek_2 db 'ConnectionPeek',0
.data:42CFF727                 align 4
.data:42CFF728 aConnectionpeek_0 db 'ConnectionPeek',0 ; DATA XREF: sub_42CF5128+29\u2191o
.data:42CFF737                 align 4
.data:42CFF738 aConnectionread_7 db 'ConnectionReadAsync',0
.data:42CFF74C aConnectionread_3 db 'ConnectionReadAsync',0
.data:42CFF74C                                         ; DATA XREF: sub_42CF5128+30\u2191o
.data:42CFF760 aConnectionver_2 db 'ConnectionVer',0
.data:42CFF76E                 align 10h
.data:42CFF770 aConnectionver_0 db 'ConnectionVer',0   ; DATA XREF: sub_42CF5128+37\u2191o
.data:42CFF77E                 align 10h
.data:42CFF780 aConnectionwrit_9 db 'ConnectionWriteAsync',0
.data:42CFF795                 align 4
.data:42CFF798 aConnectionwrit_3 db 'ConnectionWriteAsync',0
.data:42CFF798                                         ; DATA XREF: sub_42CF5128+3E\u2191o
.data:42CFF7AD                 align 10h
.data:42CFF7B0 aConnectionwrit_10 db 'ConnectionWriteStatus',0
.data:42CFF7C6                 align 4
.data:42CFF7C8 aConnectionwrit_4 db 'ConnectionWriteStatus',0
.data:42CFF7C8                                         ; DATA XREF: sub_42CF5128+45\u2191o
.data:42CFF7DE                 align 10h
.data:42CFF7E0 aConnectionobje_1 db 'ConnectionObjectSize',0
.data:42CFF7F5                 align 4
.data:42CFF7F8 aConnectionobje db 'ConnectionObjectSize',0
.data:42CFF7F8                                         ; DATA XREF: sub_42CF5128+4C\u2191o
.data:42CFF80D                 align 10h
.data:42CFF810 aConnectioninit_2 db 'ConnectionInitAsync',0
.data:42CFF824 aConnectioninit_0 db 'ConnectionInitAsync',0
.data:42CFF824                                         ; DATA XREF: sub_42CF5128+53\u2191o
.data:42CFF838 ; CHAR LibFileName[]
.data:42CFF838 LibFileName     db 'SSmsLPCn.dll',0     ; DATA XREF: sub_42CF5128+6A\u2191o
.data:42CFF845                 align 4
.data:42CFF848 ; CHAR aSsmssh70Dll[]
.data:42CFF848 aSsmssh70Dll    db 'SSmsSH70.dll',0     ; DATA XREF: sub_42CF5128:loc_42CF51A4\u2191o
.data:42CFF855                 align 4
.data:42CFF858 aLoadnetlibs    db 'LoadNetlibs',0      ; DATA XREF: sub_42CF5128+101\u2191o
.data:42CFF864 aSharedMemoryLp db 'Shared-Memory (LPC)',0
.data:42CFF864                                         ; DATA XREF: sub_42CF5128+106\u2191o
.data:42CFF878 ; CHAR aSsnmpn70Dll[]
.data:42CFF878 aSsnmpn70Dll    db 'SSnmPN70.dll',0     ; DATA XREF: sub_42CF5128+12A\u2191o
.data:42CFF885                 align 4
.data:42CFF888 aLoadnetlibs_0  db 'LoadNetlibs',0      ; DATA XREF: sub_42CF5128+1B1\u2191o
.data:42CFF894 aNamedPipes     db 'Named Pipes',0      ; DATA XREF: sub_42CF5128+1B6\u2191o
.data:42CFF8A0 ; CHAR aSsmsad70Dll[]
.data:42CFF8A0 aSsmsad70Dll    db 'SSmsAD70.dll',0     ; DATA XREF: sub_42CF5128+1D9\u2191o
.data:42CFF8AD                 align 10h
.data:42CFF8B0 aLoadnetlibs_1  db 'LoadNetlibs',0      ; DATA XREF: sub_42CF5128+25F\u2191o
.data:42CFF8BC aAdsp_1         db 'Adsp',0             ; DATA XREF: sub_42CF5128+264\u2191o
.data:42CFF8C1                 align 4
.data:42CFF8C4 ; CHAR aSsmsrp70Dll[]
.data:42CFF8C4 aSsmsrp70Dll    db 'SSmsRP70.dll',0     ; DATA XREF: sub_42CF5128+288\u2191o
.data:42CFF8D1                 align 4
.data:42CFF8D4 aLoadnetlibs_2  db 'LoadNetlibs',0      ; DATA XREF: sub_42CF5128+30F\u2191o
.data:42CFF8E0 aRpc_1          db 'Rpc',0              ; DATA XREF: sub_42CF5128+314\u2191o
.data:42CFF8E4 ; CHAR aSsmsvi70Dll[]
.data:42CFF8E4 aSsmsvi70Dll    db 'SSmsVI70.dll',0     ; DATA XREF: sub_42CF5128+337\u2191o
.data:42CFF8F1                 align 4
.data:42CFF8F4 aLoadnetlibs_3  db 'LoadNetlibs',0      ; DATA XREF: sub_42CF5128+3BD\u2191o
.data:42CFF900 aBanyanVines_1  db 'Banyan Vines',0     ; DATA XREF: sub_42CF5128+3C2\u2191o
.data:42CFF90D                 align 10h
.data:42CFF910 ; char aGiganet[]
.data:42CFF910 aGiganet        db 'GigaNet',0          ; DATA XREF: sub_42CF5128+3E6\u2191o
.data:42CFF918 ; CHAR aSsmsgnetDll[]
.data:42CFF918 aSsmsgnetDll    db 'SSmsGNet.dll',0     ; DATA XREF: sub_42CF5128+402\u2191o
.data:42CFF925                 align 4
.data:42CFF928 ; char aServernetIi[]
.data:42CFF928 aServernetIi    db 'ServerNet II',0     ; DATA XREF: sub_42CF5128:loc_42CF553C\u2191o
.data:42CFF935                 align 4
.data:42CFF938 ; CHAR aSsmssnetDll[]
.data:42CFF938 aSsmssnetDll    db 'SSmsSNet.dll',0     ; DATA XREF: sub_42CF5128+430\u2191o
.data:42CFF945                 align 4
.data:42CFF948 aLoadnetlibs_4  db 'LoadNetlibs',0      ; DATA XREF: sub_42CF5128+4B5\u2191o
.data:42CFF954 aVia            db 'Via',0              ; DATA XREF: sub_42CF5128+4BA\u2191o
.data:42CFF958 aConnectionread_8 db 'ConnectionRead',0
.data:42CFF967                 align 4
.data:42CFF968 aConnectionread_4 db 'ConnectionRead',0 ; DATA XREF: .text:42CF5607\u2191o
.data:42CFF977                 align 4
.data:42CFF978 aConnectionwrit_11 db 'ConnectionWrite',0
.data:42CFF988 aConnectionwrit_5 db 'ConnectionWrite',0
.data:42CFF988                                         ; DATA XREF: .text:42CF560E\u2191o
.data:42CFF998 aConnectionclos_5 db 'ConnectionClose',0
.data:42CFF9A8 aConnectionclos_3 db 'ConnectionClose',0
.data:42CFF9A8                                         ; DATA XREF: .text:42CF5615\u2191o
.data:42CFF9B8 aConnectionlist_10 db 'ConnectionListen',0
.data:42CFF9C9                 align 4
.data:42CFF9CC aConnectionlist_1 db 'ConnectionListen',0
.data:42CFF9CC                                         ; DATA XREF: .text:42CF561C\u2191o
.data:42CFF9DD                 align 10h
.data:42CFF9E0 aConnectionacce_3 db 'ConnectionAccept',0
.data:42CFF9F1                 align 4
.data:42CFF9F4 aConnectionacce_1 db 'ConnectionAccept',0
.data:42CFF9F4                                         ; DATA XREF: .text:42CF5623\u2191o
.data:42CFFA05                 align 4
.data:42CFFA08 aConnectionpeek_3 db 'ConnectionPeek',0
.data:42CFFA17                 align 4
.data:42CFFA18 aConnectionpeek_1 db 'ConnectionPeek',0 ; DATA XREF: .text:42CF562A\u2191o
.data:42CFFA27                 align 4
.data:42CFFA28 aConnectionread_9 db 'ConnectionReadAsync',0
.data:42CFFA3C aConnectionread_5 db 'ConnectionReadAsync',0
.data:42CFFA3C                                         ; DATA XREF: .text:42CF5631\u2191o
.data:42CFFA50 aConnectionver_3 db 'ConnectionVer',0
.data:42CFFA5E                 align 10h
.data:42CFFA60 aConnectionver_1 db 'ConnectionVer',0   ; DATA XREF: .text:42CF5638\u2191o
.data:42CFFA6E                 align 10h
.data:42CFFA70 aConnectionwrit_12 db 'ConnectionWriteAsync',0
.data:42CFFA85                 align 4
.data:42CFFA88 aConnectionwrit_6 db 'ConnectionWriteAsync',0
.data:42CFFA88                                         ; DATA XREF: .text:42CF563F\u2191o
.data:42CFFA9D                 align 10h
.data:42CFFAA0 aConnectionwrit_13 db 'ConnectionWriteStatus',0
.data:42CFFAB6                 align 4
.data:42CFFAB8 aConnectionwrit_7 db 'ConnectionWriteStatus',0
.data:42CFFAB8                                         ; DATA XREF: .text:42CF5646\u2191o
.data:42CFFACE                 align 10h
.data:42CFFAD0 aConnectionobje_2 db 'ConnectionObjectSize',0
.data:42CFFAE5                 align 4
.data:42CFFAE8 aConnectionobje_0 db 'ConnectionObjectSize',0
.data:42CFFAE8                                         ; DATA XREF: .text:42CF564D\u2191o
.data:42CFFAFD                 align 10h
.data:42CFFB00 aConnectioninit_3 db 'ConnectionInitAsync',0
.data:42CFFB14 aConnectioninit_1 db 'ConnectionInitAsync',0
.data:42CFFB14                                         ; DATA XREF: .text:42CF5654\u2191o
.data:42CFFB28 aLoadnetlibs_5  db 'LoadNetlibs',0      ; DATA XREF: .text:42CF56E2\u2191o
.data:42CFFB34 ; char aSSErrorD[]
.data:42CFFB34 aSSErrorD       db '%s(%s) : Error %d',0
.data:42CFFB34                                         ; DATA XREF: sub_42CF56FE+15\u2191o
.data:42CFFB46                 align 4
.data:42CFFB48 aQSphinxNetlibs_9 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFB48                                         ; DATA XREF: sub_42CF5769+3B\u2191o
.data:42CFFB72                 align 4
.data:42CFFB74 aLpcstructPlist db 'lpcStruct.pListenConnObject != NULL',0
.data:42CFFB74                                         ; DATA XREF: sub_42CF5769+40\u2191o
.data:42CFFB98 ; wchar_t aSharedMemory
.data:42CFFB98 aSharedMemory:                          ; DATA XREF: sub_42CF5769+97\u2191o
.data:42CFFB98                 text "UTF-16LE", ', Shared Memory',0
.data:42CFFBB8 aConnectionlist_2 db 'ConnectionListen',0
.data:42CFFBB8                                         ; DATA XREF: sub_42CF5769+D7\u2191o
.data:42CFFBC9                 align 4
.data:42CFFBCC aSharedMemoryLp_0 db 'Shared-Memory (LPC)',0
.data:42CFFBCC                                         ; DATA XREF: sub_42CF5769+DC\u2191o
.data:42CFFBE0 aQSphinxNetlibs_10 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFBE0                                         ; DATA XREF: sub_42CF5769+11D\u2191o
.data:42CFFC0A                 align 4
.data:42CFFC0C aNpstructPliste db 'npStruct.pListenConnObject != NULL',0
.data:42CFFC0C                                         ; DATA XREF: sub_42CF5769+122\u2191o
.data:42CFFC2F                 align 10h
.data:42CFFC30 ; wchar_t aNamedPipes_0
.data:42CFFC30 aNamedPipes_0:                          ; DATA XREF: sub_42CF5769+17F\u2191o
.data:42CFFC30                 text "UTF-16LE", ', Named Pipes',0
.data:42CFFC4C aConnectionlist_3 db 'ConnectionListen',0
.data:42CFFC4C                                         ; DATA XREF: sub_42CF5769+1BE\u2191o
.data:42CFFC5D                 align 10h
.data:42CFFC60 aNamedPipes_1   db 'Named Pipes',0      ; DATA XREF: sub_42CF5769+1C3\u2191o
.data:42CFFC6C aQSphinxNetlibs_11 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFC6C                                         ; DATA XREF: sub_42CF5769+204\u2191o
.data:42CFFC96                 align 4
.data:42CFFC98 aAdspstructPlis db 'adspStruct.pListenConnObject != NULL',0
.data:42CFFC98                                         ; DATA XREF: sub_42CF5769+209\u2191o
.data:42CFFCBD                 align 10h
.data:42CFFCC0 ; wchar_t aAdsp_2
.data:42CFFCC0 aAdsp_2:                                ; DATA XREF: sub_42CF5769+266\u2191o
.data:42CFFCC0                 text "UTF-16LE", ', Adsp',0
.data:42CFFCCE                 align 10h
.data:42CFFCD0 aConnectionlist_4 db 'ConnectionListen',0
.data:42CFFCD0                                         ; DATA XREF: sub_42CF5769+2A6\u2191o
.data:42CFFCE1                 align 4
.data:42CFFCE4 aAdsp_3         db 'Adsp',0             ; DATA XREF: sub_42CF5769+2AB\u2191o
.data:42CFFCE9                 align 4
.data:42CFFCEC aQSphinxNetlibs_12 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFCEC                                         ; DATA XREF: sub_42CF5769+2EC\u2191o
.data:42CFFD16                 align 4
.data:42CFFD18 aRpcstructPlist db 'rpcStruct.pListenConnObject != NULL',0
.data:42CFFD18                                         ; DATA XREF: sub_42CF5769+2F1\u2191o
.data:42CFFD3C ; wchar_t aRpc_2
.data:42CFFD3C aRpc_2:                                 ; DATA XREF: sub_42CF5769+34A\u2191o
.data:42CFFD3C                 text "UTF-16LE", ', Rpc',0
.data:42CFFD48 aConnectionlist_5 db 'ConnectionListen',0
.data:42CFFD48                                         ; DATA XREF: sub_42CF5769+38A\u2191o
.data:42CFFD59                 align 4
.data:42CFFD5C aRpc_3          db 'Rpc',0              ; DATA XREF: sub_42CF5769+38F\u2191o
.data:42CFFD60 aQSphinxNetlibs_13 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFD60                                         ; DATA XREF: sub_42CF5769+3D0\u2191o
.data:42CFFD8A                 align 4
.data:42CFFD8C aBvstructPliste db 'bvStruct.pListenConnObject != NULL',0
.data:42CFFD8C                                         ; DATA XREF: sub_42CF5769+3D5\u2191o
.data:42CFFDAF                 align 10h
.data:42CFFDB0 ; wchar_t aBanyanVines_2
.data:42CFFDB0 aBanyanVines_2:                         ; DATA XREF: sub_42CF5769+431\u2191o
.data:42CFFDB0                 text "UTF-16LE", ', Banyan Vines',0
.data:42CFFDCE                 align 10h
.data:42CFFDD0 aConnectionlist_6 db 'ConnectionListen',0
.data:42CFFDD0                                         ; DATA XREF: sub_42CF5769+471\u2191o
.data:42CFFDE1                 align 4
.data:42CFFDE4 aBanyanVines_3  db 'Banyan Vines',0     ; DATA XREF: sub_42CF5769+476\u2191o
.data:42CFFDF1                 align 4
.data:42CFFDF4 aQSphinxNetlibs_14 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFDF4                                         ; DATA XREF: sub_42CF5769+4B7\u2191o
.data:42CFFE1E                 align 10h
.data:42CFFE20 aViastructPlist db 'viaStruct.pListenConnObject != NULL',0
.data:42CFFE20                                         ; DATA XREF: sub_42CF5769+4BC\u2191o
.data:42CFFE44 ; wchar_t aVia_0
.data:42CFFE44 aVia_0:                                 ; DATA XREF: sub_42CF5769+519\u2191o
.data:42CFFE44                 text "UTF-16LE", ', Via',0
.data:42CFFE50 aConnectionlist_7 db 'ConnectionListen',0
.data:42CFFE50                                         ; DATA XREF: sub_42CF5769+558\u2191o
.data:42CFFE61                 align 4
.data:42CFFE64 aVia_1          db 'Via',0              ; DATA XREF: sub_42CF5769+55D\u2191o
.data:42CFFE68 aQSphinxNetlibs_15 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFE68                                         ; DATA XREF: .text:42CF5D03\u2191o
.data:42CFFE92                 align 4
.data:42CFFE94 aPnlPlistenconn db 'pNl->pListenConnObject != NULL',0
.data:42CFFE94                                         ; DATA XREF: .text:42CF5D08\u2191o
.data:42CFFEB3                 align 4
.data:42CFFEB4 aConnectionlist_8 db 'ConnectionListen',0
.data:42CFFEB4                                         ; DATA XREF: .text:42CF5D7F\u2191o
.data:42CFFEC5                 align 4
.data:42CFFEC8 ; char Delimiter[]
.data:42CFFEC8 Delimiter       db ',',0                ; DATA XREF: sub_42CF67F5+6\u2191o
.data:42CFFECA                 align 4
.data:42CFFECC aGethostbyname_0 db 'gethostbyname',0   ; DATA XREF: sub_42CF67F5+61\u2191o
.data:42CFFEDA                 align 4
.data:42CFFEDC aSocket_0       db 'Socket',0           ; DATA XREF: sub_42CF67F5+B9\u2191o
.data:42CFFEE3                 align 4
.data:42CFFEE4 aSoExclusiveadd_0 db 'SO_EXCLUSIVEADDRUSE',0
.data:42CFFEE4                                         ; DATA XREF: sub_42CF67F5+FD\u2191o
.data:42CFFEF8 aBind_0         db 'Bind',0             ; DATA XREF: sub_42CF67F5+13E\u2191o
.data:42CFFEFD                 align 10h
.data:42CFFF00 aFailedToGetExc_0 db 'Failed to get Exclusive port use',0
.data:42CFFF00                                         ; DATA XREF: sub_42CF67F5+15B\u2191o
.data:42CFFF21                 align 4
.data:42CFFF24 aListen_0       db 'Listen',0           ; DATA XREF: sub_42CF67F5+18D\u2191o
.data:42CFFF2B                 align 4
.data:42CFFF2C ; CHAR ProcName[]
.data:42CFFF2C ProcName        db 'ViaNumNics',0       ; DATA XREF: sub_42CF69B4+2FB\u2191o
.data:42CFFF37                 align 4
.data:42CFFF38 aQSphinxNetlibs_16 db 'q:\SPHINX\NETLIBS\nt\ssock\src\ntssocks.c',0
.data:42CFFF38                                         ; DATA XREF: sub_42CF7699+5F\u2191o
.data:42CFFF62                 align 4
.data:42CFFF64 a0              db '0',0                ; DATA XREF: sub_42CF7699+64\u2191o
.data:42CFFF66                 align 4
.data:42CFFF68 ; char aSD[]
.data:42CFFF68 aSD             db ', %s:%d',0          ; DATA XREF: sub_42CF7880+18\u2191o
.data:42CFFF70 dword_42CFFF70  dd 30h                  ; DATA XREF: sub_42CF7A27:loc_42CF7B29\u2191r
.data:42CFFF74 aSecurityDll    db 'security.dll',0     ; DATA XREF: sub_42CF7930+F\u2191o
.data:42CFFF81                 align 4
.data:42CFFF84 aSchannelDll    db 'schannel.dll',0     ; DATA XREF: sub_42CF7930:loc_42CF7948\u2191o
.data:42CFFF91                 align 4
.data:42CFFF94 ; CHAR aInitsecurityin[]
.data:42CFFF94 aInitsecurityin db 'InitSecurityInterfaceA',0
.data:42CFFF94                                         ; DATA XREF: sub_42CF7930:loc_42CF7969\u2191o
.data:42CFFFAB                 align 4
.data:42CFFFAC aMy:                                    ; DATA XREF: sub_42CF7A27+29\u2191o
.data:42CFFFAC                 text "UTF-16LE", 'MY',0
.data:42CFFFB2                 align 4
.data:42CFFFB4 aMy_0           db 'MY',0               ; DATA XREF: sub_42CF7A27:loc_42CF7A6B\u2191o
.data:42CFFFB7                 align 4
.data:42CFFFB8 aMy_1           db 'MY',0               ; DATA XREF: sub_42CF7A27+8C\u2191o
.data:42CFFFBB                 align 4
.data:42CFFFBC aMicrosoftUnifi db 'Microsoft Unified Security Protocol Provider',0
.data:42CFFFBC                                         ; DATA XREF: sub_42CF7A27+13F\u2191o
.data:42CFFFE9                 align 4
.data:42CFFFEC aMicrosoftUnifi_0 db 'Microsoft Unified Security Protocol Provider',0
.data:42CFFFEC                                         ; DATA XREF: sub_42CF7A27+16E\u2191o
.data:42D00019                 align 4
.data:42D0001C aCertfreecertif_1 db 'CertFreeCertificateContext',0
.data:42D00037                 align 4
.data:42D00038 aCertfreecertif db 'CertFreeCertificateContext',0
.data:42D00038                                         ; DATA XREF: sub_42CF7E41+6\u2191o
.data:42D00053                 align 4
.data:42D00054 aCertfindcertif_0 db 'CertFindCertificateInStore',0
.data:42D0006F                 align 10h
.data:42D00070 aCertfindcertif db 'CertFindCertificateInStore',0
.data:42D00070                                         ; DATA XREF: sub_42CF7E41+D\u2191o
.data:42D0008B                 align 4
.data:42D0008C aCertopensystem_0 db 'CertOpenSystemStoreA',0
.data:42D000A1                 align 4
.data:42D000A4 aCertopensystem db 'CertOpenSystemStoreA',0
.data:42D000A4                                         ; DATA XREF: sub_42CF7E41+14\u2191o
.data:42D000B9                 align 4
.data:42D000BC aCertopenstore_0 db 'CertOpenStore',0
.data:42D000CA                 align 4
.data:42D000CC aCertopenstore  db 'CertOpenStore',0    ; DATA XREF: sub_42CF7E41+1B\u2191o
.data:42D000DA                 align 4
.data:42D000DC aCertgetissuerc_0 db 'CertGetIssuerCertificateFromStore',0
.data:42D000FE                 align 10h
.data:42D00100 aCertgetissuerc db 'CertGetIssuerCertificateFromStore',0
.data:42D00100                                         ; DATA XREF: sub_42CF7E41+22\u2191o
.data:42D00122                 align 4
.data:42D00124 aCertnametostra_0 db 'CertNameToStrA',0
.data:42D00133                 align 4
.data:42D00134 aCertnametostra db 'CertNameToStrA',0   ; DATA XREF: sub_42CF7E41+29\u2191o
.data:42D00143                 align 4
.data:42D00144 aCertnametostrw_0 db 'CertNameToStrW',0
.data:42D00153                 align 4
.data:42D00154 aCertnametostrw db 'CertNameToStrW',0   ; DATA XREF: sub_42CF7E41+30\u2191o
.data:42D00163                 align 4
.data:42D00164 aCertfreecertif_2 db 'CertFreeCertificateChain',0
.data:42D0017D                 align 10h
.data:42D00180 aCertfreecertif_0 db 'CertFreeCertificateChain',0
.data:42D00180                                         ; DATA XREF: sub_42CF7E41+37\u2191o
.data:42D00199                 align 4
.data:42D0019C aCertverifycert_0 db 'CertVerifyCertificateChainPolicy',0
.data:42D001BD                 align 10h
.data:42D001C0 aCertverifycert db 'CertVerifyCertificateChainPolicy',0
.data:42D001C0                                         ; DATA XREF: sub_42CF7E41+3E\u2191o
.data:42D001E1                 align 4
.data:42D001E4 aCertgetcertifi_0 db 'CertGetCertificateChain',0
.data:42D001FC aCertgetcertifi db 'CertGetCertificateChain',0
.data:42D001FC                                         ; DATA XREF: sub_42CF7E41+45\u2191o
.data:42D00214 aCertfindchaini_0 db 'CertFindChainInStore',0
.data:42D00229                 align 4
.data:42D0022C aCertfindchaini db 'CertFindChainInStore',0
.data:42D0022C                                         ; DATA XREF: sub_42CF7E41+4C\u2191o
.data:42D00241                 align 4
.data:42D00244 ; CHAR aCrypt32Dll[]
.data:42D00244 aCrypt32Dll     db 'crypt32.dll',0      ; DATA XREF: sub_42CF7E41+53\u2191o
.data:42D00250 ; char aUnknown[]
.data:42D00250 aUnknown        db 'UNKNOWN',0          ; DATA XREF: sub_42CF8270:loc_42CF82E0\u2191o
.data:42D00258 ; char aSecIIncomplete_0[]
.data:42D00258 aSecIIncomplete_0 db 'SEC_I_INCOMPLETE_CREDENTIALS',0
.data:42D00258                                         ; DATA XREF: sub_42CF8270+5D\u2191o
.data:42D00275                 align 4
.data:42D00278 ; char aSecIIncomplete[]
.data:42D00278 aSecIIncomplete db 'SEC_I_INCOMPLETE_MESSAGE',0
.data:42D00278                                         ; DATA XREF: sub_42CF8270+41\u2191o
.data:42D00291                 align 4
.data:42D00294 ; char aSecIContinueNe[]
.data:42D00294 aSecIContinueNe db 'SEC_I_CONTINUE_NEEDED',0
.data:42D00294                                         ; DATA XREF: sub_42CF8270+25\u2191o
.data:42D002AA                 align 4
.data:42D002AC ; char aSecEOk[]
.data:42D002AC aSecEOk         db 'SEC_E_OK',0         ; DATA XREF: sub_42CF8270+9\u2191o
.data:42D002B5                 align 4
.data:42D002B8 dword_42D002B8  dd 706374h              ; DATA XREF: sub_42CF8300+E\u2191r
.data:42D002BC ; char aMssqlserver_3[]
.data:42D002BC aMssqlserver_3  db 'MSSQLServer',0      ; DATA XREF: sub_42CF8300+3B\u2191o
.data:42D002C8 ; char aSoftwareMicros[]
.data:42D002C8 aSoftwareMicros db 'SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\SuperSocketNetLib\',0
.data:42D002C8                                         ; DATA XREF: sub_42CF8300+51\u2191o
.data:42D00306                 align 4
.data:42D00308 ; char aSoftwareMicros_0[]
.data:42D00308 aSoftwareMicros_0 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00308                                         ; DATA XREF: sub_42CF8300:loc_42CF8367\u2191o
.data:42D00331                 align 4
.data:42D00334 ; char aMssqlserverSup[]
.data:42D00334 aMssqlserverSup db '\MSSQLServer\SuperSocketNetLib\',0
.data:42D00334                                         ; DATA XREF: sub_42CF8300+8E\u2191o
.data:42D00354 ; CHAR ValueName[]
.data:42D00354 ValueName       db 'Encrypt',0          ; DATA XREF: sub_42CF8300+17D\u2191o
.data:42D0035C ; CHAR aProtocollist[]
.data:42D0035C aProtocollist   db 'ProtocolList',0     ; DATA XREF: sub_42CF8300+1D0\u2191o
.data:42D00369                 align 4
.data:42D0036C ; CHAR aWinsocklistenb[]
.data:42D0036C aWinsocklistenb db 'WinsockListenBacklog',0
.data:42D0036C                                         ; DATA XREF: sub_42CF8300+226\u2191o
.data:42D00381                 align 4
.data:42D00384 ; char aCluster[]
.data:42D00384 aCluster        db 'Cluster\',0         ; DATA XREF: sub_42CF8300+280\u2191o
.data:42D0038D                 align 10h
.data:42D00390 ; char SubStr[]
.data:42D00390 SubStr          db 'MSSQLServer\SuperSocketNetLib',0
.data:42D00390                                         ; DATA XREF: sub_42CF8300+285\u2191o
.data:42D003AE                 align 10h
.data:42D003B0 ; CHAR aClusteripaddr[]
.data:42D003B0 aClusteripaddr  db 'ClusterIPAddr',0    ; DATA XREF: sub_42CF8300+2EC\u2191o
.data:42D003BE                 align 10h
.data:42D003C0 ; CHAR aClusteripaddr_0[]
.data:42D003C0 aClusteripaddr_0 db 'ClusterIPAddr',0   ; DATA XREF: sub_42CF8300+326\u2191o
.data:42D003CE                 align 10h
.data:42D003D0 ; CHAR aClustername[]
.data:42D003D0 aClustername    db 'ClusterName',0      ; DATA XREF: sub_42CF8300+415\u2191o
.data:42D003DC ; char aTcp_0[]
.data:42D003DC aTcp_0          db 'Tcp',0              ; DATA XREF: sub_42CF8300+4CC\u2191o
.data:42D003E0 ; CHAR aTcphideflag[]
.data:42D003E0 aTcphideflag    db 'TcpHideFlag',0      ; DATA XREF: sub_42CF8300+53D\u2191o
.data:42D003EC ; CHAR aTcpport[]
.data:42D003EC aTcpport        db 'TcpPort',0          ; DATA XREF: sub_42CF8300+5B9\u2191o
.data:42D003F4 ; char asc_42D003F4[]
.data:42D003F4 asc_42D003F4    db ',',0                ; DATA XREF: sub_42CF8300+60E\u2191o
.data:42D003F6                 align 4
.data:42D003F8 ; char asc_42D003F8[]
.data:42D003F8 asc_42D003F8    db ',',0                ; DATA XREF: sub_42CF8300:loc_42CF8972\u2191o
.data:42D003FA                 align 4
.data:42D003FC ; CHAR aTcpabortiveclo[]
.data:42D003FC aTcpabortiveclo db 'TcpAbortiveClose',0 ; DATA XREF: sub_42CF8300+71A\u2191o
.data:42D0040D                 align 10h
.data:42D00410 ; char aSpx_0[]
.data:42D00410 aSpx_0          db 'Spx',0              ; DATA XREF: sub_42CF8300+776\u2191o
.data:42D00414 ; char aMssqlserver_4[]
.data:42D00414 aMssqlserver_4  db 'MSSQLServer',0      ; DATA XREF: sub_42CF8300+7D8\u2191o
.data:42D00420 ; char asc_42D00420[]
.data:42D00420 asc_42D00420    db '$',0                ; DATA XREF: sub_42CF8300+7EE\u2191o
.data:42D00422                 align 4
.data:42D00424 ; CHAR aSpxhideflag[]
.data:42D00424 aSpxhideflag    db 'SpxHideFlag',0      ; DATA XREF: sub_42CF8300+860\u2191o
.data:42D00430 ; CHAR aSpxport[]
.data:42D00430 aSpxport        db 'SpxPort',0          ; DATA XREF: sub_42CF8300+8D0\u2191o
.data:42D00438 ; CHAR aSpxservicename[]
.data:42D00438 aSpxservicename db 'SpxServiceName',0   ; DATA XREF: sub_42CF8300+928\u2191o
.data:42D00447                 align 4
.data:42D00448 ; char aAdsp_4[]
.data:42D00448 aAdsp_4         db 'Adsp',0             ; DATA XREF: sub_42CF8300+9AC\u2191o
.data:42D0044D                 align 10h
.data:42D00450 ; CHAR aAdspobjectname[]
.data:42D00450 aAdspobjectname db 'AdspObjectName',0   ; DATA XREF: sub_42CF8300+A19\u2191o
.data:42D0045F                 align 10h
.data:42D00460 ; char aVia_2[]
.data:42D00460 aVia_2          db 'Via',0              ; DATA XREF: sub_42CF8300+A91\u2191o
.data:42D00464 ; char aNic0[]
.data:42D00464 aNic0           db 'Nic0',0             ; DATA XREF: sub_42CF8300+ABB\u2191o
.data:42D00469                 align 4
.data:42D0046C ; CHAR aVendor[]
.data:42D0046C aVendor         db 'Vendor',0           ; DATA XREF: sub_42CF8300+B18\u2191o
.data:42D00473                 align 4
.data:42D00474 ; CHAR aListeninfo[]
.data:42D00474 aListeninfo     db 'ListenInfo',0       ; DATA XREF: sub_42CF8300+B7C\u2191o
.data:42D0047F                 align 10h
.data:42D00480 ; char aWsproxy_2[]
.data:42D00480 aWsproxy_2      db 'WSProxy',0          ; DATA XREF: sub_42CF8300+BF4\u2191o
.data:42D00488 ; CHAR aWsproxyaddress[]
.data:42D00488 aWsproxyaddress db 'WSProxyAddress',0   ; DATA XREF: sub_42CF8300+C68\u2191o
.data:42D00497                 align 4
.data:42D00498 ; CHAR aWsproxyport[]
.data:42D00498 aWsproxyport    db 'WSProxyPort',0      ; DATA XREF: sub_42CF8300+D10\u2191o
.data:42D004A4 ; char aSD_0[]
.data:42D004A4 aSD_0           db '%s,%d',0            ; DATA XREF: sub_42CF8300+D68\u2191o
.data:42D004AA                 align 4
.data:42D004AC ; char aNp[]
.data:42D004AC aNp             db 'Np',0               ; DATA XREF: sub_42CF8300+DA8\u2191o
.data:42D004AF                 align 10h
.data:42D004B0 ; CHAR aPipename[]
.data:42D004B0 aPipename       db 'PipeName',0         ; DATA XREF: sub_42CF8300+DFE\u2191o
.data:42D004B9                 align 4
.data:42D004BC ; char aBv[]
.data:42D004BC aBv             db 'Bv',0               ; DATA XREF: sub_42CF8300+E7D\u2191o
.data:42D004BF                 align 10h
.data:42D004C0 ; CHAR aItemname[]
.data:42D004C0 aItemname       db 'ItemName',0         ; DATA XREF: sub_42CF8300+ED7\u2191o
.data:42D004C9                 align 4
.data:42D004CC ; CHAR aGroupname[]
.data:42D004CC aGroupname      db 'GroupName',0        ; DATA XREF: sub_42CF8300+F2F\u2191o
.data:42D004D6                 align 4
.data:42D004D8 ; char asc_42D004D8[]
.data:42D004D8 asc_42D004D8    db '@',0                ; DATA XREF: sub_42CF8300+F4E\u2191o
.data:42D004DA                 align 4
.data:42D004DC ; CHAR aOrgname[]
.data:42D004DC aOrgname        db 'OrgName',0          ; DATA XREF: sub_42CF8300+F9F\u2191o
.data:42D004E4 ; char asc_42D004E4[]
.data:42D004E4 asc_42D004E4    db '@',0                ; DATA XREF: sub_42CF8300+FBE\u2191o
.data:42D004E6                 align 4
.data:42D004E8 ; CHAR SubKey[]
.data:42D004E8 SubKey          db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D004E8                                         ; DATA XREF: sub_42CF9388+31\u2191o
.data:42D00511                 align 4
.data:42D00514 ; CHAR aInstalledinsta[]
.data:42D00514 aInstalledinsta db 'InstalledInstances',0
.data:42D00514                                         ; DATA XREF: sub_42CF9388+4F\u2191o
.data:42D00527                 align 4
.data:42D00528 ; CHAR aInstalledinsta_0[]
.data:42D00528 aInstalledinsta_0 db 'InstalledInstances',0
.data:42D00528                                         ; DATA XREF: sub_42CF9388+83\u2191o
.data:42D0053B                 align 4
.data:42D0053C ; char aMssqlserver_5[]
.data:42D0053C aMssqlserver_5  db 'MSSQLServer',0      ; DATA XREF: sub_42CF9388:loc_42CF9476\u2191o
.data:42D00548 ; char aSoftwareMicros_2[]
.data:42D00548 aSoftwareMicros_2 db 'SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\SuperSocketNetLib\',0
.data:42D00548                                         ; DATA XREF: sub_42CF9388+104\u2191o
.data:42D00586                 align 4
.data:42D00588 ; char aTcp_1[]
.data:42D00588 aTcp_1          db 'Tcp',0              ; DATA XREF: sub_42CF9388+118\u2191o
.data:42D0058C aSoftwareMicros_3 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D0058C                                         ; DATA XREF: sub_42CF9388+132\u2191o
.data:42D005B5                 align 4
.data:42D005B8 ; char aSSMssqlserverS[]
.data:42D005B8 aSSMssqlserverS db '%s%s\MSSQLServer\SuperSocketNetLib\Tcp',0
.data:42D005B8                                         ; DATA XREF: sub_42CF9388+137\u2191o
.data:42D005DF                 align 10h
.data:42D005E0 ; CHAR aTcpport_0[]
.data:42D005E0 aTcpport_0      db 'TcpPort',0          ; DATA XREF: sub_42CF9388+189\u2191o
.data:42D005E8 ; char asc_42D005E8[]
.data:42D005E8 asc_42D005E8    db ',',0                ; DATA XREF: sub_42CF9388+1C0\u2191o
.data:42D005EA                 align 4
.data:42D005EC ; char asc_42D005EC[]
.data:42D005EC asc_42D005EC    db ',',0                ; DATA XREF: sub_42CF9388:loc_42CF959F\u2191o
.data:42D005EE                 align 10h
.data:42D005F0 ; CHAR aSoftwareMicros_4[]
.data:42D005F0 aSoftwareMicros_4 db 'SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\CurrentVersion\',0
.data:42D005F0                                         ; DATA XREF: sub_42CF9388+2C5\u2191o
.data:42D0062B                 align 4
.data:42D0062C ; CHAR aCurrentversion[]
.data:42D0062C aCurrentversion db 'CurrentVersion',0   ; DATA XREF: sub_42CF9388+2EF\u2191o
.data:42D0063B                 align 4
.data:42D0063C ; char asc_42D0063C[]
.data:42D0063C asc_42D0063C    db '.',0                ; DATA XREF: sub_42CF9388+306\u2191o
.data:42D0063E                 align 10h
.data:42D00640 ; char asc_42D00640[]
.data:42D00640 asc_42D00640    db '.',0                ; DATA XREF: sub_42CF9388+32B\u2191o
.data:42D00642                 align 4
.data:42D00644 ; CHAR aSoftwareMicros_5[]
.data:42D00644 aSoftwareMicros_5 db 'Software\Microsoft\MSSQLServer\MSSQLServer',0
.data:42D00644                                         ; DATA XREF: sub_42CF9388+3AE\u2191o
.data:42D0066F                 align 10h
.data:42D00670 ; CHAR aListenon[]
.data:42D00670 aListenon       db 'ListenOn',0         ; DATA XREF: sub_42CF9388+3D8\u2191o
.data:42D00679                 align 4
.data:42D0067C ; char aSsmsso70[]
.data:42D0067C aSsmsso70       db 'SSMSSO70',0         ; DATA XREF: sub_42CF9388+41A\u2191o
.data:42D00685                 align 4
.data:42D00688 ; char aSsmsso60[]
.data:42D00688 aSsmsso60       db 'SSMSSO60',0         ; DATA XREF: sub_42CF9388+433\u2191o
.data:42D00691                 align 4
.data:42D00694 ; char aSsmsso70_0[]
.data:42D00694 aSsmsso70_0     db 'ssmsso70',0         ; DATA XREF: sub_42CF9388+44C\u2191o
.data:42D0069D                 align 10h
.data:42D006A0 ; char aSsmsso60_0[]
.data:42D006A0 aSsmsso60_0     db 'ssmsso60',0         ; DATA XREF: sub_42CF9388+465\u2191o
.data:42D006A9                 align 4
.data:42D006AC ; char Control[]
.data:42D006AC Control         db ',',0                ; DATA XREF: sub_42CF9388:loc_42CF9806\u2191o
.data:42D006AE                 align 10h
.data:42D006B0 ; CHAR aTcpdynamicport[]
.data:42D006B0 aTcpdynamicport db 'TcpDynamicPorts',0  ; DATA XREF: sub_42CF9895+1E\u2191o
.data:42D006C0 ; char asc_42D006C0[]
.data:42D006C0 asc_42D006C0    db ',',0                ; DATA XREF: sub_42CF9895+69\u2191o
.data:42D006C2                 align 4
.data:42D006C4 ; char asc_42D006C4[]
.data:42D006C4 asc_42D006C4    db ',',0                ; DATA XREF: sub_42CF9895:loc_42CF9976\u2191o
.data:42D006C6                 align 4
.data:42D006C8 ; char asc_42D006C8[]
.data:42D006C8 asc_42D006C8    db ',',0                ; DATA XREF: sub_42CF9A35+B0\u2191o
.data:42D006CA                 align 4
.data:42D006CC ; CHAR aTcpport_1[]
.data:42D006CC aTcpport_1      db 'TcpPort',0          ; DATA XREF: sub_42CF9A35+E4\u2191o
.data:42D006D4 ; char asc_42D006D4[]
.data:42D006D4 asc_42D006D4    db ',',0                ; DATA XREF: sub_42CF9A35+18F\u2191o
.data:42D006D6                 align 4
.data:42D006D8 ; CHAR aTcpdynamicport_0[]
.data:42D006D8 aTcpdynamicport_0 db 'TcpDynamicPorts',0
.data:42D006D8                                         ; DATA XREF: sub_42CF9A35+1F0\u2191o
.data:42D006E8 ; char aMssqlserver_6[]
.data:42D006E8 aMssqlserver_6  db 'MSSQLServer',0      ; DATA XREF: sub_42CF9D87+2B\u2191o
.data:42D006F4 ; char aSoftwareMicros_6[]
.data:42D006F4 aSoftwareMicros_6 db 'SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\SuperSocketNetLib\',0
.data:42D006F4                                         ; DATA XREF: sub_42CF9D87:loc_42CF9DC8\u2191o
.data:42D00732                 align 4
.data:42D00734 ; char aCluster_0[]
.data:42D00734 aCluster_0      db 'Cluster\',0         ; DATA XREF: sub_42CF9D87+55\u2191o
.data:42D0073D                 align 10h
.data:42D00740 ; char aMssqlserverSup_1[]
.data:42D00740 aMssqlserverSup_1 db 'MSSQLServer\SuperSocketNetLib',0
.data:42D00740                                         ; DATA XREF: sub_42CF9D87+5A\u2191o
.data:42D0075E                 align 10h
.data:42D00760 ; char aSoftwareMicros_7[]
.data:42D00760 aSoftwareMicros_7 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00760                                         ; DATA XREF: sub_42CF9D87:loc_42CF9E01\u2191o
.data:42D00789                 align 4
.data:42D0078C ; char aCluster_1[]
.data:42D0078C aCluster_1      db '\Cluster\',0        ; DATA XREF: sub_42CF9D87+A1\u2191o
.data:42D00796                 align 4
.data:42D00798 ; CHAR aClustername_0[]
.data:42D00798 aClustername_0  db 'ClusterName',0      ; DATA XREF: sub_42CF9D87+DF\u2191o
.data:42D007A4 ; CHAR aSoftwareMicros_8[]
.data:42D007A4 aSoftwareMicros_8 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D007A4                                         ; DATA XREF: sub_42CFA2CE+44\u2191o
.data:42D007CD                 align 10h
.data:42D007D0 ; CHAR aSsrpactiveserv[]
.data:42D007D0 aSsrpactiveserv db 'SsrpActiveServer',0 ; DATA XREF: sub_42CFA2CE+6E\u2191o
.data:42D007E1                 align 4
.data:42D007E4 ; CHAR aSsrpactiveserv_0[]
.data:42D007E4 aSsrpactiveserv_0 db 'SsrpActiveServer',0
.data:42D007E4                                         ; DATA XREF: sub_42CFA2CE+BC\u2191o
.data:42D007F5                 align 4
.data:42D007F8 ; CHAR aSoftwareMicros_9[]
.data:42D007F8 aSoftwareMicros_9 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D007F8                                         ; DATA XREF: sub_42CFA3AD+17\u2191o
.data:42D00821                 align 4
.data:42D00824 ; CHAR aSsrpactiveserv_1[]
.data:42D00824 aSsrpactiveserv_1 db 'SsrpActiveServer',0
.data:42D00824                                         ; DATA XREF: sub_42CFA3AD+3C\u2191o
.data:42D00835                 align 4
.data:42D00838 ; char asc_42D00838[]
.data:42D00838 asc_42D00838    db ':',0                ; DATA XREF: sub_42CFA64E+5A\u2191o
.data:42D0083A                 align 4
.data:42D0083C ; char aSD_1[]
.data:42D0083C aSD_1           db '%s:%d',0            ; DATA XREF: sub_42CFA84B+4D\u2191o
.data:42D00842                 align 4
.data:42D00844 ; CHAR aSoftwareMicros_10[]
.data:42D00844 aSoftwareMicros_10 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00844                                         ; DATA XREF: sub_42CFA94D+14\u2191o
.data:42D0086D                 align 10h
.data:42D00870 ; CHAR aSsrpactiveserv_2[]
.data:42D00870 aSsrpactiveserv_2 db 'SsrpActiveServer',0
.data:42D00870                                         ; DATA XREF: sub_42CFA94D+66\u2191o
.data:42D00881                 align 4
.data:42D00884 ; CHAR aSsrpservers[]
.data:42D00884 aSsrpservers    db 'SsrpServers',0      ; DATA XREF: sub_42CFA94D+1CE\u2191o
.data:42D00890 ; CHAR aSoftwareMicros_11[]
.data:42D00890 aSoftwareMicros_11 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00890                                         ; DATA XREF: sub_42CFAB38+22\u2191o
.data:42D008B9                 align 4
.data:42D008BC ; CHAR aSsrpservers_0[]
.data:42D008BC aSsrpservers_0  db 'SsrpServers',0      ; DATA XREF: sub_42CFAB38+44\u2191o
.data:42D008C8 ; CHAR aSsrpservers_1[]
.data:42D008C8 aSsrpservers_1  db 'SsrpServers',0      ; DATA XREF: sub_42CFAB38:loc_42CFAC4B\u2191o
.data:42D008D4 ; CHAR aSoftwareMicros_12[]
.data:42D008D4 aSoftwareMicros_12 db 'Software\Microsoft\MSSQLServer\MSSQLServer',0
.data:42D008D4                                         ; DATA XREF: sub_42CFAD0B+44\u2191o
.data:42D008FF                 align 10h
.data:42D00900 ; CHAR aListenon_0[]
.data:42D00900 aListenon_0     db 'ListenOn',0         ; DATA XREF: sub_42CFAD0B+75\u2191o
.data:42D00909                 align 4
.data:42D0090C ; char aSsmsso70_1[]
.data:42D0090C aSsmsso70_1     db 'ssmsso70',0         ; DATA XREF: sub_42CFAD0B+F5\u2191o
.data:42D00915                 align 4
.data:42D00918 ; char aSsmsso60_1[]
.data:42D00918 aSsmsso60_1     db 'ssmsso60',0         ; DATA XREF: sub_42CFAD0B+10B\u2191o
.data:42D00921                 align 4
.data:42D00924 ; char aTcp_2[]
.data:42D00924 aTcp_2          db 'tcp;',0             ; DATA XREF: sub_42CFAD0B:loc_42CFAE30\u2191o
.data:42D00929                 align 4
.data:42D0092C ; char asc_42D0092C[]
.data:42D0092C asc_42D0092C    db ',',0                ; DATA XREF: sub_42CFAD0B+159\u2191o
.data:42D0092E                 align 10h
.data:42D00930 ; char aD[]
.data:42D00930 aD              db '%d;',0              ; DATA XREF: sub_42CFAD0B+17C\u2191o
.data:42D00934 ; char aSsnmpn70[]
.data:42D00934 aSsnmpn70       db 'ssnmpn70',0         ; DATA XREF: sub_42CFAD0B:loc_42CFAEC9\u2191o
.data:42D0093D                 align 10h
.data:42D00940 ; char aSsnmpn60[]
.data:42D00940 aSsnmpn60       db 'ssnmpn60',0         ; DATA XREF: sub_42CFAD0B+1D4\u2191o
.data:42D00949                 align 4
.data:42D0094C ; char aNp_0[]
.data:42D0094C aNp_0           db 'np;',0              ; DATA XREF: sub_42CFAD0B:loc_42CFAEF9\u2191o
.data:42D00950 ; char asc_42D00950[]
.data:42D00950 asc_42D00950    db ',',0                ; DATA XREF: sub_42CFAD0B+222\u2191o
.data:42D00952                 align 4
.data:42D00954 ; char asc_42D00954[]
.data:42D00954 asc_42D00954    db '\\.',0              ; DATA XREF: sub_42CFAD0B+23E\u2191o
.data:42D00958 ; char asc_42D00958[]
.data:42D00958 asc_42D00958    db '\\.',0              ; DATA XREF: sub_42CFAD0B+254\u2191o
.data:42D0095C ; char aSPipeS[]
.data:42D0095C aSPipeS         db '\\%s\pipe\%s;',0    ; DATA XREF: sub_42CFAD0B+27C\u2191o
.data:42D0096A                 align 4
.data:42D0096C ; char aS[]
.data:42D0096C aS              db '%s;',0              ; DATA XREF: sub_42CFAD0B+299\u2191o
.data:42D00970 ; char aSsmsrp70[]
.data:42D00970 aSsmsrp70       db 'ssmsrp70',0         ; DATA XREF: sub_42CFAD0B:loc_42CFAFE6\u2191o
.data:42D00979                 align 4
.data:42D0097C ; char aSsmsrp60[]
.data:42D0097C aSsmsrp60       db 'ssmsrp60',0         ; DATA XREF: sub_42CFAD0B+2F1\u2191o
.data:42D00985                 align 4
.data:42D00988 ; char aRpc_4[]
.data:42D00988 aRpc_4          db 'rpc;',0             ; DATA XREF: sub_42CFAD0B:loc_42CFB012\u2191o
.data:42D0098D                 align 10h
.data:42D00990 ; char aS_0[]
.data:42D00990 aS_0            db '%s;',0              ; DATA XREF: sub_42CFAD0B+340\u2191o
.data:42D00994 ; char aSsmssp70[]
.data:42D00994 aSsmssp70       db 'ssmssp70',0         ; DATA XREF: sub_42CFAD0B:loc_42CFB08D\u2191o
.data:42D0099D                 align 10h
.data:42D009A0 ; char aSsmssp60[]
.data:42D009A0 aSsmssp60       db 'ssmssp60',0         ; DATA XREF: sub_42CFAD0B+398\u2191o
.data:42D009A9                 align 4
.data:42D009AC ; char asc_42D009AC[]
.data:42D009AC asc_42D009AC    db ',',0                ; DATA XREF: sub_42CFAD0B:loc_42CFB0BD\u2191o
.data:42D009AE                 align 10h
.data:42D009B0 ; char asc_42D009B0[]
.data:42D009B0 asc_42D009B0    db '-H',0               ; DATA XREF: sub_42CFAD0B+3CE\u2191o
.data:42D009B3                 align 4
.data:42D009B4 ; char aSpx_1[]
.data:42D009B4 aSpx_1          db 'spx;',0             ; DATA XREF: sub_42CFAD0B+3E8\u2191o
.data:42D009B9                 align 4
.data:42D009BC ; char asc_42D009BC[]
.data:42D009BC asc_42D009BC    db ',',0                ; DATA XREF: sub_42CFAD0B+41C\u2191o
.data:42D009BE                 align 10h
.data:42D009C0 ; char aD_0[]
.data:42D009C0 aD_0            db '%d;',0              ; DATA XREF: sub_42CFAD0B+43F\u2191o
.data:42D009C4 ; char aSsmsad70[]
.data:42D009C4 aSsmsad70       db 'ssmsad70',0         ; DATA XREF: sub_42CFAD0B:loc_42CFB18C\u2191o
.data:42D009CD                 align 10h
.data:42D009D0 ; char aSsmsad60[]
.data:42D009D0 aSsmsad60       db 'ssmsad60',0         ; DATA XREF: sub_42CFAD0B+497\u2191o
.data:42D009D9                 align 4
.data:42D009DC ; char aAdsp_5[]
.data:42D009DC aAdsp_5         db 'adsp;',0            ; DATA XREF: sub_42CFAD0B:loc_42CFB1BC\u2191o
.data:42D009E2                 align 4
.data:42D009E4 ; char asc_42D009E4[]
.data:42D009E4 asc_42D009E4    db ',',0                ; DATA XREF: sub_42CFAD0B+4E5\u2191o
.data:42D009E6                 align 4
.data:42D009E8 ; char aS_1[]
.data:42D009E8 aS_1            db '%s;',0              ; DATA XREF: sub_42CFAD0B+518\u2191o
.data:42D009EC ; char asc_42D009EC[]
.data:42D009EC asc_42D009EC    db '@',0                ; DATA XREF: sub_42CFAD0B:loc_42CFB23C\u2191o
.data:42D009EE                 align 10h
.data:42D009F0 ; char aS_2[]
.data:42D009F0 aS_2            db '%s;',0              ; DATA XREF: sub_42CFAD0B+544\u2191o
.data:42D009F4 ; char aSsmsvi70[]
.data:42D009F4 aSsmsvi70       db 'ssmsvi70',0         ; DATA XREF: sub_42CFAD0B:loc_42CFB291\u2191o
.data:42D009FD                 align 10h
.data:42D00A00 ; char aSsmsvi60[]
.data:42D00A00 aSsmsvi60       db 'ssmsvi60',0         ; DATA XREF: sub_42CFAD0B+59C\u2191o
.data:42D00A09                 align 4
.data:42D00A0C ; char aBv_0[]
.data:42D00A0C aBv_0           db 'bv;',0              ; DATA XREF: sub_42CFAD0B:loc_42CFB2C1\u2191o
.data:42D00A10 ; char asc_42D00A10[]
.data:42D00A10 asc_42D00A10    db ',',0                ; DATA XREF: sub_42CFAD0B+5EA\u2191o
.data:42D00A12                 align 4
.data:42D00A14 ; char aS_3[]
.data:42D00A14 aS_3            db '%s;',0              ; DATA XREF: sub_42CFAD0B+60A\u2191o
.data:42D00A18 ; char aSsmssh70[]
.data:42D00A18 aSsmssh70       db 'ssmssh70',0         ; DATA XREF: sub_42CFAD0B:loc_42CFB354\u2191o
.data:42D00A21                 align 4
.data:42D00A24 ; CHAR aSoftwareMicros_13[]
.data:42D00A24 aSoftwareMicros_13 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00A24                                         ; DATA XREF: sub_42CFB392+88\u2191o
.data:42D00A4D                 align 10h
.data:42D00A50 ; CHAR aInstalledinsta_1[]
.data:42D00A50 aInstalledinsta_1 db 'InstalledInstances',0
.data:42D00A50                                         ; DATA XREF: sub_42CFB392+B9\u2191o
.data:42D00A63                 align 4
.data:42D00A64 ; CHAR aInstalledinsta_2[]
.data:42D00A64 aInstalledinsta_2 db 'InstalledInstances',0
.data:42D00A64                                         ; DATA XREF: sub_42CFB392+106\u2191o
.data:42D00A77                 align 4
.data:42D00A78 ; char aMssqlserver_7[]
.data:42D00A78 aMssqlserver_7  db 'MSSQLServer',0      ; DATA XREF: sub_42CFB392+1B9\u2191o
.data:42D00A84 ; char aSoftwareMicros_14[]
.data:42D00A84 aSoftwareMicros_14 db 'SOFTWARE\Microsoft\MSSQLServer\MSSQLServer\SuperSocketNetLib\',0
.data:42D00A84                                         ; DATA XREF: sub_42CFB392+1D2\u2191o
.data:42D00AC2                 align 4
.data:42D00AC4 ; char aSoftwareMicros_15[]
.data:42D00AC4 aSoftwareMicros_15 db 'Software\Microsoft\MSSQLServer\MSSQLServer\CurrentVersion',0
.data:42D00AC4                                         ; DATA XREF: sub_42CFB392+1E6\u2191o
.data:42D00AFE                 align 10h
.data:42D00B00 aSoftwareMicros_16 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00B00                                         ; DATA XREF: sub_42CFB392+203\u2191o
.data:42D00B29                 align 4
.data:42D00B2C ; char aSSMssqlserverS_0[]
.data:42D00B2C aSSMssqlserverS_0 db '%s%s\MSSQLServer\SuperSocketNetLib\',0
.data:42D00B2C                                         ; DATA XREF: sub_42CFB392+208\u2191o
.data:42D00B50 aSoftwareMicros_17 db 'SOFTWARE\Microsoft\Microsoft SQL Server\',0
.data:42D00B50                                         ; DATA XREF: sub_42CFB392+224\u2191o
.data:42D00B79                 align 4
.data:42D00B7C ; char aSSMssqlserverC[]
.data:42D00B7C aSSMssqlserverC db '%s%s\MSSQLServer\CurrentVersion',0
.data:42D00B7C                                         ; DATA XREF: sub_42CFB392+229\u2191o
.data:42D00B9C ; char aMssqlserver_8[]
.data:42D00B9C aMssqlserver_8  db 'MSSQLServer',0      ; DATA XREF: sub_42CFB392+26D\u2191o
.data:42D00BA8 ; CHAR aCurrentversion_0[]
.data:42D00BA8 aCurrentversion_0 db 'CurrentVersion',0 ; DATA XREF: sub_42CFB392+2CB\u2191o
.data:42D00BB7                 align 4
.data:42D00BB8 ; char aServernameSIns[]
.data:42D00BB8 aServernameSIns db 'ServerName;%s;InstanceName;%s;IsClustered;Yes;',0
.data:42D00BB8                                         ; DATA XREF: sub_42CFB392+330\u2191o
.data:42D00BE7                 align 4
.data:42D00BE8 ; char aServernameSIns_0[]
.data:42D00BE8 aServernameSIns_0 db 'ServerName;%s;InstanceName;%s;IsClustered;No;',0
.data:42D00BE8                                         ; DATA XREF: sub_42CFB392+355\u2191o
.data:42D00C16                 align 4
.data:42D00C18 ; char aVersionS[]
.data:42D00C18 aVersionS       db 'Version;%s;',0      ; DATA XREF: sub_42CFB392+390\u2191o
.data:42D00C24 ; char asc_42D00C24[]
.data:42D00C24 asc_42D00C24    db '.',0                ; DATA XREF: sub_42CFB392+3C4\u2191o
.data:42D00C26                 align 4
.data:42D00C28 ; char asc_42D00C28[]
.data:42D00C28 asc_42D00C28    db '.',0                ; DATA XREF: sub_42CFB392+3E6\u2191o
.data:42D00C2A                 align 4
.data:42D00C2C ; char aMssqlserver_9[]
.data:42D00C2C aMssqlserver_9  db 'MSSQLServer',0      ; DATA XREF: sub_42CFB392:loc_42CFB7B7\u2191o
.data:42D00C38 ; CHAR aProtocollist_0[]
.data:42D00C38 aProtocollist_0 db 'ProtocolList',0     ; DATA XREF: sub_42CFB392+4C6\u2191o
.data:42D00C45                 align 4
.data:42D00C48 ; char aWsp[]
.data:42D00C48 aWsp            db 'wsp',0              ; DATA XREF: sub_42CFB392+542\u2191o
.data:42D00C4C ; char aS_4[]
.data:42D00C4C aS_4            db '%s;',0              ; DATA XREF: sub_42CFB392+583\u2191o
.data:42D00C50 ; char aSS[]
.data:42D00C50 aSS             db '%s%s',0             ; DATA XREF: sub_42CFB392+5C5\u2191o
.data:42D00C55                 align 4
.data:42D00C58 ; CHAR aTcphideflag_0[]
.data:42D00C58 aTcphideflag_0  db 'TcpHideFlag',0      ; DATA XREF: sub_42CFB392+674\u2191o
.data:42D00C64 ; char Str[]
.data:42D00C64 Str             db 'tcp;',0             ; DATA XREF: sub_42CFB392+696\u2191o
.data:42D00C69                 align 4
.data:42D00C6C ; CHAR aTcpport_2[]
.data:42D00C6C aTcpport_2      db 'TcpPort',0          ; DATA XREF: sub_42CFB392+6D0\u2191o
.data:42D00C74 ; char asc_42D00C74[]
.data:42D00C74 asc_42D00C74    db ',',0                ; DATA XREF: sub_42CFB392+70D\u2191o
.data:42D00C76                 align 4
.data:42D00C78 ; char aD_1[]
.data:42D00C78 aD_1            db '%d;',0              ; DATA XREF: sub_42CFB392+72C\u2191o
.data:42D00C7C ; char aD_2[]
.data:42D00C7C aD_2            db '%d;',0              ; DATA XREF: sub_42CFB392+755\u2191o
.data:42D00C80 ; CHAR aPipename_0[]
.data:42D00C80 aPipename_0     db 'PipeName',0         ; DATA XREF: sub_42CFB392+7B6\u2191o
.data:42D00C89                 align 4
.data:42D00C8C ; char aPipe[]
.data:42D00C8C aPipe           db '\\.\pipe\$$',0      ; DATA XREF: sub_42CFB392+7E6\u2191o
.data:42D00C98 ; char asc_42D00C98[]
.data:42D00C98 asc_42D00C98    db '\',0                ; DATA XREF: sub_42CFB392+80B\u2191o
.data:42D00C9A                 align 4
.data:42D00C9C ; char aSPipeS_0[]
.data:42D00C9C aSPipeS_0       db '\\%s\pipe%s;',0     ; DATA XREF: sub_42CFB392+834\u2191o
.data:42D00CA9                 align 4
.data:42D00CAC ; char aSS_0[]
.data:42D00CAC aSS_0           db '\\%s%s;',0          ; DATA XREF: sub_42CFB392+860\u2191o
.data:42D00CB4 ; char aS_5[]
.data:42D00CB4 aS_5            db '%s;',0              ; DATA XREF: sub_42CFB392+8B4\u2191o
.data:42D00CB8 ; CHAR aSpxhidflag[]
.data:42D00CB8 aSpxhidflag     db 'SpxHidFlag',0       ; DATA XREF: sub_42CFB392+90E\u2191o
.data:42D00CC3                 align 4
.data:42D00CC4 ; char aSpx_2[]
.data:42D00CC4 aSpx_2          db 'spx;',0             ; DATA XREF: sub_42CFB392+930\u2191o
.data:42D00CC9                 align 4
.data:42D00CCC ; CHAR aSpxservicename_0[]
.data:42D00CCC aSpxservicename_0 db 'SpxServiceName',0 ; DATA XREF: sub_42CFB392+960\u2191o
.data:42D00CDB                 align 4
.data:42D00CDC ; char aS_6[]
.data:42D00CDC aS_6            db '%s;',0              ; DATA XREF: sub_42CFB392+986\u2191o
.data:42D00CE0 ; CHAR aSpxport_0[]
.data:42D00CE0 aSpxport_0      db 'SpxPort',0          ; DATA XREF: sub_42CFB392+9CE\u2191o
.data:42D00CE8 ; char aS_7[]
.data:42D00CE8 aS_7            db '%s;',0              ; DATA XREF: sub_42CFB392+9F4\u2191o
.data:42D00CEC ; CHAR aAdspobjectname_0[]
.data:42D00CEC aAdspobjectname_0 db 'AdspObjectName',0 ; DATA XREF: sub_42CFB392+A55\u2191o
.data:42D00CFB                 align 4
.data:42D00CFC ; char aS_8[]
.data:42D00CFC aS_8            db '%s;',0              ; DATA XREF: sub_42CFB392+A7B\u2191o
.data:42D00D00 ; CHAR aItemname_0[]
.data:42D00D00 aItemname_0     db 'ItemName',0         ; DATA XREF: sub_42CFB392+ADC\u2191o
.data:42D00D09                 align 4
.data:42D00D0C ; char aS_9[]
.data:42D00D0C aS_9            db '%s;',0              ; DATA XREF: sub_42CFB392+B02\u2191o
.data:42D00D10 ; CHAR aGroupname_0[]
.data:42D00D10 aGroupname_0    db 'GroupName',0        ; DATA XREF: sub_42CFB392+B52\u2191o
.data:42D00D1A                 align 4
.data:42D00D1C ; char aS_10[]
.data:42D00D1C aS_10           db '@%s;',0             ; DATA XREF: sub_42CFB392+B85\u2191o
.data:42D00D21                 align 4
.data:42D00D24 ; CHAR aOrgname_0[]
.data:42D00D24 aOrgname_0      db 'OrgName',0          ; DATA XREF: sub_42CFB392+BD5\u2191o
.data:42D00D2C ; char aS_11[]
.data:42D00D2C aS_11           db '@%s;',0             ; DATA XREF: sub_42CFB392+C08\u2191o
.data:42D00D31                 align 4
.data:42D00D34 ; CHAR aListeninfo_0[]
.data:42D00D34 aListeninfo_0   db 'ListenInfo',0       ; DATA XREF: sub_42CFB392+C62\u2191o
.data:42D00D3F                 align 10h
.data:42D00D40 ; char aSS_1[]
.data:42D00D40 aSS_1           db '%s,%s;',0           ; DATA XREF: sub_42CFB392+C8D\u2191o
.data:42D00D47                 align 4
.data:42D00D48 ; char asc_42D00D48[]
.data:42D00D48 asc_42D00D48    db ';',0                ; DATA XREF: sub_42CFB392:loc_42CFC0AB\u2191o
.data:42D00D4A                 align 4
.data:42D00D4C ; void *Src
.data:42D00D4C Src             dd offset aNegotiate    ; DATA XREF: sub_42CFC1D0+96\u2191r
.data:42D00D4C                                         ; sub_42CFC1D0+CB\u2191r
.data:42D00D4C                                         ; "negotiate"
.data:42D00D50                 dd offset aKerberos     ; "kerberos"
.data:42D00D54                 dd offset aNtlm         ; "ntlm"
.data:42D00D58 ; size_t dword_42D00D58
.data:42D00D58 dword_42D00D58  dd 0Ah                  ; DATA XREF: sub_42CFC1D0+C0\u2191r
.data:42D00D5C                 db    9
.data:42D00D5D                 db    0
.data:42D00D5E                 db    0
.data:42D00D5F                 db    0
.data:42D00D60                 db    5
.data:42D00D61                 db    0
.data:42D00D62                 db    0
.data:42D00D63                 db    0
.data:42D00D64 aNegotiate      db 'negotiate',0        ; DATA XREF: .data:Src\u2191o
.data:42D00D6E                 align 10h
.data:42D00D70 aKerberos       db 'kerberos',0         ; DATA XREF: .data:42D00D50\u2191o
.data:42D00D79                 align 4
.data:42D00D7C aNtlm           db 'ntlm',0             ; DATA XREF: .data:42D00D54\u2191o
.data:42D00D81                 align 4
.data:42D00D84 aSecurityDll_0  db 'security.dll',0     ; DATA XREF: sub_42CFC1D0+F\u2191o
.data:42D00D91                 align 4
.data:42D00D94 aSecur32Dll     db 'secur32.dll',0      ; DATA XREF: sub_42CFC1D0:loc_42CFC1E8\u2191o
.data:42D00DA0 ; CHAR aInitsecurityin_0[]
.data:42D00DA0 aInitsecurityin_0 db 'InitSecurityInterfaceA',0
.data:42D00DA0                                         ; DATA XREF: sub_42CFC1D0:loc_42CFC209\u2191o
.data:42D00DB7                 align 4
.data:42D00DB8 aMssqlsvc       db 'MSSQLSvc',0         ; DATA XREF: sub_42CFCA30+1B\u2191o
.data:42D00DC1                 align 4
.data:42D00DC4 ; char aSystem[]
.data:42D00DC4 aSystem         db 'SYSTEM',0           ; DATA XREF: sub_42CFCA5A+11B\u2191o
.data:42D00DCB                 align 4
.data:42D00DCC aDsbinda_0      db 'DsBindA',0
.data:42D00DD4 aDsbinda        db 'DsBindA',0          ; DATA XREF: sub_42CFCCDC+6\u2191o
.data:42D00DDC aDsunbinda_0    db 'DsUnBindA',0
.data:42D00DE6                 align 4
.data:42D00DE8 aDsunbinda      db 'DsUnBindA',0        ; DATA XREF: sub_42CFCCDC+D\u2191o
.data:42D00DF2                 align 4
.data:42D00DF4 aDsgetspna_0    db 'DsGetSpnA',0
.data:42D00DFE                 align 10h
.data:42D00E00 aDsgetspna      db 'DsGetSpnA',0        ; DATA XREF: sub_42CFCCDC+14\u2191o
.data:42D00E0A                 align 4
.data:42D00E0C aDsfreespnarray_0 db 'DsFreeSpnArrayA',0
.data:42D00E1C aDsfreespnarray db 'DsFreeSpnArrayA',0  ; DATA XREF: sub_42CFCCDC+1B\u2191o
.data:42D00E2C aDswriteaccount_0 db 'DsWriteAccountSpnA',0
.data:42D00E3F                 align 10h
.data:42D00E40 aDswriteaccount db 'DsWriteAccountSpnA',0
.data:42D00E40                                         ; DATA XREF: sub_42CFCCDC+22\u2191o
.data:42D00E53                 align 4
.data:42D00E54 aDsfreenameresu_0 db 'DsFreeNameResultA',0
.data:42D00E66                 align 4
.data:42D00E68 aDsfreenameresu db 'DsFreeNameResultA',0
.data:42D00E68                                         ; DATA XREF: sub_42CFCCDC+29\u2191o
.data:42D00E7A                 align 4
.data:42D00E7C aDscracknamesa_0 db 'DsCrackNamesA',0
.data:42D00E8A                 align 4
.data:42D00E8C aDscracknamesa  db 'DsCrackNamesA',0    ; DATA XREF: sub_42CFCCDC+30\u2191o
.data:42D00E9A                 align 4
.data:42D00E9C ; CHAR aNtdsapiDll[]
.data:42D00E9C aNtdsapiDll     db 'ntdsapi.dll',0      ; DATA XREF: sub_42CFCCDC+37\u2191o
.data:42D00EA8 ; CHAR aKernel32Dll_0[]
.data:42D00EA8 aKernel32Dll_0  db 'kernel32.dll',0     ; DATA XREF: sub_42CFCCDC+C6\u2191o
.data:42D00EB5                 align 4
.data:42D00EB8 ; CHAR aGetcomputernam[]
.data:42D00EB8 aGetcomputernam db 'GetComputerNameExA',0
.data:42D00EB8                                         ; DATA XREF: sub_42CFCCDC:loc_42CFCDC2\u2191o
.data:42D00ECB                 align 4
.data:42D00ECC ; CHAR aSecur32Dll_0[]
.data:42D00ECC aSecur32Dll_0   db 'secur32.dll',0      ; DATA XREF: sub_42CFCCDC+131\u2191o
.data:42D00ED8 ; CHAR aGetcomputerobj[]
.data:42D00ED8 aGetcomputerobj db 'GetComputerObjectNameA',0
.data:42D00ED8                                         ; DATA XREF: sub_42CFCCDC:loc_42CFCE2D\u2191o
.data:42D00EEF                 align 10h
.data:42D00EF0 ; CHAR aGetusernameexa[]
.data:42D00EF0 aGetusernameexa db 'GetUserNameExA',0   ; DATA XREF: sub_42CFCCDC+19C\u2191o
.data:42D00EFF                 align 10h
.data:42D00F00 ; CHAR aNetapi32Dll[]
.data:42D00F00 aNetapi32Dll    db 'netapi32.dll',0     ; DATA XREF: sub_42CFCCDC+1E7\u2191o
.data:42D00F0D                 align 10h
.data:42D00F10 ; CHAR aNetapibufferfr[]
.data:42D00F10 aNetapibufferfr db 'NetApiBufferFree',0 ; DATA XREF: sub_42CFCCDC:loc_42CFCEE3\u2191o
.data:42D00F21                 align 4
.data:42D00F24 ; CHAR aDsgetdcnamea[]
.data:42D00F24 aDsgetdcnamea   db 'DsGetDcNameA',0     ; DATA XREF: sub_42CFCCDC+24F\u2191o
.data:42D00F31                 align 4
.data:42D00F34 aLs:                                    ; DATA XREF: sub_42CFD6F0+12\u2191o
.data:42D00F34                 text "UTF-16LE", '%ls',0
.data:42D00F3C ; wchar_t aSqlServer
.data:42D00F3C aSqlServer:                             ; DATA XREF: sub_42CFD6F0:loc_42CFD6FD\u2191o
.data:42D00F3C                 text "UTF-16LE", 'SQL Server',0
.data:42D00F52                 align 4
.data:42D00F54 aInstancename:                          ; DATA XREF: sub_42CFD35A+A5\u2191o
.data:42D00F54                 text "UTF-16LE", 'InstanceName',0
.data:42D00F6E                 align 10h
.data:42D00F70 ; CHAR aClusapiDll[]
.data:42D00F70 aClusapiDll     db 'CLUSAPI.DLL',0      ; DATA XREF: sub_42CFD464+17\u2191o
.data:42D00F7C ; CHAR aOpencluster[]
.data:42D00F7C aOpencluster    db 'OpenCluster',0      ; DATA XREF: sub_42CFD464+37\u2191o
.data:42D00F88 ; CHAR aClosecluster[]
.data:42D00F88 aClosecluster   db 'CloseCluster',0     ; DATA XREF: sub_42CFD464:loc_42CFD4C0\u2191o
.data:42D00F95                 align 4
.data:42D00F98 ; CHAR aOpenclustergro[]
.data:42D00F98 aOpenclustergro db 'OpenClusterGroup',0 ; DATA XREF: sub_42CFD464:loc_42CFD4E5\u2191o
.data:42D00FA9                 align 4
.data:42D00FAC ; CHAR aCloseclustergr[]
.data:42D00FAC aCloseclustergr db 'CloseClusterGroup',0
.data:42D00FAC                                         ; DATA XREF: sub_42CFD464:loc_42CFD50A\u2191o
.data:42D00FBE                 align 10h
.data:42D00FC0 ; CHAR aOpenclusterres[]
.data:42D00FC0 aOpenclusterres db 'OpenClusterResource',0
.data:42D00FC0                                         ; DATA XREF: sub_42CFD464:loc_42CFD52F\u2191o
.data:42D00FD4 ; CHAR aGetclusterreso[]
.data:42D00FD4 aGetclusterreso db 'GetClusterResourceState',0
.data:42D00FD4                                         ; DATA XREF: sub_42CFD464:loc_42CFD554\u2191o
.data:42D00FEC ; CHAR aCloseclusterre[]
.data:42D00FEC aCloseclusterre db 'CloseClusterResource',0
.data:42D00FEC                                         ; DATA XREF: sub_42CFD464:loc_42CFD579\u2191o
.data:42D01001                 align 4
.data:42D01004 ; CHAR aClusteropenenu[]
.data:42D01004 aClusteropenenu db 'ClusterOpenEnum',0  ; DATA XREF: sub_42CFD464:loc_42CFD59E\u2191o
.data:42D01014 ; CHAR aClusterenum[]
.data:42D01014 aClusterenum    db 'ClusterEnum',0      ; DATA XREF: sub_42CFD464:loc_42CFD5C3\u2191o
.data:42D01020 ; CHAR aClustercloseen[]
.data:42D01020 aClustercloseen db 'ClusterCloseEnum',0 ; DATA XREF: sub_42CFD464:loc_42CFD5E8\u2191o
.data:42D01031                 align 4
.data:42D01034 ; CHAR aClusterresourc[]
.data:42D01034 aClusterresourc db 'ClusterResourceOpenEnum',0
.data:42D01034                                         ; DATA XREF: sub_42CFD464:loc_42CFD60D\u2191o
.data:42D0104C ; CHAR aClusterresourc_0[]
.data:42D0104C aClusterresourc_0 db 'ClusterResourceEnum',0
.data:42D0104C                                         ; DATA XREF: sub_42CFD464:loc_42CFD632\u2191o
.data:42D01060 ; CHAR aClusterresourc_1[]
.data:42D01060 aClusterresourc_1 db 'ClusterResourceCloseEnum',0
.data:42D01060                                         ; DATA XREF: sub_42CFD464:loc_42CFD657\u2191o
.data:42D01079                 align 4
.data:42D0107C ; CHAR aClusterresourc_2[]
.data:42D0107C aClusterresourc_2 db 'ClusterResourceControl',0
.data:42D0107C                                         ; DATA XREF: sub_42CFD464:loc_42CFD679\u2191o
.data:42D01093                 align 4
.data:42D01094 ; CHAR aResutilsDll[]
.data:42D01094 aResutilsDll    db 'RESUTILS.DLL',0     ; DATA XREF: sub_42CFD464:loc_42CFD6A1\u2191o
.data:42D010A1                 align 4
.data:42D010A4 ; CHAR aResutilfindszp[]
.data:42D010A4 aResutilfindszp db 'ResUtilFindSzProperty',0
.data:42D010A4                                         ; DATA XREF: sub_42CFD464+25A\u2191o
.data:42D010BA                 align 10h
.data:42D010C0 ; HANDLE CompletionPort
.data:42D010C0 CompletionPort  dd 0                    ; DATA XREF: DllEntryPoint+D7\u2191w
.data:42D010C0                                         ; DllEntryPoint:loc_42CF10E1\u2191r ...
.data:42D010C4 dword_42D010C4  dd 0                    ; DATA XREF: sub_42CF7930:loc_42CF79D1\u2191w
.data:42D010C8 ; HANDLE hEventLog
.data:42D010C8 hEventLog       dd 0                    ; DATA XREF: sub_42CF1197+6\u2191r
.data:42D010C8                                         ; sub_42CF1197+30\u2191r ...
.data:42D010CC ; DWORD cEvents
.data:42D010CC cEvents         dd 0                    ; DATA XREF: ConnectionListen:loc_42CF2084\u2191r
.data:42D010CC                                         ; ConnectionListen:loc_42CF20AD\u2191r ...
.data:42D010D0 dword_42D010D0  dd 0                    ; DATA XREF: ConnectionListen+1032\u2191w
.data:42D010D0                                         ; sub_42CF2BC5+1F9\u2191r ...
.data:42D010D4 ; SOCKET dword_42D010D4
.data:42D010D4 dword_42D010D4  dd 0                    ; DATA XREF: ConnectionListen+11C8\u2191r
.data:42D010D4                                         ; sub_42CF24E5+30\u2191r ...
.data:42D010D8 ; int dword_42D010D8
.data:42D010D8 dword_42D010D8  dd 0                    ; DATA XREF: ConnectionListen+10AD\u2191w
.data:42D010D8                                         ; sub_42CF5128+10B\u2191r ...
.data:42D010DC dword_42D010DC  dd 0                    ; DATA XREF: ConnectionListen+132\u2191w
.data:42D010DC                                         ; sub_42CF2BC5+1BB\u2191r
.data:42D010E0 dword_42D010E0  dd 0                    ; DATA XREF: ConnectionListen+1116\u2191w
.data:42D010E0                                         ; ConnectionClose:loc_42CF32C0\u2191r
.data:42D010E4 dword_42D010E4  dd 0                    ; DATA XREF: ConnectionListen+6E1\u2191r
.data:42D010E4                                         ; ConnectionListen+6E9\u2191w ...
.data:42D010E8 dword_42D010E8  dd 0                    ; DATA XREF: sub_42CF2424:loc_42CF2492\u2191w
.data:42D010E8                                         ; sub_42CF24E5:loc_42CF24F9\u2191r ...
.data:42D010EC word_42D010EC   dw 0                    ; DATA XREF: ConnectionListen+47\u2191r
.data:42D010EE                 align 10h
.data:42D010F0 byte_42D010F0   db 0                    ; DATA XREF: ConnectionListen+76\u2191r
.data:42D010F1                 align 4
.data:42D010F4 ; char Str2[4]
.data:42D010F4 Str2            db 4 dup(0)             ; DATA XREF: ConnectionListen+BC\u2191o
.data:42D010F8 unk_42D010F8    db    0                 ; DATA XREF: ConnectionListen+112A\u2191o
.data:42D010F9                 db    0
.data:42D010FA                 db    0
.data:42D010FB                 db    0
.data:42D010FC ; char byte_42D010FC[4]
.data:42D010FC byte_42D010FC   db 4 dup(0)             ; DATA XREF: ConnectionListen+116E\u2191o
.data:42D01100 unk_42D01100    db    0                 ; DATA XREF: ConnectionClose+EC\u2191o
.data:42D01101                 db    0
.data:42D01102                 db    0
.data:42D01103                 db    0
.data:42D01104 ; char byte_42D01104[4]
.data:42D01104 byte_42D01104   db 4 dup(0)             ; DATA XREF: sub_42CF6E4F+113\u2191o
.data:42D01108 unk_42D01108    db    0                 ; DATA XREF: sub_42CF7930+6A\u2191o
.data:42D01109                 db    0
.data:42D0110A                 db    0
.data:42D0110B                 db    0
.data:42D0110C                 db    0
.data:42D0110D                 db    0
.data:42D0110E                 db    0
.data:42D0110F                 db    0
.data:42D01110                 db    0
.data:42D01111                 db    0
.data:42D01112                 db    0
.data:42D01113                 db    0
.data:42D01114 dword_42D01114  dd 0                    ; DATA XREF: sub_42CF7A27+146\u2191r
.data:42D01118                 db    0
.data:42D01119                 db    0
.data:42D0111A                 db    0
.data:42D0111B                 db    0
.data:42D0111C                 db    0
.data:42D0111D                 db    0
.data:42D0111E                 db    0
.data:42D0111F                 db    0
.data:42D01120                 db    0
.data:42D01121                 db    0
.data:42D01122                 db    0
.data:42D01123                 db    0
.data:42D01124 dword_42D01124  dd 0                    ; DATA XREF: sub_42CF7F6F+F6\u2191r
.data:42D01128                 db    0
.data:42D01129                 db    0
.data:42D0112A                 db    0
.data:42D0112B                 db    0
.data:42D0112C dword_42D0112C  dd 0                    ; DATA XREF: sub_42CF7F60+7\u2191r
.data:42D01130                 db    0
.data:42D01131                 db    0
.data:42D01132                 db    0
.data:42D01133                 db    0
.data:42D01134 dword_42D01134  dd 0                    ; DATA XREF: sub_42CF7E2C+D\u2191r
.data:42D01138                 db    0
.data:42D01139                 db    0
.data:42D0113A                 db    0
.data:42D0113B                 db    0
.data:42D0113C                 db    0
.data:42D0113D                 db    0
.data:42D0113E                 db    0
.data:42D0113F                 db    0
.data:42D01140                 db    0
.data:42D01141                 db    0
.data:42D01142                 db    0
.data:42D01143                 db    0
.data:42D01144                 db    0
.data:42D01145                 db    0
.data:42D01146                 db    0
.data:42D01147                 db    0
.data:42D01148 dword_42D01148  dd 0                    ; DATA XREF: sub_42CF7A27+18C\u2191r
.data:42D01148                                         ; sub_42CF7F6F+1F5\u2191r
.data:42D0114C dword_42D0114C  dd 0                    ; DATA XREF: sub_42CF7A27+173\u2191r
.data:42D01150 dword_42D01150  dd 0                    ; DATA XREF: sub_42CF7930+95\u2191r
.data:42D01154 dword_42D01154  dd 0                    ; DATA XREF: sub_42CF7930+8B\u2191r
.data:42D01158                 db    0
.data:42D01159                 db    0
.data:42D0115A                 db    0
.data:42D0115B                 db    0
.data:42D0115C                 db    0
.data:42D0115D                 db    0
.data:42D0115E                 db    0
.data:42D0115F                 db    0
.data:42D01160                 db    0
.data:42D01161                 db    0
.data:42D01162                 db    0
.data:42D01163                 db    0
.data:42D01164                 db    0
.data:42D01165                 db    0
.data:42D01166                 db    0
.data:42D01167                 db    0
.data:42D01168                 db    0
.data:42D01169                 db    0
.data:42D0116A                 db    0
.data:42D0116B                 db    0
.data:42D0116C dword_42D0116C  dd 0                    ; DATA XREF: sub_42CF7D75+78\u2191r
.data:42D01170 dword_42D01170  dd 0                    ; DATA XREF: sub_42CF7BBF+71\u2191r
.data:42D01170                                         ; sub_42CF7BBF+123\u2191r
.data:42D01174                 align 8
.data:42D01178 dword_42D01178  dd 0                    ; DATA XREF: sub_42CF7A27+164\u2191r
.data:42D01178                                         ; sub_42CF7E41+C5\u2191o
.data:42D0117C dword_42D0117C  dd 0                    ; DATA XREF: sub_42CF7A27+7D\u2191r
.data:42D0117C                                         ; sub_42CF7A27+BF\u2191r
.data:42D01180 dword_42D01180  dd 0                    ; DATA XREF: sub_42CF7A27+4B\u2191r
.data:42D01180                                         ; sub_42CF7A27+93\u2191r
.data:42D01184 dword_42D01184  dd 0                    ; DATA XREF: sub_42CF7A27+39\u2191r
.data:42D01188                 db    0
.data:42D01189                 db    0
.data:42D0118A                 db    0
.data:42D0118B                 db    0
.data:42D0118C                 db    0
.data:42D0118D                 db    0
.data:42D0118E                 db    0
.data:42D0118F                 db    0
.data:42D01190                 db    0
.data:42D01191                 db    0
.data:42D01192                 db    0
.data:42D01193                 db    0
.data:42D01194                 db    0
.data:42D01195                 db    0
.data:42D01196                 db    0
.data:42D01197                 db    0
.data:42D01198                 db    0
.data:42D01199                 db    0
.data:42D0119A                 db    0
.data:42D0119B                 db    0
.data:42D0119C                 db    0
.data:42D0119D                 db    0
.data:42D0119E                 db    0
.data:42D0119F                 db    0
.data:42D011A0                 db    0
.data:42D011A1                 db    0
.data:42D011A2                 db    0
.data:42D011A3                 db    0
.data:42D011A4 ; HMODULE dword_42D011A4
.data:42D011A4 dword_42D011A4  dd 0                    ; DATA XREF: sub_42CF7930+29\u2191w
.data:42D011A4                                         ; sub_42CF7930+2E\u2191r ...
.data:42D011A8 ; char byte_42D011A8[4]
.data:42D011A8 byte_42D011A8   db 4 dup(0)             ; DATA XREF: sub_42CF8300+1E6\u2191o
.data:42D011AC ; char byte_42D011AC[4]
.data:42D011AC byte_42D011AC   db 4 dup(0)             ; DATA XREF: sub_42CF8300:loc_42CF8659\u2191o
.data:42D011B0 ; char byte_42D011B0[4]
.data:42D011B0 byte_42D011B0   db 4 dup(0)             ; DATA XREF: sub_42CF8300+44D\u2191o
.data:42D011B4 ; char byte_42D011B4[4]
.data:42D011B4 byte_42D011B4   db 4 dup(0)             ; DATA XREF: sub_42CF8300+AA5\u2191o
.data:42D011B8 unk_42D011B8    db    0                 ; DATA XREF: sub_42CF9388+18\u2191o
.data:42D011B9                 db    0
.data:42D011BA                 db    0
.data:42D011BB                 db    0
.data:42D011BC ; char byte_42D011BC[4]
.data:42D011BC byte_42D011BC   db 4 dup(0)             ; DATA XREF: sub_42CF9388:loc_42CF9430\u2191o
.data:42D011C0 byte_42D011C0   db 0                    ; DATA XREF: sub_42CF9388:loc_42CF9613\u2191r
.data:42D011C1                 align 4
.data:42D011C4 byte_42D011C4   db 0                    ; DATA XREF: sub_42CF9388+378\u2191r
.data:42D011C5                 align 4
.data:42D011C8 ; char byte_42D011C8[4]
.data:42D011C8 byte_42D011C8   db 4 dup(0)             ; DATA XREF: sub_42CF9388:loc_42CF9786\u2191o
.data:42D011CC byte_42D011CC   db 0                    ; DATA XREF: sub_42CF9A35+E\u2191r
.data:42D011CD                 align 10h
.data:42D011D0 ; char byte_42D011D0[4]
.data:42D011D0 byte_42D011D0   db 4 dup(0)             ; DATA XREF: sub_42CF9A35+115\u2191o
.data:42D011D4 ; char byte_42D011D4[4]
.data:42D011D4 byte_42D011D4   db 4 dup(0)             ; DATA XREF: sub_42CF9A35:loc_42CF9BF3\u2191o
.data:42D011D8 ; char byte_42D011D8[4]
.data:42D011D8 byte_42D011D8   db 4 dup(0)             ; DATA XREF: sub_42CF9D87+16\u2191o
.data:42D011DC ; SOCKET dword_42D011DC
.data:42D011DC dword_42D011DC  dd 0                    ; DATA XREF: StartAddress+33\u2191r
.data:42D011DC                                         ; StartAddress+BF\u2191r ...
.data:42D011E0 ; char Str1[4]
.data:42D011E0 Str1            db 4 dup(0)             ; DATA XREF: StartAddress+23B\u2191o
.data:42D011E4 byte_42D011E4   db 0                    ; DATA XREF: sub_42CFA2CE+A\u2191r
.data:42D011E5                 align 4
.data:42D011E8 ; char byte_42D011E8[4]
.data:42D011E8 byte_42D011E8   db 4 dup(0)             ; DATA XREF: sub_42CFA2CE+81\u2191o
.data:42D011EC ; char byte_42D011EC[4]
.data:42D011EC byte_42D011EC   db 4 dup(0)             ; DATA XREF: sub_42CFA64E+79\u2191o
.data:42D011F0 ; char byte_42D011F0[4]
.data:42D011F0 byte_42D011F0   db 4 dup(0)             ; DATA XREF: sub_42CFA94D+24\u2191o
.data:42D011F4 ; char byte_42D011F4[4]
.data:42D011F4 byte_42D011F4   db 4 dup(0)             ; DATA XREF: sub_42CFA94D+75\u2191o
.data:42D011F8 ; char byte_42D011F8[4]
.data:42D011F8 byte_42D011F8   db 4 dup(0)             ; DATA XREF: sub_42CFAD0B:loc_42CFADC4\u2191o
.data:42D011FC ; char byte_42D011FC[4]
.data:42D011FC byte_42D011FC   db 4 dup(0)             ; DATA XREF: sub_42CFAD0B+266\u2191o
.data:42D01200 ; char byte_42D01200[4]
.data:42D01200 byte_42D01200   db 4 dup(0)             ; DATA XREF: sub_42CFB392+61\u2191o
.data:42D01204 ; char byte_42D01204[4]
.data:42D01204 byte_42D01204   db 4 dup(0)             ; DATA XREF: sub_42CFB392:loc_42CFB51A\u2191o
.data:42D01208 ; char byte_42D01208[4]
.data:42D01208 byte_42D01208   db 4 dup(0)             ; DATA XREF: sub_42CFB392:loc_42CFB8B8\u2191o
.data:42D0120C dword_42D0120C  dd 0                    ; DATA XREF: sub_42CFC1D0+5B\u2191w
.data:42D0120C                                         ; sub_42CFC1D0+60\u2191r ...
.data:42D01210 unk_42D01210    db    0                 ; DATA XREF: sub_42CFC1D0+D3\u2191o
.data:42D01210                                         ; sub_42CFC325+2E\u2191o
.data:42D01211                 db    0
.data:42D01212                 db    0
.data:42D01213                 db    0
.data:42D01214                 db    0
.data:42D01215                 db    0
.data:42D01216                 db    0
.data:42D01217                 db    0
.data:42D01218                 db    0
.data:42D01219                 db    0
.data:42D0121A                 db    0
.data:42D0121B                 db    0
.data:42D0121C                 db    0
.data:42D0121D                 db    0
.data:42D0121E                 db    0
.data:42D0121F                 db    0
.data:42D01220 dword_42D01220  dd 0                    ; DATA XREF: sub_42CFCA5A+C4\u2191r
.data:42D01220                                         ; sub_42CFCCDC+B9\u2191o
.data:42D01224 dword_42D01224  dd 0                    ; DATA XREF: sub_42CFCA5A+250\u2191r
.data:42D01228 dword_42D01228  dd 0                    ; DATA XREF: sub_42CFCA30+22\u2191r
.data:42D0122C dword_42D0122C  dd 0                    ; DATA XREF: sub_42CFCA5A+267\u2191r
.data:42D01230 dword_42D01230  dd 0                    ; DATA XREF: sub_42CFCA5A+23D\u2191r
.data:42D01234 dword_42D01234  dd 0                    ; DATA XREF: sub_42CFCA5A+1E4\u2191r
.data:42D01238 dword_42D01238  dd 0                    ; DATA XREF: sub_42CFCA5A+18F\u2191r
.data:42D0123C                 align 10h
.data:42D01240 ; WCHAR WideCharStr
.data:42D01240 WideCharStr     dw 0                    ; DATA XREF: sub_42CFCFE0+3\u2191o
.data:42D01240                                         ; sub_42CFCFEA+46\u2191o
.data:42D01242                 db    0
.data:42D01243                 db    0
.data:42D01244                 db    0
.data:42D01245                 db    0
.data:42D01246                 db    0
.data:42D01247                 db    0
.data:42D01248                 db    0
.data:42D01249                 db    0
.data:42D0124A                 db    0
.data:42D0124B                 db    0
.data:42D0124C                 db    0
.data:42D0124D                 db    0
.data:42D0124E                 db    0
.data:42D0124F                 db    0
.data:42D01250                 db    0
.data:42D01251                 db    0
.data:42D01252                 db    0
.data:42D01253                 db    0
.data:42D01254                 db    0
.data:42D01255                 db    0
.data:42D01256                 db    0
.data:42D01257                 db    0
.data:42D01258                 db    0
.data:42D01259                 db    0
.data:42D0125A                 db    0
.data:42D0125B                 db    0
.data:42D0125C                 db    0
.data:42D0125D                 db    0
.data:42D0125E                 db    0
.data:42D0125F                 db    0
.data:42D01260                 db    0
.data:42D01261                 db    0
.data:42D01262                 db    0
.data:42D01263                 db    0
.data:42D01264                 db    0
.data:42D01265                 db    0
.data:42D01266                 db    0
.data:42D01267                 db    0
.data:42D01268                 db    0
.data:42D01269                 db    0
.data:42D0126A                 db    0
.data:42D0126B                 db    0
.data:42D0126C                 db    0
.data:42D0126D                 db    0
.data:42D0126E                 db    0
.data:42D0126F                 db    0
.data:42D01270                 db    0
.data:42D01271                 db    0
.data:42D01272                 db    0
.data:42D01273                 db    0
.data:42D01274                 db    0
.data:42D01275                 db    0
.data:42D01276                 db    0
.data:42D01277                 db    0
.data:42D01278                 db    0
.data:42D01279                 db    0
.data:42D0127A                 db    0
.data:42D0127B                 db    0
.data:42D0127C                 db    0
.data:42D0127D                 db    0
.data:42D0127E                 db    0
.data:42D0127F                 db    0
.data:42D01280                 db    0
.data:42D01281                 db    0
.data:42D01282                 db    0
.data:42D01283                 db    0
.data:42D01284                 db    0
.data:42D01285                 db    0
.data:42D01286                 db    0
.data:42D01287                 db    0
.data:42D01288                 db    0
.data:42D01289                 db    0
.data:42D0128A                 db    0
.data:42D0128B                 db    0
.data:42D0128C                 db    0
.data:42D0128D                 db    0
.data:42D0128E                 db    0
.data:42D0128F                 db    0
.data:42D01290                 db    0
.data:42D01291                 db    0
.data:42D01292                 db    0
.data:42D01293                 db    0
.data:42D01294                 db    0
.data:42D01295                 db    0
.data:42D01296                 db    0
.data:42D01297                 db    0
.data:42D01298                 db    0
.data:42D01299                 db    0
.data:42D0129A                 db    0
.data:42D0129B                 db    0
.data:42D0129C                 db    0
.data:42D0129D                 db    0
.data:42D0129E                 db    0
.data:42D0129F                 db    0
.data:42D012A0                 db    0
.data:42D012A1                 db    0
.data:42D012A2                 db    0
.data:42D012A3                 db    0
.data:42D012A4                 db    0
.data:42D012A5                 db    0
.data:42D012A6                 db    0
.data:42D012A7                 db    0
.data:42D012A8                 db    0
.data:42D012A9                 db    0
.data:42D012AA                 db    0
.data:42D012AB                 db    0
.data:42D012AC                 db    0
.data:42D012AD                 db    0
.data:42D012AE                 db    0
.data:42D012AF                 db    0
.data:42D012B0                 db    0
.data:42D012B1                 db    0
.data:42D012B2                 db    0
.data:42D012B3                 db    0
.data:42D012B4                 db    0
.data:42D012B5                 db    0
.data:42D012B6                 db    0
.data:42D012B7                 db    0
.data:42D012B8                 db    0
.data:42D012B9                 db    0
.data:42D012BA                 db    0
.data:42D012BB                 db    0
.data:42D012BC                 db    0
.data:42D012BD                 db    0
.data:42D012BE                 db    0
.data:42D012BF                 db    0
.data:42D012C0                 db    0
.data:42D012C1                 db    0
.data:42D012C2                 db    0
.data:42D012C3                 db    0
.data:42D012C4                 db    0
.data:42D012C5                 db    0
.data:42D012C6                 db    0
.data:42D012C7                 db    0
.data:42D012C8                 db    0
.data:42D012C9                 db    0
.data:42D012CA                 db    0
.data:42D012CB                 db    0
.data:42D012CC                 db    0
.data:42D012CD                 db    0
.data:42D012CE                 db    0
.data:42D012CF                 db    0
.data:42D012D0                 db    0
.data:42D012D1                 db    0
.data:42D012D2                 db    0
.data:42D012D3                 db    0
.data:42D012D4                 db    0
.data:42D012D5                 db    0
.data:42D012D6                 db    0
.data:42D012D7                 db    0
.data:42D012D8                 db    0
.data:42D012D9                 db    0
.data:42D012DA                 db    0
.data:42D012DB                 db    0
.data:42D012DC                 db    0
.data:42D012DD                 db    0
.data:42D012DE                 db    0
.data:42D012DF                 db    0
.data:42D012E0                 db    0
.data:42D012E1                 db    0
.data:42D012E2                 db    0
.data:42D012E3                 db    0
.data:42D012E4                 db    0
.data:42D012E5                 db    0
.data:42D012E6                 db    0
.data:42D012E7                 db    0
.data:42D012E8                 db    0
.data:42D012E9                 db    0
.data:42D012EA                 db    0
.data:42D012EB                 db    0
.data:42D012EC                 db    0
.data:42D012ED                 db    0
.data:42D012EE                 db    0
.data:42D012EF                 db    0
.data:42D012F0                 db    0
.data:42D012F1                 db    0
.data:42D012F2                 db    0
.data:42D012F3                 db    0
.data:42D012F4                 db    0
.data:42D012F5                 db    0
.data:42D012F6                 db    0
.data:42D012F7                 db    0
.data:42D012F8                 db    0
.data:42D012F9                 db    0
.data:42D012FA                 db    0
.data:42D012FB                 db    0
.data:42D012FC                 db    0
.data:42D012FD                 db    0
.data:42D012FE                 db    0
.data:42D012FF                 db    0
.data:42D01300                 db    0
.data:42D01301                 db    0
.data:42D01302                 db    0
.data:42D01303                 db    0
.data:42D01304                 db    0
.data:42D01305                 db    0
.data:42D01306                 db    0
.data:42D01307                 db    0
.data:42D01308                 db    0
.data:42D01309                 db    0
.data:42D0130A                 db    0
.data:42D0130B                 db    0
.data:42D0130C                 db    0
.data:42D0130D                 db    0
.data:42D0130E                 db    0
.data:42D0130F                 db    0
.data:42D01310                 db    0
.data:42D01311                 db    0
.data:42D01312                 db    0
.data:42D01313                 db    0
.data:42D01314                 db    0
.data:42D01315                 db    0
.data:42D01316                 db    0
.data:42D01317                 db    0
.data:42D01318                 db    0
.data:42D01319                 db    0
.data:42D0131A                 db    0
.data:42D0131B                 db    0
.data:42D0131C                 db    0
.data:42D0131D                 db    0
.data:42D0131E                 db    0
.data:42D0131F                 db    0
.data:42D01320                 db    0
.data:42D01321                 db    0
.data:42D01322                 db    0
.data:42D01323                 db    0
.data:42D01324                 db    0
.data:42D01325                 db    0
.data:42D01326                 db    0
.data:42D01327                 db    0
.data:42D01328                 db    0
.data:42D01329                 db    0
.data:42D0132A                 db    0
.data:42D0132B                 db    0
.data:42D0132C                 db    0
.data:42D0132D                 db    0
.data:42D0132E                 db    0
.data:42D0132F                 db    0
.data:42D01330                 db    0
.data:42D01331                 db    0
.data:42D01332                 db    0
.data:42D01333                 db    0
.data:42D01334                 db    0
.data:42D01335                 db    0
.data:42D01336                 db    0
.data:42D01337                 db    0
.data:42D01338                 db    0
.data:42D01339                 db    0
.data:42D0133A                 db    0
.data:42D0133B                 db    0
.data:42D0133C                 db    0
.data:42D0133D                 db    0
.data:42D0133E                 db    0
.data:42D0133F                 db    0
.data:42D01340                 db    0
.data:42D01341                 db    0
.data:42D01342                 db    0
.data:42D01343                 db    0
.data:42D01344                 db    0
.data:42D01345                 db    0
.data:42D01346                 db    0
.data:42D01347                 db    0
.data:42D01348                 db    0
.data:42D01349                 db    0
.data:42D0134A                 db    0
.data:42D0134B                 db    0
.data:42D0134C                 db    0
.data:42D0134D                 db    0
.data:42D0134E                 db    0
.data:42D0134F                 db    0
.data:42D01350                 db    0
.data:42D01351                 db    0
.data:42D01352                 db    0
.data:42D01353                 db    0
.data:42D01354                 db    0
.data:42D01355                 db    0
.data:42D01356                 db    0
.data:42D01357                 db    0
.data:42D01358                 db    0
.data:42D01359                 db    0
.data:42D0135A                 db    0
.data:42D0135B                 db    0
.data:42D0135C                 db    0
.data:42D0135D                 db    0
.data:42D0135E                 db    0
.data:42D0135F                 db    0
.data:42D01360                 db    0
.data:42D01361                 db    0
.data:42D01362                 db    0
.data:42D01363                 db    0
.data:42D01364                 db    0
.data:42D01365                 db    0
.data:42D01366                 db    0
.data:42D01367                 db    0
.data:42D01368                 db    0
.data:42D01369                 db    0
.data:42D0136A                 db    0
.data:42D0136B                 db    0
.data:42D0136C                 db    0
.data:42D0136D                 db    0
.data:42D0136E                 db    0
.data:42D0136F                 db    0
.data:42D01370                 db    0
.data:42D01371                 db    0
.data:42D01372                 db    0
.data:42D01373                 db    0
.data:42D01374                 db    0
.data:42D01375                 db    0
.data:42D01376                 db    0
.data:42D01377                 db    0
.data:42D01378                 db    0
.data:42D01379                 db    0
.data:42D0137A                 db    0
.data:42D0137B                 db    0
.data:42D0137C                 db    0
.data:42D0137D                 db    0
.data:42D0137E                 db    0
.data:42D0137F                 db    0
.data:42D01380                 db    0
.data:42D01381                 db    0
.data:42D01382                 db    0
.data:42D01383                 db    0
.data:42D01384                 db    0
.data:42D01385                 db    0
.data:42D01386                 db    0
.data:42D01387                 db    0
.data:42D01388                 db    0
.data:42D01389                 db    0
.data:42D0138A                 db    0
.data:42D0138B                 db    0
.data:42D0138C                 db    0
.data:42D0138D                 db    0
.data:42D0138E                 db    0
.data:42D0138F                 db    0
.data:42D01390                 db    0
.data:42D01391                 db    0
.data:42D01392                 db    0
.data:42D01393                 db    0
.data:42D01394                 db    0
.data:42D01395                 db    0
.data:42D01396                 db    0
.data:42D01397                 db    0
.data:42D01398                 db    0
.data:42D01399                 db    0
.data:42D0139A                 db    0
.data:42D0139B                 db    0
.data:42D0139C                 db    0
.data:42D0139D                 db    0
.data:42D0139E                 db    0
.data:42D0139F                 db    0
.data:42D013A0                 db    0
.data:42D013A1                 db    0
.data:42D013A2                 db    0
.data:42D013A3                 db    0
.data:42D013A4                 db    0
.data:42D013A5                 db    0
.data:42D013A6                 db    0
.data:42D013A7                 db    0
.data:42D013A8                 db    0
.data:42D013A9                 db    0
.data:42D013AA                 db    0
.data:42D013AB                 db    0
.data:42D013AC                 db    0
.data:42D013AD                 db    0
.data:42D013AE                 db    0
.data:42D013AF                 db    0
.data:42D013B0                 db    0
.data:42D013B1                 db    0
.data:42D013B2                 db    0
.data:42D013B3                 db    0
.data:42D013B4                 db    0
.data:42D013B5                 db    0
.data:42D013B6                 db    0
.data:42D013B7                 db    0
.data:42D013B8                 db    0
.data:42D013B9                 db    0
.data:42D013BA                 db    0
.data:42D013BB                 db    0
.data:42D013BC                 db    0
.data:42D013BD                 db    0
.data:42D013BE                 db    0
.data:42D013BF                 db    0
.data:42D013C0                 db    0
.data:42D013C1                 db    0
.data:42D013C2                 db    0
.data:42D013C3                 db    0
.data:42D013C4                 db    0
.data:42D013C5                 db    0
.data:42D013C6                 db    0
.data:42D013C7                 db    0
.data:42D013C8                 db    0
.data:42D013C9                 db    0
.data:42D013CA                 db    0
.data:42D013CB                 db    0
.data:42D013CC                 db    0
.data:42D013CD                 db    0
.data:42D013CE                 db    0
.data:42D013CF                 db    0
.data:42D013D0                 db    0
.data:42D013D1                 db    0
.data:42D013D2                 db    0
.data:42D013D3                 db    0
.data:42D013D4                 db    0
.data:42D013D5                 db    0
.data:42D013D6                 db    0
.data:42D013D7                 db    0
.data:42D013D8                 db    0
.data:42D013D9                 db    0
.data:42D013DA                 db    0
.data:42D013DB                 db    0
.data:42D013DC                 db    0
.data:42D013DD                 db    0
.data:42D013DE                 db    0
.data:42D013DF                 db    0
.data:42D013E0                 db    0
.data:42D013E1                 db    0
.data:42D013E2                 db    0
.data:42D013E3                 db    0
.data:42D013E4                 db    0
.data:42D013E5                 db    0
.data:42D013E6                 db    0
.data:42D013E7                 db    0
.data:42D013E8                 db    0
.data:42D013E9                 db    0
.data:42D013EA                 db    0
.data:42D013EB                 db    0
.data:42D013EC                 db    0
.data:42D013ED                 db    0
.data:42D013EE                 db    0
.data:42D013EF                 db    0
.data:42D013F0                 db    0
.data:42D013F1                 db    0
.data:42D013F2                 db    0
.data:42D013F3                 db    0
.data:42D013F4                 db    0
.data:42D013F5                 db    0
.data:42D013F6                 db    0
.data:42D013F7                 db    0
.data:42D013F8                 db    0
.data:42D013F9                 db    0
.data:42D013FA                 db    0
.data:42D013FB                 db    0
.data:42D013FC                 db    0
.data:42D013FD                 db    0
.data:42D013FE                 db    0
.data:42D013FF                 db    0
.data:42D01400                 db    0
.data:42D01401                 db    0
.data:42D01402                 db    0
.data:42D01403                 db    0
.data:42D01404                 db    0
.data:42D01405                 db    0
.data:42D01406                 db    0
.data:42D01407                 db    0
.data:42D01408                 db    0
.data:42D01409                 db    0
.data:42D0140A                 db    0
.data:42D0140B                 db    0
.data:42D0140C                 db    0
.data:42D0140D                 db    0
.data:42D0140E                 db    0
.data:42D0140F                 db    0
.data:42D01410                 db    0
.data:42D01411                 db    0
.data:42D01412                 db    0
.data:42D01413                 db    0
.data:42D01414                 db    0
.data:42D01415                 db    0
.data:42D01416                 db    0
.data:42D01417                 db    0
.data:42D01418                 db    0
.data:42D01419                 db    0
.data:42D0141A                 db    0
.data:42D0141B                 db    0
.data:42D0141C                 db    0
.data:42D0141D                 db    0
.data:42D0141E                 db    0
.data:42D0141F                 db    0
.data:42D01420                 db    0
.data:42D01421                 db    0
.data:42D01422                 db    0
.data:42D01423                 db    0
.data:42D01424                 db    0
.data:42D01425                 db    0
.data:42D01426                 db    0
.data:42D01427                 db    0
.data:42D01428                 db    0
.data:42D01429                 db    0
.data:42D0142A                 db    0
.data:42D0142B                 db    0
.data:42D0142C                 db    0
.data:42D0142D                 db    0
.data:42D0142E                 db    0
.data:42D0142F                 db    0
.data:42D01430                 db    0
.data:42D01431                 db    0
.data:42D01432                 db    0
.data:42D01433                 db    0
.data:42D01434                 db    0
.data:42D01435                 db    0
.data:42D01436                 db    0
.data:42D01437                 db    0
.data:42D01438                 db    0
.data:42D01439                 db    0
.data:42D0143A                 db    0
.data:42D0143B                 db    0
.data:42D0143C                 db    0
.data:42D0143D                 db    0
.data:42D0143E                 db    0
.data:42D0143F                 db    0
.data:42D01440 ; HMODULE dword_42D01440
.data:42D01440 dword_42D01440  dd 0                    ; DATA XREF: sub_42CFCFEA+21\u2191o
.data:42D01440                                         ; sub_42CFCFEA:loc_42CFD0FA\u2191r ...
.data:42D01444 dword_42D01444  dd 0                    ; DATA XREF: sub_42CFCFEA+5D\u2191r
.data:42D01448                 db    0
.data:42D01449                 db    0
.data:42D0144A                 db    0
.data:42D0144B                 db    0
.data:42D0144C                 db    0
.data:42D0144D                 db    0
.data:42D0144E                 db    0
.data:42D0144F                 db    0
.data:42D01450                 db    0
.data:42D01451                 db    0
.data:42D01452                 db    0
.data:42D01453                 db    0
.data:42D01454 dword_42D01454  dd 0                    ; DATA XREF: sub_42CFD12F+BC\u2191r
.data:42D01458 dword_42D01458  dd 0                    ; DATA XREF: sub_42CFCFEA+BF\u2191r
.data:42D0145C dword_42D0145C  dd 0                    ; DATA XREF: sub_42CFD12F+107\u2191r
.data:42D01460 dword_42D01460  dd 0                    ; DATA XREF: sub_42CFD12F+21\u2191r
.data:42D01464 dword_42D01464  dd 0                    ; DATA XREF: sub_42CFD12F+60\u2191r
.data:42D01464                                         ; sub_42CFD12F+A3\u2191r
.data:42D01468 dword_42D01468  dd 0                    ; DATA XREF: sub_42CFD12F+136\u2191r
.data:42D0146C                 db    0
.data:42D0146D                 db    0
.data:42D0146E                 db    0
.data:42D0146F                 db    0
.data:42D01470                 db    0
.data:42D01471                 db    0
.data:42D01472                 db    0
.data:42D01473                 db    0
.data:42D01474                 db    0
.data:42D01475                 db    0
.data:42D01476                 db    0
.data:42D01477                 db    0
.data:42D01478 dword_42D01478  dd 0                    ; DATA XREF: sub_42CFD272+31\u2191r
.data:42D01478                                         ; sub_42CFD272+7D\u2191r ...
.data:42D0147C ; HMODULE dword_42D0147C
.data:42D0147C dword_42D0147C  dd 0                    ; DATA XREF: sub_42CFCFEA:loc_42CFD10F\u2191r
.data:42D0147C                                         ; sub_42CFCFEA+12E\u2191r
.data:42D01480 dword_42D01480  dd 0                    ; DATA XREF: sub_42CFD35A+B2\u2191r
.data:42D01484 ; HMODULE dword_42D01484
.data:42D01484 dword_42D01484  dd 0                    ; DATA XREF: sub_42CFCCDC+13C\u2191w
.data:42D01484                                         ; sub_42CFCCDC+141\u2191r ...
.data:42D01488 dword_42D01488  dd 0                    ; DATA XREF: sub_42CFCA5A+E8\u2191r
.data:42D01488                                         ; sub_42CFCCDC+242\u2191o
.data:42D0148C dword_42D0148C  dd 0                    ; DATA XREF: sub_42CFCA30+11\u2191r
.data:42D0148C                                         ; sub_42CFCA5A+3D\u2191w
.data:42D01490 dword_42D01490  dd 0                    ; DATA XREF: sub_42CFCA5A+152\u2191r
.data:42D01490                                         ; sub_42CFCCDC+1DA\u2191o
.data:42D01494 dword_42D01494  dd 0                    ; DATA XREF: sub_42CFCA5A+1F9\u2191r
.data:42D01494                                         ; sub_42CFCCDC+18F\u2191o
.data:42D01498 dword_42D01498  dd 0                    ; DATA XREF: sub_42CFCA5A+94\u2191r
.data:42D01498                                         ; sub_42CFCCDC+28A\u2191o
.data:42D0149C unk_42D0149C    db    0                 ; DATA XREF: sub_42CFCCDC+124\u2191o
.data:42D0149D                 db    0
.data:42D0149E                 db    0
.data:42D0149F                 db    0
.data:42D014A0 ; HMODULE dword_42D014A0
.data:42D014A0 dword_42D014A0  dd 0                    ; DATA XREF: sub_42CFCCDC+42\u2191w
.data:42D014A0                                         ; sub_42CFCCDC+47\u2191r ...
.data:42D014A4 ; HMODULE dword_42D014A4
.data:42D014A4 dword_42D014A4  dd 0                    ; DATA XREF: sub_42CFCCDC+D1\u2191w
.data:42D014A4                                         ; sub_42CFCCDC+D6\u2191r ...
.data:42D014A8 ; HMODULE dword_42D014A8
.data:42D014A8 dword_42D014A8  dd 0                    ; DATA XREF: sub_42CFCCDC+1F2\u2191w
.data:42D014A8                                         ; sub_42CFCCDC+1F7\u2191r ...
.data:42D014AC                 align 20h
.data:42D014C0 dword_42D014C0  dd 0                    ; DATA XREF: sub_42CFC5E0+7\u2191o
.data:42D014C0                                         ; sub_42CFC5E0+B0\u2191w ...
.data:42D014C4 ; DWORD dword_42D014C4
.data:42D014C4 dword_42D014C4  dd 0                    ; DATA XREF: sub_42CFC5E0+95\u2191o
.data:42D014C8 ; HANDLE dword_42D014C8
.data:42D014C8 dword_42D014C8  dd 0                    ; DATA XREF: sub_42CFC5E0+22\u2191w
.data:42D014C8                                         ; sub_42CFC5E0+27\u2191r ...
.data:42D014CC ; HANDLE dword_42D014CC
.data:42D014CC dword_42D014CC  dd 0                    ; DATA XREF: sub_42CFC5E0+3F\u2191w
.data:42D014CC                                         ; sub_42CFC6C2+1F6\u2191r ...
.data:42D014D0 ; HANDLE dword_42D014D0
.data:42D014D0 dword_42D014D0  dd 0                    ; DATA XREF: sub_42CFC5E0+52\u2191w
.data:42D014D0                                         ; sub_42CFC6C2+20C\u2191r ...
.data:42D014D4 dword_42D014D4  dd 0                    ; DATA XREF: sub_42CFC5E0+57\u2191w
.data:42D014D4                                         ; sub_42CFC6C2+203\u2191r ...
.data:42D014D8 ; char Destination[48]
.data:42D014D8 Destination     db 30h dup(0)           ; DATA XREF: sub_42CFC5E0+7F\u2191o
.data:42D014D8                                         ; sub_42CFC6C2+14D\u2191o
.data:42D01508 word_42D01508   dw 0                    ; DATA XREF: sub_42CFC5E0+67\u2191w
.data:42D01508                                         ; sub_42CFC5E0:loc_42CFC652\u2191w ...
.data:42D0150A                 align 4
.data:42D0150C ; SOCKET dword_42D0150C
.data:42D0150C dword_42D0150C  dd 0                    ; DATA XREF: sub_42CFC5E0+8F\u2191w
.data:42D0150C                                         ; sub_42CFC6C2+116\u2191r
.data:42D01510 ; __time32_t Time1
.data:42D01510 Time1           dd 0                    ; DATA XREF: sub_42CFA283+3\u2191o
.data:42D01510                                         ; sub_42CFA283+17\u2191r ...
.data:42D01514 ; __time32_t dword_42D01514
.data:42D01514 dword_42D01514  dd 0                    ; DATA XREF: sub_42CFA4FE+77\u2191o
.data:42D01514                                         ; sub_42CFA4FE+8B\u2191r ...
.data:42D01518                 align 10h
.data:42D01520 ; struct sockaddr from
.data:42D01520 from            sockaddr <0>            ; DATA XREF: sub_42CFA4FE+11\u2191o
.data:42D01520                                         ; sub_42CFA5C6:loc_42CFA624\u2191o
.data:42D01530 ; __time32_t Time
.data:42D01530 Time            dd 0                    ; DATA XREF: StartAddress:loc_42CF9FE8\u2191o
.data:42D01530                                         ; sub_42CFA4FE+52\u2191o ...
.data:42D01534 ; __time32_t Time2
.data:42D01534 Time2           dd 0                    ; DATA XREF: StartAddress+5F\u2191o
.data:42D01534                                         ; sub_42CFA283+11\u2191r ...
.data:42D01538                 align 10h
.data:42D01540 dword_42D01540  dd 0                    ; DATA XREF: sub_42CFA64E:loc_42CFA68A\u2191r
.data:42D01540                                         ; sub_42CFA64E+4E\u2191w ...
.data:42D01544 ; int Val
.data:42D01544 Val             dd 0                    ; DATA XREF: StartAddress+13\u2191w
.data:42D01544                                         ; sub_42CFA64E+D1\u2191r ...
.data:42D01548 ; char *String1
.data:42D01548 String1         dd 0                    ; DATA XREF: StartAddress+9\u2191w
.data:42D01548                                         ; StartAddress:loc_42CFA112\u2191r ...
.data:42D0154C ; int word_42D0154C
.data:42D0154C word_42D0154C   dw 0                    ; DATA XREF: StartAddress+29\u2191w
.data:42D0154C                                         ; StartAddress:loc_42CF9F21\u2191r ...
.data:42D0154E                 db    0
.data:42D0154F                 db    0
.data:42D01550 dword_42D01550  dd 0                    ; DATA XREF: StartAddress:loc_42CF9FD9\u2191w
.data:42D01550                                         ; StartAddress:loc_42CFA1BE\u2191r ...
.data:42D01554 ; DWORD cbData
.data:42D01554 cbData          dd 0                    ; DATA XREF: sub_42CF9388:loc_42CF94D4\u2191w
.data:42D01554                                         ; sub_42CF9388+17B\u2191o ...
.data:42D01558                 align 10h
.data:42D01560 ; BYTE Data
.data:42D01560 Data            db 0                    ; DATA XREF: sub_42CF9388+180\u2191o
.data:42D01560                                         ; sub_42CF9388+1A0\u2191o ...
.data:42D01561                 db    0
.data:42D01562                 db    0
.data:42D01563                 db    0
.data:42D01564                 db    0
.data:42D01565                 db    0
.data:42D01566                 db    0
.data:42D01567                 db    0
.data:42D01568                 db    0
.data:42D01569                 db    0
.data:42D0156A                 db    0
.data:42D0156B                 db    0
.data:42D0156C                 db    0
.data:42D0156D                 db    0
.data:42D0156E                 db    0
.data:42D0156F                 db    0
.data:42D01570                 db    0
.data:42D01571                 db    0
.data:42D01572                 db    0
.data:42D01573                 db    0
.data:42D01574                 db    0
.data:42D01575                 db    0
.data:42D01576                 db    0
.data:42D01577                 db    0
.data:42D01578                 db    0
.data:42D01579                 db    0
.data:42D0157A                 db    0
.data:42D0157B                 db    0
.data:42D0157C                 db    0
.data:42D0157D                 db    0
.data:42D0157E                 db    0
.data:42D0157F                 db    0
.data:42D01580                 db    0
.data:42D01581                 db    0
.data:42D01582                 db    0
.data:42D01583                 db    0
.data:42D01584                 db    0
.data:42D01585                 db    0
.data:42D01586                 db    0
.data:42D01587                 db    0
.data:42D01588                 db    0
.data:42D01589                 db    0
.data:42D0158A                 db    0
.data:42D0158B                 db    0
.data:42D0158C                 db    0
.data:42D0158D                 db    0
.data:42D0158E                 db    0
.data:42D0158F                 db    0
.data:42D01590                 db    0
.data:42D01591                 db    0
.data:42D01592                 db    0
.data:42D01593                 db    0
.data:42D01594                 db    0
.data:42D01595                 db    0
.data:42D01596                 db    0
.data:42D01597                 db    0
.data:42D01598                 db    0
.data:42D01599                 db    0
.data:42D0159A                 db    0
.data:42D0159B                 db    0
.data:42D0159C                 db    0
.data:42D0159D                 db    0
.data:42D0159E                 db    0
.data:42D0159F                 db    0
.data:42D015A0                 db    0
.data:42D015A1                 db    0
.data:42D015A2                 db    0
.data:42D015A3                 db    0
.data:42D015A4                 db    0
.data:42D015A5                 db    0
.data:42D015A6                 db    0
.data:42D015A7                 db    0
.data:42D015A8                 db    0
.data:42D015A9                 db    0
.data:42D015AA                 db    0
.data:42D015AB                 db    0
.data:42D015AC                 db    0
.data:42D015AD                 db    0
.data:42D015AE                 db    0
.data:42D015AF                 db    0
.data:42D015B0                 db    0
.data:42D015B1                 db    0
.data:42D015B2                 db    0
.data:42D015B3                 db    0
.data:42D015B4                 db    0
.data:42D015B5                 db    0
.data:42D015B6                 db    0
.data:42D015B7                 db    0
.data:42D015B8                 db    0
.data:42D015B9                 db    0
.data:42D015BA                 db    0
.data:42D015BB                 db    0
.data:42D015BC                 db    0
.data:42D015BD                 db    0
.data:42D015BE                 db    0
.data:42D015BF                 db    0
.data:42D015C0                 db    0
.data:42D015C1                 db    0
.data:42D015C2                 db    0
.data:42D015C3                 db    0
.data:42D015C4                 db    0
.data:42D015C5                 db    0
.data:42D015C6                 db    0
.data:42D015C7                 db    0
.data:42D015C8                 db    0
.data:42D015C9                 db    0
.data:42D015CA                 db    0
.data:42D015CB                 db    0
.data:42D015CC                 db    0
.data:42D015CD                 db    0
.data:42D015CE                 db    0
.data:42D015CF                 db    0
.data:42D015D0                 db    0
.data:42D015D1                 db    0
.data:42D015D2                 db    0
.data:42D015D3                 db    0
.data:42D015D4                 db    0
.data:42D015D5                 db    0
.data:42D015D6                 db    0
.data:42D015D7                 db    0
.data:42D015D8                 db    0
.data:42D015D9                 db    0
.data:42D015DA                 db    0
.data:42D015DB                 db    0
.data:42D015DC                 db    0
.data:42D015DD                 db    0
.data:42D015DE                 db    0
.data:42D015DF                 db    0
.data:42D015E0                 db    0
.data:42D015E1                 db    0
.data:42D015E2                 db    0
.data:42D015E3                 db    0
.data:42D015E4                 db    0
.data:42D015E5                 db    0
.data:42D015E6                 db    0
.data:42D015E7                 db    0
.data:42D015E8                 db    0
.data:42D015E9                 db    0
.data:42D015EA                 db    0
.data:42D015EB                 db    0
.data:42D015EC                 db    0
.data:42D015ED                 db    0
.data:42D015EE                 db    0
.data:42D015EF                 db    0
.data:42D015F0                 db    0
.data:42D015F1                 db    0
.data:42D015F2                 db    0
.data:42D015F3                 db    0
.data:42D015F4                 db    0
.data:42D015F5                 db    0
.data:42D015F6                 db    0
.data:42D015F7                 db    0
.data:42D015F8                 db    0
.data:42D015F9                 db    0
.data:42D015FA                 db    0
.data:42D015FB                 db    0
.data:42D015FC                 db    0
.data:42D015FD                 db    0
.data:42D015FE                 db    0
.data:42D015FF                 db    0
.data:42D01600                 db    0
.data:42D01601                 db    0
.data:42D01602                 db    0
.data:42D01603                 db    0
.data:42D01604                 db    0
.data:42D01605                 db    0
.data:42D01606                 db    0
.data:42D01607                 db    0
.data:42D01608                 db    0
.data:42D01609                 db    0
.data:42D0160A                 db    0
.data:42D0160B                 db    0
.data:42D0160C                 db    0
.data:42D0160D                 db    0
.data:42D0160E                 db    0
.data:42D0160F                 db    0
.data:42D01610                 db    0
.data:42D01611                 db    0
.data:42D01612                 db    0
.data:42D01613                 db    0
.data:42D01614                 db    0
.data:42D01615                 db    0
.data:42D01616                 db    0
.data:42D01617                 db    0
.data:42D01618                 db    0
.data:42D01619                 db    0
.data:42D0161A                 db    0
.data:42D0161B                 db    0
.data:42D0161C                 db    0
.data:42D0161D                 db    0
.data:42D0161E                 db    0
.data:42D0161F                 db    0
.data:42D01620                 db    0
.data:42D01621                 db    0
.data:42D01622                 db    0
.data:42D01623                 db    0
.data:42D01624                 db    0
.data:42D01625                 db    0
.data:42D01626                 db    0
.data:42D01627                 db    0
.data:42D01628                 db    0
.data:42D01629                 db    0
.data:42D0162A                 db    0
.data:42D0162B                 db    0
.data:42D0162C                 db    0
.data:42D0162D                 db    0
.data:42D0162E                 db    0
.data:42D0162F                 db    0
.data:42D01630                 db    0
.data:42D01631                 db    0
.data:42D01632                 db    0
.data:42D01633                 db    0
.data:42D01634                 db    0
.data:42D01635                 db    0
.data:42D01636                 db    0
.data:42D01637                 db    0
.data:42D01638                 db    0
.data:42D01639                 db    0
.data:42D0163A                 db    0
.data:42D0163B                 db    0
.data:42D0163C                 db    0
.data:42D0163D                 db    0
.data:42D0163E                 db    0
.data:42D0163F                 db    0
.data:42D01640                 db    0
.data:42D01641                 db    0
.data:42D01642                 db    0
.data:42D01643                 db    0
.data:42D01644                 db    0
.data:42D01645                 db    0
.data:42D01646                 db    0
.data:42D01647                 db    0
.data:42D01648                 db    0
.data:42D01649                 db    0
.data:42D0164A                 db    0
.data:42D0164B                 db    0
.data:42D0164C                 db    0
.data:42D0164D                 db    0
.data:42D0164E                 db    0
.data:42D0164F                 db    0
.data:42D01650                 db    0
.data:42D01651                 db    0
.data:42D01652                 db    0
.data:42D01653                 db    0
.data:42D01654                 db    0
.data:42D01655                 db    0
.data:42D01656                 db    0
.data:42D01657                 db    0
.data:42D01658                 db    0
.data:42D01659                 db    0
.data:42D0165A                 db    0
.data:42D0165B                 db    0
.data:42D0165C                 db    0
.data:42D0165D                 db    0
.data:42D0165E                 db    0
.data:42D0165F                 db    0
.data:42D01660                 db    0
.data:42D01661                 db    0
.data:42D01662                 db    0
.data:42D01663                 db    0
.data:42D01664                 db    0
.data:42D01665                 db    0
.data:42D01666                 db    0
.data:42D01667                 db    0
.data:42D01668                 db    0
.data:42D01669                 db    0
.data:42D0166A                 db    0
.data:42D0166B                 db    0
.data:42D0166C                 db    0
.data:42D0166D                 db    0
.data:42D0166E                 db    0
.data:42D0166F                 db    0
.data:42D01670                 db    0
.data:42D01671                 db    0
.data:42D01672                 db    0
.data:42D01673                 db    0
.data:42D01674                 db    0
.data:42D01675                 db    0
.data:42D01676                 db    0
.data:42D01677                 db    0
.data:42D01678                 db    0
.data:42D01679                 db    0
.data:42D0167A                 db    0
.data:42D0167B                 db    0
.data:42D0167C                 db    0
.data:42D0167D                 db    0
.data:42D0167E                 db    0
.data:42D0167F                 db    0
.data:42D01680                 db    0
.data:42D01681                 db    0
.data:42D01682                 db    0
.data:42D01683                 db    0
.data:42D01684                 db    0
.data:42D01685                 db    0
.data:42D01686                 db    0
.data:42D01687                 db    0
.data:42D01688                 db    0
.data:42D01689                 db    0
.data:42D0168A                 db    0
.data:42D0168B                 db    0
.data:42D0168C                 db    0
.data:42D0168D                 db    0
.data:42D0168E                 db    0
.data:42D0168F                 db    0
.data:42D01690                 db    0
.data:42D01691                 db    0
.data:42D01692                 db    0
.data:42D01693                 db    0
.data:42D01694                 db    0
.data:42D01695                 db    0
.data:42D01696                 db    0
.data:42D01697                 db    0
.data:42D01698                 db    0
.data:42D01699                 db    0
.data:42D0169A                 db    0
.data:42D0169B                 db    0
.data:42D0169C                 db    0
.data:42D0169D                 db    0
.data:42D0169E                 db    0
.data:42D0169F                 db    0
.data:42D016A0                 db    0
.data:42D016A1                 db    0
.data:42D016A2                 db    0
.data:42D016A3                 db    0
.data:42D016A4                 db    0
.data:42D016A5                 db    0
.data:42D016A6                 db    0
.data:42D016A7                 db    0
.data:42D016A8                 db    0
.data:42D016A9                 db    0
.data:42D016AA                 db    0
.data:42D016AB                 db    0
.data:42D016AC                 db    0
.data:42D016AD                 db    0
.data:42D016AE                 db    0
.data:42D016AF                 db    0
.data:42D016B0                 db    0
.data:42D016B1                 db    0
.data:42D016B2                 db    0
.data:42D016B3                 db    0
.data:42D016B4                 db    0
.data:42D016B5                 db    0
.data:42D016B6                 db    0
.data:42D016B7                 db    0
.data:42D016B8                 db    0
.data:42D016B9                 db    0
.data:42D016BA                 db    0
.data:42D016BB                 db    0
.data:42D016BC                 db    0
.data:42D016BD                 db    0
.data:42D016BE                 db    0
.data:42D016BF                 db    0
.data:42D016C0                 db    0
.data:42D016C1                 db    0
.data:42D016C2                 db    0
.data:42D016C3                 db    0
.data:42D016C4                 db    0
.data:42D016C5                 db    0
.data:42D016C6                 db    0
.data:42D016C7                 db    0
.data:42D016C8                 db    0
.data:42D016C9                 db    0
.data:42D016CA                 db    0
.data:42D016CB                 db    0
.data:42D016CC                 db    0
.data:42D016CD                 db    0
.data:42D016CE                 db    0
.data:42D016CF                 db    0
.data:42D016D0                 db    0
.data:42D016D1                 db    0
.data:42D016D2                 db    0
.data:42D016D3                 db    0
.data:42D016D4                 db    0
.data:42D016D5                 db    0
.data:42D016D6                 db    0
.data:42D016D7                 db    0
.data:42D016D8                 db    0
.data:42D016D9                 db    0
.data:42D016DA                 db    0
.data:42D016DB                 db    0
.data:42D016DC                 db    0
.data:42D016DD                 db    0
.data:42D016DE                 db    0
.data:42D016DF                 db    0
.data:42D016E0                 db    0
.data:42D016E1                 db    0
.data:42D016E2                 db    0
.data:42D016E3                 db    0
.data:42D016E4                 db    0
.data:42D016E5                 db    0
.data:42D016E6                 db    0
.data:42D016E7                 db    0
.data:42D016E8                 db    0
.data:42D016E9                 db    0
.data:42D016EA                 db    0
.data:42D016EB                 db    0
.data:42D016EC                 db    0
.data:42D016ED                 db    0
.data:42D016EE                 db    0
.data:42D016EF                 db    0
.data:42D016F0                 db    0
.data:42D016F1                 db    0
.data:42D016F2                 db    0
.data:42D016F3                 db    0
.data:42D016F4                 db    0
.data:42D016F5                 db    0
.data:42D016F6                 db    0
.data:42D016F7                 db    0
.data:42D016F8                 db    0
.data:42D016F9                 db    0
.data:42D016FA                 db    0
.data:42D016FB                 db    0
.data:42D016FC                 db    0
.data:42D016FD                 db    0
.data:42D016FE                 db    0
.data:42D016FF                 db    0
.data:42D01700                 db    0
.data:42D01701                 db    0
.data:42D01702                 db    0
.data:42D01703                 db    0
.data:42D01704                 db    0
.data:42D01705                 db    0
.data:42D01706                 db    0
.data:42D01707                 db    0
.data:42D01708                 db    0
.data:42D01709                 db    0
.data:42D0170A                 db    0
.data:42D0170B                 db    0
.data:42D0170C                 db    0
.data:42D0170D                 db    0
.data:42D0170E                 db    0
.data:42D0170F                 db    0
.data:42D01710                 db    0
.data:42D01711                 db    0
.data:42D01712                 db    0
.data:42D01713                 db    0
.data:42D01714                 db    0
.data:42D01715                 db    0
.data:42D01716                 db    0
.data:42D01717                 db    0
.data:42D01718                 db    0
.data:42D01719                 db    0
.data:42D0171A                 db    0
.data:42D0171B                 db    0
.data:42D0171C                 db    0
.data:42D0171D                 db    0
.data:42D0171E                 db    0
.data:42D0171F                 db    0
.data:42D01720                 db    0
.data:42D01721                 db    0
.data:42D01722                 db    0
.data:42D01723                 db    0
.data:42D01724                 db    0
.data:42D01725                 db    0
.data:42D01726                 db    0
.data:42D01727                 db    0
.data:42D01728                 db    0
.data:42D01729                 db    0
.data:42D0172A                 db    0
.data:42D0172B                 db    0
.data:42D0172C                 db    0
.data:42D0172D                 db    0
.data:42D0172E                 db    0
.data:42D0172F                 db    0
.data:42D01730                 db    0
.data:42D01731                 db    0
.data:42D01732                 db    0
.data:42D01733                 db    0
.data:42D01734                 db    0
.data:42D01735                 db    0
.data:42D01736                 db    0
.data:42D01737                 db    0
.data:42D01738                 db    0
.data:42D01739                 db    0
.data:42D0173A                 db    0
.data:42D0173B                 db    0
.data:42D0173C                 db    0
.data:42D0173D                 db    0
.data:42D0173E                 db    0
.data:42D0173F                 db    0
.data:42D01740                 db    0
.data:42D01741                 db    0
.data:42D01742                 db    0
.data:42D01743                 db    0
.data:42D01744                 db    0
.data:42D01745                 db    0
.data:42D01746                 db    0
.data:42D01747                 db    0
.data:42D01748                 db    0
.data:42D01749                 db    0
.data:42D0174A                 db    0
.data:42D0174B                 db    0
.data:42D0174C                 db    0
.data:42D0174D                 db    0
.data:42D0174E                 db    0
.data:42D0174F                 db    0
.data:42D01750                 db    0
.data:42D01751                 db    0
.data:42D01752                 db    0
.data:42D01753                 db    0
.data:42D01754                 db    0
.data:42D01755                 db    0
.data:42D01756                 db    0
.data:42D01757                 db    0
.data:42D01758                 db    0
.data:42D01759                 db    0
.data:42D0175A                 db    0
.data:42D0175B                 db    0
.data:42D0175C                 db    0
.data:42D0175D                 db    0
.data:42D0175E                 db    0
.data:42D0175F                 db    0
.data:42D01760                 db    0
.data:42D01761                 db    0
.data:42D01762                 db    0
.data:42D01763                 db    0
.data:42D01764                 db    0
.data:42D01765                 db    0
.data:42D01766                 db    0
.data:42D01767                 db    0
.data:42D01768                 db    0
.data:42D01769                 db    0
.data:42D0176A                 db    0
.data:42D0176B                 db    0
.data:42D0176C                 db    0
.data:42D0176D                 db    0
.data:42D0176E                 db    0
.data:42D0176F                 db    0
.data:42D01770                 db    0
.data:42D01771                 db    0
.data:42D01772                 db    0
.data:42D01773                 db    0
.data:42D01774                 db    0
.data:42D01775                 db    0
.data:42D01776                 db    0
.data:42D01777                 db    0
.data:42D01778                 db    0
.data:42D01779                 db    0
.data:42D0177A                 db    0
.data:42D0177B                 db    0
.data:42D0177C                 db    0
.data:42D0177D                 db    0
.data:42D0177E                 db    0
.data:42D0177F                 db    0
.data:42D01780                 db    0
.data:42D01781                 db    0
.data:42D01782                 db    0
.data:42D01783                 db    0
.data:42D01784                 db    0
.data:42D01785                 db    0
.data:42D01786                 db    0
.data:42D01787                 db    0
.data:42D01788                 db    0
.data:42D01789                 db    0
.data:42D0178A                 db    0
.data:42D0178B                 db    0
.data:42D0178C                 db    0
.data:42D0178D                 db    0
.data:42D0178E                 db    0
.data:42D0178F                 db    0
.data:42D01790                 db    0
.data:42D01791                 db    0
.data:42D01792                 db    0
.data:42D01793                 db    0
.data:42D01794                 db    0
.data:42D01795                 db    0
.data:42D01796                 db    0
.data:42D01797                 db    0
.data:42D01798                 db    0
.data:42D01799                 db    0
.data:42D0179A                 db    0
.data:42D0179B                 db    0
.data:42D0179C                 db    0
.data:42D0179D                 db    0
.data:42D0179E                 db    0
.data:42D0179F                 db    0
.data:42D017A0                 db    0
.data:42D017A1                 db    0
.data:42D017A2                 db    0
.data:42D017A3                 db    0
.data:42D017A4                 db    0
.data:42D017A5                 db    0
.data:42D017A6                 db    0
.data:42D017A7                 db    0
.data:42D017A8                 db    0
.data:42D017A9                 db    0
.data:42D017AA                 db    0
.data:42D017AB                 db    0
.data:42D017AC                 db    0
.data:42D017AD                 db    0
.data:42D017AE                 db    0
.data:42D017AF                 db    0
.data:42D017B0                 db    0
.data:42D017B1                 db    0
.data:42D017B2                 db    0
.data:42D017B3                 db    0
.data:42D017B4                 db    0
.data:42D017B5                 db    0
.data:42D017B6                 db    0
.data:42D017B7                 db    0
.data:42D017B8                 db    0
.data:42D017B9                 db    0
.data:42D017BA                 db    0
.data:42D017BB                 db    0
.data:42D017BC                 db    0
.data:42D017BD                 db    0
.data:42D017BE                 db    0
.data:42D017BF                 db    0
.data:42D017C0                 db    0
.data:42D017C1                 db    0
.data:42D017C2                 db    0
.data:42D017C3                 db    0
.data:42D017C4                 db    0
.data:42D017C5                 db    0
.data:42D017C6                 db    0
.data:42D017C7                 db    0
.data:42D017C8                 db    0
.data:42D017C9                 db    0
.data:42D017CA                 db    0
.data:42D017CB                 db    0
.data:42D017CC                 db    0
.data:42D017CD                 db    0
.data:42D017CE                 db    0
.data:42D017CF                 db    0
.data:42D017D0                 db    0
.data:42D017D1                 db    0
.data:42D017D2                 db    0
.data:42D017D3                 db    0
.data:42D017D4                 db    0
.data:42D017D5                 db    0
.data:42D017D6                 db    0
.data:42D017D7                 db    0
.data:42D017D8                 db    0
.data:42D017D9                 db    0
.data:42D017DA                 db    0
.data:42D017DB                 db    0
.data:42D017DC                 db    0
.data:42D017DD                 db    0
.data:42D017DE                 db    0
.data:42D017DF                 db    0
.data:42D017E0                 db    0
.data:42D017E1                 db    0
.data:42D017E2                 db    0
.data:42D017E3                 db    0
.data:42D017E4                 db    0
.data:42D017E5                 db    0
.data:42D017E6                 db    0
.data:42D017E7                 db    0
.data:42D017E8                 db    0
.data:42D017E9                 db    0
.data:42D017EA                 db    0
.data:42D017EB                 db    0
.data:42D017EC                 db    0
.data:42D017ED                 db    0
.data:42D017EE                 db    0
.data:42D017EF                 db    0
.data:42D017F0                 db    0
.data:42D017F1                 db    0
.data:42D017F2                 db    0
.data:42D017F3                 db    0
.data:42D017F4                 db    0
.data:42D017F5                 db    0
.data:42D017F6                 db    0
.data:42D017F7                 db    0
.data:42D017F8                 db    0
.data:42D017F9                 db    0
.data:42D017FA                 db    0
.data:42D017FB                 db    0
.data:42D017FC                 db    0
.data:42D017FD                 db    0
.data:42D017FE                 db    0
.data:42D017FF                 db    0
.data:42D01800                 db    0
.data:42D01801                 db    0
.data:42D01802                 db    0
.data:42D01803                 db    0
.data:42D01804                 db    0
.data:42D01805                 db    0
.data:42D01806                 db    0
.data:42D01807                 db    0
.data:42D01808                 db    0
.data:42D01809                 db    0
.data:42D0180A                 db    0
.data:42D0180B                 db    0
.data:42D0180C                 db    0
.data:42D0180D                 db    0
.data:42D0180E                 db    0
.data:42D0180F                 db    0
.data:42D01810                 db    0
.data:42D01811                 db    0
.data:42D01812                 db    0
.data:42D01813                 db    0
.data:42D01814                 db    0
.data:42D01815                 db    0
.data:42D01816                 db    0
.data:42D01817                 db    0
.data:42D01818                 db    0
.data:42D01819                 db    0
.data:42D0181A                 db    0
.data:42D0181B                 db    0
.data:42D0181C                 db    0
.data:42D0181D                 db    0
.data:42D0181E                 db    0
.data:42D0181F                 db    0
.data:42D01820                 db    0
.data:42D01821                 db    0
.data:42D01822                 db    0
.data:42D01823                 db    0
.data:42D01824                 db    0
.data:42D01825                 db    0
.data:42D01826                 db    0
.data:42D01827                 db    0
.data:42D01828                 db    0
.data:42D01829                 db    0
.data:42D0182A                 db    0
.data:42D0182B                 db    0
.data:42D0182C                 db    0
.data:42D0182D                 db    0
.data:42D0182E                 db    0
.data:42D0182F                 db    0
.data:42D01830                 db    0
.data:42D01831                 db    0
.data:42D01832                 db    0
.data:42D01833                 db    0
.data:42D01834                 db    0
.data:42D01835                 db    0
.data:42D01836                 db    0
.data:42D01837                 db    0
.data:42D01838                 db    0
.data:42D01839                 db    0
.data:42D0183A                 db    0
.data:42D0183B                 db    0
.data:42D0183C                 db    0
.data:42D0183D                 db    0
.data:42D0183E                 db    0
.data:42D0183F                 db    0
.data:42D01840                 db    0
.data:42D01841                 db    0
.data:42D01842                 db    0
.data:42D01843                 db    0
.data:42D01844                 db    0
.data:42D01845                 db    0
.data:42D01846                 db    0
.data:42D01847                 db    0
.data:42D01848                 db    0
.data:42D01849                 db    0
.data:42D0184A                 db    0
.data:42D0184B                 db    0
.data:42D0184C                 db    0
.data:42D0184D                 db    0
.data:42D0184E                 db    0
.data:42D0184F                 db    0
.data:42D01850                 db    0
.data:42D01851                 db    0
.data:42D01852                 db    0
.data:42D01853                 db    0
.data:42D01854                 db    0
.data:42D01855                 db    0
.data:42D01856                 db    0
.data:42D01857                 db    0
.data:42D01858                 db    0
.data:42D01859                 db    0
.data:42D0185A                 db    0
.data:42D0185B                 db    0
.data:42D0185C                 db    0
.data:42D0185D                 db    0
.data:42D0185E                 db    0
.data:42D0185F                 db    0
.data:42D01860                 db    0
.data:42D01861                 db    0
.data:42D01862                 db    0
.data:42D01863                 db    0
.data:42D01864                 db    0
.data:42D01865                 db    0
.data:42D01866                 db    0
.data:42D01867                 db    0
.data:42D01868                 db    0
.data:42D01869                 db    0
.data:42D0186A                 db    0
.data:42D0186B                 db    0
.data:42D0186C                 db    0
.data:42D0186D                 db    0
.data:42D0186E                 db    0
.data:42D0186F                 db    0
.data:42D01870                 db    0
.data:42D01871                 db    0
.data:42D01872                 db    0
.data:42D01873                 db    0
.data:42D01874                 db    0
.data:42D01875                 db    0
.data:42D01876                 db    0
.data:42D01877                 db    0
.data:42D01878                 db    0
.data:42D01879                 db    0
.data:42D0187A                 db    0
.data:42D0187B                 db    0
.data:42D0187C                 db    0
.data:42D0187D                 db    0
.data:42D0187E                 db    0
.data:42D0187F                 db    0
.data:42D01880                 db    0
.data:42D01881                 db    0
.data:42D01882                 db    0
.data:42D01883                 db    0
.data:42D01884                 db    0
.data:42D01885                 db    0
.data:42D01886                 db    0
.data:42D01887                 db    0
.data:42D01888                 db    0
.data:42D01889                 db    0
.data:42D0188A                 db    0
.data:42D0188B                 db    0
.data:42D0188C                 db    0
.data:42D0188D                 db    0
.data:42D0188E                 db    0
.data:42D0188F                 db    0
.data:42D01890                 db    0
.data:42D01891                 db    0
.data:42D01892                 db    0
.data:42D01893                 db    0
.data:42D01894                 db    0
.data:42D01895                 db    0
.data:42D01896                 db    0
.data:42D01897                 db    0
.data:42D01898                 db    0
.data:42D01899                 db    0
.data:42D0189A                 db    0
.data:42D0189B                 db    0
.data:42D0189C                 db    0
.data:42D0189D                 db    0
.data:42D0189E                 db    0
.data:42D0189F                 db    0
.data:42D018A0                 db    0
.data:42D018A1                 db    0
.data:42D018A2                 db    0
.data:42D018A3                 db    0
.data:42D018A4                 db    0
.data:42D018A5                 db    0
.data:42D018A6                 db    0
.data:42D018A7                 db    0
.data:42D018A8                 db    0
.data:42D018A9                 db    0
.data:42D018AA                 db    0
.data:42D018AB                 db    0
.data:42D018AC                 db    0
.data:42D018AD                 db    0
.data:42D018AE                 db    0
.data:42D018AF                 db    0
.data:42D018B0                 db    0
.data:42D018B1                 db    0
.data:42D018B2                 db    0
.data:42D018B3                 db    0
.data:42D018B4                 db    0
.data:42D018B5                 db    0
.data:42D018B6                 db    0
.data:42D018B7                 db    0
.data:42D018B8                 db    0
.data:42D018B9                 db    0
.data:42D018BA                 db    0
.data:42D018BB                 db    0
.data:42D018BC                 db    0
.data:42D018BD                 db    0
.data:42D018BE                 db    0
.data:42D018BF                 db    0
.data:42D018C0                 db    0
.data:42D018C1                 db    0
.data:42D018C2                 db    0
.data:42D018C3                 db    0
.data:42D018C4                 db    0
.data:42D018C5                 db    0
.data:42D018C6                 db    0
.data:42D018C7                 db    0
.data:42D018C8                 db    0
.data:42D018C9                 db    0
.data:42D018CA                 db    0
.data:42D018CB                 db    0
.data:42D018CC                 db    0
.data:42D018CD                 db    0
.data:42D018CE                 db    0
.data:42D018CF                 db    0
.data:42D018D0                 db    0
.data:42D018D1                 db    0
.data:42D018D2                 db    0
.data:42D018D3                 db    0
.data:42D018D4                 db    0
.data:42D018D5                 db    0
.data:42D018D6                 db    0
.data:42D018D7                 db    0
.data:42D018D8                 db    0
.data:42D018D9                 db    0
.data:42D018DA                 db    0
.data:42D018DB                 db    0
.data:42D018DC                 db    0
.data:42D018DD                 db    0
.data:42D018DE                 db    0
.data:42D018DF                 db    0
.data:42D018E0                 db    0
.data:42D018E1                 db    0
.data:42D018E2                 db    0
.data:42D018E3                 db    0
.data:42D018E4                 db    0
.data:42D018E5                 db    0
.data:42D018E6                 db    0
.data:42D018E7                 db    0
.data:42D018E8                 db    0
.data:42D018E9                 db    0
.data:42D018EA                 db    0
.data:42D018EB                 db    0
.data:42D018EC                 db    0
.data:42D018ED                 db    0
.data:42D018EE                 db    0
.data:42D018EF                 db    0
.data:42D018F0                 db    0
.data:42D018F1                 db    0
.data:42D018F2                 db    0
.data:42D018F3                 db    0
.data:42D018F4                 db    0
.data:42D018F5                 db    0
.data:42D018F6                 db    0
.data:42D018F7                 db    0
.data:42D018F8                 db    0
.data:42D018F9                 db    0
.data:42D018FA                 db    0
.data:42D018FB                 db    0
.data:42D018FC                 db    0
.data:42D018FD                 db    0
.data:42D018FE                 db    0
.data:42D018FF                 db    0
.data:42D01900                 db    0
.data:42D01901                 db    0
.data:42D01902                 db    0
.data:42D01903                 db    0
.data:42D01904                 db    0
.data:42D01905                 db    0
.data:42D01906                 db    0
.data:42D01907                 db    0
.data:42D01908                 db    0
.data:42D01909                 db    0
.data:42D0190A                 db    0
.data:42D0190B                 db    0
.data:42D0190C                 db    0
.data:42D0190D                 db    0
.data:42D0190E                 db    0
.data:42D0190F                 db    0
.data:42D01910                 db    0
.data:42D01911                 db    0
.data:42D01912                 db    0
.data:42D01913                 db    0
.data:42D01914                 db    0
.data:42D01915                 db    0
.data:42D01916                 db    0
.data:42D01917                 db    0
.data:42D01918                 db    0
.data:42D01919                 db    0
.data:42D0191A                 db    0
.data:42D0191B                 db    0
.data:42D0191C                 db    0
.data:42D0191D                 db    0
.data:42D0191E                 db    0
.data:42D0191F                 db    0
.data:42D01920                 db    0
.data:42D01921                 db    0
.data:42D01922                 db    0
.data:42D01923                 db    0
.data:42D01924                 db    0
.data:42D01925                 db    0
.data:42D01926                 db    0
.data:42D01927                 db    0
.data:42D01928                 db    0
.data:42D01929                 db    0
.data:42D0192A                 db    0
.data:42D0192B                 db    0
.data:42D0192C                 db    0
.data:42D0192D                 db    0
.data:42D0192E                 db    0
.data:42D0192F                 db    0
.data:42D01930                 db    0
.data:42D01931                 db    0
.data:42D01932                 db    0
.data:42D01933                 db    0
.data:42D01934                 db    0
.data:42D01935                 db    0
.data:42D01936                 db    0
.data:42D01937                 db    0
.data:42D01938                 db    0
.data:42D01939                 db    0
.data:42D0193A                 db    0
.data:42D0193B                 db    0
.data:42D0193C                 db    0
.data:42D0193D                 db    0
.data:42D0193E                 db    0
.data:42D0193F                 db    0
.data:42D01940                 db    0
.data:42D01941                 db    0
.data:42D01942                 db    0
.data:42D01943                 db    0
.data:42D01944                 db    0
.data:42D01945                 db    0
.data:42D01946                 db    0
.data:42D01947                 db    0
.data:42D01948                 db    0
.data:42D01949                 db    0
.data:42D0194A                 db    0
.data:42D0194B                 db    0
.data:42D0194C                 db    0
.data:42D0194D                 db    0
.data:42D0194E                 db    0
.data:42D0194F                 db    0
.data:42D01950                 db    0
.data:42D01951                 db    0
.data:42D01952                 db    0
.data:42D01953                 db    0
.data:42D01954                 db    0
.data:42D01955                 db    0
.data:42D01956                 db    0
.data:42D01957                 db    0
.data:42D01958                 db    0
.data:42D01959                 db    0
.data:42D0195A                 db    0
.data:42D0195B                 db    0
.data:42D0195C                 db    0
.data:42D0195D                 db    0
.data:42D0195E                 db    0
.data:42D0195F                 db    0
.data:42D01960 dword_42D01960  dd 0                    ; DATA XREF: sub_42CF7930+90\u2191w
.data:42D01960                                         ; sub_42CF7BBF+88\u2191r ...
.data:42D01964 dword_42D01964  dd 0                    ; DATA XREF: sub_42CF7930+9B\u2191w
.data:42D01964                                         ; sub_42CF7D75+8F\u2191r
.data:42D01968 ; HMODULE dword_42D01968
.data:42D01968 dword_42D01968  dd 0                    ; DATA XREF: sub_42CF7930:loc_42CF7A02\u2191r
.data:42D01968                                         ; sub_42CF7930+DB\u2191r ...
.data:42D0196C                 align 20h
.data:42D01980 ; struct _OSVERSIONINFOA VersionInformation
.data:42D01980 VersionInformation _OSVERSIONINFOA <0>  ; DATA XREF: DllEntryPoint+54\u2191w
.data:42D01980                                         ; DllEntryPoint+5E\u2191o ...
.data:42D01A14 dword_42D01A14  dd 0                    ; DATA XREF: ConnectionClose+259\u2191r
.data:42D01A14                                         ; sub_42CF69B4+CF\u2191r ...
.data:42D01A18 dword_42D01A18  dd 0                    ; DATA XREF: sub_42CF1197+4C\u2191r
.data:42D01A18                                         ; ConnectionListen+43D\u2191r ...
.data:42D01A1C dword_42D01A1C  dd 0                    ; DATA XREF: DllEntryPoint:loc_42CF104A\u2191w
.data:42D01A1C                                         ; DllEntryPoint+77\u2191w ...
.data:42D01A20 ; HANDLE hEvent
.data:42D01A20 hEvent          dd 0                    ; DATA XREF: ConnectionClose+134\u2191r
.data:42D01A20                                         ; ConnectionClose+150\u2191r ...
.data:42D01A24                 align 20h
.data:42D01A40 ; CHAR name[256]
.data:42D01A40 name            db 100h dup(0)          ; DATA XREF: ConnectionListen+99\u2191o
.data:42D01A40                                         ; ConnectionListen+14A\u2191o ...
.data:42D01B40 dword_42D01B40  dd 0                    ; DATA XREF: ConnectionListen+3B4\u2191r
.data:42D01B40                                         ; sub_42CF8300+120\u2191w ...
.data:42D01B44 ; size_t dword_42D01B44
.data:42D01B44 dword_42D01B44  dd 0                    ; DATA XREF: sub_42CF7275+B0\u2191r
.data:42D01B44                                         ; sub_42CF7275+CC\u2191r ...
.data:42D01B48 ; HANDLE hThread
.data:42D01B48 hThread         dd 0                    ; DATA XREF: ConnectionClose:loc_42CF341A\u2191r
.data:42D01B48                                         ; ConnectionClose+220\u2191r ...
.data:42D01B4C dword_42D01B4C  dd 0                    ; DATA XREF: ConnectionClose+12A\u2191w
.data:42D01B4C                                         ; sub_42CF508D+48\u2191w ...
.data:42D01B50                 align 20h
.data:42D01B60 ; HANDLE dword_42D01B60
.data:42D01B60 dword_42D01B60  dd 0                    ; DATA XREF: ConnectionClose+264\u2191r
.data:42D01B60                                         ; ConnectionClose+273\u2191r ...
.data:42D01B64                 db    0
.data:42D01B65                 db    0
.data:42D01B66                 db    0
.data:42D01B67                 db    0
.data:42D01B68                 db    0
.data:42D01B69                 db    0
.data:42D01B6A                 db    0
.data:42D01B6B                 db    0
.data:42D01B6C                 db    0
.data:42D01B6D                 db    0
.data:42D01B6E                 db    0
.data:42D01B6F                 db    0
.data:42D01B70                 db    0
.data:42D01B71                 db    0
.data:42D01B72                 db    0
.data:42D01B73                 db    0
.data:42D01B74                 db    0
.data:42D01B75                 db    0
.data:42D01B76                 db    0
.data:42D01B77                 db    0
.data:42D01B78                 db    0
.data:42D01B79                 db    0
.data:42D01B7A                 db    0
.data:42D01B7B                 db    0
.data:42D01B7C                 db    0
.data:42D01B7D                 db    0
.data:42D01B7E                 db    0
.data:42D01B7F                 db    0
.data:42D01B80                 db    0
.data:42D01B81                 db    0
.data:42D01B82                 db    0
.data:42D01B83                 db    0
.data:42D01B84                 db    0
.data:42D01B85                 db    0
.data:42D01B86                 db    0
.data:42D01B87                 db    0
.data:42D01B88                 db    0
.data:42D01B89                 db    0
.data:42D01B8A                 db    0
.data:42D01B8B                 db    0
.data:42D01B8C                 db    0
.data:42D01B8D                 db    0
.data:42D01B8E                 db    0
.data:42D01B8F                 db    0
.data:42D01B90                 db    0
.data:42D01B91                 db    0
.data:42D01B92                 db    0
.data:42D01B93                 db    0
.data:42D01B94                 db    0
.data:42D01B95                 db    0
.data:42D01B96                 db    0
.data:42D01B97                 db    0
.data:42D01B98                 db    0
.data:42D01B99                 db    0
.data:42D01B9A                 db    0
.data:42D01B9B                 db    0
.data:42D01B9C                 db    0
.data:42D01B9D                 db    0
.data:42D01B9E                 db    0
.data:42D01B9F                 db    0
.data:42D01BA0 ; void *dword_42D01BA0
.data:42D01BA0 dword_42D01BA0  dd 0                    ; DATA XREF: sub_42CF2585+AF\u2191r
.data:42D01BA0                                         ; sub_42CF5769+28\u2191w ...
.data:42D01BA4 ; HMODULE hModule
.data:42D01BA4 hModule         dd 0                    ; DATA XREF: sub_42CF5128+75\u2191w
.data:42D01BA4                                         ; sub_42CF5128+87\u2191w ...
.data:42D01BA8 dword_42D01BA8  dd 0                    ; DATA XREF: sub_42CF5128+C4\u2191w
.data:42D01BA8                                         ; sub_42CF5128+CE\u2191r ...
.data:42D01BAC dword_42D01BAC  dd 0                    ; DATA XREF: sub_42CF652F+43\u2191r
.data:42D01BB0 dword_42D01BB0  dd 0                    ; DATA XREF: sub_42CF5D98+3D\u2191r
.data:42D01BB4 dword_42D01BB4  dd 0                    ; DATA XREF: sub_42CF5769+78\u2191r
.data:42D01BB8 dword_42D01BB8  dd 0                    ; DATA XREF: sub_42CF2585+B6\u2191r
.data:42D01BBC dword_42D01BBC  dd 0                    ; DATA XREF: sub_42CF664E+4B\u2191r
.data:42D01BC0 dword_42D01BC0  dd 0                    ; DATA XREF: sub_42CF6030+4C\u2191r
.data:42D01BC4                 align 8
.data:42D01BC8 dword_42D01BC8  dd 0                    ; DATA XREF: sub_42CF618A+47\u2191r
.data:42D01BCC dword_42D01BCC  dd 0                    ; DATA XREF: sub_42CF62C4+43\u2191r
.data:42D01BD0 dword_42D01BD0  dd 0                    ; DATA XREF: sub_42CF2585+6\u2191r
.data:42D01BD0                                         ; sub_42CF5769+18\u2191r
.data:42D01BD4 dword_42D01BD4  dd 0                    ; DATA XREF: sub_42CF5EAD+45\u2191r
.data:42D01BD8 dword_42D01BD8  dd 0                    ; DATA XREF: sub_42CF5769+8B\u2191w
.data:42D01BD8                                         ; sub_42CF5769+C5\u2191w
.data:42D01BDC ; DWORD dword_42D01BDC
.data:42D01BDC dword_42D01BDC  dd 0                    ; DATA XREF: sub_42CF69B4+B4\u2191o
.data:42D01BE0 ; HANDLE dword_42D01BE0
.data:42D01BE0 dword_42D01BE0  dd 0                    ; DATA XREF: ConnectionClose:loc_42CF3432\u2191r
.data:42D01BE0                                         ; ConnectionClose+238\u2191r ...
.data:42D01BE4 ; HANDLE hMutex
.data:42D01BE4 hMutex          dd 0                    ; DATA XREF: ConnectionClose+11E\u2191r
.data:42D01BE4                                         ; ConnectionClose+141\u2191r ...
.data:42D01BE8                 align 20h
.data:42D01C00 ; void *dword_42D01C00
.data:42D01C00 dword_42D01C00  dd 0                    ; DATA XREF: sub_42CF29C9+AF\u2191r
.data:42D01C00                                         ; ConnectionClose+328\u2191r ...
.data:42D01C04 ; HMODULE dword_42D01C04
.data:42D01C04 dword_42D01C04  dd 0                    ; DATA XREF: DllEntryPoint:loc_42CF1142\u2191r
.data:42D01C04                                         ; DllEntryPoint+14B\u2191r ...
.data:42D01C08 dword_42D01C08  dd 0                    ; DATA XREF: sub_42CF5128+380\u2191w
.data:42D01C08                                         ; sub_42CF5128+38A\u2191r ...
.data:42D01C0C dword_42D01C0C  dd 0                    ; DATA XREF: sub_42CF652F+CD\u2191r
.data:42D01C10 dword_42D01C10  dd 0                    ; DATA XREF: ConnectionClose+33C\u2191r
.data:42D01C10                                         ; sub_42CF5D98+A1\u2191r
.data:42D01C14 dword_42D01C14  dd 0                    ; DATA XREF: sub_42CF5769+412\u2191r
.data:42D01C18 dword_42D01C18  dd 0                    ; DATA XREF: sub_42CF29C9+B6\u2191r
.data:42D01C1C                 align 10h
.data:42D01C20 dword_42D01C20  dd 0                    ; DATA XREF: sub_42CF6030+FF\u2191r
.data:42D01C24                 align 8
.data:42D01C28 dword_42D01C28  dd 0                    ; DATA XREF: sub_42CF618A+E1\u2191r
.data:42D01C2C dword_42D01C2C  dd 0                    ; DATA XREF: sub_42CF62C4+CD\u2191r
.data:42D01C30 dword_42D01C30  dd 0                    ; DATA XREF: sub_42CF29C9+6\u2191r
.data:42D01C30                                         ; sub_42CF5769+3AD\u2191r
.data:42D01C34 dword_42D01C34  dd 0                    ; DATA XREF: sub_42CF5EAD+10E\u2191r
.data:42D01C38 dword_42D01C38  dd 0                    ; DATA XREF: sub_42CF5769+425\u2191w
.data:42D01C38                                         ; sub_42CF5769+45F\u2191w
.data:42D01C3C ; DWORD dword_42D01C3C
.data:42D01C3C dword_42D01C3C  dd 0                    ; DATA XREF: sub_42CF69B4+293\u2191o
.data:42D01C40 dword_42D01C40  dd 0                    ; DATA XREF: ConnectionListen:loc_42CF220F\u2191w
.data:42D01C40                                         ; sub_42CF2BC5:loc_42CF2DB2\u2191r ...
.data:42D01C44 ; HANDLE hSemaphore
.data:42D01C44 hSemaphore      dd 0                    ; DATA XREF: ConnectionListen+483\u2191w
.data:42D01C44                                         ; ConnectionListen+488\u2191r ...
.data:42D01C48                 align 20h
.data:42D01C60 ; void *dword_42D01C60
.data:42D01C60 dword_42D01C60  dd 0                    ; DATA XREF: sub_42CF28CB+AF\u2191r
.data:42D01C60                                         ; ConnectionClose+2F1\u2191r ...
.data:42D01C64 ; HMODULE dword_42D01C64
.data:42D01C64 dword_42D01C64  dd 0                    ; DATA XREF: DllEntryPoint:loc_42CF112C\u2191r
.data:42D01C64                                         ; DllEntryPoint+135\u2191r ...
.data:42D01C68 dword_42D01C68  dd 0                    ; DATA XREF: sub_42CF5128+2D1\u2191w
.data:42D01C68                                         ; sub_42CF5128+2DB\u2191r ...
.data:42D01C6C dword_42D01C6C  dd 0                    ; DATA XREF: sub_42CF652F+AC\u2191r
.data:42D01C70 dword_42D01C70  dd 0                    ; DATA XREF: ConnectionClose+305\u2191r
.data:42D01C70                                         ; sub_42CF5D98+88\u2191r
.data:42D01C74 dword_42D01C74  dd 0                    ; DATA XREF: sub_42CF5769+329\u2191r
.data:42D01C78 dword_42D01C78  dd 0                    ; DATA XREF: sub_42CF28CB+B6\u2191r
.data:42D01C7C dword_42D01C7C  dd 0                    ; DATA XREF: sub_42CF664E+CC\u2191r
.data:42D01C80 dword_42D01C80  dd 0                    ; DATA XREF: sub_42CF6030+D5\u2191r
.data:42D01C84                 align 8
.data:42D01C88 dword_42D01C88  dd 0                    ; DATA XREF: sub_42CF618A+BC\u2191r
.data:42D01C8C dword_42D01C8C  dd 0                    ; DATA XREF: sub_42CF62C4+AC\u2191r
.data:42D01C90 dword_42D01C90  dd 0                    ; DATA XREF: sub_42CF28CB+6\u2191r
.data:42D01C90                                         ; sub_42CF5769+2C9\u2191r
.data:42D01C94 dword_42D01C94  dd 0                    ; DATA XREF: sub_42CF5EAD+DE\u2191r
.data:42D01C98 dword_42D01C98  dd 0                    ; DATA XREF: sub_42CF5769+33D\u2191w
.data:42D01C98                                         ; sub_42CF5769+378\u2191w
.data:42D01C9C ; DWORD dword_42D01C9C
.data:42D01C9C dword_42D01C9C  dd 0                    ; DATA XREF: sub_42CF69B4+22F\u2191o
.data:42D01CA0 ; size_t Size
.data:42D01CA0 Size            dd 0                    ; DATA XREF: ConnectionRead+D0\u2191r
.data:42D01CA0                                         ; ConnectionRead+E4\u2191r ...
.data:42D01CA4 dword_42D01CA4  dd 0                    ; DATA XREF: ConnectionRead+D6\u2191r
.data:42D01CA4                                         ; ConnectionRead+E9\u2191r ...
.data:42D01CA8                 db    0
.data:42D01CA9                 db    0
.data:42D01CAA                 db    0
.data:42D01CAB                 db    0
.data:42D01CAC                 db    0
.data:42D01CAD                 db    0
.data:42D01CAE                 db    0
.data:42D01CAF                 db    0
.data:42D01CB0                 db    0
.data:42D01CB1                 db    0
.data:42D01CB2                 db    0
.data:42D01CB3                 db    0
.data:42D01CB4 ; ULONG_PTR CompletionKey
.data:42D01CB4 CompletionKey   dd 0                    ; DATA XREF: sub_42CF23E9+11\u2191w
.data:42D01CB4                                         ; ConnectionAccept+34\u2191r ...
.data:42D01CB8 ; HANDLE hHandle
.data:42D01CB8 hHandle         dd 0                    ; DATA XREF: ConnectionListen+4AD\u2191w
.data:42D01CB8                                         ; ConnectionListen+4B2\u2191r ...
.data:42D01CBC ; DWORD dword_42D01CBC
.data:42D01CBC dword_42D01CBC  dd 0                    ; DATA XREF: sub_42CF69B4+5F\u2191o
.data:42D01CC0 ; HANDLE hEventObject
.data:42D01CC0 hEventObject    dd 0                    ; DATA XREF: ConnectionListen+502\u2191w
.data:42D01CC0                                         ; sub_42CF2424+33\u2191w ...
.data:42D01CC4                 db    0
.data:42D01CC5                 db    0
.data:42D01CC6                 db    0
.data:42D01CC7                 db    0
.data:42D01CC8                 db    0
.data:42D01CC9                 db    0
.data:42D01CCA                 db    0
.data:42D01CCB                 db    0
.data:42D01CCC                 db    0
.data:42D01CCD                 db    0
.data:42D01CCE                 db    0
.data:42D01CCF                 db    0
.data:42D01CD0                 db    0
.data:42D01CD1                 db    0
.data:42D01CD2                 db    0
.data:42D01CD3                 db    0
.data:42D01CD4                 db    0
.data:42D01CD5                 db    0
.data:42D01CD6                 db    0
.data:42D01CD7                 db    0
.data:42D01CD8                 db    0
.data:42D01CD9                 db    0
.data:42D01CDA                 db    0
.data:42D01CDB                 db    0
.data:42D01CDC                 db    0
.data:42D01CDD                 db    0
.data:42D01CDE                 db    0
.data:42D01CDF                 db    0
.data:42D01CE0                 db    0
.data:42D01CE1                 db    0
.data:42D01CE2                 db    0
.data:42D01CE3                 db    0
.data:42D01CE4                 db    0
.data:42D01CE5                 db    0
.data:42D01CE6                 db    0
.data:42D01CE7                 db    0
.data:42D01CE8                 db    0
.data:42D01CE9                 db    0
.data:42D01CEA                 db    0
.data:42D01CEB                 db    0
.data:42D01CEC                 db    0
.data:42D01CED                 db    0
.data:42D01CEE                 db    0
.data:42D01CEF                 db    0
.data:42D01CF0                 db    0
.data:42D01CF1                 db    0
.data:42D01CF2                 db    0
.data:42D01CF3                 db    0
.data:42D01CF4                 db    0
.data:42D01CF5                 db    0
.data:42D01CF6                 db    0
.data:42D01CF7                 db    0
.data:42D01CF8                 db    0
.data:42D01CF9                 db    0
.data:42D01CFA                 db    0
.data:42D01CFB                 db    0
.data:42D01CFC                 db    0
.data:42D01CFD                 db    0
.data:42D01CFE                 db    0
.data:42D01CFF                 db    0
.data:42D01D00                 db    0
.data:42D01D01                 db    0
.data:42D01D02                 db    0
.data:42D01D03                 db    0
.data:42D01D04                 db    0
.data:42D01D05                 db    0
.data:42D01D06                 db    0
.data:42D01D07                 db    0
.data:42D01D08                 db    0
.data:42D01D09                 db    0
.data:42D01D0A                 db    0
.data:42D01D0B                 db    0
.data:42D01D0C                 db    0
.data:42D01D0D                 db    0
.data:42D01D0E                 db    0
.data:42D01D0F                 db    0
.data:42D01D10                 db    0
.data:42D01D11                 db    0
.data:42D01D12                 db    0
.data:42D01D13                 db    0
.data:42D01D14                 db    0
.data:42D01D15                 db    0
.data:42D01D16                 db    0
.data:42D01D17                 db    0
.data:42D01D18                 db    0
.data:42D01D19                 db    0
.data:42D01D1A                 db    0
.data:42D01D1B                 db    0
.data:42D01D1C                 db    0
.data:42D01D1D                 db    0
.data:42D01D1E                 db    0
.data:42D01D1F                 db    0
.data:42D01D20                 db    0
.data:42D01D21                 db    0
.data:42D01D22                 db    0
.data:42D01D23                 db    0
.data:42D01D24                 db    0
.data:42D01D25                 db    0
.data:42D01D26                 db    0
.data:42D01D27                 db    0
.data:42D01D28                 db    0
.data:42D01D29                 db    0
.data:42D01D2A                 db    0
.data:42D01D2B                 db    0
.data:42D01D2C                 db    0
.data:42D01D2D                 db    0
.data:42D01D2E                 db    0
.data:42D01D2F                 db    0
.data:42D01D30                 db    0
.data:42D01D31                 db    0
.data:42D01D32                 db    0
.data:42D01D33                 db    0
.data:42D01D34                 db    0
.data:42D01D35                 db    0
.data:42D01D36                 db    0
.data:42D01D37                 db    0
.data:42D01D38                 db    0
.data:42D01D39                 db    0
.data:42D01D3A                 db    0
.data:42D01D3B                 db    0
.data:42D01D3C                 db    0
.data:42D01D3D                 db    0
.data:42D01D3E                 db    0
.data:42D01D3F                 db    0
.data:42D01D40                 db    0
.data:42D01D41                 db    0
.data:42D01D42                 db    0
.data:42D01D43                 db    0
.data:42D01D44                 db    0
.data:42D01D45                 db    0
.data:42D01D46                 db    0
.data:42D01D47                 db    0
.data:42D01D48                 db    0
.data:42D01D49                 db    0
.data:42D01D4A                 db    0
.data:42D01D4B                 db    0
.data:42D01D4C                 db    0
.data:42D01D4D                 db    0
.data:42D01D4E                 db    0
.data:42D01D4F                 db    0
.data:42D01D50                 db    0
.data:42D01D51                 db    0
.data:42D01D52                 db    0
.data:42D01D53                 db    0
.data:42D01D54                 db    0
.data:42D01D55                 db    0
.data:42D01D56                 db    0
.data:42D01D57                 db    0
.data:42D01D58                 db    0
.data:42D01D59                 db    0
.data:42D01D5A                 db    0
.data:42D01D5B                 db    0
.data:42D01D5C                 db    0
.data:42D01D5D                 db    0
.data:42D01D5E                 db    0
.data:42D01D5F                 db    0
.data:42D01D60                 db    0
.data:42D01D61                 db    0
.data:42D01D62                 db    0
.data:42D01D63                 db    0
.data:42D01D64                 db    0
.data:42D01D65                 db    0
.data:42D01D66                 db    0
.data:42D01D67                 db    0
.data:42D01D68                 db    0
.data:42D01D69                 db    0
.data:42D01D6A                 db    0
.data:42D01D6B                 db    0
.data:42D01D6C                 db    0
.data:42D01D6D                 db    0
.data:42D01D6E                 db    0
.data:42D01D6F                 db    0
.data:42D01D70                 db    0
.data:42D01D71                 db    0
.data:42D01D72                 db    0
.data:42D01D73                 db    0
.data:42D01D74                 db    0
.data:42D01D75                 db    0
.data:42D01D76                 db    0
.data:42D01D77                 db    0
.data:42D01D78                 db    0
.data:42D01D79                 db    0
.data:42D01D7A                 db    0
.data:42D01D7B                 db    0
.data:42D01D7C                 db    0
.data:42D01D7D                 db    0
.data:42D01D7E                 db    0
.data:42D01D7F                 db    0
.data:42D01D80                 db    0
.data:42D01D81                 db    0
.data:42D01D82                 db    0
.data:42D01D83                 db    0
.data:42D01D84                 db    0
.data:42D01D85                 db    0
.data:42D01D86                 db    0
.data:42D01D87                 db    0
.data:42D01D88                 db    0
.data:42D01D89                 db    0
.data:42D01D8A                 db    0
.data:42D01D8B                 db    0
.data:42D01D8C                 db    0
.data:42D01D8D                 db    0
.data:42D01D8E                 db    0
.data:42D01D8F                 db    0
.data:42D01D90                 db    0
.data:42D01D91                 db    0
.data:42D01D92                 db    0
.data:42D01D93                 db    0
.data:42D01D94                 db    0
.data:42D01D95                 db    0
.data:42D01D96                 db    0
.data:42D01D97                 db    0
.data:42D01D98                 db    0
.data:42D01D99                 db    0
.data:42D01D9A                 db    0
.data:42D01D9B                 db    0
.data:42D01D9C                 db    0
.data:42D01D9D                 db    0
.data:42D01D9E                 db    0
.data:42D01D9F                 db    0
.data:42D01DA0                 db    0
.data:42D01DA1                 db    0
.data:42D01DA2                 db    0
.data:42D01DA3                 db    0
.data:42D01DA4                 db    0
.data:42D01DA5                 db    0
.data:42D01DA6                 db    0
.data:42D01DA7                 db    0
.data:42D01DA8                 db    0
.data:42D01DA9                 db    0
.data:42D01DAA                 db    0
.data:42D01DAB                 db    0
.data:42D01DAC                 db    0
.data:42D01DAD                 db    0
.data:42D01DAE                 db    0
.data:42D01DAF                 db    0
.data:42D01DB0                 db    0
.data:42D01DB1                 db    0
.data:42D01DB2                 db    0
.data:42D01DB3                 db    0
.data:42D01DB4                 db    0
.data:42D01DB5                 db    0
.data:42D01DB6                 db    0
.data:42D01DB7                 db    0
.data:42D01DB8                 db    0
.data:42D01DB9                 db    0
.data:42D01DBA                 db    0
.data:42D01DBB                 db    0
.data:42D01DBC                 db    0
.data:42D01DBD                 db    0
.data:42D01DBE                 db    0
.data:42D01DBF                 db    0
.data:42D01DC0 ; DWORD ThreadId
.data:42D01DC0 ThreadId        dd 0                    ; DATA XREF: sub_42CF508D+52\u2191o
.data:42D01DC4                 align 8
.data:42D01DC8 unk_42D01DC8    db    0                 ; DATA XREF: ConnectionListen+3E8\u2191o
.data:42D01DC8                                         ; sub_42CF7275+23B\u2191o
.data:42D01DC9                 db    0
.data:42D01DCA                 db    0
.data:42D01DCB                 db    0
.data:42D01DCC                 db    0
.data:42D01DCD                 db    0
.data:42D01DCE                 db    0
.data:42D01DCF                 db    0
.data:42D01DD0 dword_42D01DD0  dd 0                    ; DATA XREF: ConnectionClose:loc_42CF3318\u2191r
.data:42D01DD0                                         ; ConnectionClose+15C\u2191w ...
.data:42D01DD4                 align 10h
.data:42D01DE0 unk_42D01DE0    db    0                 ; DATA XREF: sub_42CF2683:loc_42CF2777\u2191o
.data:42D01DE0                                         ; sub_42CF2683+129\u2191o ...
.data:42D01DE1                 db    0
.data:42D01DE2                 db    0
.data:42D01DE3                 db    0
.data:42D01DE4                 db    0
.data:42D01DE5                 db    0
.data:42D01DE6                 db    0
.data:42D01DE7                 db    0
.data:42D01DE8                 db    0
.data:42D01DE9                 db    0
.data:42D01DEA                 db    0
.data:42D01DEB                 db    0
.data:42D01DEC                 db    0
.data:42D01DED                 db    0
.data:42D01DEE                 db    0
.data:42D01DEF                 db    0
.data:42D01DF0                 db    0
.data:42D01DF1                 db    0
.data:42D01DF2                 db    0
.data:42D01DF3                 db    0
.data:42D01DF4                 db    0
.data:42D01DF5                 db    0
.data:42D01DF6                 db    0
.data:42D01DF7                 db    0
.data:42D01DF8 dword_42D01DF8  dd 0                    ; DATA XREF: sub_42CF23E9+1E\u2191w
.data:42D01DF8                                         ; ConnectionAccept+40\u2191r
.data:42D01DFC dword_42D01DFC  dd 0                    ; DATA XREF: ConnectionListen:loc_42CF1644\u2191w
.data:42D01DFC                                         ; ConnectionListen:loc_42CF1650\u2191w ...
.data:42D01E00 ; void *Block
.data:42D01E00 Block           dd 0                    ; DATA XREF: sub_42CF2683+AF\u2191r
.data:42D01E00                                         ; ConnectionClose:loc_42CF3488\u2191r ...
.data:42D01E04 ; HMODULE hLibModule
.data:42D01E04 hLibModule      dd 0                    ; DATA XREF: DllEntryPoint+101\u2191r
.data:42D01E04                                         ; DllEntryPoint+10A\u2191r ...
.data:42D01E08 dword_42D01E08  dd 0                    ; DATA XREF: sub_42CF5128+173\u2191w
.data:42D01E08                                         ; sub_42CF5128+17D\u2191r ...
.data:42D01E0C dword_42D01E0C  dd 0                    ; DATA XREF: sub_42CF652F+67\u2191r
.data:42D01E10 dword_42D01E10  dd 0                    ; DATA XREF: ConnectionClose+297\u2191r
.data:42D01E10                                         ; sub_42CF5D98+56\u2191r
.data:42D01E14 dword_42D01E14  dd 0                    ; DATA XREF: sub_42CF5769+15E\u2191r
.data:42D01E18 dword_42D01E18  dd 0                    ; DATA XREF: sub_42CF2683+B6\u2191r
.data:42D01E1C dword_42D01E1C  dd 0                    ; DATA XREF: sub_42CF664E+77\u2191r
.data:42D01E20 dword_42D01E20  dd 0                    ; DATA XREF: sub_42CF6030+79\u2191r
.data:42D01E24                 align 8
.data:42D01E28 dword_42D01E28  dd 0                    ; DATA XREF: sub_42CF618A+6F\u2191r
.data:42D01E2C dword_42D01E2C  dd 0                    ; DATA XREF: sub_42CF62C4+67\u2191r
.data:42D01E30 dword_42D01E30  dd 0                    ; DATA XREF: sub_42CF2683+6\u2191r
.data:42D01E30                                         ; sub_42CF5769+FA\u2191r
.data:42D01E34 dword_42D01E34  dd 0                    ; DATA XREF: sub_42CF5EAD+78\u2191r
.data:42D01E38 dword_42D01E38  dd 0                    ; DATA XREF: sub_42CF5769+172\u2191w
.data:42D01E38                                         ; sub_42CF5769+1AC\u2191w
.data:42D01E3C ; DWORD dword_42D01E3C
.data:42D01E3C dword_42D01E3C  dd 0                    ; DATA XREF: sub_42CF69B4+11A\u2191o
.data:42D01E40 ; char MultiByteStr[256]
.data:42D01E40 MultiByteStr    db 100h dup(0)          ; DATA XREF: ConnectionListen+EC\u2191o
.data:42D01E40                                         ; ConnectionListen+FF\u2191o ...
.data:42D01F40 ; void *dword_42D01F40
.data:42D01F40 dword_42D01F40  dd 0                    ; DATA XREF: sub_42CF27CD+AF\u2191r
.data:42D01F40                                         ; ConnectionClose+2BA\u2191r ...
.data:42D01F44 ; HMODULE dword_42D01F44
.data:42D01F44 dword_42D01F44  dd 0                    ; DATA XREF: DllEntryPoint:loc_42CF1116\u2191r
.data:42D01F44                                         ; DllEntryPoint+11F\u2191r ...
.data:42D01F48 dword_42D01F48  dd 0                    ; DATA XREF: sub_42CF5128+222\u2191w
.data:42D01F48                                         ; sub_42CF5128+22C\u2191r ...
.data:42D01F4C dword_42D01F4C  dd 0                    ; DATA XREF: sub_42CF652F+8B\u2191r
.data:42D01F50 dword_42D01F50  dd 0                    ; DATA XREF: ConnectionClose+2CE\u2191r
.data:42D01F50                                         ; sub_42CF5D98+6F\u2191r
.data:42D01F54 dword_42D01F54  dd 0                    ; DATA XREF: sub_42CF5769+245\u2191r
.data:42D01F58 dword_42D01F58  dd 0                    ; DATA XREF: sub_42CF27CD+B6\u2191r
.data:42D01F5C dword_42D01F5C  dd 0                    ; DATA XREF: sub_42CF664E+A3\u2191r
.data:42D01F60 dword_42D01F60  dd 0                    ; DATA XREF: sub_42CF6030+A8\u2191r
.data:42D01F64                 align 8
.data:42D01F68 dword_42D01F68  dd 0                    ; DATA XREF: sub_42CF618A+97\u2191r
.data:42D01F6C dword_42D01F6C  dd 0                    ; DATA XREF: sub_42CF62C4+8B\u2191r
.data:42D01F70 dword_42D01F70  dd 0                    ; DATA XREF: sub_42CF27CD+6\u2191r
.data:42D01F70                                         ; sub_42CF5769+1E1\u2191r
.data:42D01F74 dword_42D01F74  dd 0                    ; DATA XREF: sub_42CF5EAD+AB\u2191r
.data:42D01F78 dword_42D01F78  dd 0                    ; DATA XREF: sub_42CF5769+259\u2191w
.data:42D01F78                                         ; sub_42CF5769+294\u2191w
.data:42D01F7C ; DWORD dword_42D01F7C
.data:42D01F7C dword_42D01F7C  dd 0                    ; DATA XREF: sub_42CF69B4+1CE\u2191o
.data:42D01F80 ; struct _RTL_CRITICAL_SECTION CriticalSection
.data:42D01F80 CriticalSection _RTL_CRITICAL_SECTION <0>
.data:42D01F80                                         ; DATA XREF: sub_42CF2683+E9\u2191o
.data:42D01F80                                         ; sub_42CF2683+105\u2191o ...
.data:42D01F98                 align 10h
.data:42D01FA0 ; SOCKET s
.data:42D01FA0 s               dd 0                    ; DATA XREF: ConnectionListen+513\u2191w
.data:42D01FA0                                         ; ConnectionListen+EA0\u2191w ...
.data:42D01FA4                 db    0
.data:42D01FA5                 db    0
.data:42D01FA6                 db    0
.data:42D01FA7                 db    0
.data:42D01FA8                 db    0
.data:42D01FA9                 db    0
.data:42D01FAA                 db    0
.data:42D01FAB                 db    0
.data:42D01FAC                 db    0
.data:42D01FAD                 db    0
.data:42D01FAE                 db    0
.data:42D01FAF                 db    0
.data:42D01FB0                 db    0
.data:42D01FB1                 db    0
.data:42D01FB2                 db    0
.data:42D01FB3                 db    0
.data:42D01FB4                 db    0
.data:42D01FB5                 db    0
.data:42D01FB6                 db    0
.data:42D01FB7                 db    0
.data:42D01FB8                 db    0
.data:42D01FB9                 db    0
.data:42D01FBA                 db    0
.data:42D01FBB                 db    0
.data:42D01FBC                 db    0
.data:42D01FBD                 db    0
.data:42D01FBE                 db    0
.data:42D01FBF                 db    0
.data:42D01FC0                 db    0
.data:42D01FC1                 db    0
.data:42D01FC2                 db    0
.data:42D01FC3                 db    0
.data:42D01FC4                 db    0
.data:42D01FC5                 db    0
.data:42D01FC6                 db    0
.data:42D01FC7                 db    0
.data:42D01FC8                 db    0
.data:42D01FC9                 db    0
.data:42D01FCA                 db    0
.data:42D01FCB                 db    0
.data:42D01FCC                 db    0
.data:42D01FCD                 db    0
.data:42D01FCE                 db    0
.data:42D01FCF                 db    0
.data:42D01FD0                 db    0
.data:42D01FD1                 db    0
.data:42D01FD2                 db    0
.data:42D01FD3                 db    0
.data:42D01FD4                 db    0
.data:42D01FD5                 db    0
.data:42D01FD6                 db    0
.data:42D01FD7                 db    0
.data:42D01FD8                 db    0
.data:42D01FD9                 db    0
.data:42D01FDA                 db    0
.data:42D01FDB                 db    0
.data:42D01FDC                 db    0
.data:42D01FDD                 db    0
.data:42D01FDE                 db    0
.data:42D01FDF                 db    0
.data:42D01FE0                 db    0
.data:42D01FE1                 db    0
.data:42D01FE2                 db    0
.data:42D01FE3                 db    0
.data:42D01FE4                 db    0
.data:42D01FE5                 db    0
.data:42D01FE6                 db    0
.data:42D01FE7                 db    0
.data:42D01FE8                 db    0
.data:42D01FE9                 db    0
.data:42D01FEA                 db    0
.data:42D01FEB                 db    0
.data:42D01FEC                 db    0
.data:42D01FED                 db    0
.data:42D01FEE                 db    0
.data:42D01FEF                 db    0
.data:42D01FF0                 db    0
.data:42D01FF1                 db    0
.data:42D01FF2                 db    0
.data:42D01FF3                 db    0
.data:42D01FF4                 db    0
.data:42D01FF5                 db    0
.data:42D01FF6                 db    0
.data:42D01FF7                 db    0
.data:42D01FF8                 db    0
.data:42D01FF9                 db    0
.data:42D01FFA                 db    0
.data:42D01FFB                 db    0
.data:42D01FFC                 db    0
.data:42D01FFD                 db    0
.data:42D01FFE                 db    0
.data:42D01FFF                 db    0
.data:42D02000                 db    ? ;
.data:42D02001                 db    ? ;
.data:42D02002                 db    ? ;
.data:42D02003                 db    ? ;
.data:42D02004                 db    ? ;
.data:42D02005                 db    ? ;
.data:42D02006                 db    ? ;
.data:42D02007                 db    ? ;
.data:42D02008                 db    ? ;
.data:42D02009                 db    ? ;
.data:42D0200A                 db    ? ;
.data:42D0200B                 db    ? ;
.data:42D0200C                 db    ? ;
.data:42D0200D                 db    ? ;
.data:42D0200E                 db    ? ;
.data:42D0200F                 db    ? ;
.data:42D02010                 db    ? ;
.data:42D02011                 db    ? ;
.data:42D02012                 db    ? ;
.data:42D02013                 db    ? ;
.data:42D02014                 db    ? ;
.data:42D02015                 db    ? ;
.data:42D02016                 db    ? ;
.data:42D02017                 db    ? ;
.data:42D02018                 db    ? ;
.data:42D02019                 db    ? ;
.data:42D0201A                 db    ? ;
.data:42D0201B                 db    ? ;
.data:42D0201C                 db    ? ;
.data:42D0201D                 db    ? ;
.data:42D0201E                 db    ? ;
.data:42D0201F                 db    ? ;
.data:42D02020                 db    ? ;
.data:42D02021                 db    ? ;
.data:42D02022                 db    ? ;
.data:42D02023                 db    ? ;
.data:42D02024                 db    ? ;
.data:42D02025                 db    ? ;
.data:42D02026                 db    ? ;
.data:42D02027                 db    ? ;
.data:42D02028                 db    ? ;
.data:42D02029                 db    ? ;
.data:42D0202A                 db    ? ;
.data:42D0202B                 db    ? ;
.data:42D0202C                 db    ? ;
.data:42D0202D                 db    ? ;
.data:42D0202E                 db    ? ;
.data:42D0202F                 db    ? ;
.data:42D02030                 db    ? ;
.data:42D02031                 db    ? ;
.data:42D02032                 db    ? ;
.data:42D02033                 db    ? ;
.data:42D02034                 db    ? ;
.data:42D02035                 db    ? ;
.data:42D02036                 db    ? ;
.data:42D02037                 db    ? ;
.data:42D02038                 db    ? ;
.data:42D02039                 db    ? ;
.data:42D0203A                 db    ? ;
.data:42D0203B                 db    ? ;
.data:42D0203C                 db    ? ;
.data:42D0203D                 db    ? ;
.data:42D0203E                 db    ? ;
.data:42D0203F                 db    ? ;
.data:42D02040                 db    ? ;
.data:42D02041                 db    ? ;
.data:42D02042                 db    ? ;
.data:42D02043                 db    ? ;
.data:42D02044                 db    ? ;
.data:42D02045                 db    ? ;
.data:42D02046                 db    ? ;
.data:42D02047                 db    ? ;
.data:42D02048                 db    ? ;
.data:42D02049                 db    ? ;
.data:42D0204A                 db    ? ;
.data:42D0204B                 db    ? ;
.data:42D0204C                 db    ? ;
.data:42D0204D                 db    ? ;
.data:42D0204E                 db    ? ;
.data:42D0204F                 db    ? ;
.data:42D02050                 db    ? ;
.data:42D02051                 db    ? ;
.data:42D02052                 db    ? ;
.data:42D02053                 db    ? ;
.data:42D02054                 db    ? ;
.data:42D02055                 db    ? ;
.data:42D02056                 db    ? ;
.data:42D02057                 db    ? ;
.data:42D02058                 db    ? ;
.data:42D02059                 db    ? ;
.data:42D0205A                 db    ? ;
.data:42D0205B                 db    ? ;
.data:42D0205C                 db    ? ;
.data:42D0205D                 db    ? ;
.data:42D0205E                 db    ? ;
.data:42D0205F                 db    ? ;
.data:42D02060                 db    ? ;
.data:42D02061                 db    ? ;
.data:42D02062                 db    ? ;
.data:42D02063                 db    ? ;
.data:42D02064                 db    ? ;
.data:42D02065                 db    ? ;
.data:42D02066                 db    ? ;
.data:42D02067                 db    ? ;
.data:42D02068                 db    ? ;
.data:42D02069                 db    ? ;
.data:42D0206A                 db    ? ;
.data:42D0206B                 db    ? ;
.data:42D0206C                 db    ? ;
.data:42D0206D                 db    ? ;
.data:42D0206E                 db    ? ;
.data:42D0206F                 db    ? ;
.data:42D02070                 db    ? ;
.data:42D02071                 db    ? ;
.data:42D02072                 db    ? ;
.data:42D02073                 db    ? ;
.data:42D02074                 db    ? ;
.data:42D02075                 db    ? ;
.data:42D02076                 db    ? ;
.data:42D02077                 db    ? ;
.data:42D02078                 db    ? ;
.data:42D02079                 db    ? ;
.data:42D0207A                 db    ? ;
.data:42D0207B                 db    ? ;
.data:42D0207C                 db    ? ;
.data:42D0207D                 db    ? ;
.data:42D0207E                 db    ? ;
.data:42D0207F                 db    ? ;
.data:42D02080                 db    ? ;
.data:42D02081                 db    ? ;
.data:42D02082                 db    ? ;
.data:42D02083                 db    ? ;
.data:42D02084                 db    ? ;
.data:42D02085                 db    ? ;
.data:42D02086                 db    ? ;
.data:42D02087                 db    ? ;
.data:42D02088                 db    ? ;
.data:42D02089                 db    ? ;
.data:42D0208A                 db    ? ;
.data:42D0208B                 db    ? ;
.data:42D0208C                 db    ? ;
.data:42D0208D                 db    ? ;
.data:42D0208E                 db    ? ;
.data:42D0208F                 db    ? ;
.data:42D02090                 db    ? ;
.data:42D02091                 db    ? ;
.data:42D02092                 db    ? ;
.data:42D02093                 db    ? ;
.data:42D02094                 db    ? ;
.data:42D02095                 db    ? ;
.data:42D02096                 db    ? ;
.data:42D02097                 db    ? ;
.data:42D02098                 db    ? ;
.data:42D02099                 db    ? ;
.data:42D0209A                 db    ? ;
.data:42D0209B                 db    ? ;
.data:42D0209C                 db    ? ;
.data:42D0209D                 db    ? ;
.data:42D0209E                 db    ? ;
.data:42D0209F                 db    ? ;
.data:42D020A0 dword_42D020A0  dd ?                    ; DATA XREF: ConnectionInitialize+19\u2191r
.data:42D020A0                                         ; sub_42CFC1D0+E6\u2191w ...
.data:42D020A4                 align 20h
.data:42D020C0 ; void *dword_42D020C0
.data:42D020C0 dword_42D020C0  dd ?                    ; DATA XREF: sub_42CF2AC7+AF\u2191r
.data:42D020C0                                         ; ConnectionClose+35F\u2191r ...
.data:42D020C4 ; HMODULE dword_42D020C4
.data:42D020C4 dword_42D020C4  dd ?                    ; DATA XREF: DllEntryPoint:loc_42CF1157\u2191r
.data:42D020C4                                         ; DllEntryPoint+160\u2191r ...
.data:42D020C8 dword_42D020C8  dd ?                    ; DATA XREF: sub_42CF5128+478\u2191w
.data:42D020C8                                         ; sub_42CF5128+482\u2191r ...
.data:42D020CC dword_42D020CC  dd ?                    ; DATA XREF: sub_42CF652F+EE\u2191r
.data:42D020D0 dword_42D020D0  dd ?                    ; DATA XREF: ConnectionClose+373\u2191r
.data:42D020D0                                         ; sub_42CF5D98+BA\u2191r
.data:42D020D4 dword_42D020D4  dd ?                    ; DATA XREF: sub_42CF5769+4F8\u2191r
.data:42D020D8 dword_42D020D8  dd ?                    ; DATA XREF: sub_42CF2AC7+B6\u2191r
.data:42D020DC                 align 10h
.data:42D020E0 dword_42D020E0  dd ?                    ; DATA XREF: sub_42CF6030+129\u2191r
.data:42D020E4                 align 8
.data:42D020E8 dword_42D020E8  dd ?                    ; DATA XREF: sub_42CF618A+106\u2191r
.data:42D020EC dword_42D020EC  dd ?                    ; DATA XREF: sub_42CF62C4+EE\u2191r
.data:42D020F0 dword_42D020F0  dd ?                    ; DATA XREF: sub_42CF2AC7+6\u2191r
.data:42D020F0                                         ; sub_42CF5769+494\u2191r
.data:42D020F4 dword_42D020F4  dd ?                    ; DATA XREF: sub_42CF5EAD+13E\u2191r
.data:42D020F8 dword_42D020F8  dd ?                    ; DATA XREF: sub_42CF5769+50C\u2191w
.data:42D020F8                                         ; sub_42CF5769+546\u2191w
.data:42D020FC ; DWORD dword_42D020FC
.data:42D020FC dword_42D020FC  dd ?                    ; DATA XREF: sub_42CF69B4+344\u2191o
.data:42D02100 ; DWORD dword_42D02100
.data:42D02100 dword_42D02100  dd ?                    ; DATA XREF: sub_42CF69B4+F\u2191o
.data:42D02104                 align 1000h
.data:42D02104 _data           ends
.data:42D02104
.data:42D02104
.data:42D02104                 end DllEntryPoint
